<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CoCoNutNut&#39;s NoteBook</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-05-02T06:44:40.845Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>coconutnut</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è¯»ä¹¦ç¬”è®° æ·±åº¦å·¥ä½œ</title>
    <link href="http://yoursite.com/2020/05/02/deepwork/"/>
    <id>http://yoursite.com/2020/05/02/deepwork/</id>
    <published>2020-05-02T06:43:28.000Z</published>
    <updated>2020-05-02T06:44:40.845Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2020/deepwork.png">]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/2020/deepwork.png&quot;&gt;
      
    
    </summary>
    
    
      <category term="Memo" scheme="http://yoursite.com/categories/Memo/"/>
    
    
      <category term="mindmap" scheme="http://yoursite.com/tags/mindmap/"/>
    
      <category term="excerpt" scheme="http://yoursite.com/tags/excerpt/"/>
    
  </entry>
  
  <entry>
    <title>è¯¾ç¨‹æ€»ç»“ å‹åŠ›ä¸æƒ…ç»ªç®¡ç†</title>
    <link href="http://yoursite.com/2020/05/02/mindmap-stress/"/>
    <id>http://yoursite.com/2020/05/02/mindmap-stress/</id>
    <published>2020-05-02T06:39:18.000Z</published>
    <updated>2020-05-02T06:42:28.658Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2020/stress.png">]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/2020/stress.png&quot;&gt;
      
    
    </summary>
    
    
      <category term="Other" scheme="http://yoursite.com/categories/Other/"/>
    
    
      <category term="mindmap" scheme="http://yoursite.com/tags/mindmap/"/>
    
  </entry>
  
  <entry>
    <title>è¯¾ç¨‹æ€»ç»“ ä¿¡æ¯ç´ å…»ä¸å®è·µ</title>
    <link href="http://yoursite.com/2020/05/02/mindmap-paper/"/>
    <id>http://yoursite.com/2020/05/02/mindmap-paper/</id>
    <published>2020-05-02T06:37:40.000Z</published>
    <updated>2020-05-02T06:42:29.475Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2020/paper.png">]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/2020/paper.png&quot;&gt;


      
    
    </summary>
    
    
      <category term="Other" scheme="http://yoursite.com/categories/Other/"/>
    
    
      <category term="mindmap" scheme="http://yoursite.com/tags/mindmap/"/>
    
  </entry>
  
  <entry>
    <title>gitç¬”è®°</title>
    <link href="http://yoursite.com/2020/05/02/note-git/"/>
    <id>http://yoursite.com/2020/05/02/note-git/</id>
    <published>2020-05-02T05:55:24.000Z</published>
    <updated>2020-05-02T05:57:10.154Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/pcottle/learnGitBranching" target="_blank" rel="noopener">https://github.com/pcottle/learnGitBranching</a></p></blockquote><img src="/images/2020/git.png">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/pcottle/learnGitBranching&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/pcottle/learnGitBra
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="tool" scheme="http://yoursite.com/tags/tool/"/>
    
      <category term="mindmap" scheme="http://yoursite.com/tags/mindmap/"/>
    
  </entry>
  
  <entry>
    <title>å››æœˆæ¯æ—¥ä¸€é¢˜æ‰“å¡å®Œå·¥çºªå¿µ</title>
    <link href="http://yoursite.com/2020/04/30/memo/"/>
    <id>http://yoursite.com/2020/04/30/memo/</id>
    <published>2020-04-30T08:02:52.000Z</published>
    <updated>2020-04-30T08:06:18.121Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2020/screencapture2020-04-30 PM4.03.43.jpg" width=300><p>ä¸‰æœˆå·®ä¸€ç‚¹ç‚¹ï¼Œå››æœˆæˆåŠŸå’¯~</p><img src="/images/2020/screencapture2020-04-30 PM4.04.55.jpg" width=300>]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/2020/screencapture2020-04-30 PM4.03.43.jpg&quot; width=300&gt;

&lt;p&gt;ä¸‰æœˆå·®ä¸€ç‚¹ç‚¹ï¼Œå››æœˆæˆåŠŸå’¯~&lt;/p&gt;
&lt;img src=&quot;/images/2020/screencapture2020-04-3
      
    
    </summary>
    
    
      <category term="Memo" scheme="http://yoursite.com/categories/Memo/"/>
    
    
      <category term="algorithm" scheme="http://yoursite.com/tags/algorithm/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°06 GatewayæœåŠ¡ç½‘å…³</title>
    <link href="http://yoursite.com/2020/04/25/note-springcloud-06/"/>
    <id>http://yoursite.com/2020/04/25/note-springcloud-06/</id>
    <published>2020-04-25T01:42:08.000Z</published>
    <updated>2020-04-25T05:31:33.869Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://blog.csdn.net/ThinkWon/article/details/103757927" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103757927</a></p></blockquote><p>Gatewayæ˜¯åœ¨Springç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„APIç½‘å…³æœåŠ¡ï¼Œæ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹APIè¿›è¡Œè·¯ç”±ï¼Œä»¥åŠæä¾›ä¸€äº›å¼ºå¤§çš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œ ä¾‹å¦‚ï¼šç†”æ–­ã€é™æµã€é‡è¯•ç­‰</p><p>é›†æˆHystrixçš„æ–­è·¯å™¨åŠŸèƒ½å’ŒSpring CloudæœåŠ¡å‘ç°åŠŸèƒ½</p><h1 id="åˆ›å»ºapi-gatewayæ¨¡å—"><a href="#åˆ›å»ºapi-gatewayæ¨¡å—" class="headerlink" title="åˆ›å»ºapi-gatewayæ¨¡å—"></a>åˆ›å»ºapi-gatewayæ¨¡å—</h1><h2 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸éœ€è¦æ³¨å†Œï¼Ÿ</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9201</span></span><br><span class="line"></span><br><span class="line"><span class="attr">service-url:</span></span><br><span class="line">  <span class="attr">user-service:</span> <span class="string">http://localhost:8201</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">          <span class="comment"># è·¯ç”±çš„ID</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">path_route</span></span><br><span class="line">          <span class="comment"># åŒ¹é…åè·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">$&#123;service-url.user-service&#125;/user/&#123;id&#125;</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/user/&#123;id&#125;</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨consul-serverã€user-serviceå’Œapi-gateway</p><p>æµ‹è¯• <a href="http://localhost:9201/user/1" target="_blank" rel="noopener">http://localhost:9201/user/1</a></p><img src="/images/2020/screencapture2020-04-25 AM9.58.55.jpg"><h1 id="Route-Predicate-çš„ä½¿ç”¨"><a href="#Route-Predicate-çš„ä½¿ç”¨" class="headerlink" title="Route Predicate çš„ä½¿ç”¨"></a>Route Predicate çš„ä½¿ç”¨</h1><ul><li><p>After Route Predicate : åœ¨æŒ‡å®šæ—¶é—´ä¹‹åçš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p></li><li><p>Before Route Predicate : åœ¨æŒ‡å®šæ—¶é—´ä¹‹å‰çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p></li><li><p>Between Route Predicate : åœ¨æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p></li><li><p>Cookie Route Predicate : å¸¦æœ‰æŒ‡å®šCookieçš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;jourwon</span><br></pre></td></tr></table></figure></li><li><p>Header Route Predicate : å¸¦æœ‰æŒ‡å®šè¯·æ±‚å¤´çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Request-Id:123</span><br></pre></td></tr></table></figure></li><li><p>Host Route Predicate : å¸¦æœ‰æŒ‡å®šHostçš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Host:www.jourwon.com</span><br></pre></td></tr></table></figure></li><li><p>Method Route Predicate : å‘é€æŒ‡å®šæ–¹æ³•çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET</span><br></pre></td></tr></table></figure></li><li><p>Path Route Predicate : å‘é€æŒ‡å®šè·¯å¾„çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;user&#x2F;1</span><br></pre></td></tr></table></figure></li><li><p>Query Route Predicate : å¸¦æŒ‡å®šæŸ¥è¯¢å‚æ•°çš„è¯·æ±‚å¯ä»¥åŒ¹é…è¯¥è·¯ç”±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;jourwon</span><br></pre></td></tr></table></figure></li><li><p>RemoteAddr Route Predicate : ä»æŒ‡å®šè¿œç¨‹åœ°å€å‘èµ·çš„è¯·æ±‚å¯ä»¥åŒ¹é…è¯¥è·¯ç”±</p></li><li><p>Weight Route Predicate : ä½¿ç”¨æƒé‡æ¥è·¯ç”±ç›¸åº”è¯·æ±‚</p><p>å¦‚80%çš„è¯·æ±‚è·¯ç”±åˆ°localhost:8201ï¼Œ20%è·¯ç”±åˆ°localhost:8202</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">weight_high</span></span><br><span class="line">        <span class="attr">uri:</span> <span class="string">http://localhost:8201</span></span><br><span class="line">        <span class="attr">predicates:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">Weight=group1,</span> <span class="number">8</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">weight_low</span></span><br><span class="line">        <span class="attr">uri:</span> <span class="string">http://localhost:8202</span></span><br><span class="line">        <span class="attr">predicates:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">Weight=group1,</span> <span class="number">2</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="Route-Filterçš„ä½¿ç”¨"><a href="#Route-Filterçš„ä½¿ç”¨" class="headerlink" title="Route Filterçš„ä½¿ç”¨"></a>Route Filterçš„ä½¿ç”¨</h1><p>å¯ç”¨äºä¿®æ”¹è¿›å…¥çš„HTTPè¯·æ±‚å’Œè¿”å›çš„HTTPå“åº”ï¼Œåªèƒ½æŒ‡å®šè·¯ç”±è¿›è¡Œä½¿ç”¨</p><ul><li>AddRequestParameter GatewayFilter : ç»™è¯·æ±‚æ·»åŠ å‚æ•°çš„è¿‡æ»¤å™¨</li><li>StripPrefix GatewayFilter : å¯¹æŒ‡å®šæ•°é‡çš„è·¯å¾„å‰ç¼€è¿›è¡Œå»é™¤çš„è¿‡æ»¤å™¨</li><li>PrefixPath GatewayFilter : ä¸StripPrefixè¿‡æ»¤å™¨ç›¸åï¼Œä¼šå¯¹åŸæœ‰è·¯å¾„è¿›è¡Œå¢åŠ æ“ä½œçš„è¿‡æ»¤å™¨</li><li>Retry GatewayFilter : å¯¹è·¯ç”±è¯·æ±‚è¿›è¡Œé‡è¯•çš„è¿‡æ»¤å™¨ï¼Œæ ¹æ®è·¯ç”±è¯·æ±‚è¿”å›çš„HTTPçŠ¶æ€ç æ¥ç¡®å®šæ˜¯å¦è¿›è¡Œé‡è¯•</li></ul><h2 id="Hystrix-GatewayFilter"><a href="#Hystrix-GatewayFilter" class="headerlink" title="Hystrix GatewayFilter"></a>Hystrix GatewayFilter</h2><p>å°†æ–­è·¯å™¨åŠŸèƒ½æ·»åŠ åˆ°ç½‘å…³è·¯ç”±ä¸­</p><p>éœ€æ·»åŠ Hystrixçš„ç›¸å…³ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ ç›¸å…³æœåŠ¡é™çº§çš„å¤„ç†ç±»FallbackController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FallbackController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/fallback"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">fallback</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">"data"</span>,<span class="keyword">null</span>);</span><br><span class="line">        result.put(<span class="string">"message"</span>,<span class="string">"Get request fallback!"</span>);</span><br><span class="line">        result.put(<span class="string">"code"</span>,<span class="number">500</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®æœåŠ¡é™çº§</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">filters:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Hystrix</span></span><br><span class="line">    <span class="attr">args:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">fallbackcmd</span></span><br><span class="line">      <span class="attr">fallback-uri:</span> <span class="string">forward:/fallback</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼ˆå…ˆé‡å¯api-gatewayï¼‰</p><p>å…³é—­user-serviceï¼Œè°ƒç”¨<a href="http://localhost:9201/user/1" target="_blank" rel="noopener">http://localhost:9201/user/1</a> </p><img src="/images/2020/screencapture2020-04-25 AM10.13.57.jpg"><p>å‘ç”Ÿäº†é™çº§</p><h2 id="RequestRateLimiter-GatewayFilter"><a href="#RequestRateLimiter-GatewayFilter" class="headerlink" title="RequestRateLimiter GatewayFilter"></a>RequestRateLimiter GatewayFilter</h2><p>å¯ä»¥ç”¨äºé™æµ</p><p>æ·»åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis-reactive<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ é™æµç­–ç•¥çš„é…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisRateLimiterConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> KeyResolver <span class="title">userKeyResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®è¯·æ±‚å‚æ•°ä¸­çš„usernameè¿›è¡Œé™æµ</span></span><br><span class="line">        <span class="keyword">return</span> exchange -&gt; Mono.just(exchange.getRequest().getQueryParams().getFirst(<span class="string">"username"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> KeyResolver <span class="title">ipKeyResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®è®¿é—®IPè¿›è¡Œé™æµ</span></span><br><span class="line">        <span class="keyword">return</span> exchange -&gt; Mono.just(exchange.getRequest().getRemoteAddress().getHostName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ Rediså’ŒRequestRateLimiterçš„é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RequestRateLimiter</span></span><br><span class="line">  <span class="attr">args:</span></span><br><span class="line">    <span class="comment"># æ¯ç§’å…è®¸å¤„ç†çš„è¯·æ±‚æ•°é‡</span></span><br><span class="line">    <span class="attr">redis-rate-limiter.replenishRate:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># æ¯ç§’æœ€å¤§å¤„ç†çš„è¯·æ±‚æ•°é‡</span></span><br><span class="line">    <span class="attr">redis-rate-limiter.burstCapacity:</span> <span class="number">2</span></span><br><span class="line">    <span class="comment"># é™æµç­–ç•¥ï¼Œå¯¹åº”ç­–ç•¥çš„Bean</span></span><br><span class="line">    <span class="attr">key-resolver:</span> <span class="string">"#&#123;@ipKeyResolver&#125;"</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><p>å¯åŠ¨æœåŠ¡ï¼Œå¤šæ¬¡è¯·æ±‚ <a href="http://localhost:9201/user/1" target="_blank" rel="noopener">http://localhost:9201/user/1</a></p><img src="/images/2020/screencapture2020-04-25 AM10.35.06.jpg"><p>æŠ¥é”™429</p><h2 id="DEBUGï¼šå¯åŠ¨å¤±è´¥"><a href="#DEBUGï¼šå¯åŠ¨å¤±è´¥" class="headerlink" title="DEBUGï¼šå¯åŠ¨å¤±è´¥"></a>DEBUGï¼šå¯åŠ¨å¤±è´¥</h2><p>æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">***************************</span><br><span class="line">APPLICATION FAILED TO START</span><br><span class="line">***************************</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line"></span><br><span class="line">Parameter 1 of method requestRateLimiterGatewayFilterFactory in org.springframework.cloud.gateway.config.GatewayAutoConfiguration required a single bean, but 2 were found:</span><br><span class="line">- userKeyResolver: defined by method &#39;userKeyResolver&#39; in class path resource [com&#x2F;coconutnut&#x2F;apigateway&#x2F;config&#x2F;RedisRateLimiterConfig.class]</span><br><span class="line">- ipKeyResolver: defined by method &#39;ipKeyResolver&#39; in class path resource [com&#x2F;coconutnut&#x2F;apigateway&#x2F;config&#x2F;RedisRateLimiterConfig.class]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Action:</span><br><span class="line"></span><br><span class="line">Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Process finished with exit code 1</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºåŠ ä¸Š@Primaryï¼Œè§£å†³</p><h2 id="DEBUGï¼šRedisè¿æ¥å¤±è´¥"><a href="#DEBUGï¼šRedisè¿æ¥å¤±è´¥" class="headerlink" title="DEBUGï¼šRedisè¿æ¥å¤±è´¥"></a>DEBUGï¼šRedisè¿æ¥å¤±è´¥</h2><p>è®¿é—®<a href="http://localhost:9201/user/1æ—¶æ•°æ®æ­£å¸¸ï¼Œä½†æ§åˆ¶å°æŠ¥é”™" target="_blank" rel="noopener">http://localhost:9201/user/1æ—¶æ•°æ®æ­£å¸¸ï¼Œä½†æ§åˆ¶å°æŠ¥é”™</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost:6379</span><br><span class="line">at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1199) ~[spring-data-redis-2.2.3.RELEASE.jar:2.2.3.RELEASE]</span><br><span class="line">at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1178) ~[spring-data-redis-2.2.3.RELEASE.jar:2.2.3.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ä¸‹è½½å®‰è£…</p><blockquote><p><a href="http://www.redis.cn/download.html" target="_blank" rel="noopener">http://www.redis.cn/download.html</a></p></blockquote><p>å¯åŠ¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-5.0.5 % src&#x2F;redis-server</span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-04-25 AM10.37.45.jpg"><p>å¥½å¯çˆ±ğŸ™€</p><h1 id="ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨"><a href="#ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨" class="headerlink" title="ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨"></a>ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨</h1><p>ï¼ˆå¼ƒï¼‰</p><p>æ•™ç¨‹ç»™çš„æ˜¯eurekaï¼Œè¿™é‡Œå°è¯•æ”¹æˆconsul</p><p>åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ”¹é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">application:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">api-gateway</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">locator:</span></span><br><span class="line">          <span class="comment">#å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment">#ä½¿ç”¨å°å†™æœåŠ¡åï¼Œé»˜è®¤æ˜¯å¤§å†™</span></span><br><span class="line">          <span class="attr">lower-case-service-id:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="DEBUGï¼šå¯åŠ¨å¤±è´¥-1"><a href="#DEBUGï¼šå¯åŠ¨å¤±è´¥-1" class="headerlink" title="DEBUGï¼šå¯åŠ¨å¤±è´¥"></a>DEBUGï¼šå¯åŠ¨å¤±è´¥</h2><p>æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br></pre></td></tr></table></figure><p>å‘ç°å¯åŠ¨ç±»å¿˜åŠ æ³¨é‡Šäº†ï¼ŒåŠ ä¸Šå…ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br></pre></td></tr></table></figure><p>çœ‹ä¸‹ä¾èµ–ï¼Œæ²¡æœ‰å†²çª</p><img src="/images/2020/screencapture2020-04-25 AM10.49.46.jpg"><p>ä½†æ˜¯ç¡®å®æ˜¯åŠ äº†consulçš„ä¾èµ–ä¹‹åæ‰æŠ¥é”™çš„</p><p>å»æ‰å®ƒçš„ä¾èµ–å°±å¯ä»¥æ­£å¸¸å¯åŠ¨</p><blockquote><p><a href="https://blog.csdn.net/jiazhiyuan0/article/details/84033595" target="_blank" rel="noopener">https://blog.csdn.net/jiazhiyuan0/article/details/84033595</a></p><p><a href="https://blog.csdn.net/maduo_duo/article/details/84866137" target="_blank" rel="noopener">https://blog.csdn.net/maduo_duo/article/details/84866137</a></p></blockquote><p>ç¡®å®å¯èƒ½æ˜¯æœ‰å†²çª</p><p>ç°åœ¨çš„Spring Bootç‰ˆæœ¬æ˜¯2.2.2.RELEASEï¼ŒSpring Cloudç‰ˆæœ¬æ˜¯2.2.0.RELEASE</p><p><strong>å°è¯•1</strong></p><p>æŠŠSpring Booté™åˆ°2.2.0</p><p>å¹¶ä¸è¡Œ</p><p><strong>å°è¯•2</strong></p><blockquote><p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/319" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/319</a></p><p>Finchley is not compatible with boot 2.1.0. Either downgrade to boot 2.0.6 or use Greenwich.M3</p></blockquote><p>è¿™é‡Œç”¨çš„æ˜¯Hoxtonç‰ˆæœ¬</p><p>æ‰¾ä¸‹æ–‡æ¡£</p><blockquote><p><a href="https://spring.io/blog/2019/11/28/spring-cloud-hoxton-released" target="_blank" rel="noopener">https://spring.io/blog/2019/11/28/spring-cloud-hoxton-released</a></p></blockquote><p>Consulå’ŒGatewayçš„ç‰ˆæœ¬ä¹Ÿæ˜¯2.2.0.RELEASE</p><blockquote><p><a href="https://spring.io/projects/spring-cloud#overview" target="_blank" rel="noopener">https://spring.io/projects/spring-cloud#overview</a></p></blockquote><p>Hoxtonå¯¹åº”çš„Boot Versionæ˜¯2.2.x</p><p>åº”è¯¥æ²¡é”™</p><p>å¥½å‡ ä¸ªåœ°æ–¹çœ‹åˆ°è¯´æ˜¯spring-boot-starter-webçš„é—®é¢˜</p><img src="/images/2020/screencapture2020-04-25 AM11.49.26.jpg"><p>æœä¸€ä¸‹ï¼Œç¡®å®å¼•ç”¨äº†</p><p>æŠŠå®ƒæ’é™¤</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-04-25 AM11.55.17.jpg"><p>å¹¶ä¸è¡Œ</p><p><strong>å°è¯•3</strong></p><p>æ‰¾æ‰¾Spring Cloud Hoxton + Gatway + Consulçš„æ•™ç¨‹</p><blockquote><p><a href="https://piotrminkowski.com/2019/11/06/microservices-with-spring-boot-spring-cloud-gateway-and-consul-cluster/" target="_blank" rel="noopener">https://piotrminkowski.com/2019/11/06/microservices-with-spring-boot-spring-cloud-gateway-and-consul-cluster/</a></p></blockquote><p>è¿™ä¸ªæ•™ç¨‹çš„ä¾èµ–æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å·²æœ‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŠŠä¹‹å‰spring-boot-starterçš„ä¾èµ–æ”¹æˆspring-boot-starter-web</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯æ²¡å¯åŠ¨æˆåŠŸï¼Œä½†æ˜¯æŠ¥é”™å˜æˆäº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 12:09:53.083 ERROR 4989 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat</span><br><span class="line">at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) ~[spring-boot-2.2.2.RELEASE.jar:2.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/fly_west/article/details/101229871?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">https://blog.csdn.net/fly_west/article/details/101229871?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1</a></p></blockquote><p>è¿˜æ˜¯spring-boot-starter-webå†²çªçš„é—®é¢˜</p><p>ç°åœ¨å†æŠŠgatewayé‡Œçš„webfluxæ’é™¤è¯•è¯•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 12:12:38.331 ERROR 5002 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat</span><br><span class="line">at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) ~[spring-boot-2.2.2.RELEASE.jar:2.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>å°è¯•4</strong></p><p>ä¾èµ–å…¨æ”¹å¾—å’Œåˆšé‚£ä¸ªæ•™ç¨‹ä¸€æ ·è¯•è¯•</p><p>hystrixå’Œredisç›¸å…³çš„éƒ½æ³¨é‡Šæ‰</p><p>ç‰ˆæœ¬</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.RC1<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯å´©äº†</p><p>å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œä¾èµ–çš„æœ€ä¸‹é¢æ€ä¹ˆè¿˜æœ‰ä¸ª</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¼°è®¡æ˜¯åˆ›å»ºçš„æ—¶å€™å¯¼å…¥çš„ï¼Œåˆ æ‰</p><p>é‡å¯</p><p>å´©</p><p><strong>å°è¯•5</strong></p><p>è¿˜æ˜¯æŠŠç‰ˆæœ¬æ”¹å›Spring Boot 2.2.0å’ŒSpring Cloud Hoxton</p><p>ç°åœ¨çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--            &lt;exclusions&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                &lt;exclusion&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                    &lt;artifactId&gt;spring-cloud-starter-webflux&lt;/artifactId&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                &lt;/exclusion&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--            &lt;/exclusions&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨çš„æŠ¥é”™</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 12:32:36.436 ERROR 5170 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat</span><br><span class="line">at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) ~[spring-boot-2.2.2.RELEASE.jar:2.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>åˆšæ‰çœ‹ä¾èµ–å›¾å‘ç°gatewayä¾èµ–çš„æ˜¯webflux</p><p>è¿™é‡Œä¾èµ–çš„æ˜¯web</p><p>å¦‚æœæ”¹æˆwebfluxï¼Ÿ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 12:33:57.502 ERROR 5182 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åº”è¯¥æ˜¯ï¼Œå¯åŠ¨éœ€è¦webï¼Œå¦åˆ™æŠ¥BeanCreationException</p><p>è€Œgatewayä¾èµ–äº†webfluxï¼Œå’Œwebå†²çªï¼ŒæŠ¥ApplicationContextException</p><p>å†æŠŠexclusionåŠ ä¸Š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 12:35:30.492 ERROR 5188 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æŠŠexclusionå»æ‰ï¼Œwebfluxåˆ äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 12:37:30.419 ERROR 5199 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><img src="/images/2020/a.gif" width=200><p><strong>å°è¯•6</strong></p><blockquote><p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/319" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/319</a></p></blockquote><p>ä¹‹å‰è¿™ä¸ªissueé‡Œé¢æœ‰äººè¯´</p><blockquote><p>spring cloud gateway is not compatible with spring mvc and servlet containers, what you get when you depend on <code>spring-boot-starter-web</code>.</p></blockquote><p>è¯•è¯•æŠŠspring-boot-starter-webé‡Œçš„spring mvcå’Œservletæ’é™¤äº†ï¼Ÿ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸è¡Œ</p><blockquote><p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/1004" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/1004</a></p><p><code>spring-cloud-gateway-mvc</code> is not compatible with gateway core. You need to use <code>spring-cloud-gateway-webflux</code>.</p></blockquote><blockquote><p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/1473" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/1473</a></p><p>Spring MVC found on classpath, which is incompatible with Spring Cloud Gateway at this time. Please remove spring-boot-starter-web dependency.</p></blockquote><p>ç°åœ¨å°±åªæœ‰è¿™å‡ ä¸ªä¾èµ–ï¼Œä¸ºä»€ä¹ˆè¿˜æ˜¯å¯åŠ¨ä¸äº†å‘¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-gateway&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>éš¾é“actuatoré‡Œé¢ä¹Ÿæœ‰webï¼Ÿ</p><p>æŠŠå®ƒæ³¨é‡Šæ‰</p><p>æŠ¥é”™å˜æˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-25 13:17:36.860 ERROR 5310 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.AutoServiceRegistrationAutoConfiguration&#39;: Unsatisfied dependency expressed through field &#39;autoServiceRegistration&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;consulAutoServiceRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Unsatisfied dependency expressed through method &#39;consulAutoServiceRegistration&#39; parameter 3; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:643) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/802" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/802</a></p><p>Gateway is thought to be used as a separate technical component in your architecture. It usually does not make sense to add a gateway dependency directly to your business code.</p></blockquote><p>é€‚åˆå•ç‹¬ä½¿ç”¨â€¦</p><p>å•ç‹¬ä½¿ç”¨â€¦</p><p>å•ç‹¬â€¦</p><p>fine</p><p>æš‚æ—¶å°±ä¸ç»“åˆæ³¨å†Œä¸­å¿ƒäº†</p><p>ä»¥åæœ‰éœ€è¦å†è¯´</p><p>å†è§</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ThinkWon/article/details/103757927&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://blog.csdn.net/Thin
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="springcloud" scheme="http://yoursite.com/tags/springcloud/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisPlusç¬”è®°06 è‡ªåŠ¨å¡«å……ã€é€»è¾‘åˆ é™¤ã€é€šç”¨æšä¸¾ç­‰</title>
    <link href="http://yoursite.com/2020/04/24/note-mybatisplus-06/"/>
    <id>http://yoursite.com/2020/04/24/note-mybatisplus-06/</id>
    <published>2020-04-24T11:22:46.000Z</published>
    <updated>2020-04-24T12:01:56.874Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p><p>P55~62</p></blockquote><h1 id="sqlæ³¨å…¥å™¨"><a href="#sqlæ³¨å…¥å™¨" class="headerlink" title="sqlæ³¨å…¥å™¨"></a>sqlæ³¨å…¥å™¨</h1><p>é»˜è®¤çš„Mapperä¸­æ–¹æ³•ä¸å¤Ÿç”¨æ—¶ï¼Œè‡ªå·±æ‰©å……BaseMapperä¸­çš„æ–¹æ³•</p><blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR?p=55" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR?p=55</a></p></blockquote><h1 id="è‡ªåŠ¨å¡«å……"><a href="#è‡ªåŠ¨å¡«å……" class="headerlink" title="è‡ªåŠ¨å¡«å……"></a>è‡ªåŠ¨å¡«å……</h1><p>æ’å…¥æˆ–è€…æ›´æ–°æ•°æ®æ—¶ï¼Œå¸Œæœ›æœ‰äº›å­—æ®µå¯ä»¥è‡ªåŠ¨å¡«å……æ•°æ®ï¼Œæ¯”å¦‚å¯†ç ã€version ç­‰</p><h2 id="æ·»åŠ -TableFieldæ³¨è§£"><a href="#æ·»åŠ -TableFieldæ³¨è§£" class="headerlink" title="æ·»åŠ @TableFieldæ³¨è§£"></a>æ·»åŠ @TableFieldæ³¨è§£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="meta">@TableField</span>(fill = FieldFill.INSERT)</span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure><p>FieldFillå¯é€‰ï¼š</p><ul><li>DEFAULT é»˜è®¤ä¸å¤„ç†</li><li>INSERT æ’å…¥è¯•å¡«å……å­—æ®µ</li><li>UPDATE æ›´æ–°æ—¶å¡«å……å­—æ®µ</li><li>INSERT_UPDATE æ’å…¥å’Œæ›´æ–°æ—¶å¡«å……å­—æ®µ</li></ul><h2 id="ç¼–å†™MyMetaObjectHandler"><a href="#ç¼–å†™MyMetaObjectHandler" class="headerlink" title="ç¼–å†™MyMetaObjectHandler"></a>ç¼–å†™MyMetaObjectHandler</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        Object version = getFieldValByName(<span class="string">"version"</span>, metaObject);</span><br><span class="line">        <span class="keyword">if</span>(version == <span class="keyword">null</span>)&#123;</span><br><span class="line">            setFieldValByName(<span class="string">"version"</span>, <span class="number">1</span>, metaObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertFill</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setName(<span class="string">"å¼ å››"</span>);</span><br><span class="line">  user.setUserName(<span class="string">"zhangsi"</span>);</span><br><span class="line">  user.setPassword(<span class="string">"123123"</span>);</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setEmail(<span class="string">"zhangsi@itast.cn"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.insert(user);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> Timeï¼š9 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.insert</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    INSERT </span><br><span class="line">    INTO</span><br><span class="line">        tb_user</span><br><span class="line">        ( user_name, password, name, age, email, version ) </span><br><span class="line">    VALUES</span><br><span class="line">        ( &#39;zhangsi&#39;, &#39;123123&#39;, &#39;å¼ å››&#39;, 30, &#39;zhangsi@itast.cn&#39;, 1 )</span><br><span class="line"></span><br><span class="line">result &#x3D; 1</span><br></pre></td></tr></table></figure><h1 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h1><p>å°†æ•°æ®æ ‡è®°ä¸ºåˆ é™¤ï¼Œè€Œå¹¶éçœŸæ­£åˆ é™¤</p><p>æŸ¥è¯¢æ—¶éœ€è¦æºå¸¦çŠ¶æ€æ¡ä»¶ï¼Œç¡®ä¿è¢«æ ‡è®°çš„æ•°æ®ä¸è¢«æŸ¥è¯¢åˆ°</p><h2 id="ä¿®æ”¹è¡¨ç»“æ„"><a href="#ä¿®æ”¹è¡¨ç»“æ„" class="headerlink" title="ä¿®æ”¹è¡¨ç»“æ„"></a>ä¿®æ”¹è¡¨ç»“æ„</h2><p>ä¸ºtb_userè¡¨å¢åŠ deletedå­—æ®µï¼Œç”¨äºè¡¨ç¤ºæ•°æ®æ˜¯å¦è¢«åˆ é™¤ï¼Œ1ä»£è¡¨åˆ é™¤ï¼Œ0ä»£è¡¨æœªåˆ é™¤</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`deleted`</span> <span class="built_in">int</span>(<span class="number">1</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> <span class="keyword">COMMENT</span> <span class="string">'1ä»£è¡¨åˆ é™¤ï¼Œ0ä»£è¡¨æœªåˆ é™¤'</span> <span class="keyword">AFTER</span> <span class="string">`version`</span>;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹Userå®ä½“ï¼Œå¢åŠ deletedå±æ€§å¹¶ä¸”æ·»åŠ @TableLogicæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableLogic</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>application.propertiesä¸­</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1) mybatis-plus.global-config.db-config.logic-delete-value=1</span></span><br><span class="line"><span class="comment"># é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0) mybatis-plus.global-config.db-config.logic-not-delete-value=0</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨é»˜è®¤å€¼å¯ä»¥çœç•¥</p><h2 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User(); user.setId(<span class="number">2L</span>);</span><br><span class="line">  <span class="keyword">boolean</span> delete = user.deleteById();</span><br><span class="line">  System.out.println(delete);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> Timeï¼š2 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.deleteById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    UPDATE</span><br><span class="line">        tb_user </span><br><span class="line">    SET</span><br><span class="line">        deleted&#x3D;1 </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND deleted&#x3D;0</span><br><span class="line"></span><br><span class="line">true</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šå˜æˆäº†UPDATE</p><img src="/images/2020/screencapture2020-04-24 PM7.42.26.jpg"><p>ç„¶åæŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">2L</span>);</span><br><span class="line">  User user2 = user.selectById();</span><br><span class="line">  System.out.println(user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> Timeï¼š5 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.selectById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    SELECT</span><br><span class="line">        id,</span><br><span class="line">        user_name,</span><br><span class="line">        password,</span><br><span class="line">        name,</span><br><span class="line">        age,</span><br><span class="line">        email,</span><br><span class="line">        version,</span><br><span class="line">        deleted </span><br><span class="line">    FROM</span><br><span class="line">        tb_user </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND deleted&#x3D;0</span><br><span class="line"></span><br><span class="line">null</span><br></pre></td></tr></table></figure><p>SQLä¸­æ·»åŠ äº†deleted=0çš„æ¡ä»¶ï¼Œæ²¡æœ‰æŸ¥åˆ°æ•°æ®</p><h1 id="é€šç”¨æšä¸¾"><a href="#é€šç”¨æšä¸¾" class="headerlink" title="é€šç”¨æšä¸¾"></a>é€šç”¨æšä¸¾</h1><h2 id="ä¿®æ”¹è¡¨ç»“æ„-1"><a href="#ä¿®æ”¹è¡¨ç»“æ„-1" class="headerlink" title="ä¿®æ”¹è¡¨ç»“æ„"></a>ä¿®æ”¹è¡¨ç»“æ„</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`sex`</span> <span class="built_in">int</span>(<span class="number">1</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> <span class="keyword">COMMENT</span> <span class="string">'1-ç”·ï¼Œ2-å¥³'</span> <span class="keyword">AFTER</span> <span class="string">`deleted`</span>;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹Userå®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> SexEnum sex;</span><br></pre></td></tr></table></figure><h2 id="å®šä¹‰æšä¸¾"><a href="#å®šä¹‰æšä¸¾" class="headerlink" title="å®šä¹‰æšä¸¾"></a>å®šä¹‰æšä¸¾</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.enums.IEnum;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> SexEnum implements IEnum&lt;Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">    MAN(<span class="number">1</span>,<span class="string">"ç”·"</span>),</span><br><span class="line">    WOMAN(<span class="number">2</span>,<span class="string">"å¥³"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    SexEnum(<span class="keyword">int</span> value, String desc) &#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æšä¸¾åŒ…æ‰«æ</span><br><span class="line">mybatis-plus.type-enums-package&#x3D;com.coconutnut.demo.enums</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setName(<span class="string">"å¼ äº”"</span>);</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line">  user.setUserName(<span class="string">"zhangwu"</span>);</span><br><span class="line">  user.setEmail(<span class="string">"zhangwu@itcast.cn"</span>);</span><br><span class="line">  user.setSex(SexEnum.WOMAN);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">boolean</span> insert = user.insert();</span><br><span class="line">  System.out.println(insert);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> Timeï¼š6 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.insert</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    INSERT </span><br><span class="line">    INTO</span><br><span class="line">        tb_user</span><br><span class="line">        ( user_name, password, name, age, email, sex, version ) </span><br><span class="line">    VALUES</span><br><span class="line">        ( &#39;zhangwu&#39;, &#39;123456&#39;, &#39;å¼ äº”&#39;, 30, &#39;zhangwu@itcast.cn&#39;, 2, 1 )</span><br><span class="line"></span><br><span class="line">true</span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-04-24 PM7.51.09.jpg"><h1 id="ä»£ç ç”Ÿæˆå™¨"><a href="#ä»£ç ç”Ÿæˆå™¨" class="headerlink" title="ä»£ç ç”Ÿæˆå™¨"></a>ä»£ç ç”Ÿæˆå™¨</h1><p>AutoGenerator æ˜¯ MyBatis-Plus çš„ä»£ç ç”Ÿæˆå™¨ï¼Œé€šè¿‡ AutoGenerator å¯ä»¥å¿«é€Ÿç”Ÿæˆ Entityã€Mapperã€MapperXMLã€Serviceã€Controller ç­‰å„ä¸ªæ¨¡å—çš„ä»£ç ï¼Œæå‡å¼€å‘æ•ˆç‡</p><blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR?p=60" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR?p=60</a></p></blockquote><h1 id="MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶"><a href="#MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶" class="headerlink" title="MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶"></a>MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶</h1><p>åŸºäº IDEA çš„å¿«é€Ÿå¼€å‘æ’ä»¶</p><p>å®‰è£…ï¼šFile -&gt; Settings -&gt; Pluginsï¼Œæœç´¢å¹¶å®‰è£…</p><p>åŠŸèƒ½ï¼šJavaå’Œå¯¹åº”XMLè·³è½¬ï¼›Mapperæ–¹æ³•è‡ªåŠ¨ç”Ÿæˆ XML</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rE41197jR&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1rE411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="mybatis_plus" scheme="http://yoursite.com/tags/mybatis-plus/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisPlusç¬”è®°05 æ’ä»¶</title>
    <link href="http://yoursite.com/2020/04/24/note-mybatisplus-05/"/>
    <id>http://yoursite.com/2020/04/24/note-mybatisplus-05/</id>
    <published>2020-04-24T10:23:30.000Z</published>
    <updated>2020-04-24T11:24:13.311Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p><p>P49~54</p></blockquote><h1 id="mybatisçš„æ’ä»¶æœºåˆ¶"><a href="#mybatisçš„æ’ä»¶æœºåˆ¶" class="headerlink" title="mybatisçš„æ’ä»¶æœºåˆ¶"></a>mybatisçš„æ’ä»¶æœºåˆ¶</h1><p>MyBatis å…è®¸åœ¨å·²æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆª</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬:</p><ul><li><p>Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) </p></li><li><p>ParameterHandler (getParameterObject, setParameters)</p></li><li><p>ResultSetHandler (handleResultSets, handleOutputParameters)</p></li><li><p>StatementHandler (prepare, parameterize, batch, update, query)</p></li></ul><p>å¯ä»¥æ‹¦æˆªï¼š</p><ul><li>æ‰§è¡Œå™¨çš„æ–¹æ³•</li><li>å‚æ•°çš„å¤„ç†</li><li>ç»“æœé›†çš„å¤„ç†</li><li>Sqlè¯­æ³•æ„å»ºçš„å¤„ç†</li></ul><p>è‡ªå®šä¹‰æ‹¦æˆªå™¨å¯ä»¥å®ç°Interceptoræ¥å£ï¼Œæ³¨å…¥åˆ°Springå®¹å™¨</p><h1 id="æ‰§è¡Œåˆ†ææ’ä»¶"><a href="#æ‰§è¡Œåˆ†ææ’ä»¶" class="headerlink" title="æ‰§è¡Œåˆ†ææ’ä»¶"></a>æ‰§è¡Œåˆ†ææ’ä»¶</h1><p>å¯ç”¨ä½œé˜»æ–­å…¨è¡¨æ›´æ–°ã€åˆ é™¤çš„æ“ä½œ</p><p>æ³¨æ„:è¯¥æ’ä»¶ä»…é€‚ç”¨äºå¼€å‘ç¯å¢ƒï¼Œä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒï¼ˆæ€§èƒ½é—®é¢˜ï¼‰</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>MybatisPlusConfigä¸­é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SqlExplainInterceptor <span class="title">sqlExplainInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">  SqlExplainInterceptor sqlExplainInterceptor = <span class="keyword">new</span> SqlExplainInterceptor();</span><br><span class="line">  List&lt;ISqlParser&gt; sqlParserList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  sqlParserList.add(<span class="keyword">new</span> BlockAttackSqlParser());</span><br><span class="line">  sqlExplainInterceptor.setSqlParserList(sqlParserList);</span><br><span class="line">  <span class="keyword">return</span> sqlExplainInterceptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">20</span>);</span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.update(user, <span class="keyword">null</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼šå…¨è¡¨æ›´æ–°è¢«é˜»æ–­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Prohibition of table update operation</span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-04-24 PM6.51.47.jpg"><h1 id="æ€§èƒ½åˆ†ææ’ä»¶"><a href="#æ€§èƒ½åˆ†ææ’ä»¶" class="headerlink" title="æ€§èƒ½åˆ†ææ’ä»¶"></a>æ€§èƒ½åˆ†ææ’ä»¶</h1><p>ç”¨äºè¾“å‡ºæ¯æ¡ SQL è¯­å¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥è®¾ç½®æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼Œè¶…è¿‡æ—¶é—´ä¼šæŠ›å‡ºå¼‚å¸¸</p><h2 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>ä¸¤ç§æ–¹å¼ï¼Œå¯ä»¥åƒä¸Šé¢ä¸€æ ·åœ¨Configä¸­é…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨xmlä¸­é…ç½®</p><p>è¿™é‡Œç”¨xmlæ–¹å¼</p><p>mybatis-config.xmlä¸­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL æ‰§è¡Œæ€§èƒ½åˆ†æï¼Œå¼€å‘ç¯å¢ƒä½¿ç”¨ï¼Œçº¿ä¸Šä¸æ¨èã€‚ maxTime æŒ‡çš„æ˜¯ sql æœ€å¤§æ‰§è¡Œæ—¶é•¿ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.baomidou.mybatisplus.extension.plugins.PerformanceInterceptor"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxTime"</span> <span class="attr">value</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--SQLæ˜¯å¦æ ¼å¼åŒ– é»˜è®¤false--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"format"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æ‰§è¡ŒtestSelectById()</p><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Timeï¼š10 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.selectById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    SELECT</span><br><span class="line">        id,</span><br><span class="line">        user_name,</span><br><span class="line">        password,</span><br><span class="line">        name,</span><br><span class="line">        age,</span><br><span class="line">        email </span><br><span class="line">    FROM</span><br><span class="line">        tb_user </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line"></span><br><span class="line">User(id&#x3D;2, userName&#x3D;lisi, password&#x3D;123456, name&#x3D;æå››, age&#x3D;20, email&#x3D;test2@itcast.cn)</span><br></pre></td></tr></table></figure><h1 id="ä¹è§‚é”æ’ä»¶"><a href="#ä¹è§‚é”æ’ä»¶" class="headerlink" title="ä¹è§‚é”æ’ä»¶"></a>ä¹è§‚é”æ’ä»¶</h1><p>å½“è¦æ›´æ–°ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œå¸Œæœ›è¿™æ¡è®°å½•æ²¡æœ‰è¢«åˆ«äººæ›´æ–°</p><p>å®ç°æ–¹å¼:</p><ul><li>å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰version</li><li>æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ªversion</li><li>æ‰§è¡Œæ›´æ–°æ—¶ï¼Œ set version = newVersion where version = oldVersion</li><li>å¦‚æœversionä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</li></ul><h2 id="é…ç½®-2"><a href="#é…ç½®-2" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Versionå­—æ®µ"><a href="#Versionå­—æ®µ" class="headerlink" title="Versionå­—æ®µ"></a>Versionå­—æ®µ</h2><p>ä¸ºè¡¨æ·»åŠ versionå­—æ®µï¼Œå¹¶ä¸”è®¾ç½®åˆå§‹å€¼ä¸º1</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`version`</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="literal">NULL</span> <span class="keyword">AFTER</span> <span class="string">`email`</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> <span class="string">`tb_user`</span> <span class="keyword">SET</span> <span class="string">`version`</span>=<span class="string">'1'</span>;</span><br></pre></td></tr></table></figure><p>ä¸ºUserå®ä½“ç±»æ·»åŠ versionå­—æ®µå’Œæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateVersion</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setId(<span class="number">2L</span>);</span><br><span class="line">  user.setVersion(<span class="number">1</span>); <span class="comment">// å½“å‰versionä¸º1</span></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.updateById(user);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> Timeï¼š2 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.updateById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    UPDATE</span><br><span class="line">        tb_user </span><br><span class="line">    SET</span><br><span class="line">        age&#x3D;30,</span><br><span class="line">        version&#x3D;2 </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND version&#x3D;1</span><br><span class="line"></span><br><span class="line">result &#x3D; 1</span><br></pre></td></tr></table></figure><p>ä¹è§‚é”æ’ä»¶æ·»åŠ äº†versionæ¡ä»¶ï¼Œå¹¶è®¾ç½®æ–°çš„versionä¸º2</p><img src="/images/2020/screencapture2020-04-24 PM7.07.07.jpg"><p>å¦‚æœå†æ‰§è¡Œä¸€æ¬¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> Timeï¼š1 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.updateById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    UPDATE</span><br><span class="line">        tb_user </span><br><span class="line">    SET</span><br><span class="line">        age&#x3D;30,</span><br><span class="line">        version&#x3D;2 </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND version&#x3D;1</span><br><span class="line"></span><br><span class="line">result &#x3D; 0</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶versionå·²ç»æ˜¯2ï¼Œä¸èƒ½æ‰§è¡Œäº†</p><p>æ­£å¸¸çš„ä½¿ç”¨æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateVersion</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">2L</span>); <span class="comment">// æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"></span><br><span class="line">  User userVersion = user.selectById(); <span class="comment">// å½“å‰ç‰ˆæœ¬</span></span><br><span class="line">  user.setAge(<span class="number">30</span>);  <span class="comment">// æ›´æ–°çš„æ•°æ®</span></span><br><span class="line">  user.setVersion(userVersion.getVersion()); <span class="comment">// ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.updateById(user);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰¹åˆ«è¯´æ˜"><a href="#ç‰¹åˆ«è¯´æ˜" class="headerlink" title="ç‰¹åˆ«è¯´æ˜"></a>ç‰¹åˆ«è¯´æ˜</h2><ul><li>æ”¯æŒçš„æ•°æ®ç±»å‹åªæœ‰:int,Integer,long,Long,Date,Timestamp,LocalDateTime</li><li>æ•´æ•°ç±»å‹ä¸‹ newVersion = oldVersion + 1</li><li>newVersion ä¼šå›å†™åˆ° entity ä¸­</li><li>ä»…æ”¯æŒ updateById(id) ä¸ update(entity, wrapper) æ–¹æ³•</li><li>åœ¨ update(entity, wrapper) æ–¹æ³•ä¸‹, wrapper ä¸èƒ½å¤ç”¨</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rE41197jR&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1rE411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="mybatis_plus" scheme="http://yoursite.com/tags/mybatis-plus/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisPlusç¬”è®°04 ActiveRecord</title>
    <link href="http://yoursite.com/2020/04/24/note-mybatisplus-04/"/>
    <id>http://yoursite.com/2020/04/24/note-mybatisplus-04/</id>
    <published>2020-04-24T09:59:21.000Z</published>
    <updated>2020-04-24T10:23:02.592Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p><p>P40~45</p></blockquote><p>å±äºORM(å¯¹è±¡å…³ç³»æ˜ å°„)å±‚</p><p>ä¸»è¦æ€æƒ³:</p><ul><li>æ¯ä¸€ä¸ªæ•°æ®åº“è¡¨å¯¹åº”åˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»çš„æ¯ä¸€ä¸ªå¯¹è±¡å®ä¾‹å¯¹åº”äºæ•°æ®åº“ä¸­è¡¨çš„ä¸€è¡Œè®°å½•;é€šå¸¸è¡¨çš„æ¯ä¸ªå­—æ®µåœ¨ç±»ä¸­éƒ½æœ‰ç›¸åº”çš„Field;</li><li>ActiveRecordåŒæ—¶è´Ÿè´£æŠŠè‡ªå·±æŒä¹…åŒ–ï¼Œåœ¨ActiveRecordä¸­å°è£…äº†å¯¹æ•°æ®åº“çš„è®¿é—®ï¼Œå³CURD;</li><li>ActiveRecordæ˜¯ä¸€ç§é¢†åŸŸæ¨¡å‹(Domain Model)ï¼Œå°è£…äº†éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘;</li></ul><h1 id="å¼€å¯AR"><a href="#å¼€å¯AR" class="headerlink" title="å¼€å¯AR"></a>å¼€å¯AR</h1><p>å®ä½“å¯¹è±¡ç»§æ‰¿Modelå³å¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName</span>(<span class="string">"tb_user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableId</span>(type = IdType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>ä¸éœ€è¦UserMapperäº†ï¼Œç›´æ¥æŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">2L</span>);</span><br><span class="line">  User user2 = user.selectById();</span><br><span class="line">  System.out.println(user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User(id&#x3D;2, userName&#x3D;lisi, password&#x3D;123456, name&#x3D;æå››, age&#x3D;20, email&#x3D;test2@itcast.cn)</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”ä»¥å‰çš„æŸ¥è¯¢æ–¹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  User user = <span class="keyword">this</span>.userMapper.selectById(<span class="number">2L</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ARåï¼Œä¸éœ€è¦æ˜¾ç¤ºçš„æ³¨å…¥UserMapperï¼Œä½†æ˜¯è¿™ä¸ªç±»è¿˜æ˜¯éœ€è¦çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæŠŠè¿™ä¸ªåˆ äº†å°±è¿è¡Œä¸äº†äº†</p><h1 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h1><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>æ–¹æ³•ä¸€ï¼šåŒä¸Š</p><p>æ–¹æ³•äºŒï¼šæ¡ä»¶æŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">  userQueryWrapper.le(<span class="string">"age"</span>,<span class="string">"20"</span>);</span><br><span class="line">  List&lt;User&gt; users = user.selectList(userQueryWrapper);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (User user1 : users) &#123;</span><br><span class="line">    System.out.println(user1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setName(<span class="string">"åˆ˜å¤‡"</span>);</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line">  user.setUserName(<span class="string">"liubei"</span>);</span><br><span class="line">  user.setEmail(<span class="string">"liubei@itcast.cn"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">boolean</span> insert = user.insert();</span><br><span class="line"></span><br><span class="line">  System.out.println(insert);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿”å›æ’å…¥æ˜¯å¦æˆåŠŸ</p><img src="/images/2020/screencapture2020-04-24 PM6.15.09.jpg" width=500><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">5L</span>);</span><br><span class="line">  user.setAge(<span class="number">35</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">boolean</span> update = user.updateById();</span><br><span class="line">  System.out.println(update);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-04-24 PM6.16.55.jpg" width=500><p>ä¹Ÿå¯ä»¥æ ¹æ®æ¡ä»¶ï¼ˆç”¨Wrapperï¼‰æ›´æ–°</p><h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User(); user.setId(<span class="number">7L</span>);</span><br><span class="line">  <span class="keyword">boolean</span> delete = user.deleteById();</span><br><span class="line">  System.out.println(delete);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-04-24 PM6.18.54.jpg" width=500>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rE41197jR&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1rE411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="mybatis_plus" scheme="http://yoursite.com/tags/mybatis-plus/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisPlusç¬”è®°03 æ¡ä»¶æ„é€ å™¨</title>
    <link href="http://yoursite.com/2020/04/22/note-mybatisplus-03/"/>
    <id>http://yoursite.com/2020/04/22/note-mybatisplus-03/</id>
    <published>2020-04-22T08:00:00.000Z</published>
    <updated>2020-04-22T08:24:33.334Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p><p>p33~39</p></blockquote><p>Wrapperæ¥å£å®ç°ç±»é‡ç‚¹æœ‰AbstractWrapperå’ŒAbstractChainWrapper</p><p>åŒºåˆ«åœ¨äºAbstractChainWrapperé‡‡ç”¨lambdaè¡¨è¾¾å¼ç¼–å†™</p><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>ä»¥allEqä¸ºä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ¡ä»¶</span></span><br><span class="line">Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;(); </span><br><span class="line">params.put(<span class="string">"name"</span>, <span class="string">"å¼ ä¸‰"</span>);</span><br><span class="line">params.put(<span class="string">"age"</span>, <span class="string">"20"</span>); </span><br><span class="line">params.put(<span class="string">"password"</span>, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">wrapper.allEq(params);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢</span></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç”Ÿæˆçš„sqlè¯­å¥ä¸º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_user <span class="keyword">WHERE</span> <span class="keyword">password</span> <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">AND</span> <span class="keyword">name</span> = ? <span class="keyword">AND</span> age = ?</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå‚æ•°ä¸ºfalseæ—¶å¿½ç•¥å€¼ä¸ºnullçš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wrapper.allEq(params,<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„sqlè¯­å¥ä¸º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_user <span class="keyword">WHERE</span> <span class="keyword">name</span> = ? <span class="keyword">AND</span> age = ?</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥è®¾ç½®è¿‡æ»¤å™¨</p><h1 id="åŸºæœ¬æ¯”è¾ƒæ“ä½œ"><a href="#åŸºæœ¬æ¯”è¾ƒæ“ä½œ" class="headerlink" title="åŸºæœ¬æ¯”è¾ƒæ“ä½œ"></a>åŸºæœ¬æ¯”è¾ƒæ“ä½œ</h1><p><a href="https://mybatis.plus/guide/wrapper.html#abstractwrapper" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><h1 id="æ¨¡ç³ŠæŸ¥è¯¢"><a href="#æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢"></a>æ¨¡ç³ŠæŸ¥è¯¢</h1><p>likeã€notLikeã€likeLeftã€likeRight</p><p>ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line">wrapper.like(<span class="string">"name"</span>, <span class="string">"æ›¹"</span>); <span class="comment">// %æ›¹%</span></span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h1><p>orderByï¼ˆé»˜è®¤Ascï¼‰ã€orderByAscã€orderByDesc</p><p>ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT id,user_name,password,name,age,email FROM tb_user ORDER BY age DESC</span></span><br><span class="line">wrapper.orderByDesc(<span class="string">"age"</span>);</span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é€»è¾‘æŸ¥è¯¢"><a href="#é€»è¾‘æŸ¥è¯¢" class="headerlink" title="é€»è¾‘æŸ¥è¯¢"></a>é€»è¾‘æŸ¥è¯¢</h1><p>orã€and</p><p>ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT id,user_name,password,name,age,email FROM tb_user WHERE name = ? OR age = ?</span></span><br><span class="line">wrapper.eq(<span class="string">"name"</span>,<span class="string">"æå››"</span>).or().eq(<span class="string">"age"</span>, <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æŒ‡å®šæŸ¥è¯¢å­—æ®µ"><a href="#æŒ‡å®šæŸ¥è¯¢å­—æ®µ" class="headerlink" title="æŒ‡å®šæŸ¥è¯¢å­—æ®µ"></a>æŒ‡å®šæŸ¥è¯¢å­—æ®µ</h1><p>select</p><p>ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT id,name,age FROM tb_user WHERE name = ? OR age = ?</span></span><br><span class="line">wrapper.eq(<span class="string">"name"</span>, <span class="string">"æå››"</span>)</span><br><span class="line">.or()</span><br><span class="line">.eq(<span class="string">"age"</span>, <span class="number">24</span>)</span><br><span class="line">.select(<span class="string">"id"</span>, <span class="string">"name"</span>, <span class="string">"age"</span>);</span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rE41197jR&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1rE411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="mybatis_plus" scheme="http://yoursite.com/tags/mybatis-plus/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisPlusç¬”è®°02 é…ç½®</title>
    <link href="http://yoursite.com/2020/04/22/note-mybatisplus-02/"/>
    <id>http://yoursite.com/2020/04/22/note-mybatisplus-02/</id>
    <published>2020-04-22T07:32:48.000Z</published>
    <updated>2020-04-22T08:00:25.966Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p><p>p27~32</p></blockquote><p><a href="https://mybatis.plus/config/#åŸºæœ¬é…ç½®" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><h1 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h1><h2 id="configLocation"><a href="#configLocation" class="headerlink" title="configLocation"></a>configLocation</h2><p>MyBatis é…ç½®æ–‡ä»¶ä½ç½®</p><p>egï¼šresourcesæ–‡ä»¶å¤¹ä¸‹æœ‰mybatis-config.xmlï¼Œè¦å°†å…¶ä½œä¸ºMyBatisé…ç½®æ–‡ä»¶</p><p>åˆ™éœ€åœ¨applications.propertiesä¸­é…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŒ‡å®šå…¨å±€çš„é…ç½®æ–‡ä»¶</span><br><span class="line">mybatis-plus.config-location &#x3D; classpath:mybatis-config.xml</span><br></pre></td></tr></table></figure><h2 id="mapperLocations"><a href="#mapperLocations" class="headerlink" title="mapperLocations"></a>mapperLocations</h2><p>æŒ‡å®šmapperæ–‡ä»¶ä½ç½®</p><p>å½“é»˜è®¤çš„Mapperä¸å¤Ÿç”¨ï¼ˆå¦‚éœ€è¦å¤šè¡¨æŸ¥è¯¢æ—¶ï¼‰ï¼Œå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰çš„mapperï¼Œåœ¨é‡Œé¢å†™sqlè¯­å¥</p><p>ä¾‹å¦‚resourcesä¸­æ–°å»ºmybatisæ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ªUserMapper.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mybatis-plus.mapper-locations &#x3D; classpath*:mybatis&#x2F;*.xml</span><br></pre></td></tr></table></figure><p>Mavenå¤šæ¨¡å—é¡¹ç›®çš„æ‰«æè·¯å¾„éœ€ä»¥classpath*å¼€å¤´ï¼ˆå³åŠ åœ¨å¤šä¸ªjaråŒ…ä¸‹çš„xmlæ–‡ä»¶ï¼‰</p><h2 id="typeAliasesPackage"><a href="#typeAliasesPackage" class="headerlink" title="typeAliasesPackage"></a>typeAliasesPackage</h2><p>ç»™åŒ…ä¸­çš„ç±»æ³¨å†Œåˆ«åï¼Œæ³¨å†Œååœ¨ Mapper å¯¹åº”çš„ XML æ–‡ä»¶ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»åï¼Œè€Œä¸ç”¨ä½¿ç”¨å…¨é™å®šçš„ç±»å</p><p>ä¾‹å¦‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mybatis-plus.type-aliases-package &#x3D; cn.itcast.mp.pojo</span><br></pre></td></tr></table></figure><h1 id="è¿›é˜¶é…ç½®"><a href="#è¿›é˜¶é…ç½®" class="headerlink" title="è¿›é˜¶é…ç½®"></a>è¿›é˜¶é…ç½®</h1><p>å¤§éƒ½ä¸º MyBatis åŸç”Ÿæ”¯æŒçš„é…ç½®</p><p>æ³¨æ„ï¼šå¦‚æœåˆ¶å®šäº†å…¨å±€é…ç½®æ–‡ä»¶ï¼Œéœ€è¦åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œå’Œapplication.propertiesä¸èƒ½å…±å­˜</p><h2 id="mapUnderscoreToCamelCase"><a href="#mapUnderscoreToCamelCase" class="headerlink" title="mapUnderscoreToCamelCase"></a>mapUnderscoreToCamelCase</h2><p>æ˜¯å¦å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™æ˜ å°„</p><h2 id="cacheEnabled"><a href="#cacheEnabled" class="headerlink" title="cacheEnabled"></a>cacheEnabled</h2><p>å¼€å¯MybatisäºŒçº§ç¼“å­˜ï¼Œé»˜è®¤ä¸º true</p><h1 id="DB-ç­–ç•¥é…ç½®"><a href="#DB-ç­–ç•¥é…ç½®" class="headerlink" title="DB ç­–ç•¥é…ç½®"></a>DB ç­–ç•¥é…ç½®</h1><h2 id="idType"><a href="#idType" class="headerlink" title="idType"></a>idType</h2><p>å…¨å±€é»˜è®¤ä¸»é”®ç±»å‹ï¼Œè®¾ç½®åï¼Œå³å¯çœç•¥å®ä½“å¯¹è±¡ä¸­çš„@TableId(type = IdType.AUTO)é…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mybatis-plus.global-config.db-config.id-type &#x3D; auto</span><br></pre></td></tr></table></figure><h2 id="tablePrefix"><a href="#tablePrefix" class="headerlink" title="tablePrefix"></a>tablePrefix</h2><p>æŒ‡å®šè¡¨åå‰ç¼€ï¼Œå…¨å±€é…ç½®åå¯çœç•¥@TableName()é…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mybatis-plus.global-config.db-config.table-prefix &#x3D; tb_</span><br></pre></td></tr></table></figure><p>å¦‚ï¼ŒUserç±»é»˜è®¤ä¼šå»æ‰¾userè¡¨ï¼Œå¦‚æœè¦æ‰¾tb_userè¡¨ï¼Œéœ€è¦ä½¿ç”¨æ³¨è§£ï¼Œæˆ–è€…å…¨å±€é…ç½®å‰ç¼€</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rE41197jR&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1rE411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="mybatis_plus" scheme="http://yoursite.com/tags/mybatis-plus/"/>
    
  </entry>
  
  <entry>
    <title>MyBatisPlusç¬”è®°01 CRUD</title>
    <link href="http://yoursite.com/2020/04/21/note-mybatisplus-01/"/>
    <id>http://yoursite.com/2020/04/21/note-mybatisplus-01/</id>
    <published>2020-04-21T03:38:49.000Z</published>
    <updated>2020-04-21T07:28:32.800Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p><p>p1~25</p></blockquote><h1 id="æ•°æ®åº“å‡†å¤‡"><a href="#æ•°æ®åº“å‡†å¤‡" class="headerlink" title="æ•°æ®åº“å‡†å¤‡"></a>æ•°æ®åº“å‡†å¤‡</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºæµ‹è¯•è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span> (</span><br><span class="line"><span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'ä¸»é”®ID'</span>, <span class="string">`user_name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ç”¨æˆ·å'</span>, <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'å¯†ç '</span>,</span><br><span class="line"><span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'å§“å'</span>,</span><br><span class="line"><span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'å¹´é¾„'</span>, <span class="string">`email`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'é‚®ç®±'</span>, PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥æµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'1'</span>, <span class="string">'zhangsan'</span>, <span class="string">'123456'</span>, <span class="string">'å¼ ä¸‰'</span>, <span class="string">'18'</span>, <span class="string">'test1@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'2'</span>, <span class="string">'lisi'</span>, <span class="string">'123456'</span>, <span class="string">'æå››'</span>, <span class="string">'20'</span>, <span class="string">'test2@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'3'</span>, <span class="string">'wangwu'</span>, <span class="string">'123456'</span>, <span class="string">'ç‹äº”'</span>, <span class="string">'28'</span>, <span class="string">'test3@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'4'</span>, <span class="string">'zhaoliu'</span>, <span class="string">'123456'</span>, <span class="string">'èµµå…­'</span>, <span class="string">'21'</span>, <span class="string">'test4@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'5'</span>, <span class="string">'sunqi'</span>, <span class="string">'123456'</span>, <span class="string">'å­™ä¸ƒ'</span>, <span class="string">'24'</span>, <span class="string">'test5@itcast.cn'</span>);</span><br></pre></td></tr></table></figure><h1 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h1><h2 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mybatis-plusçš„springbootæ”¯æŒ--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--ç®€åŒ–beanä»£ç çš„å·¥å…·åŒ…--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="log4j-properties"><a href="#log4j-properties" class="headerlink" title="log4j.properties"></a>log4j.properties</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,A1</span></span><br><span class="line"><span class="meta">log4j.appender.A1</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.A1.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.A1.layout.ConversionPattern</span>=<span class="string">[%t] [%c]-[%p] %m%n</span></span><br></pre></td></tr></table></figure><h3 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.application.name</span> = <span class="string">itcast-mp-springboot</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/groot? useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">iamgroot</span></span><br></pre></td></tr></table></figure><h2 id="å®ä½“ç±»"><a href="#å®ä½“ç±»" class="headerlink" title="å®ä½“ç±»"></a>å®ä½“ç±»</h2><p>ä½¿ç”¨lombokæ³¨è§£ç”Ÿæˆgetã€setæ–¹æ³•</p><p>ä½¿ç”¨MybatisPlusæ³¨è§£æŒ‡å®šè¡¨å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName</span>(<span class="string">"tb_user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="meta">@TableId</span>(type = IdType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨@TableIdæŒ‡å®šidçš„å¢é•¿ç­–ç•¥</p><h3 id="TableField"><a href="#TableField" class="headerlink" title="@TableField"></a>@TableField</h3><p>å¯è§£å†³çš„é—®é¢˜ï¼š</p><ol><li><p>å¯¹è±¡ä¸­çš„å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜(éé©¼å³°)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField</span>(value = <span class="string">"email"</span>)</span><br><span class="line"><span class="keyword">private</span> String mail;</span><br></pre></td></tr></table></figure></li><li><p>å¯¹è±¡ä¸­çš„å±æ€§å­—æ®µåœ¨è¡¨ä¸­ä¸å­˜åœ¨çš„é—®é¢˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField</span>(exist = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> String address;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢æ—¶ä¸è¿”å›è¯¥å­—æ®µçš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField</span>(select = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> String password;</span><br></pre></td></tr></table></figure></li></ol><h2 id="Mapperæ¥å£"><a href="#Mapperæ¥å£" class="headerlink" title="Mapperæ¥å£"></a>Mapperæ¥å£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="SpringBootå¯åŠ¨ç±»"><a href="#SpringBootå¯åŠ¨ç±»" class="headerlink" title="SpringBootå¯åŠ¨ç±»"></a>SpringBootå¯åŠ¨ç±»</h2><p>ä½¿ç”¨@MapperScanè®¾ç½®mapperæ¥å£çš„æ‰«æåŒ…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.coconutnut.demo.mapper"</span>) </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/screencapture2020-04-21 PM12.22.59.jpg" width=300><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">DemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><img src="/images/2020/screencapture2020-04-21 PM12.19.07.jpg"><h2 id="DEBUG-ä¾èµ–é‡å¤"><a href="#DEBUG-ä¾èµ–é‡å¤" class="headerlink" title="DEBUG ä¾èµ–é‡å¤"></a>DEBUG ä¾èµ–é‡å¤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br></pre></td></tr></table></figure><p>åˆ é™¤ä¾èµ–ä¸­çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.slf4j&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;slf4j-log4j12&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><h1 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h1><p>æŸ¥çœ‹UserMapperç»§æ‰¿çš„BaseMapperæºç </p><img src="/images/2020/screencapture2020-04-21 PM12.28.46.jpg"><p>CRUDæ–¹æ³•éƒ½æœ‰äº†</p><p>å®˜ç½‘æ–‡æ¡£</p><blockquote><p><a href="https://mybatis.plus/guide/crud-interface.html#mapper-crud-æ¥å£" target="_blank" rel="noopener">https://mybatis.plus/guide/crud-interface.html#mapper-crud-%E6%8E%A5%E5%8F%A3</a></p></blockquote><p>ç›´æ¥æµ‹è¯•</p><h2 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(T entity)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">TestUserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setAge(<span class="number">20</span>);</span><br><span class="line">        user.setUserName(<span class="string">"zhangsi"</span>);</span><br><span class="line">        user.setName(<span class="string">"å¼ å››"</span>);</span><br><span class="line">        user.setEmail(<span class="string">"zhangsi@163.com"</span>);</span><br><span class="line">        user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.insert(user); <span class="comment">// è¿”å›çš„resultæ˜¯å—å½±å“çš„è¡Œæ•°ï¼Œå¹¶ä¸æ˜¯è‡ªå¢åçš„id</span></span><br><span class="line">        System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">        System.out.println(user.getId()); <span class="comment">// è‡ªå¢åçš„idä¼šå›å¡«åˆ°å¯¹è±¡ä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œåï¼Œæ•°æ®åº“å˜åŒ–</p><img src="/images/2020/screencapture2020-04-21 PM12.57.42.jpg"><p>è¾“å‡º</p><img src="/images/2020/screencapture2020-04-21 PM12.57.29.jpg"><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® whereEntity æ¡ä»¶ï¼Œæ›´æ–°è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(@Param(Constants.ENTITY)</span> T entity, @<span class="title">Param</span><span class="params">(Constants.WRAPPER)</span> Wrapper&lt;T&gt; updateWrapper)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® ID ä¿®æ”¹</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateById</span><span class="params">(@Param(Constants.ENTITY)</span> T entity)</span>;</span><br></pre></td></tr></table></figure><h3 id="æ ¹æ®idæ›´æ–°"><a href="#æ ¹æ®idæ›´æ–°" class="headerlink" title="æ ¹æ®idæ›´æ–°"></a>æ ¹æ®idæ›´æ–°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">1L</span>);</span><br><span class="line">  user.setAge(<span class="number">21</span>);</span><br><span class="line">  <span class="comment">//æ ¹æ®idæ›´æ–°ï¼Œæ›´æ–°ä¸ä¸ºnullçš„å­—æ®µ</span></span><br><span class="line">  <span class="keyword">this</span>.userMapper.updateById(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.29.48.jpg"><h3 id="æ ¹æ®æ¡ä»¶æ›´æ–°"><a href="#æ ¹æ®æ¡ä»¶æ›´æ–°" class="headerlink" title="æ ¹æ®æ¡ä»¶æ›´æ–°"></a>æ ¹æ®æ¡ä»¶æ›´æ–°</h3><h4 id="QueryWrapper"><a href="#QueryWrapper" class="headerlink" title="QueryWrapper"></a>QueryWrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">22</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°çš„æ¡ä»¶</span></span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">  <span class="comment">// wrapper.eq("id", 6);</span></span><br><span class="line">  wrapper.eq(<span class="string">"user_name"</span>,<span class="string">"zhangsan"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.update(user, wrapper);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>wrapperä¸­è®¾ç½®å±æ€§ç”¨çš„æ˜¯mysqlè¡¨ä¸­çš„åç§°</p><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.35.03.jpg"><h4 id="UpdateWrapper"><a href="#UpdateWrapper" class="headerlink" title="UpdateWrapper"></a>UpdateWrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//æ›´æ–°çš„æ¡ä»¶ä»¥åŠå­—æ®µ</span></span><br><span class="line">  UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">  wrapper.eq(<span class="string">"id"</span>, <span class="number">6</span>).set(<span class="string">"age"</span>, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ‰§è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.update(<span class="keyword">null</span>, wrapper);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.37.47.jpg"><h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; wrapper)</span>;</span><br><span class="line"><span class="comment">// åˆ é™¤ï¼ˆæ ¹æ®ID æ‰¹é‡åˆ é™¤ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteBatchIds</span><span class="params">(@Param(Constants.COLLECTION)</span> Collection&lt;? extends Serializable&gt; idList)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® ID åˆ é™¤</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"><span class="comment">// æ ¹æ® columnMap æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteByMap</span><span class="params">(@Param(Constants.COLUMN_MAP)</span> Map&lt;String, Object&gt; columnMap)</span>;</span><br></pre></td></tr></table></figure><h3 id="deleteById"><a href="#deleteById" class="headerlink" title="deleteById"></a>deleteById</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.deleteById(<span class="number">6L</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.41.34.jpg"><h3 id="deleteByMap"><a href="#deleteByMap" class="headerlink" title="deleteByMap"></a>deleteByMap</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// å°†columnMapä¸­çš„å…ƒç´ è®¾ç½®ä¸ºåˆ é™¤çš„æ¡ä»¶ï¼Œå¤šä¸ªä¹‹é—´ä¸ºandå…³ç³»</span></span><br><span class="line">  Map&lt;String, Object&gt; columnMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  columnMap.put(<span class="string">"age"</span>,<span class="number">20</span>);</span><br><span class="line">  columnMap.put(<span class="string">"name"</span>,<span class="string">"å¼ ä¸‰"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.deleteByMap(columnMap);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.43.36.jpg"><p>æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„</p><h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// ç”¨æ³•1</span></span><br><span class="line"><span class="comment">//        QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;();</span></span><br><span class="line"><span class="comment">//        wrapper.eq("user_name","zhangsan");</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ç”¨æ³•2</span></span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">20</span>);</span><br><span class="line">  user.setName(<span class="string">"å¼ ä¸‰"</span>);</span><br><span class="line">  <span class="comment">// å°†å®ä½“å¯¹è±¡è¿›è¡ŒåŒ…è£…ï¼ŒåŒ…è£…ä¸ºæ“ä½œæ¡ä»¶</span></span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;(user);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.delete(wrapper);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨èä½¿ç”¨ç”¨æ³•2</p><h3 id="deleteByIds"><a href="#deleteByIds" class="headerlink" title="deleteByIds"></a>deleteByIds</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.deleteBatchIds(Arrays.asList(<span class="number">1L</span>,<span class="number">10L</span>,<span class="number">20L</span>)); </span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® ID æŸ¥è¯¢</span></span><br><span class="line"><span class="function">T <span class="title">selectById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="function">T <span class="title">selectOne</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢ï¼ˆæ ¹æ®ID æ‰¹é‡æŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectBatchIds</span><span class="params">(@Param(Constants.COLLECTION)</span> Collection&lt;? extends Serializable&gt; idList)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectList</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"><span class="comment">// æŸ¥è¯¢ï¼ˆæ ¹æ® columnMap æ¡ä»¶ï¼‰</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectByMap</span><span class="params">(@Param(Constants.COLUMN_MAP)</span> Map&lt;String, Object&gt; columnMap)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; selectMaps(<span class="meta">@Param</span>(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ã€‚æ³¨æ„ï¼š åªè¿”å›ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼</span></span><br><span class="line"><span class="function">List&lt;Object&gt; <span class="title">selectObjs</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ï¼ˆå¹¶ç¿»é¡µï¼‰</span></span><br><span class="line"><span class="function">IPage&lt;T&gt; <span class="title">selectPage</span><span class="params">(IPage&lt;T&gt; page, @Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ï¼ˆå¹¶ç¿»é¡µï¼‰</span></span><br><span class="line">IPage&lt;Map&lt;String, Object&gt;&gt; selectMapsPage(IPage&lt;T&gt; page, <span class="meta">@Param</span>(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢æ€»è®°å½•æ•°</span></span><br><span class="line"><span class="function">Integer <span class="title">selectCount</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br></pre></td></tr></table></figure><h3 id="selectById"><a href="#selectById" class="headerlink" title="selectById"></a>selectById</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  User user = <span class="keyword">this</span>.userMapper.selectById(<span class="number">2L</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.52.44.jpg"><p>æ²¡æŸ¥åˆ°ä¸ºnull</p><h3 id="selectOne"><a href="#selectOne" class="headerlink" title="selectOne"></a>selectOne</h3><p>ä¸å­˜åœ¨è¿”å›null</p><p>æŸ¥åˆ°å¤šæ¡æŠ¥é”™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.eq(<span class="string">"name"</span>, <span class="string">"æå››"</span>);</span><br><span class="line">  User user = <span class="keyword">this</span>.userMapper.selectOne(wrapper);</span><br><span class="line">  System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User(id&#x3D;2, userName&#x3D;lisi, password&#x3D;123456, name&#x3D;æå››, age&#x3D;20, email&#x3D;test2@itcast.cn)</span><br></pre></td></tr></table></figure><h3 id="selectBatchIds"><a href="#selectBatchIds" class="headerlink" title="selectBatchIds"></a>selectBatchIds</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectBatchIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectBatchIds(Arrays.asList(<span class="number">2L</span>, <span class="number">3L</span>, <span class="number">100L</span>));</span><br><span class="line">  <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM2.54.08.jpg"><h3 id="selectCount"><a href="#selectCount" class="headerlink" title="selectCount"></a>selectCount</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.gt(<span class="string">"age"</span>, <span class="number">23</span>); <span class="comment">// å¹´é¾„å¤§äº23å²</span></span><br><span class="line">  Integer count = <span class="keyword">this</span>.userMapper.selectCount(wrapper);</span><br><span class="line">  System.out.println(<span class="string">"count = "</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count &#x3D; 2</span><br></pre></td></tr></table></figure><h3 id="selectList"><a href="#selectList" class="headerlink" title="selectList"></a>selectList</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.gt(<span class="string">"age"</span>, <span class="number">23</span>); <span class="comment">// å¹´é¾„å¤§äº23å²</span></span><br><span class="line">  <span class="comment">//æ ¹æ®æ¡ä»¶æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">  List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line">  <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">    System.out.println(<span class="string">"user = "</span> + user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM3.03.34.jpg"><h3 id="selectPage"><a href="#selectPage" class="headerlink" title="selectPage"></a>selectPage</h3><p>é…ç½®åˆ†é¡µæ’ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.coconutnut.demo.mapper"</span>) <span class="comment">// è®¾ç½®mapperæ¥å£çš„æ‰«æåŒ…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰äº†è¿™ä¸ªé…ç½®ç±»ä¹‹åï¼ŒDemoApplicationä¸­çš„@MapperScanå¯ä»¥å»æ‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.gt(<span class="string">"age"</span>, <span class="number">20</span>); <span class="comment">// å¹´é¾„å¤§äº20å²</span></span><br><span class="line">  Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">  IPage&lt;User&gt; iPage = <span class="keyword">this</span>.userMapper.selectPage(page, wrapper);</span><br><span class="line"></span><br><span class="line">  System.out.println(<span class="string">"æ•°æ®æ€»æ¡æ•°:"</span> + iPage.getTotal());</span><br><span class="line">  System.out.println(<span class="string">"æ€»é¡µæ•°:"</span> + iPage.getPages());</span><br><span class="line">  List&lt;User&gt; users = iPage.getRecords();</span><br><span class="line">  <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">    System.out.println(<span class="string">"user = "</span> + user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå</p><img src="/images/2020/screencapture2020-04-21 PM3.11.25.jpg">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1rE41197jR&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1rE411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="mybatis_plus" scheme="http://yoursite.com/tags/mybatis-plus/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°05 OpenFeignæœåŠ¡æ¶ˆè´¹è€…</title>
    <link href="http://yoursite.com/2020/04/21/note-springcloud-05/"/>
    <id>http://yoursite.com/2020/04/21/note-springcloud-05/</id>
    <published>2020-04-21T01:36:57.000Z</published>
    <updated>2020-04-21T02:12:01.468Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://blog.csdn.net/ThinkWon/article/details/103735751" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103735751</a></p></blockquote><p>Spring Cloud OpenFeign æ˜¯å£°æ˜å¼çš„æœåŠ¡è°ƒç”¨å·¥å…·ï¼Œå®ƒæ•´åˆäº†Ribbonå’ŒHystrixï¼Œæ‹¥æœ‰è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å®¹é”™åŠŸèƒ½</p><h1 id="åˆ›å»ºfeign-serviceæ¨¡å—"><a href="#åˆ›å»ºfeign-serviceæ¨¡å—" class="headerlink" title="åˆ›å»ºfeign-serviceæ¨¡å—"></a>åˆ›å»ºfeign-serviceæ¨¡å—</h1><h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><p>æ•™ç¨‹ç»™çš„ä¾èµ–æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ¢æˆconsulæ³¨å†Œä¸­å¿ƒï¼Œæ”¹æˆ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°æ²¡æœ‰spring cloudç‰ˆæœ¬å’Œä¾èµ–ç®¡ç†ï¼ŒåŠ ä¸Š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.RELEASE<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å³ä¾§Mavenæ ä¸­æ²¡æœ‰çº¢çº¿</p><p>ä¸‹ä¸€æ­¥</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>æ•™ç¨‹ç»™çš„é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8701</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">feign-service</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8001/eureka/</span></span><br></pre></td></tr></table></figure><p>æ¢æˆconsul</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#eureka:</span></span><br><span class="line"><span class="comment">#  client:</span></span><br><span class="line"><span class="comment">#    register-with-eureka: true</span></span><br><span class="line"><span class="comment">#    fetch-registry: true</span></span><br><span class="line"><span class="comment">#    service-url:</span></span><br><span class="line"><span class="comment">#      defaultZone: http://localhost:8001/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cloud:</span></span><br><span class="line">  <span class="attr">consul:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">    <span class="attr">discovery:</span></span><br><span class="line">      <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure><h2 id="EnableFeignClientså¯åŠ¨åŠŸèƒ½"><a href="#EnableFeignClientså¯åŠ¨åŠŸèƒ½" class="headerlink" title="@EnableFeignClientså¯åŠ¨åŠŸèƒ½"></a>@EnableFeignClientså¯åŠ¨åŠŸèƒ½</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@EnableFeignClients</span><br><span class="line">@EnableDiscoveryClient</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class FeignServiceApplication &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(FeignServiceApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¥å£å’Œæ§åˆ¶å™¨"><a href="#æ¥å£å’Œæ§åˆ¶å™¨" class="headerlink" title="æ¥å£å’Œæ§åˆ¶å™¨"></a>æ¥å£å’Œæ§åˆ¶å™¨</h2><p>æ ¹æ®æºç è¡¥é½å…¶å®ƒä»£ç </p><img src="/images/2020/screencapture2020-04-21 AM9.49.59.jpg" width=300><h1 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h1><p>å¯åŠ¨consulæœåŠ¡å™¨ï¼Œä¸¤ä¸ªuser-serviceï¼Œfeign-serviceæœåŠ¡</p><img src="/images/2020/screencapture2020-04-21 AM9.52.28.jpg"><p>è°ƒç”¨<a href="http://localhost:8701/user/1å››æ¬¡" target="_blank" rel="noopener">http://localhost:8701/user/1å››æ¬¡</a></p><img src="/images/2020screencapture2020-04-21 AM9.53.09.jpg"><p>äº¤æ›¿æ‰“å°</p><img src="/images/2020/screencapture2020-04-21 AM9.53.16.jpg"><h1 id="æœåŠ¡é™çº§"><a href="#æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h1><p>å‰é¢UserFallbackServiceä¹Ÿæ‹·è¿‡æ¥äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"user-service"</span>, fallback = UserFallbackService<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨é‡Šä¹ŸåŠ äº†</p><p>ä¿®æ”¹application.ymlï¼Œå¼€å¯HystrixåŠŸèƒ½</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨Feignä¸­å¼€å¯Hystrix</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>å…³é—­ä¸¤ä¸ªuser-serviceæœåŠ¡ï¼Œé‡æ–°å¯åŠ¨feign-service</p><p>è°ƒç”¨<a href="http://localhost:8701/user/1è¿›è¡Œæµ‹è¯•" target="_blank" rel="noopener">http://localhost:8701/user/1è¿›è¡Œæµ‹è¯•</a></p><p>å‘ç°è¢«é™çº§</p><img src="/images/2020/screencapture2020-04-21 AM9.57.28.jpg"><h1 id="æ—¥å¿—æ‰“å°åŠŸèƒ½"><a href="#æ—¥å¿—æ‰“å°åŠŸèƒ½" class="headerlink" title="æ—¥å¿—æ‰“å°åŠŸèƒ½"></a>æ—¥å¿—æ‰“å°åŠŸèƒ½</h1><p>ç”¨FeignConfigé…ç½®ç±»</p><p>åœ¨application.ymlä¸­é…ç½®éœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯</p><p>å¯è®¾ç½®æ—¥å¿—çº§åˆ«</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-21 AM10.11.43.jpg">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ThinkWon/article/details/103735751&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://blog.csdn.net/Thin
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="springcloud" scheme="http://yoursite.com/tags/springcloud/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°04 ConsulæœåŠ¡æ²»ç†</title>
    <link href="http://yoursite.com/2020/04/20/note-springcloud-04/"/>
    <id>http://yoursite.com/2020/04/20/note-springcloud-04/</id>
    <published>2020-04-20T03:06:19.000Z</published>
    <updated>2020-04-20T04:06:21.592Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.consul.io/" target="_blank" rel="noopener">https://www.consul.io/</a></p></blockquote><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><blockquote><p><a href="https://learn.hashicorp.com/consul/getting-started/install.html" target="_blank" rel="noopener">https://learn.hashicorp.com/consul/getting-started/install.html</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% brew install consul</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% consul version</span><br><span class="line">Consul v1.6.3</span><br><span class="line">Protocol 2 spoken by default, understands 2 to 3 (agent will automatically use protocol &gt;2 when speaking to compatible agents)</span><br></pre></td></tr></table></figure><h1 id="å®˜æ–¹æ•™ç¨‹"><a href="#å®˜æ–¹æ•™ç¨‹" class="headerlink" title="å®˜æ–¹æ•™ç¨‹"></a>å®˜æ–¹æ•™ç¨‹</h1><blockquote><p><a href="https://learn.hashicorp.com/consul/getting-started/agent" target="_blank" rel="noopener">https://learn.hashicorp.com/consul/getting-started/agent</a></p></blockquote><h2 id="å¯åŠ¨æœåŠ¡å™¨"><a href="#å¯åŠ¨æœåŠ¡å™¨" class="headerlink" title="å¯åŠ¨æœåŠ¡å™¨"></a>å¯åŠ¨æœåŠ¡å™¨</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ consul agent -dev</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹èŠ‚ç‚¹"><a href="#æŸ¥çœ‹èŠ‚ç‚¹" class="headerlink" title="æŸ¥çœ‹èŠ‚ç‚¹"></a>æŸ¥çœ‹èŠ‚ç‚¹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ consul members</span><br></pre></td></tr></table></figure><p><strong>å°è¯•</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% consul members</span><br><span class="line">Node                  Address         Status  Type    Build  Protocol  DC   Segment</span><br><span class="line">Ss-MacBook-Pro.local  127.0.0.1:8301  alive   server  1.6.3  2         dc1  &lt;all&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">coconutnut@Ss-MacBook-Pro ~ % consul members -detailed</span><br><span class="line">Node                  Address         Status  Tags</span><br><span class="line">Ss-MacBook-Pro.local  127.0.0.1:8301  alive   acls&#x3D;0,build&#x3D;1.6.3:7f3b5f3+,dc&#x3D;dc1,id&#x3D;d9c5a17b-cc6b-1ca6-7c72-07304fbcccdc,port&#x3D;8300,raft_vsn&#x3D;3,role&#x3D;consul,segment&#x3D;&lt;all&gt;,vsn&#x3D;2,vsn_max&#x3D;3,vsn_min&#x3D;2,wan_join_port&#x3D;8302</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯memberå‘½ä»¤è·å–çš„ä¿¡æ¯åªæ˜¯eventually consistentçš„</p><p>ä¸€è‡´æ€§æ›´å¼ºçš„æ–¹å¼æ˜¯ä½¿ç”¨http api</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost:8500&#x2F;v1&#x2F;catalog&#x2F;nodes</span><br></pre></td></tr></table></figure><p><strong>å°è¯•</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">% curl localhost:8500&#x2F;v1&#x2F;catalog&#x2F;nodes</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;ID&quot;: &quot;d9c5a17b-cc6b-1ca6-7c72-07304fbcccdc&quot;,</span><br><span class="line">        &quot;Node&quot;: &quot;Ss-MacBook-Pro.local&quot;,</span><br><span class="line">        &quot;Address&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">        &quot;Datacenter&quot;: &quot;dc1&quot;,</span><br><span class="line">        &quot;TaggedAddresses&quot;: &#123;</span><br><span class="line">            &quot;lan&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">            &quot;wan&quot;: &quot;127.0.0.1&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Meta&quot;: &#123;</span><br><span class="line">            &quot;consul-network-segment&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;CreateIndex&quot;: 10,</span><br><span class="line">        &quot;ModifyIndex&quot;: 11</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨dns</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">% dig @127.0.0.1 -p 8600 Judiths-MBP.node.consul</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @127.0.0.1 -p 8600 Judiths-MBP.node.consul</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 33684</span><br><span class="line">;; flags: qr aa rd; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1</span><br><span class="line">;; WARNING: recursion requested but not available</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;Judiths-MBP.node.consul.INA</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">consul.0INSOAns.consul. hostmaster.consul. 1587353730 3600 600 86400 0</span><br><span class="line"></span><br><span class="line">;; Query time: 0 msec</span><br><span class="line">;; SERVER: 127.0.0.1#8600(127.0.0.1)</span><br><span class="line">;; WHEN: Mon Apr 20 11:35:30 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 102</span><br></pre></td></tr></table></figure><h2 id="ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹"><a href="#ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹" class="headerlink" title="ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹"></a>ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹</h2><p>ctrl+C æš‚åœæœåŠ¡å™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ consul leave</span><br></pre></td></tr></table></figure><h1 id="æ³¨å†Œåˆ°consul"><a href="#æ³¨å†Œåˆ°consul" class="headerlink" title="æ³¨å†Œåˆ°consul"></a>æ³¨å†Œåˆ°consul</h1><blockquote><p><a href="https://juejin.im/post/5db05582f265da4d4c20180f" target="_blank" rel="noopener">https://juejin.im/post/5db05582f265da4d4c20180f</a></p></blockquote><p>å°†ä»¥å‰æ³¨å†Œåˆ°eurekaçš„æœåŠ¡æ”¹åˆ°consul</p><p>user-serviceæ¨¡å—</p><p>ä¿®æ”¹ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#eureka:</span></span><br><span class="line"><span class="comment">#  client:</span></span><br><span class="line"><span class="comment">#    register-with-eureka: true</span></span><br><span class="line"><span class="comment">#    fetch-registry: true</span></span><br><span class="line"><span class="comment">#    service-url:</span></span><br><span class="line"><span class="comment">#      defaultZone: http://localhost:8001/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cloud:</span></span><br><span class="line">  <span class="attr">consul:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">    <span class="attr">discovery:</span></span><br><span class="line">      <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure><p>ribbon-serviceæ¨¡å—ä¹Ÿæ˜¯</p><img src="/images/2020/screencapture2020-04-20 AM11.50.55.jpg"><p> Service Checksæ˜¯Xï¼Œä½†æ˜¯å¯ä»¥è®¿é—®ï¼Ÿ</p><img src="/images/2020/screencapture2020-04-20 AM11.51.51.jpg"><p>ä½†æ˜¯<a href="http://localhost:8301/user/1è·å–ä¸äº†" target="_blank" rel="noopener">http://localhost:8301/user/1è·å–ä¸äº†</a></p><p>æŠ¥é”™ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.IllegalStateException: No instances available for user-service</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/kxj19980524/article/details/86935415" target="_blank" rel="noopener">https://blog.csdn.net/kxj19980524/article/details/86935415</a></p></blockquote><p>è¿˜éœ€è¦åŠ ä¸€ä¸ªç›‘æ§ä¸­å¿ƒçš„ä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>é‡å¯</p><img src="/images/2020/screencapture2020-04-20 AM11.58.30.jpg"><p>è®¿é—®<a href="http://localhost:8301/user/1å››æ¬¡" target="_blank" rel="noopener">http://localhost:8301/user/1å››æ¬¡</a></p><p>æ§åˆ¶å°è¾“å‡º</p><img src="/images/2020/screencapture2020-04-20 AM11.58.49.jpg"><p>äº¤æ›¿è°ƒç”¨</p><img src="/images/2020/screencapture2020-04-20 AM11.58.58.jpg"><p>æˆåŠŸ</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç»ˆç«¯å¯åŠ¨consulæœåŠ¡å™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ consul agent -dev</span><br></pre></td></tr></table></figure><p>Ideaæ¨¡å— consulå®¢æˆ·ç«¯</p><p>ä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>é…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cloud:</span><br><span class="line">  consul:</span><br><span class="line">    host: localhost</span><br><span class="line">    port: 8500</span><br><span class="line">    discovery:</span><br><span class="line">      service-name: $&#123;spring.application.name&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.consul.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.consul.io/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;å®‰è£…&quot;&gt;&lt;a 
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="springcloud" scheme="http://yoursite.com/tags/springcloud/"/>
    
  </entry>
  
  <entry>
    <title>axiosè¯·æ±‚è·¨åŸŸé—®é¢˜</title>
    <link href="http://yoursite.com/2020/04/18/debug/"/>
    <id>http://yoursite.com/2020/04/18/debug/</id>
    <published>2020-04-18T04:00:22.000Z</published>
    <updated>2020-04-21T01:36:23.357Z</updated>
    
    <content type="html"><![CDATA[<img src="/images/2020/screencapture2020-04-18 PM12.01.36.jpg"><p>å‘ç°æœ‰è·¨åŸŸé—®é¢˜</p><p>æŸ¥åˆ°</p><blockquote><p><a href="https://www.cnblogs.com/l-y-h/p/11815452.html" target="_blank" rel="noopener">https://www.cnblogs.com/l-y-h/p/11815452.html</a></p></blockquote><p>ç…§ç€æ”¹äº†ä¸€ä¸‹</p><p>ä½†æ˜¯åˆå‡ºç°äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cannot set property $http of #&lt;Vue&gt; which has only a getter at eval axios</span><br></pre></td></tr></table></figure><p>æœ€åè§£å†³æ–¹æ³•</p><p>vue.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        proxy: &#123;</span><br><span class="line">            &#39;&#x2F;api&#39;: &#123;</span><br><span class="line">                target: &#39;http:&#x2F;&#x2F;***:3000&#x2F;&#39;,</span><br><span class="line">                &#x2F;&#x2F; å…è®¸è·¨åŸŸ</span><br><span class="line">                changeOrigin: true,</span><br><span class="line">                ws: true,</span><br><span class="line">                pathRewrite: &#123;</span><br><span class="line">                    &#39;^&#x2F;api&#39;: &#39;&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$axios.get(<span class="string">'/api/findall'</span>).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(response.data)</span><br><span class="line">            &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                alert(error);</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;img src=&quot;/images/2020/screencapture2020-04-18 PM12.01.36.jpg&quot;&gt;

&lt;p&gt;å‘ç°æœ‰è·¨åŸŸé—®é¢˜&lt;/p&gt;
&lt;p&gt;æŸ¥åˆ°&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/l
      
    
    </summary>
    
    
      <category term="Debug" scheme="http://yoursite.com/categories/Debug/"/>
    
    
      <category term="vue" scheme="http://yoursite.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>Axureç¬”è®°</title>
    <link href="http://yoursite.com/2020/04/16/note-axure/"/>
    <id>http://yoursite.com/2020/04/16/note-axure/</id>
    <published>2020-04-16T03:17:25.000Z</published>
    <updated>2020-05-02T05:58:08.513Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV1Yx411f7d6" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Yx411f7d6</a></p></blockquote><h1 id="æ ‡å°º"><a href="#æ ‡å°º" class="headerlink" title="æ ‡å°º"></a>æ ‡å°º</h1><p>æŒ‰ä½å°ºå­æ‹–ä¸‹æ¥</p><img src="/images/2020/screencapture2020-04-16 AM11.19.53.jpg"><p>å·¦ä¾§ä¹Ÿæ˜¯</p><h1 id="åœ†è§’"><a href="#åœ†è§’" class="headerlink" title="åœ†è§’"></a>åœ†è§’</h1><p>æŒ‰ä½é»„è‰²ä¸‰è§’æ‹–åŠ¨</p><img src="/images/2020/screencapture2020-04-16 AM11.34.03.jpg"><h1 id="å¹³å‡æ’å¸ƒ"><a href="#å¹³å‡æ’å¸ƒ" class="headerlink" title="å¹³å‡æ’å¸ƒ"></a>å¹³å‡æ’å¸ƒ</h1><p>é€‰ä¸­å‡ ä¸ªå…ƒç´ ï¼Œç‚¹æ°´å¹³</p><img src="/images/2020/screencapture2020-04-16 AM11.37.11.jpg"><h1 id="åˆ‡å‰²é¡¶æ "><a href="#åˆ‡å‰²é¡¶æ " class="headerlink" title="åˆ‡å‰²é¡¶æ "></a>åˆ‡å‰²é¡¶æ </h1><p>å³é”®-&gt;åˆ†å‰²å›¾ç‰‡</p><img src="/images/2020/screencapture2020-04-16 PM12.08.32.jpg"><h1 id="åŠ¨ä½œ"><a href="#åŠ¨ä½œ" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h1><p>å…ˆå»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªé¡µé¢å¯¹åº”ä¸€é¡µï¼Œå¤§å°ã€ä½ç½®ç›¸åŒ</p><p>ç”¨çƒ­åŒºç½©åœ¨ç‚¹å‡»åŒºåŸŸä¸Š</p><p>æ·»åŠ äº¤äº’</p><img src="/images/2020/screencapture2020-04-16 PM12.27.48.jpg"><p>è·³è½¬é¡µé¢ å¯é€‰æ‹©æ‰“å¼€é“¾æ¥</p><hr><p>ä¸Šæ‰‹å®Œæˆ</p><img src="/images/2020/screencapture2020-04-16 PM12.31.48.jpg"><img src="/images/2020/screencapture2020-04-16 PM12.31.52.jpg">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.bilibili.com/video/BV1Yx411f7d6&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.bilibili.com/video/BV1Yx411
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="tool" scheme="http://yoursite.com/tags/tool/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°03 Hystrixæ–­è·¯å™¨</title>
    <link href="http://yoursite.com/2020/04/12/note-springcloud-03/"/>
    <id>http://yoursite.com/2020/04/12/note-springcloud-03/</id>
    <published>2020-04-12T07:57:20.000Z</published>
    <updated>2020-04-12T09:37:03.122Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://blog.csdn.net/ThinkWon/article/details/103732497" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103732497</a></p></blockquote><p>HystrixåŠŸèƒ½ï¼šæœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­ã€çº¿ç¨‹éš”ç¦»ã€è¯·æ±‚ç¼“å­˜ã€è¯·æ±‚åˆå¹¶ã€æœåŠ¡ç›‘æ§ç­‰</p><h1 id="åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—"><a href="#åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—" class="headerlink" title="åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—"></a>åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—</h1><p>ç»è¿‡å‰é¢ä¸€ç³»åˆ—æ‰å¿ƒæ“ä½œï¼Œè¿™æ¬¡åˆ›å»ºçš„æ—¶å€™æ²¡æœ‰ç”¨Spring InitializeråŠ ä¾èµ–ï¼Œç›´æ¥æ”¹çš„pom.xmlå¹¶ä¿®æ”¹ç‰ˆæœ¬</p><p>@EnableCircuitBreakerå¼€å¯æ–­è·¯å™¨åŠŸèƒ½</p><p>pomä¸­è¿˜è¦åŠ ä¸€ä¸ªä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;cn.hutool&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;hutool-all&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;version&gt;5.1.0&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ¨¡å—ä¹Ÿæ·»åŠ äº†Ribbonçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½</p><p>ä½†æ˜¯pomä¸­å¹¶æ²¡æœ‰é…ç½®è¿™ä¸ªä¾èµ–</p><p>çœ‹äº†ä¸‹ä¾èµ–å›¾å‘ç°æ˜¯eureka-clientä¾èµ–çš„</p><img src="/images/2020/screencapture2020-04-12 PM4.24.37.jpg"><h2 id="æœåŠ¡é™çº§"><a href="#æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h2><p>åœ¨UserHystrixControllerä¸­æ·»åŠ ç”¨äºæµ‹è¯•æœåŠ¡é™çº§çš„æ¥å£</p><p>åœ¨UserServiceä¸­æ·»åŠ è°ƒç”¨æ–¹æ³•ä¸æœåŠ¡é™çº§æ–¹æ³•ï¼Œå¹¶æ·»åŠ @HystrixCommandæ³¨è§£</p><p>å¯åŠ¨eureka-serverã€user-serviceã€hystrix-serviceæœåŠ¡</p><img src="/images/2020/screencapture2020-04-12 PM5.16.10.jpg"><p>å…³é—­user-serviceæœåŠ¡é‡æ–°æµ‹è¯•è¯¥æ¥å£</p><img src="/images/2020/screencapture2020-04-12 PM5.16.42.jpg"><p>åé¢æµ‹è¯•å¿½ç•¥æŸäº›å¼‚å¸¸é™çº§ã€ç¼“å­˜ã€è¯·æ±‚åˆå¹¶è¡¨ç°å‡å’Œæ•™ç¨‹ä¸€æ ·</p><img src="/images/2020/screencapture2020-04-12 PM5.35.06.jpg"><h2 id="DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥"><a href="#DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥" class="headerlink" title="DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥"></a>DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥</h2><p>å¯åŠ¨åæ³¨å†Œä¸­å¿ƒ</p><img src="/images/2020/screencapture2020-04-12 PM4.31.04.jpg"><p>è°ƒç”¨æµ‹è¯•æ–¹æ³•å</p><img src="/images/2020/screencapture2020-04-12 PM4.31.10.jpg"><p>ç›´æ¥å¤±è´¥äº†ï¼Ÿ</p><p>è¯•è¯•åŸæœåŠ¡åœ°å€</p><img src="/images/2020/screencapture2020-04-12 PM4.32.40.jpg"><p>æ²¡é—®é¢˜</p><p>è¿™ä¸ªbugä¼¼æ›¾ç›¸è¯†</p><p>ä¸Šæ¬¡åœ¨ribbon-serviceä¸­æ·»åŠ äº†ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.netflix.ribbon<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ribbon-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>hystrix-serviceä¸­ä¹ŸåŠ ä¸€ä¸ªè¯•è¯•</p><p>æ³¨å†Œä¸­å¿ƒå¤šäº†è­¦å‘Š</p><img src="/images/2020/screencapture2020-04-12 PM4.35.28.jpg"><p>è¿è¡Œ*2</p><p>è¿˜æ˜¯å¤±è´¥äº†</p><p>çœ‹ä¸‹Maven</p><img src="/images/2020/screencapture2020-04-12 PM4.43.25.jpg"><p>åŠ ä¸ªç‰ˆæœ¬</p><p>ribbonæ¨¡å—ç”¨çš„æ˜¯2.3.0</p><p>è¿è¡Œ*3</p><p>è¿˜æ˜¯æŒ‚äº†</p><p>æ‹¿æºç çš„è¿™ä¸‰ä¸ªæ¨¡å—è¯•è¯•</p><img src="/images/2020/screencapture2020-04-12 PM4.47.14.jpg"><p>æ˜¯å¯ä»¥çš„</p><p>å¯¹æ¯”ç‰ˆæœ¬</p><img src="/images/2020/screencapture2020-04-12 PM4.49.02.jpg"><p>å…¨éƒ¨æ”¹æˆä¸€æ ·çš„</p><p>å‘ç°æºç pomä¸­è¿˜å¤šäº†ä¸€ä¸ª</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä»¥åŠ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>éš¾æ€ªå‰é¢springframework-cloudçš„æ¨¡å—æ€»æ˜¯æ²¡æœ‰ç‰ˆæœ¬å·ï¼ŒåŸæ¥æ˜¯æ²¡åŠ è¿™ä¸ª</p><p>ï¼ˆè§£å†³äº†å‰é¢ç¬”è®°02ä¸­ä¸€ä¸ªMARKï¼‰</p><p>è¿è¡Œ*4</p><p>è¿˜ğŸ¥¶æ˜¯ğŸ¥¶æŒ‚ğŸ¥¶äº†</p><p>å†æ¥ä¸€ä¸ªä¸ªæ¯”ä»£ç </p><p>æ²¡å·®å•Šï¼Ÿ</p><p>éš¾é“æ˜¯å…¶å®ƒæ¨¡å—çš„ä¾èµ–ä¹Ÿè¦æ”¹ï¼Ÿæ”¹å§</p><p>å‘ç°å‰é¢å¤§éƒ¨åˆ†éƒ½æ˜¯æœ‰dependencyManagementçš„ï¼Œæ‰€ä»¥å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå˜åŠ¨</p><p>è¿è¡Œ*5</p><p>æŒ‚</p><p>åˆšæ‰æŠŠspring-boot-starter-actuatoråˆ äº†ï¼Œé‡æ–°åŠ ä¸Š</p><p>è¿è¡Œ*6</p><p>ï¼æˆåŠŸäº†</p><p>å¯æ˜¯è¿™ä¸ªæ—¶å€™å…¶å®ƒç‰ˆæœ¬éƒ½å’Œæºç ä¸€æ ·äº†ï¼Œä½†æ˜¯æºç æ²¡æœ‰ç”¨è¿™ä¸ªå•Šï¼Ÿ-MARK-</p><h2 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h2><ol><li><p>ç‰ˆæœ¬ ç‰ˆæœ¬ ç‰ˆæœ¬</p></li><li><p>æ³¨å†Œä¸­å¿ƒæœ‰ï¼Œä½†æ‰¾ä¸åˆ°æœåŠ¡ï¼Œè¯•è¯•åŠ ä¸Š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-12 PM5.36.45.jpg">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ThinkWon/article/details/103732497&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://blog.csdn.net/Thin
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="springcloud" scheme="http://yoursite.com/tags/springcloud/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°02 Ribbonè´Ÿè½½å‡è¡¡</title>
    <link href="http://yoursite.com/2020/04/09/note-springcloud-02/"/>
    <id>http://yoursite.com/2020/04/09/note-springcloud-02/</id>
    <published>2020-04-09T11:13:46.000Z</published>
    <updated>2020-04-12T08:59:59.314Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://blog.csdn.net/ThinkWon/article/details/103729080" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103729080</a></p></blockquote><h1 id="user-serviceæ¨¡å—"><a href="#user-serviceæ¨¡å—" class="headerlink" title="user-serviceæ¨¡å—"></a>user-serviceæ¨¡å—</h1><ol><li>åˆ›å»ºuser-serviceæ¨¡å—</li><li>pom.xmlæ·»åŠ ä¾èµ–</li><li>é…ç½®application.yml</li><li>å®ä½“ç±»å’Œå“åº”ç±»</li><li>æ§åˆ¶å™¨</li><li>Serviceæ¥å£å’Œå®ç°ç±»</li></ol><h1 id="ribbon-serviceæ¨¡å—"><a href="#ribbon-serviceæ¨¡å—" class="headerlink" title="ribbon-serviceæ¨¡å—"></a>ribbon-serviceæ¨¡å—</h1><ol><li>åˆ›å»ºribbon-serviceæ¨¡å—</li><li>pom.xmlæ·»åŠ ä¾èµ–</li><li>é…ç½®application.yml</li><li>@LoadBalancedæ³¨è§£èµ‹äºˆRestTemplateè´Ÿè½½å‡è¡¡çš„èƒ½åŠ›</li><li>å®ä½“ç±»å’Œå“åº”ç±»</li><li>æ§åˆ¶å™¨</li></ol><h1 id="è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º"><a href="#è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º" class="headerlink" title="è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º"></a>è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º</h1><ol><li>å¼€å¯æœåŠ¡</li></ol><p>8001å¼€ä¸€ä¸ªServerï¼ˆä¸Šæ¬¡çš„æ¨¡å—ï¼‰</p><p>8201ã€8202å„å¼€ä¸€ä¸ªService</p><img src="/images/2020/screencapture2020-04-09 PM7.55.27.jpg"><p>è¿™æ¬¡æ˜¯åŒæ ·çš„é…ç½®æ–‡ä»¶ï¼Œ2ä¸ªç«¯å£å„å¼€ä¸€ä¸ªï¼Œæ”¹Active profiles</p><p>ä¸Šæ¬¡æ˜¯ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œå¼€åœ¨ä¸åŒçš„ç«¯å£ï¼Œç”¨Override parameters</p><p>8301å¼€Ribbon Service</p><img src="/images/2020/screencapture2020-04-09 PM9.36.41.jpg"><ol start="2"><li>è°ƒç”¨æ¥å£è¿›è¡Œæµ‹è¯•</li></ol><img src="/images/2020/screencapture2020-04-10 AM10.28.54.jpg"><p>8201</p><img src="/images/2020/screencapture2020-04-10 AM10.32.24.jpg"><p>8202</p><img src="/images/2020/screencapture2020-04-10 AM10.32.33.jpg"><h2 id="DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ"><a href="#DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ" class="headerlink" title="DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ"></a>DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ</h2><p>å¯åŠ¨å‡ ä¸ªæœåŠ¡å</p><img src="/images/2020/screencapture2020-04-09 PM7.59.13.jpg"><p>ä½†æ˜¯æµè§ˆå™¨ä¸­æŸ¥çœ‹</p><img src="/images/2020/screencapture2020-04-09 PM7.59.23.jpg"><p>å‘ç°åˆå¿˜è®°åŠ @EnableDiscoveryClientäº†</p><p>é‡å¯</p><p>è¿˜æ˜¯æ²¡æœ‰æ³¨å†Œä¸Š</p><p><strong>å°è¯•1</strong></p><blockquote><p><a href="https://blog.csdn.net/yangyongming_888/article/details/83859092" target="_blank" rel="noopener">https://blog.csdn.net/yangyongming_888/article/details/83859092</a></p></blockquote><p>è¯´æ˜¯ä¾èµ–å¸¦starterå’Œä¸å¸¦starter</p><p>ä½†æ˜¯çœ‹äº†ä¸‹ä¸‰ä¸ªpom.xmlä¸­éƒ½æ˜¯å¸¦starterçš„</p><p>å†æ¯”è¾ƒä¸€ä¸‹ä¾èµ–</p><p>æºç -eureka-server</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é¡¹ç›®-eureka-server</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æºç -ribbon-service</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é¡¹ç›®-ribbon-service</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æºç -user-service</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é¡¹ç›®-user-service</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€æ ·ï¼Œçœ‹æ¥ä¸æ˜¯è¿™ä¸ªé—®é¢˜</p><p><strong>å°è¯•2</strong></p><p>å…³é—­serverï¼Œç›´æ¥å¯åŠ¨serviceï¼Œå‘ç°ä¹Ÿå¯åŠ¨äº†ï¼Œå¹¶æ²¡æœ‰æŠ¥é”™</p><p>ä½†æ˜¯ä¸Šæ¬¡çš„clientå¦‚æœåœ¨æ²¡å¼€serviceçš„æ—¶å€™å¯åŠ¨ä¼šæŠ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.sun.jersey.api.client.ClientHandlerException: java.net.ConnectException: Connection refused (Connection refused)</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ä¹Ÿè®¸æ ¹æœ¬å°±æ²¡æœ‰è¿ä¸ŠæœåŠ¡å™¨ï¼Ÿ</p><p>éš¾é“æ˜¯ymlæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -X clean install</span><br></pre></td></tr></table></figure><p>æ²¡ç”¨</p><blockquote><p><a href="https://segmentfault.com/q/1010000012008825" target="_blank" rel="noopener">https://segmentfault.com/q/1010000012008825</a></p></blockquote><p>æœ‰è¯´æ˜¯ymlçš„ç¼©è¿›é—®é¢˜</p><p>çœ‹äº†ä¸€ä¸‹ä¸Šæ¬¡å¯ä»¥æ³¨å†Œçš„æœåŠ¡çš„yml</p><img src="/images/2020/screencapture2020-04-09 PM8.49.31.jpg"><p>è¿™æ¬¡çš„</p><img src="/images/2020/screencapture2020-04-09 PM8.49.35.jpg"><p>å‘ç°æ³¨å†Œçš„trueæ˜¯ç™½è‰²çš„</p><p>æç¤º</p><img src="/images/2020/screencapture2020-04-09 PM8.53.23.jpg"><p>ç¡®å®æœ‰é—®é¢˜</p><p>æŠŠpom.xmlä¸­spring-cloud-starter-netflix-eureka-clientçš„ä¾èµ–æ³¨é‡Šçš„ï¼Œä¾ç„¶èƒ½å¯åŠ¨</p><blockquote><p><a href="https://ask.csdn.net/questions/719186" target="_blank" rel="noopener">https://ask.csdn.net/questions/719186</a></p></blockquote><p>æœ‰è¯´åŠ ç‰ˆæœ¬å·çš„</p><p>æ²¡ç”¨</p><p>æƒ³æƒ³å’Œä¸Šæ¬¡åˆ›å»ºçš„åŒºåˆ«ï¼Œä¸Šæ¬¡æ˜¯åœ¨åˆ›å»ºæ¨¡å—çš„æ—¶å€™é€šè¿‡Spring Initializeré€‰æ‹©äº†Eureka Discovery Clientçš„ä¾èµ–</p><p>è¯•è¯•åˆ›å»ºä¸€ä¸ªuser-service2ï¼Œåˆ›å»ºçš„æ—¶å€™é€‰ä¸ŠEureka Discovery Client</p><p>æŠŠapplication.ymlçš„å†…å®¹å¤åˆ¶è¿‡å»ï¼Œå¯ä»¥è§£æ</p><p>å®ƒçš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>user-serviceçš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ²¡å·®å•Š</p><p>é‚£éš¾é“æ˜¯ä¾èµ–æ²¡æœ‰å¯¼å…¥</p><p>çœ‹ä¸‹Maven</p><img src="/images/2020/screencapture2020-04-09 PM9.14.59.jpg"><p>???</p><p>éš¾é“çœŸæ˜¯æ²¡æœ‰ç‰ˆæœ¬å·</p><p>è€Œä¸”ä¸ºä»€ä¹ˆå‰é¢çš„æ¨¡å—ä¹Ÿéƒ½æ˜¯çº¢çš„ï¼Œé‚£æ˜¯æ€ä¹ˆè¿è¡ŒæˆåŠŸçš„ è¿·æƒ‘</p><p>ç‚¹è¿›å»çœ‹ä¸€ä¸‹</p><img src="/images/2020/screencapture2020-04-09 PM9.15.46.jpg"><p>ä¹Ÿè®¸åªæ˜¯éƒ¨åˆ†å†²çªæ‰€ä»¥è¿˜èƒ½è¿è¡Œï¼Ÿ</p><p>æ€»ä¹‹å…ˆåŠ ä¸ªç‰ˆæœ¬å·</p><img src="/images/2020/screencapture2020-04-09 PM9.23.48.jpg"><p>åŠ äº†ä¹‹åè¿˜æ˜¯unknown</p><p>é‡å¯ä¹Ÿæ˜¯</p><p>å‘ç°å³ä¸‹è§’åœ¨ä¸‹è½½</p><p>ä¸‹å®Œä¹‹åå˜æˆäº†Mavenä¸­å˜æˆäº†2.2.2.RELEASE</p><p>æ¿€åŠ¨åœ°æ“æ“æ‰‹</p><img src="/images/2020/screencapture2020-04-09 PM9.27.27.jpg"><p>æˆåŠŸï¼</p><img src="/images/2020/screencapture2020-04-09 PM9.29.40.jpg"><p>æ³¨å†Œä¸Šäº†</p><p>ç»™ribbon-serviceä¹ŸåŠ ä¸ªç‰ˆæœ¬</p><p>åŠ åœ¨propertiesé‡Œä¼¼ä¹ä¸ç®¡ç”¨ï¼Œæš‚æ—¶éƒ½åŠ åœ¨dependencyé‡Œå¥½äº†</p><img src="/images/2020/screencapture2020-04-09 PM9.31.51.jpg"><h2 id="DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜"><a href="#DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜" class="headerlink" title="DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜"></a>DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜</h2><p>å‡ºç°Whitelabel Error Page</p><p>æŠ¥é”™æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">2020-04-09 21:37:37.483 ERROR 3503 --- [nio-8301-exec-1] o.a.c.c.C.[.[.[&#x2F;].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Failed to process import candidates for configuration class [org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration]; nested exception is java.lang.IllegalStateException: Failed to introspect annotated methods on class org.springframework.cloud.netflix.ribbon.RestClientRibbonConfiguration] with root cause</span><br><span class="line"></span><br><span class="line">java.lang.ClassNotFoundException: com.netflix.niws.client.http.RestClient</span><br><span class="line">at java.net.URLClassLoader.findClass(URLClassLoader.java:382) ~[na:1.8.0_241]</span><br><span class="line">at java.lang.ClassLoader.loadClass(ClassLoader.java:418) ~[na:1.8.0_241]</span><br></pre></td></tr></table></figure><p>æ‰¾ä¸åˆ°com.netflix.niws.client.http.RestClient</p><p>çœ‹ä¸€ä¸‹ä¾èµ–</p><img src="/images/2020/screencapture2020-04-09 PM9.46.14.jpg"><p>ä¼¼ä¹æœ‰å¾ˆå¤šå†²çª</p><blockquote><p><a href="https://stackoverflow.com/questions/50675895/java-lang-classnotfoundexception-com-netflix-discovery-eurekaclientconfig" target="_blank" rel="noopener">https://stackoverflow.com/questions/50675895/java-lang-classnotfoundexception-com-netflix-discovery-eurekaclientconfig</a></p><p>You should select only <em>Eureka Server</em> using <em>spring Initializr</em> while creating eureka server project.</p></blockquote><p>â€¦</p><p>è¯•ä¸€ä¸‹é‡æ–°åˆ›å»º</p><img src="/images/2020/screencapture2020-04-09 PM10.00.26.jpg" width=400><p>å°±æ²¡æœ‰å†²çªäº†</p><p>è¿è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.ClassNotFoundException: com.netflix.niws.client.http.RestClient</span><br></pre></td></tr></table></figure><p>æ€ä¹ˆè¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Ÿï¼Ÿï¼Ÿ</p><p>æŠŠribbonçš„ä¾èµ–æŒªåˆ°å‰é¢æ¥ä¼˜å…ˆæ‰¾å‘¢ï¼Ÿ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ä¸è¡Œ</p><p>å†ç¿»ä¸€ä¸‹æŠ¥é”™å‘ç°æ˜¯getUserå‡½æ•°çš„é—®é¢˜</p><img src="/images/2020/screencapture2020-04-09 PM10.19.03.jpg"><p>åœ¨é‡Œé¢æ‰“å°ä¸€ä¸‹è·¯å¾„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">getUser</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"ã€getUserä¸­ã€‘userServiceUrlï¼š"</span>+userServiceUrl);</span><br><span class="line">  <span class="keyword">return</span> restTemplate.getForObject(userServiceUrl + <span class="string">"/user/&#123;1&#125;"</span>, Result<span class="class">.<span class="keyword">class</span>, <span class="title">id</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ã€getUserä¸­ã€‘userServiceUrlï¼šhttp:&#x2F;&#x2F;user-service</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰localhost?</p><p>æµè§ˆå™¨è®¿é—®ä¸€ä¸‹</p><p>æ‰¾ä¸åˆ° <strong>user-service</strong> çš„æœåŠ¡å™¨ IP åœ°å€</p><p>ä¸Šæ¬¡å¥½åƒæ³¨å†Œè¿‡ipæ¥ç€</p><p>ä½†æ˜¯æ³¨å†Œæ˜¯hostname</p><p>è¿™é‡Œåº”è¯¥æ˜¯è¦é€šè¿‡æœåŠ¡åç§°è®¿é—®2ä¸ªServiceï¼Œä¼¼ä¹ä¸ä¸€æ ·</p><p>è¯•è¯•ç›´æ¥ç”¨localhoståŠ ç«¯å£è®¿é—®</p><img src="/images/2020/screencapture2020-04-09 PM10.33.08.jpg"><p>å•ä¸ªèŠ‚ç‚¹çš„æœåŠ¡æ²¡æœ‰é—®é¢˜</p><p>é‚£åº”è¯¥å°±æ˜¯åœ¨æ³¨å†ŒæœåŠ¡åç§°åˆ°ipçš„è½¬æ¢ä¸Šå‡ºäº†é—®é¢˜</p><blockquote><p><a href="https://bbs.csdn.net/topics/392414113" target="_blank" rel="noopener">https://bbs.csdn.net/topics/392414113</a></p></blockquote><p>æŠŠ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RestTemplate restTemplate;</span><br></pre></td></tr></table></figure><p>æ”¹æˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RestOperations restTemplate;</span><br></pre></td></tr></table></figure><p>ä¸è¡Œ</p><blockquote><p><a href="https://www.liangzl.com/get-article-detail-174951.html" target="_blank" rel="noopener">https://www.liangzl.com/get-article-detail-174951.html</a></p></blockquote><p>å¯¹æ¯”äº†ä¸€ä¸‹è¿™ä¸ªæ•™ç¨‹ï¼Œä¹Ÿæ²¡æ‰¾åˆ°é—®é¢˜</p><p>ç½‘é¡µä¸Šçš„é”™è¯¯ä¿¡æ¯æ˜¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">There was an unexpected error (type&#x3D;Internal Server Error, status&#x3D;500).</span><br><span class="line">Failed to process import candidates for configuration class [org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration]; nested exception is java.lang.IllegalStateException: Failed to introspect annotated methods on class org.springframework.cloud.netflix.ribbon.RestClientRibbonConfiguration</span><br></pre></td></tr></table></figure><p>ä¼¼ä¹æ˜¯æ³¨é‡Šçš„é—®é¢˜</p><p>â€¦</p><p>å¾ˆä¹…å¾ˆä¹…ä»¥å</p><p>â€¦</p><p>è¯•è¯•æºç èƒ½ä¸èƒ½è·‘</p><p>æ¼«é•¿çš„ä¸‹è½½ä¾èµ–</p><p><strong>ç¬¬äºŒå¤©</strong></p><p>è¿è¡Œæºç </p><img src="/images/2020/screencapture2020-04-10 AM10.05.19.jpg"><img src="/images/2020/screencapture2020-04-10 AM10.05.28.jpg"><p>æ²¡æœ‰é—®é¢˜</p><p>è€Œä¸”Mavenä¸€ä¸ªéƒ½æ²¡çº¢</p><img src="/images/2020/screencapture2020-04-10 AM10.06.09.jpg" width=300><p>å¯¹æ¯”ä¸€ä¸‹ä¾èµ–ç‰ˆæœ¬</p><p>æºç eureka-server</p><img src="/images/2020/screencapture2020-04-10 AM10.08.50.jpg"><p>é¡¹ç›®eureka-server</p><img src="/images/2020/screencapture2020-04-10 AM10.08.58.jpg"><p>spring-cloud-starter-netflix-eureka-serverç‰ˆæœ¬ä¸ä¸€æ ·</p><p>diffä¸€ä¸‹pomæ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">8c8</span><br><span class="line">&lt;         &lt;version&gt;2.2.2.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line">---</span><br><span class="line">&gt;         &lt;version&gt;2.2.6.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line">11c11</span><br><span class="line">&lt;     &lt;groupId&gt;com.jourwon.springcloud&lt;&#x2F;groupId&gt;</span><br><span class="line">---</span><br><span class="line">&gt;     &lt;groupId&gt;com.coconutnut&lt;&#x2F;groupId&gt;</span><br><span class="line">19c19</span><br><span class="line">&lt;         &lt;spring-cloud.version&gt;Hoxton.RELEASE&lt;&#x2F;spring-cloud.version&gt;</span><br><span class="line">---</span><br><span class="line">&gt;         &lt;spring-cloud.version&gt;Hoxton.SR3&lt;&#x2F;spring-cloud.version&gt;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæ˜¯spring-boot-starter-parentçš„ç‰ˆæœ¬ä¸ä¸€æ ·</p><p>ä¸€ä¸ªæ˜¯spring-cloudçš„ç‰ˆæœ¬ä¸ä¸€æ ·</p><p>ä¿®æ”¹spring-cloudçš„ç‰ˆæœ¬ï¼ŒMavençš„å†²çªå°±æ²¡æœ‰äº†</p><p>äºæ˜¯æŠŠå…¶å®ƒpomçš„ç‰ˆæœ¬ä¹Ÿæ”¹äº†</p><p>spring-boot-starter-parentçš„ç‰ˆæœ¬æš‚æ—¶æ²¡æ”¹ï¼Œä¿æŒæœ€æ–°</p><img src="/images/2020/screencapture2020-04-10 AM10.22.11.jpg"><p>å¯åŠ¨</p><img src="/images/2020/screencapture2020-04-10 AM10.22.23.jpg"><p>æ³¨å†Œä¸Šäº†</p><img src="/images/2020/screencapture2020-04-10 AM10.22.18.jpg"><p>åˆå´©äº†</p><p>ä½†æ˜¯è¿™æ¬¡æ§åˆ¶å°æ²¡æœ‰Erroräº†</p><p>é”™è¯¯ä¿¡æ¯å˜æˆäº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">There was an unexpected error (type&#x3D;Internal Server Error, status&#x3D;500).</span><br><span class="line">No instances available for user-service</span><br></pre></td></tr></table></figure><p>å•ç‹¬è®¿é—®<a href="http://localhost:8201/user/1æˆ–è€…http://localhost:8202/user/1éƒ½æ˜¯å¯ä»¥çš„" target="_blank" rel="noopener">http://localhost:8201/user/1æˆ–è€…http://localhost:8202/user/1éƒ½æ˜¯å¯ä»¥çš„</a></p><blockquote><p><a href="https://blog.csdn.net/choice_of_door/article/details/85467105" target="_blank" rel="noopener">https://blog.csdn.net/choice_of_door/article/details/85467105</a></p></blockquote><p>æŒ‰ç…§è¿™ä¸ªåŠ äº†ä¸ªä¾èµ–</p><p>ï¼ˆæºç é‡Œå¹¶æ²¡æœ‰ ä½†æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<del>MARK</del> (ç¬”è®°03ä¸­è§£å†³)ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.netflix.ribbon<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ribbon-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸäº†ï¼</p><p>å—·ï¼</p><h2 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h2><p>éƒ½æ˜¯ç‰ˆæœ¬çš„å‘</p><p>åˆ›å»ºæ—¶ç”¨Spring InitializeråŠ è¿˜æ˜¯åæœŸåœ¨pom.xmlä¸­åŠ ä¸é‡è¦</p><p>ä½†æœ€å¥½å’Œæ•™ç¨‹ä¿æŒä¸€è‡´</p><p>è‡³å°‘æ£€æŸ¥å³è¾¹Mavenæ ä¸­æ²¡æœ‰çº¢çº¿</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-10 AM10.51.52.jpg">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ThinkWon/article/details/103729080&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://blog.csdn.net/Thin
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="springcloud" scheme="http://yoursite.com/tags/springcloud/"/>
    
  </entry>
  
  <entry>
    <title>SpringCloudç¬”è®°01 Eurekaæ³¨å†Œä¸­å¿ƒ</title>
    <link href="http://yoursite.com/2020/04/08/note-springcloud-01/"/>
    <id>http://yoursite.com/2020/04/08/note-springcloud-01/</id>
    <published>2020-04-08T13:11:54.000Z</published>
    <updated>2020-04-09T15:48:55.329Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://blog.csdn.net/ThinkWon/article/details/103726655" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103726655</a></p></blockquote><hr><blockquote><p>Spring Cloud Netflix Eurekaæ˜¯Spring Cloud Netflixå­é¡¹ç›®çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡æ²»ç†</p></blockquote><p>å…ˆç–‘æƒ‘äº†ä¸€ä¸‹æ­¤Netflixæ˜¯ä¸æ˜¯å½¼Netflix</p><p>æŸ¥äº†ä¸€ä¸‹ <a href="https://www.cnblogs.com/EasonJim/p/7795816.html" target="_blank" rel="noopener">Netflixæ˜¯ä»€ä¹ˆï¼Œä¸Spring Cloudæœ‰ä»€ä¹ˆå…³ç³»</a> è¿˜çœŸæ˜¯</p><p>çˆ±äº†çˆ±äº†</p><hr><h1 id="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ"><a href="#æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ" class="headerlink" title="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ"></a>æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ</h1><ol><li><p>åˆ›å»ºeureka-serveræ¨¡å—</p></li><li><p>@EnableEurekaServerå¯ç”¨Euerkaæ³¨å†Œä¸­å¿ƒåŠŸèƒ½</p></li><li><p>application.ymlæ·»åŠ é…ç½®</p><p>é¡¹ç›®é»˜è®¤æ˜¯application.propertiesï¼Œä¸ºäº†å’Œæ•™ç¨‹ä¿æŒä¸€è‡´</p><p>åˆ é™¤application.propertiesï¼Œæ‰§è¡Œ mvn -X clean install</p></li><li><p>Run Dashboardè¿è¡Œåº”ç”¨</p></li><li><p>æµè§ˆå™¨æ‰“å¼€æ³¨å†Œä¸­å¿ƒ</p></li></ol><img src="/images/2020/screencapture2020-04-09 AM10.00.53.jpg"><p>æˆåŠŸ</p><hr><p>ä¾èµ–ä¸‹äº†æŒºä¹…ï¼Œçœ‹çœ¼éƒ½æœ‰äº›ä»€ä¹ˆ</p><img src="/images/2020/screencapture2020-04-09 AM9.33.00.jpg" width=400><p>ğŸ˜±ğŸ˜±ğŸ˜±</p><p>ä¸Šé¢æ˜¯spring-cloud-starter-netflix-eureka-server</p><img src="/images/2020/screencapture2020-04-09 AM9.34.40.jpg"><p>ä¸‹é¢æ˜¯spring-boot-starter-test</p><img src="/images/2020/screencapture2020-04-09 AM9.35.06.jpg"><h2 id="DEBUGï¼šæ²¡æœ‰Run-Dashboard"><a href="#DEBUGï¼šæ²¡æœ‰Run-Dashboard" class="headerlink" title="DEBUGï¼šæ²¡æœ‰Run Dashboard"></a>DEBUGï¼šæ²¡æœ‰Run Dashboard</h2><p><strong>å°è¯•1</strong></p><blockquote><p><a href="https://blog.csdn.net/chinoukin/article/details/80577890" target="_blank" rel="noopener">https://blog.csdn.net/chinoukin/article/details/80577890</a></p></blockquote><p>æ”¹.idea/workspace.xmlçš„</p><p>åŸæœ¬æ˜¯è¿™æ ·</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">name</span>=<span class="string">"RunDashboard"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">"configurationTypes"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"SpringBootApplicationConfigurationType"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶æ¯æ¬¡æ”¹äº†command+så°±åˆå›å»äº†</p><p><strong>å°è¯•2</strong></p><blockquote><p><a href="https://blog.csdn.net/feixiangsmile/article/details/96908744" target="_blank" rel="noopener">https://blog.csdn.net/feixiangsmile/article/details/96908744</a></p></blockquote><p>Edit Configurationsä¸­</p><p>Templatesä¸­</p><p>ç‚¹å‡»åŠ å·æ·»åŠ Applicationå’ŒSpring Boot</p><p>workspace.xmlå˜æˆäº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">name</span>=<span class="string">"RunDashboard"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">"configurationTypes"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"Application"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"SpringBootApplicationConfigurationType"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†è¿˜æ˜¯æ²¡æœ‰</p><p><strong>å°è¯•3</strong></p><blockquote><p><a href="https://www.cnblogs.com/JealousGirl/p/openorcloserundash.html" target="_blank" rel="noopener">https://www.cnblogs.com/JealousGirl/p/openorcloserundash.html</a></p><p><a href="https://blog.csdn.net/icebox126/article/details/78861943" target="_blank" rel="noopener">https://blog.csdn.net/icebox126/article/details/78861943</a></p></blockquote><p>åœ¨workspace.xmlä¸­æ·»åŠ ï¼ˆè¿™æ¬¡å¯ä»¥åŠ äº†ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show.run.dashboard.notification"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é‡å¯è¿˜æ˜¯ä¸ä¼šå¼¹å‡ºæç¤º</p><p><strong>å°è¯•4</strong></p><blockquote><p><a href="https://intellij-support.jetbrains.com/hc/en-us/community/posts/115000428264-New-Spring-Boot-Run-dashboard-not-showing-up" target="_blank" rel="noopener">https://intellij-support.jetbrains.com/hc/en-us/community/posts/115000428264-New-Spring-Boot-Run-dashboard-not-showing-up</a></p><p><a href="https://blog.csdn.net/jianxia801/article/details/99576764" target="_blank" rel="noopener">https://blog.csdn.net/jianxia801/article/details/99576764</a></p></blockquote><img src="/images/2020/screencapture2020-04-09 AM10.30.31.jpg"><p>â€¦</p><p>fine</p><p>åŸæ¥ä¸€ç›´éƒ½åœ¨å•Š</p><img src="/images/2020/screencapture2020-04-09 AM10.31.24.jpg"><h1 id="æ­å»ºEurekaå®¢æˆ·ç«¯"><a href="#æ­å»ºEurekaå®¢æˆ·ç«¯" class="headerlink" title="æ­å»ºEurekaå®¢æˆ·ç«¯"></a>æ­å»ºEurekaå®¢æˆ·ç«¯</h1><ol><li><p>åˆ›å»ºeureka-clientæ¨¡å—</p></li><li><p>æ·»åŠ ä¾èµ–</p></li><li><p>åŠ @EnableDiscoveryClientè¡¨æ˜æ˜¯ä¸€ä¸ªEurekaå®¢æˆ·ç«¯</p></li><li><p>é…ç½®</p></li></ol><h2 id="DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client"><a href="#DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client" class="headerlink" title="DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client"></a>DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client</h2><p><strong>å°è¯•1</strong></p><p>åŸæ¥çš„pom.xmlä¸­çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ•™ç¨‹ä¸­è¯´è¦æ·»åŠ çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹ç”±äºspring-cloud-starter-netflix-eureka-clientå·²ç»æœ‰äº†</p><p>ç›´æ¥æ·»åŠ äº†ä¸Šé¢è¿™ä¸ªspring-boot-starter-web</p><p>ä½†æ˜¯è§‰å¾—å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Ÿ</p><p>spring-boot-starter-testå’Œspring-boot-starter-webä¼šä¸ä¼šå†²çªå‘¢?</p><img src="/images/2020/screencapture2020-04-09 AM10.39.19.jpg"><p>æ²¡å†²çª</p><p>ä½†æ˜¯spring-boot-starter-testä¼¼ä¹å¤šäº†å¾ˆå¤šä¸œè¥¿ï¼ˆè¯•äº†ä¸€ä¸‹å¹¶ä¸èƒ½åˆ ï¼‰</p><p><strong>å°è¯•2</strong></p><p>çœ‹ä¸‹æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2020-04-09 10:43:38.777 ERROR 1243 --- [           main] c.n.d.s.t.d.RedirectingEurekaHttpClient  : Request execution error. endpoint&#x3D;DefaultEndpoint&#123; serviceUrl&#x3D;&#39;http:&#x2F;&#x2F;localhost:8001&#x2F;eureka&#x2F;&#125;</span><br><span class="line"></span><br><span class="line">com.sun.jersey.api.client.ClientHandlerException: java.net.ConnectException: Connection refused (Connection refused)</span><br></pre></td></tr></table></figure><p>å¥½åƒå¹²äº†ä¸ªè ¢äº‹</p><img src="/images/2020/screencapture2020-04-09 AM10.44.58.jpg"><p>æœç„¶ æœåŠ¡å™¨æ²¡å¼€</p><p>é‡æ¥ å…ˆå¼€eureka-server å†å¼€eureka-client</p><img src="/images/2020/screencapture2020-04-09 AM10.46.19.jpg"><img src="/images/2020/screencapture2020-04-09 AM10.46.31.jpg"><p>æ³¨å†ŒæˆåŠŸ</p><h1 id="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤"><a href="#æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤" class="headerlink" title="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤"></a>æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤</h1><p>ç›®çš„ï¼šé˜²æ­¢æ³¨å†Œä¸­å¿ƒæŒ‚äº†æ•´ä¸ªå®æ‰ æ­å»ºåŒèŠ‚ç‚¹çš„æ³¨å†Œä¸­å¿ƒé›†ç¾¤</p><ol><li><p>2ä¸ªé…ç½®æ–‡ä»¶</p><p>ï¼ˆä¸çŸ¥é“åŸæœ¬çš„application.ymlè¦ä¸è¦åˆ ï¼Ÿçœ‹äº†ä¸‹æºç æ²¡æœ‰åˆ ï¼‰</p></li><li><p>æœ¬æœºé…ç½®åŸŸå</p><p>macOSåœ¨/etc/hosts</p><p>æ”¹ä¹‹å‰çš„å­˜ä¸ªæ¡£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">##</span><br><span class="line"># Host Database</span><br><span class="line">#</span><br><span class="line"># localhost is used to configure the loopback interface</span><br><span class="line"># when the system is booting.  Do not change this entry.</span><br><span class="line">##</span><br><span class="line">127.0.0.1localhost</span><br><span class="line">255.255.255.255broadcasthost</span><br><span class="line">::1             localhost</span><br><span class="line">127.0.0.1 xmind.net</span><br><span class="line">127.0.0.1 www.xmind.net</span><br></pre></td></tr></table></figure><p>åŠ ä¸¤è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 replica1</span><br><span class="line">127.0.0.1 replica2</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨</p></li><li><p>ä¿®æ”¹é…ç½®ï¼Œè®©eureka-clientè¿æ¥åˆ°é›†ç¾¤</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€</span><br><span class="line"># defaultZone: http:&#x2F;&#x2F;localhost:8001&#x2F;eureka</span><br><span class="line"># åŒæ—¶æ³¨å†Œåˆ°ä¸¤ä¸ªæ³¨å†Œä¸­å¿ƒ</span><br><span class="line">defaultZone: http:&#x2F;&#x2F;replica1:8002&#x2F;eureka&#x2F;,http:&#x2F;&#x2F;replica2:8003&#x2F;eureka&#x2F;</span><br></pre></td></tr></table></figure><h2 id="DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ"><a href="#DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ" class="headerlink" title="DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ"></a>DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ</h2><p>å¤åˆ¶ä¸€ä»½åŸå¯åŠ¨é…ç½®ï¼Œä¿®æ”¹ä¸ºä»replica1å¯åŠ¨</p><img src="/images/2020/screencapture2020-04-09 AM10.57.57.jpg"><p>Run</p><img src="/images/2020/screencapture2020-04-09 AM10.59.41.jpg"><p>å‘ç°æœ‰å¤‡ä»½ï¼Œä½†æ˜¯æ²¡æœ‰æ³¨å†Œï¼Ÿ</p><img src="/images/2020/screencapture2020-04-09 AM10.59.52.jpg"><p>ä¼¼ä¹æ˜¯åªå¤åˆ¶äº†ä¸€ä»½é…ç½®ï¼Œreplica2æ²¡æœ‰å¯åŠ¨</p><p>åŠ ä¸Š</p><img src="/images/2020/screencapture2020-04-09 AM11.10.28.jpg"><p>å¥½äº†</p><img src="/images/2020/screencapture2020-04-09 AM11.11.58.jpg"><h1 id="ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯"><a href="#ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯" class="headerlink" title="ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯"></a>ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯</h1><ol><li>åˆ›å»ºeureka-security-serveræ¨¡å—</li><li>æ·»åŠ ä¾èµ–</li><li>é…ç½®pom.xml</li><li>æ·»åŠ WebSecurityConfig</li><li>eureka-clientæ³¨å†Œåˆ°æœ‰ç™»å½•è®¤è¯çš„æ³¨å†Œä¸­å¿ƒ</li><li>ä»¥application-security.ymlé…ç½®è¿è¡Œeureka-client</li></ol><h2 id="DEBUGï¼šSpringSecurityæ¨¡å—"><a href="#DEBUGï¼šSpringSecurityæ¨¡å—" class="headerlink" title="DEBUGï¼šSpringSecurityæ¨¡å—"></a>DEBUGï¼šSpringSecurityæ¨¡å—</h2><p>è¦æ·»åŠ SpringSecurityæ¨¡å—ï¼Œä¹Ÿè®¸æ˜¯Spring Cloud Securityä¸‹çš„Cloud Securityï¼Ÿå…ˆè¯•è¯•</p><p>åˆ›å»ºå‡ºçš„pom.xmlä¸­ä¾èµ–æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ•™ç¨‹ä¸­è¦åŠ çš„ä¾èµ–æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¥½åƒä¸æ˜¯è¿™ä¸ª</p><p>é‡æ–°åˆ›å»º</p><p>è¿™æ¬¡ç›´æ¥æœç´¢Spring Security å‘ç°æœ‰è¿™ä¸ªæ¨¡å—</p><img src="/images/2020/screencapture2020-04-09 AM11.18.28.jpg"><p>ï¼ˆæœ€åå‘ç°éƒ½è¡Œï¼Œä¸”æ²¡å¿…è¦åˆ›å»ºæ—¶æ·»åŠ ï¼Œéšæ—¶åœ¨pom.xmlä¸­ä¿®æ”¹éƒ½å¯ï¼‰</p><h2 id="DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®"><a href="#DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®" class="headerlink" title="DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®"></a>DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®</h2><blockquote><p><a href="https://www.jianshu.com/p/909eb8a48d49" target="_blank" rel="noopener">https://www.jianshu.com/p/909eb8a48d49</a></p></blockquote><p>å³è¾¹Mavenæ ï¼‹å¯¹åº”çš„pom.xml</p><h2 id="DEBUGï¼šå¯åŠ¨æŠ¥é”™-amp-Whitelabel-Error-Page"><a href="#DEBUGï¼šå¯åŠ¨æŠ¥é”™-amp-Whitelabel-Error-Page" class="headerlink" title="DEBUGï¼šå¯åŠ¨æŠ¥é”™&amp;Whitelabel Error Page"></a>DEBUGï¼šå¯åŠ¨æŠ¥é”™&amp;Whitelabel Error Page</h2><img src="/images/2020/screencapture2020-04-09 AM11.27.19.jpg"><blockquote><p><a href="https://blog.csdn.net/qq_28379809/article/details/102789716" target="_blank" rel="noopener">https://blog.csdn.net/qq_28379809/article/details/102789716</a></p></blockquote><p>æ·»åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨</p><img src="/images/2020/screencapture2020-04-09 AM11.32.17.jpg"><p>è¾“å…¥è´¦å·å¯†ç </p><img src="/images/2020/screencapture2020-04-09 AM11.32.27.jpg"><p>å‘ç°EurekaSecurityServerApplicationæ²¡æœ‰åŠ @EnableEurekaServer</p><img src="/images/2020/screencapture2020-04-09 AM11.45.35.jpg"><p>pom.xmlä¸­æœ‰spring-cloud-starter-netflix-eureka-serverï¼Œä¸ºä»€ä¹ˆå¯¼ä¸è¿›æ¥å‘¢</p><p>å’Œeureka-serverçš„é…ç½®æ¯”è¾ƒï¼Œå‘ç°å°‘ä¸€å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.SR3<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åŠ ä¸Š</p><p>è¿˜æ˜¯ä¸è¡Œ</p><p>æºç ä¸­æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.RELEASE<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.security<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-security-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æºç ä¸­çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¤åˆ¶è¿‡å»</p><p>Reimport Maven Projects</p><p>å‘ç°æ­£åœ¨ä¸‹è½½çš„è¿›åº¦æ¡</p><p>æ‰€ä»¥éš¾é“åˆšæ‰æ˜¯å› ä¸ºä¾èµ–è¿˜æ²¡ä¸‹è½½å®Œå—</p><p>ä¸‹è½½å®Œæˆ</p><p>å…¨çº¢äº†â€¦</p><img src="/images/2020/screencapture2020-04-09 AM11.58.06.jpg"><p>æ”¹å›åŸæœ¬çš„ä¾èµ– åˆ æ‰spring-boot-starter-web ä¸çº¢äº†</p><p>å¯åŠ¨</p><img src="/images/2020/screencapture2020-04-09 AM11.59.54.jpg"><p>ğŸ™ƒ</p><p>ä»”ç»†çœ‹ä¸‹æºç çš„é…ç½®æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è€Œä¸æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥éš¾é“è¿˜æ˜¯åº”è¯¥å¼•å…¥Spring Cloud Securityæ¨¡å—ï¼Ÿ</p><p>é‡æ–°åˆ›å»ºè¯•è¯•</p><p>æˆåŠŸï¼</p><h2 id="DEBUGï¼šä»¥application-security-ymlé…ç½®è¿è¡Œeureka-client"><a href="#DEBUGï¼šä»¥application-security-ymlé…ç½®è¿è¡Œeureka-client" class="headerlink" title="DEBUGï¼šä»¥application-security.ymlé…ç½®è¿è¡Œeureka-client"></a>DEBUGï¼šä»¥application-security.ymlé…ç½®è¿è¡Œeureka-client</h2><p>ç°åœ¨eureka-clientæœ‰2ä¸ªyml</p><img src="/images/2020/screencapture2020-04-09 PM3.55.10.jpg"><p>ç›´æ¥è¿è¡Œè¿˜æ˜¯application.ymlçš„8101ç«¯å£</p><p>æ ¹æ®åˆšæ‰eureka-serverçš„å¤šä¸ªyml</p><p>æ˜¯ä¿®æ”¹äº†æŒ‡å®šä¸»æœºåœ°å€</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application.yml</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">localhost</span></span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application-replica1.yml</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">replica1</span></span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># application-replica2.yml</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">replica2</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨Edit Configurationsä¸­å¤åˆ¶Configurationï¼Œç„¶åä¿®æ”¹ä¸»æœºå</p><p>äºæ˜¯è¿™é‡Œä¹ŸåŠ ä¸ŠæŒ‡å®šä¸»æœºå</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">instance:</span></span><br><span class="line">  <span class="attr">hostname:</span> <span class="string">eureka-client-security</span></span><br></pre></td></tr></table></figure><p>å¤åˆ¶ä¸€ä¸ªEurekaClientApplicationçš„é…ç½®ï¼ŒActive profileså¤„æ”¹ä¸ºä¸»æœºå</p><img src="/images/2020/screencapture2020-04-09 PM4.01.03.jpg"><p>ä½†è¿˜æ˜¯8101ï¼Ÿ</p><img src="/images/2020/screencapture2020-04-09 PM4.04.44.jpg"><p>è§‚å¯Ÿå‘ç°</p><p>Serverçš„é…ç½®æ–‡ä»¶1å«application-replica1.ymlï¼Œhostnameæ˜¯replica1ï¼ŒActive profileså¡«çš„replica1</p><p>é…ç½®æ–‡ä»¶2å«application-replica2.ymlï¼Œhostnameæ˜¯replica2ï¼ŒActive profileså¡«çš„replica2</p><p>éš¾é“â€¦</p><p>æŠŠClientçš„application-security.ymlä¸­æ”¹æˆ</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">instance:</span></span><br><span class="line">  <span class="attr">hostname:</span> <span class="string">security</span></span><br></pre></td></tr></table></figure><p>Active profilesæ”¹æˆsecurity</p><p>Run</p><img src="/images/2020/screencapture2020-04-09 PM4.10.10.jpg"><p>æ‰“å¼€äº†ï¼</p><img src="/images/2020/screencapture2020-04-09 PM4.11.03.jpg"><p>æœ‰ä¸ª<strong>EMERGENCY!</strong> </p><p>ä¿æŠ¤æœºåˆ¶åé¢å†çœ‹</p><p>å…ˆè¯•è¯•è¿™ä¸ªæŒ‡å®šymlåˆ°åº•æ˜¯æ€ä¹ˆæŒ‡å®šçš„</p><table><thead><tr><th>æ–‡ä»¶å</th><th>hostname</th><th>Active profiles</th><th>èƒ½å¦å¯åŠ¨</th></tr></thead><tbody><tr><td>application-security.yml</td><td>eureka-client-security</td><td>eureka-client-security</td><td>å¦</td></tr><tr><td>application-security.yml</td><td>security</td><td>security</td><td>å¯</td></tr><tr><td>application-security.yml</td><td>securityX</td><td>security</td><td>å¯</td></tr><tr><td>application-securityX.yml</td><td>security</td><td>security</td><td>å¦</td></tr></tbody></table><p>çœ‹æ¥Active profilesè¦å¡«æ–‡ä»¶ååé¢çš„éƒ¨åˆ†</p><p>æ•™ç¨‹æœ€ä¸‹é¢çš„å¸¸ç”¨é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span> <span class="comment">#eurekaå®¢æˆ·ç«¯é…ç½®</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span> <span class="comment">#æ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ°eurekaæœåŠ¡ç«¯ä¸Šå»</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span> <span class="comment">#æ˜¯å¦è·å–eurekaæœåŠ¡ç«¯ä¸Šæ³¨å†Œçš„æœåŠ¡åˆ—è¡¨</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8001/eureka/</span> <span class="comment"># æŒ‡å®šæ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment"># å¯ç”¨eurekaå®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="attr">registry-fetch-interval-seconds:</span> <span class="number">30</span> <span class="comment">#å®šä¹‰å»eurekaæœåŠ¡ç«¯è·å–æœåŠ¡åˆ—è¡¨çš„æ—¶é—´é—´éš”</span></span><br><span class="line">  <span class="attr">instance:</span> <span class="comment">#eurekaå®¢æˆ·ç«¯å®ä¾‹é…ç½®</span></span><br><span class="line">    <span class="attr">lease-renewal-interval-in-seconds:</span> <span class="number">30</span> <span class="comment">#å®šä¹‰æœåŠ¡å¤šä¹…å»æ³¨å†Œä¸­å¿ƒç»­çº¦</span></span><br><span class="line">    <span class="attr">lease-expiration-duration-in-seconds:</span> <span class="number">90</span> <span class="comment">#å®šä¹‰æœåŠ¡å¤šä¹…ä¸å»ç»­çº¦è®¤ä¸ºæœåŠ¡å¤±æ•ˆ</span></span><br><span class="line">    <span class="attr">metadata-map:</span></span><br><span class="line">      <span class="attr">zone:</span> <span class="string">guangdong</span> <span class="comment">#æ‰€åœ¨åŒºåŸŸ</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">localhost</span> <span class="comment">#æœåŠ¡ä¸»æœºåç§°</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">false</span> <span class="comment">#æ˜¯å¦ä¼˜å…ˆä½¿ç”¨ipæ¥ä½œä¸ºä¸»æœºå</span></span><br><span class="line">  <span class="attr">server:</span> <span class="comment">#eurekaæœåŠ¡ç«¯é…ç½®</span></span><br><span class="line">    <span class="attr">enable-self-preservation:</span> <span class="literal">false</span> <span class="comment">#å…³é—­eurekaæœåŠ¡ç«¯çš„ä¿æŠ¤æœºåˆ¶</span></span><br></pre></td></tr></table></figure><p>äºæ˜¯åœ¨eureka-serverçš„ymlä¸­åŠ ä¸Š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span> <span class="comment">#eurekaæœåŠ¡ç«¯é…ç½®</span></span><br><span class="line">    <span class="attr">enable-self-preservation:</span> <span class="literal">true</span> <span class="comment">#å…³é—­eurekaæœåŠ¡ç«¯çš„ä¿æŠ¤æœºåˆ¶</span></span><br></pre></td></tr></table></figure><p>å°±æ²¡æœ‰<strong>EMERGENCY!</strong> äº†</p><h2 id="å…³äºeureka-security-serverçš„ä¾èµ–"><a href="#å…³äºeureka-security-serverçš„ä¾èµ–" class="headerlink" title="å…³äºeureka-security-serverçš„ä¾èµ–"></a>å…³äºeureka-security-serverçš„ä¾èµ–</h2><p>å‘ç°æ•™ç¨‹é‡Œå†™çš„ä¾èµ–æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æºç é‡Œç”¨çš„ä¾èµ–æ˜¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è‡ªå·±åˆšæ‰å¯åŠ¨æˆåŠŸçš„æ˜¯spring-cloud-starter-security</p><p>æ”¹æˆspring-boot-starter-securityè¯•äº†ä¸€ä¸‹ä¹ŸæˆåŠŸäº†</p><h2 id="é—®é¢˜è§£å†³æ€»ç»“"><a href="#é—®é¢˜è§£å†³æ€»ç»“" class="headerlink" title="é—®é¢˜è§£å†³æ€»ç»“"></a>é—®é¢˜è§£å†³æ€»ç»“</h2><ol><li>ç”¨Spring Cloud Securityæ¨¡å—ï¼Œä¸æ˜¯Spring Securityæ¨¡å—</li><li>EurekaSecurityServerApplicationè¦è®°å¾—åŠ @EnableEurekaServer</li><li>ç”¨æŒ‡å®šçš„ymlï¼ˆapplication-XXX.ymlï¼‰å¯åŠ¨Spring Bootï¼Œåœ¨Edit Configurationsä¸­å¤åˆ¶ä¸€ä¸ªåŸConfigurationï¼ŒActive profileså¡«æŒ‡å®šymlæ–‡ä»¶ååŠéƒ¨åˆ†ï¼ˆXXXï¼‰ï¼Œè¿è¡Œè¿™ä¸ªConfiguration</li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-09 PM4.44.05.jpg">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/ThinkWon/article/details/103726655&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://blog.csdn.net/Thin
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="springcloud" scheme="http://yoursite.com/tags/springcloud/"/>
    
  </entry>
  
  <entry>
    <title>åˆ·é¢˜é˜¶æ®µä¸€å®Œå·¥çºªå¿µï¼</title>
    <link href="http://yoursite.com/2020/04/08/memo/"/>
    <id>http://yoursite.com/2020/04/08/memo/</id>
    <published>2020-04-08T12:30:32.000Z</published>
    <updated>2020-04-09T07:35:58.567Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸ª<a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Leetcode%20%E9%A2%98%E8%A7%A3%20-%20%E7%9B%AE%E5%BD%95.md" title="" target="">ç›®å½•</a>ç»ˆäºå®Œå·¥äº†</p><p>LeetCodeä»å»å¹´å‡†å¤‡ç®—æ³•è€ƒè¯•å¼€å§‹åˆ·</p><p>åˆ°ç°åœ¨åˆšå¥½2222ä¸ªç¡¬å¸ğŸ˜ƒ</p><p>æ£’çƒå¸½ï¼å†²é¸­ï¼</p><img src="/images/2020/screencapture2020-04-08 PM7.47.28.jpg" width=300><p>3æœˆæ¯æ—¥1é¢˜å¿˜äº†1å¤© å°±é‚£ä¹ˆ å¹²å¹²å‡€å‡€ æ— å¿§æ— è™‘çš„ å¿˜äº†ğŸ˜­</p><p>4æœˆæäº†å¼ æ—¥å†è´´åœ¨åºŠå¯¹é¢çš„ç™½æ¿ä¸Š ä½†æ„¿â€¦</p><hr><p>æœ€è¿‘å‘¨èµ›è¿˜ä¸å¦‚åˆšå¼€å§‹åšå¾—å¥½</p><p>æœ‰ä¸€ä¸ä¸å‡„å‡‰</p><p>å¸Œæœ›çƒ§æ‰çš„è„‘ç»†èƒç»™æ–°çš„ç¥ç»å›è·¯æä¾›å…»æ–™äº†å§</p><img src="/images/2020/img-91ef518e959886326719c5d07a824772.jpg" width=400><p>æœ€è¿‘çœ‹åˆ°è¿™å¼ å›¾è§‰å¾—è²Œä¼¼å¾ˆæœ‰é“ç†</p><p>æ”¾åœ¨è¿™é‡Œ</p><p>ä¸çŸ¥é“ä»¥åä¼šä¸ä¼šæœ‰ä»€ä¹ˆæ„Ÿå—</p><hr><p>æœ€åæ˜¯ä¸€å¤§æ¡çœ‹æ¿çš„å®Œå·¥è®°å½•</p><img src="/images/2020/Apr-09-2020 15-35-04.gif"><p>å¿«ä¹</p><p>å®…å®¶è¿åŠ¨è®¡åˆ’è¿›è¡Œä¸­</p><p>ä¸¤ä¸ªæœˆæ²¡å‡ºé—¨è¿˜è½»äº†ä¹Ÿæ˜¯å¾ˆéœ‡æƒŠ</p><p>ç»§ç»­æ‰“å¡ï¼å˜¿å’»ï¼</p><p>ä¹Ÿè®¸å“ªå¤©å°±èƒ½åŠˆå‰äº†å‘¢</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¿™ä¸ª&lt;a href=&quot;https://github.com/CyC2018/CS-Notes/blob/master/notes/Leetcode%20%E9%A2%98%E8%A7%A3%20-%20%E7%9B%AE%E5%BD%95.md&quot; title=&quot;&quot; targ
      
    
    </summary>
    
    
      <category term="Memo" scheme="http://yoursite.com/categories/Memo/"/>
    
    
      <category term="algorithm" scheme="http://yoursite.com/tags/algorithm/"/>
    
  </entry>
  
</feed>
