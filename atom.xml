<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CoCoNutNut&#39;s NoteBook</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2021-02-19T09:52:59.351Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>coconutnut</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Unity Project 版本记录</title>
    <link href="http://yoursite.com/2021/02/19/unity-project-memo/"/>
    <id>http://yoursite.com/2021/02/19/unity-project-memo/</id>
    <published>2021-02-19T09:35:47.000Z</published>
    <updated>2021-02-19T09:52:59.351Z</updated>
    
    <content type="html"><![CDATA[<h1 id="02-16-V0-1"><a href="#02-16-V0-1" class="headerlink" title="02.16 V0.1"></a>02.16 V0.1</h1><h2 id="新增基础移动操作"><a href="#新增基础移动操作" class="headerlink" title="新增基础移动操作"></a>新增基础移动操作</h2><ul><li><p>点击寻路</p><img src="/images/2021/Feb-16-2021 18-29-31.gif"></li><li><p>靠近显示介绍</p><img src="/images/2021/Feb-16-2021 18-29-44.gif"></li><li><p>鼠标滚动前后平移</p><img src="/images/2021/Feb-16-2021 18-30-18.gif"></li><li><p>键盘前后左右平移</p><img src="/images/2021/Feb-16-2021 18-30-32.gif"></li><li><p>鼠标拖拽旋转视角</p><img src="/images/2021/Feb-16-2021 18-30-55.gif"></li></ul><h1 id="02-19-V0-1-1"><a href="#02-19-V0-1-1" class="headerlink" title="02.19 V0.1.1"></a>02.19 V0.1.1</h1><h2 id="新增介绍牌"><a href="#新增介绍牌" class="headerlink" title="新增介绍牌"></a>新增介绍牌</h2><ul><li><p>删除靠近显示介绍</p></li><li><p>介绍牌鼠标移入高亮</p><img src="/images/2021/Feb-19-2021 17-25-29.gif"></li><li><p>点击介绍牌寻路</p><img src="/images/2021/Feb-19-2021 17-25-59.gif"><ul><li>寻路中任意操作打断</li><li>到达目的地后转向介绍牌</li></ul></li></ul><h2 id="新增导游栏"><a href="#新增导游栏" class="headerlink" title="新增导游栏"></a>新增导游栏</h2><ul><li><p>点击中间按钮寻路</p><img src="/images/2021/Feb-19-2021 17-45-43.gif"></li><li><p>点击左右按钮更新导游栏并寻路</p><img src="/images/2021/Feb-19-2021 17-26-58.gif"><ul><li>最左/最右时按钮不可用</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;02-16-V0-1&quot;&gt;&lt;a href=&quot;#02-16-V0-1&quot; class=&quot;headerlink&quot; title=&quot;02.16 V0.1&quot;&gt;&lt;/a&gt;02.16 V0.1&lt;/h1&gt;&lt;h2 id=&quot;新增基础移动操作&quot;&gt;&lt;a href=&quot;#新增基础移动操作&quot; cla
      
    
    </summary>
    
    
      <category term="Memo" scheme="http://yoursite.com/categories/Memo/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity Note UI,Event</title>
    <link href="http://yoursite.com/2021/02/17/unity/"/>
    <id>http://yoursite.com/2021/02/17/unity/</id>
    <published>2021-02-17T07:59:43.000Z</published>
    <updated>2021-02-19T09:28:32.738Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Canvas大小"><a href="#Canvas大小" class="headerlink" title="Canvas大小"></a>Canvas大小</h1><blockquote><p><a href="https://www.youtube.com/watch?v=OKK69bmjmJE&amp;ab_channel=Creagines" target="_blank" rel="noopener">https://www.youtube.com/watch?v=OKK69bmjmJE&amp;ab_channel=Creagines</a></p></blockquote><p>Canvas Scaler-&gt; 缩放模式 -&gt; 屏幕大小缩放</p><p>解决了上次文字飞掉的问题</p><p>可以下一步啦</p><img src="/images/2021/screencapture2021-02-17 PM5.26.42.jpg"><h1 id="点击按钮"><a href="#点击按钮" class="headerlink" title="点击按钮"></a>点击按钮</h1><blockquote><p><a href="https://www.cnblogs.com/Peng18233754457/p/7792442.html" target="_blank" rel="noopener">https://www.cnblogs.com/Peng18233754457/p/7792442.html</a></p></blockquote><p>一开始事件用的是Button的onClick()</p><p>发现Event System更好用</p><img src="/images/2021/screencapture2021-02-17 PM8.10.25.jpg"><ul><li>Button上鼠标单击()里+ （其它事件可以添加组件触发）</li><li>EventTest.cs中 public void A()</li></ul><p>Button这样就可以了</p><p>3D物体要使用，还要先给Main Camera加一个Physics Raycaster组件</p><h1 id="点击寻路"><a href="#点击寻路" class="headerlink" title="点击寻路"></a>点击寻路</h1><p>Player监听点击实现，更改寻路</p><blockquote><p><a href="https://www.youtube.com/watch?v=wlo-ZvV3ovg&amp;ab_channel=JasonWeimann" target="_blank" rel="noopener">https://www.youtube.com/watch?v=wlo-ZvV3ovg&amp;ab_channel=JasonWeimann</a></p></blockquote><p>参考↑通过Action实现，避免到处reference</p><h1 id="寻路转向"><a href="#寻路转向" class="headerlink" title="寻路转向"></a>寻路转向</h1><p>寻路完成后转向board</p><p>设置了一个isNavigating变量，记录状态</p><p>到达后用DOTWeen转向</p><h1 id="寻路打断"><a href="#寻路打断" class="headerlink" title="寻路打断"></a>寻路打断</h1><p>每次有输入时，打断寻路，同时将设置成false</p><p>一个小问题是，第一次点击board时将isNavigating设成true，但同时Input.GetMouseButtonUp(0)也会为true，所以额外用了一个firstClick判断是否为第一次点击</p><p>最后相关代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">private bool isNavigating &#x3D; false;</span><br><span class="line">private bool firstClick &#x3D; true;</span><br><span class="line">private Vector3 turnPosition;</span><br><span class="line"></span><br><span class="line">void Update()</span><br><span class="line">&#123;</span><br><span class="line">  if(Input.GetMouseButtonUp(0))&#123;</span><br><span class="line">    if(isNavigating)&#123;</span><br><span class="line">      if(firstClick)&#123;</span><br><span class="line">        firstClick &#x3D; false;</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        isNavigating &#x3D; false;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      firstClick &#x3D; true; </span><br><span class="line">      &#x2F;&#x2F; 这里可能有点点问题，isNavigating设成false之后，要下一次Update才能检测到，但是Update调得很快，基本感觉不到，所以暂时就这样写了，看着舒服些。但MARK一下，以后如果有问题，再把这里拆出去单独判断。</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ...</span><br><span class="line"></span><br><span class="line">  &#125;else if(Input.GetMouseButton(0))&#123;</span><br><span class="line">    isNavigating &#x3D; false;</span><br><span class="line"></span><br><span class="line">   &#x2F;&#x2F; ...</span><br><span class="line"></span><br><span class="line">  &#125;else if(Input.GetAxis(&quot;Mouse ScrollWheel&quot;)!&#x3D;0 || Input.GetAxis(&quot;Horizontal&quot;)!&#x3D;0 || Input.GetAxis(&quot;Vertical&quot;)!&#x3D;0)&#123;</span><br><span class="line">    isNavigating &#x3D; false;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void SetNewDestination(Vector3 destination, Vector3 boardPosition) &#123;</span><br><span class="line">  &#x2F;&#x2F; set new destination</span><br><span class="line">  agent.SetDestination(destination);</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; set turn destination</span><br><span class="line">  turnPosition &#x3D; boardPosition;</span><br><span class="line">  isNavigating &#x3D; true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="02-19-update"><a href="#02-19-update" class="headerlink" title="02.19 update"></a>02.19 update</h2><p>后续做导游时发现，点击UI寻路按钮时，事件发生的顺序是：</p><ul><li>GetMouseButton</li><li>Set Destination</li><li>GetMouseButtonUp</li></ul><p>而再次GetMouseButton和GetMouseButtonUp都需要打断，用之前的方法很混乱</p><p>于是改成三种状态，只能按顺序切换</p><ol><li><p>GuideStatus.Static 默认状态</p></li><li><p>GuideStatus.Ready 设置寻路后，Static-&gt;Ready</p></li><li><p>GuideStatus.On</p><ul><li>Ready状态获取到一次GetMouseButtonUp，变成On</li><li>On状态时，GetMouseButton或GetMouseButtonUp均会打断寻路，变成Static</li><li>On状态到达目的地后，变成Static</li></ul></li></ol><p>测试目前没什么问题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">private Vector3 turnPosition;</span><br><span class="line">private GuideStatus currentGuideStatus &#x3D; GuideStatus.Static;</span><br><span class="line">private enum GuideStatus</span><br><span class="line">&#123;</span><br><span class="line">  Static,</span><br><span class="line">  Ready,</span><br><span class="line">  On</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Update()</span><br><span class="line">&#123;</span><br><span class="line">  if(Input.GetMouseButtonUp(0))&#123;</span><br><span class="line">    &#x2F;&#x2F; if is click</span><br><span class="line">    if(mouseDownCount &lt; 2)&#123;</span><br><span class="line">      if(currentGuideStatus &#x3D;&#x3D; GuideStatus.Ready)&#123;</span><br><span class="line">        currentGuideStatus &#x3D; GuideStatus.On;</span><br><span class="line">      &#125;else if(currentGuideStatus &#x3D;&#x3D; GuideStatus.On)&#123;</span><br><span class="line">        currentGuideStatus &#x3D; GuideStatus.Static;</span><br><span class="line">        Debug.Log(&quot;[guide] disrupted by GetMouseButtonUp-Click&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &#x2F;&#x2F; ...</span><br><span class="line">    mouseDownCount &#x3D; 0;</span><br><span class="line"></span><br><span class="line">  &#125;else if(Input.GetMouseButton(0))&#123;</span><br><span class="line">    if(currentGuideStatus&#x3D;&#x3D;GuideStatus.On)&#123;</span><br><span class="line">      currentGuideStatus &#x3D; GuideStatus.Static;</span><br><span class="line">      Debug.Log(&quot;[guide] disrupted by GetMouseButton&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line"></span><br><span class="line">    mouseDownCount++;</span><br><span class="line"></span><br><span class="line">  &#125;else if(Input.GetAxis(&quot;Mouse ScrollWheel&quot;)!&#x3D;0 || Input.GetAxis(&quot;Horizontal&quot;)!&#x3D;0 || Input.GetAxis(&quot;Vertical&quot;)!&#x3D;0)&#123;</span><br><span class="line">      if(currentGuideStatus&#x3D;&#x3D;GuideStatus.On)&#123;</span><br><span class="line">        currentGuideStatus &#x3D; GuideStatus.Static;</span><br><span class="line">        Debug.Log(&quot;[guide] disrupted by Movement&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      &#x2F;&#x2F; ...</span><br><span class="line">    </span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    if(currentGuideStatus&#x3D;&#x3D;GuideStatus.On &amp;&amp; agent.remainingDistance&#x3D;&#x3D;0)&#123;</span><br><span class="line">      Debug.Log(&quot;[guide] look at &quot;+turnPosition);</span><br><span class="line">      transform.DOLookAt(turnPosition,turnDuration,AxisConstraint.Y);</span><br><span class="line">      currentGuideStatus &#x3D; GuideStatus.Static;</span><br><span class="line">      Debug.Log(&quot;[guide] end&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void SetNewDestination(Vector3 destination, Vector3 destination2) &#123;</span><br><span class="line">  Debug.Log(&quot;[guide] start&quot;);</span><br><span class="line">  currentGuideStatus &#x3D; GuideStatus.Ready;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; set new destination</span><br><span class="line">  agent.SetDestination(destination);</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; set turn destination</span><br><span class="line">  turnPosition &#x3D; destination2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="UI遮盖Raycast"><a href="#UI遮盖Raycast" class="headerlink" title="UI遮盖Raycast"></a>UI遮盖Raycast</h1><p>加完导航寻路的UI之后，发现raycast仍可以穿透UI，同时点击寻路</p><p>看到一种解决是用EventSystem.current.IsPointerOverGameObject()</p><p>但是Canvas是全屏大小，点击哪里都是true</p><p>Canvas Group也没有用</p><blockquote><p><a href="https://stackoverflow.com/questions/52654002/unity-not-ignoring-button-click-in-ignore-raycast-layer" target="_blank" rel="noopener">https://stackoverflow.com/questions/52654002/unity-not-ignoring-button-click-in-ignore-raycast-layer</a></p></blockquote><p>最后参考这个</p><blockquote><p><a href="https://gameinstitute.qq.com/community/detail/129017" target="_blank" rel="noopener">https://gameinstitute.qq.com/community/detail/129017</a></p></blockquote><p>给所有的Button加了tag来判断</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">private bool IsPointerOverUIObject()&#123;</span><br><span class="line">    &#x2F;&#x2F; get mouse position</span><br><span class="line">    PointerEventData eventDataCurrentPosition &#x3D; new PointerEventData(EventSystem.current);</span><br><span class="line">    eventDataCurrentPosition.position &#x3D; new Vector2(Input.mousePosition.x, Input.mousePosition.y);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; get all raycast result</span><br><span class="line">    List&lt;RaycastResult&gt; results &#x3D; new List&lt;RaycastResult&gt;();</span><br><span class="line">    EventSystem.current.RaycastAll(eventDataCurrentPosition, results);</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; check UI tag</span><br><span class="line">    foreach(RaycastResult r in results)&#123;</span><br><span class="line">        if(r.gameObject.tag &#x3D;&#x3D; &quot;UI&quot;)&#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="脚本执行顺序问题"><a href="#脚本执行顺序问题" class="headerlink" title="脚本执行顺序问题"></a>脚本执行顺序问题</h1><p>做了导航栏之后，发现初始化顺序有点问题</p><p>导航栏要使用Board上的数字和名字，有时会为默认值</p><p>选中任意一个script，调整Inspector-&gt;Execution Order，解决</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Canvas大小&quot;&gt;&lt;a href=&quot;#Canvas大小&quot; class=&quot;headerlink&quot; title=&quot;Canvas大小&quot;&gt;&lt;/a&gt;Canvas大小&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Project V0.1 Record</title>
    <link href="http://yoursite.com/2021/02/16/unity/"/>
    <id>http://yoursite.com/2021/02/16/unity/</id>
    <published>2021-02-16T10:24:56.000Z</published>
    <updated>2021-02-19T09:19:16.535Z</updated>
    
    <content type="html"><![CDATA[<p>做了个初版试试水~😃</p><h1 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h1><h2 id="点击寻路"><a href="#点击寻路" class="headerlink" title="点击寻路"></a>点击寻路</h2><img src="/images/2021/Feb-16-2021 18-29-31.gif"><h2 id="靠近显示介绍"><a href="#靠近显示介绍" class="headerlink" title="靠近显示介绍"></a>靠近显示介绍</h2><img src="/images/2021/Feb-16-2021 18-29-44.gif"><h2 id="鼠标滚动前后平移"><a href="#鼠标滚动前后平移" class="headerlink" title="鼠标滚动前后平移"></a>鼠标滚动前后平移</h2><img src="/images/2021/Feb-16-2021 18-30-18.gif"><h2 id="键盘前后左右平移"><a href="#键盘前后左右平移" class="headerlink" title="键盘前后左右平移"></a>键盘前后左右平移</h2><img src="/images/2021/Feb-16-2021 18-30-32.gif"><h2 id="鼠标拖拽旋转视角"><a href="#鼠标拖拽旋转视角" class="headerlink" title="鼠标拖拽旋转视角"></a>鼠标拖拽旋转视角</h2><img src="/images/2021/Feb-16-2021 18-30-55.gif"><h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><img src="/images/2021/screencapture2021-02-16 PM6.27.11.jpg"><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><h2 id="PlayerController"><a href="#PlayerController" class="headerlink" title="PlayerController"></a>PlayerController</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class PlayerController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField, Range(0f,500f)]</span><br><span class="line">    private float mouseLookSensitivity &#x3D; 200f;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(0f,100f)]</span><br><span class="line">    private float mouseMoveSensitivity &#x3D; 10f;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(0f,10f)]</span><br><span class="line">    private float keyMoveSensitivity &#x3D; 5f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform cameraTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private float cameraRotation &#x3D; 0f;</span><br><span class="line">    private int mouseDownCount &#x3D; 0;</span><br><span class="line"></span><br><span class="line">    UnityEngine.AI.NavMeshAgent agent;</span><br><span class="line"></span><br><span class="line">    GameObject clickEffect;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;UnityEngine.AI.NavMeshAgent&gt;();</span><br><span class="line"></span><br><span class="line">        clickEffect &#x3D; Resources.Load&lt;GameObject&gt;(&quot;Prefabs&#x2F;ClickEffect&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(Input.GetMouseButtonUp(0))&#123;</span><br><span class="line">            &#x2F;&#x2F; if is click</span><br><span class="line">            if(mouseDownCount &lt; 2)&#123;</span><br><span class="line">                &#x2F;&#x2F; click to navigate</span><br><span class="line">                RaycastHit hit;</span><br><span class="line">                Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">                if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">                    &#x2F;&#x2F; move when hit floor</span><br><span class="line">                    if(hit.transform.tag &#x3D;&#x3D; &quot;Floor&quot;)&#123;</span><br><span class="line">                        agent.SetDestination(hit.point);</span><br><span class="line"></span><br><span class="line">                        &#x2F;&#x2F; click effect</span><br><span class="line">                        GameObject clickEffectObject &#x3D; Instantiate(clickEffect);</span><br><span class="line">                        clickEffectObject.transform.position &#x3D; hit.point;</span><br><span class="line">                        Destroy(clickEffectObject, 1);</span><br><span class="line">                    &#125; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            mouseDownCount &#x3D; 0;</span><br><span class="line"></span><br><span class="line">        &#125;else if(Input.GetMouseButton(0))&#123;</span><br><span class="line">            &#x2F;&#x2F; stop navigation</span><br><span class="line">            agent.ResetPath();</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; get mouse position</span><br><span class="line">            float mouseX &#x3D; Input.GetAxis(&quot;Mouse X&quot;) * mouseLookSensitivity * Time.deltaTime;</span><br><span class="line">            float mouseY &#x3D; Input.GetAxis(&quot;Mouse Y&quot;) * mouseLookSensitivity * Time.deltaTime;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; rotate camera up and down</span><br><span class="line">            cameraRotation -&#x3D; mouseY;</span><br><span class="line">            cameraRotation &#x3D; Mathf.Clamp(cameraRotation, -30f, 30f);</span><br><span class="line">            cameraTransform.localRotation &#x3D; Quaternion.Euler(cameraRotation, 0f, 0f);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; rotate player left and right</span><br><span class="line">            transform.Rotate(Vector3.up * (mouseX));</span><br><span class="line"></span><br><span class="line">            mouseDownCount++;</span><br><span class="line"></span><br><span class="line">        &#125;else if(Input.GetAxis(&quot;Mouse ScrollWheel&quot;)!&#x3D;0 || Input.GetAxis(&quot;Horizontal&quot;)!&#x3D;0 || Input.GetAxis(&quot;Vertical&quot;)!&#x3D;0)&#123;</span><br><span class="line">            &#x2F;&#x2F; stop navigation</span><br><span class="line">            agent.ResetPath();</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; mouse scroll input</span><br><span class="line">            float mouseV &#x3D; Input.GetAxis(&quot;Mouse ScrollWheel&quot;);</span><br><span class="line">            &#x2F;&#x2F; keyborad input</span><br><span class="line">            float keyV &#x3D; Input.GetAxis(&quot;Vertical&quot;);</span><br><span class="line">            float keyH &#x3D; Input.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line"></span><br><span class="line">            Vector3 move &#x3D; transform.forward * (mouseV * mouseMoveSensitivity + keyV * keyMoveSensitivity)</span><br><span class="line">                        + transform.right * keyH * keyMoveSensitivity;</span><br><span class="line"></span><br><span class="line">            agent.Move(move * Time.deltaTime);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ArtTextController"><a href="#ArtTextController" class="headerlink" title="ArtTextController"></a>ArtTextController</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line"></span><br><span class="line">public class ArtTextController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField]</span><br><span class="line">    private string title;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private string description;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(0f,10f)]</span><br><span class="line">    private float displayTextDistance &#x3D; 5f;</span><br><span class="line"></span><br><span class="line">    private Transform playerTransform;</span><br><span class="line"></span><br><span class="line">    private Text displayArtTitle;</span><br><span class="line">    private Text displayArtDescription;</span><br><span class="line"></span><br><span class="line">    private float dist;</span><br><span class="line"></span><br><span class="line">    private bool check;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; get player transform</span><br><span class="line">        playerTransform &#x3D; GameObject.FindWithTag(&quot;Player&quot;).GetComponent&lt;Transform&gt;();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; get UI text</span><br><span class="line">        displayArtTitle &#x3D; GameObject.FindWithTag(&quot;ArtTitle&quot;).GetComponent&lt;Text&gt;();</span><br><span class="line">        displayArtDescription &#x3D; GameObject.FindWithTag(&quot;ArtDescription&quot;).GetComponent&lt;Text&gt;();</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; set default text</span><br><span class="line">        displayArtTitle.text &#x3D; &quot;&quot;;</span><br><span class="line">        displayArtDescription.text &#x3D; &quot;&quot;;</span><br><span class="line"></span><br><span class="line">        check &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(playerTransform)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F; distance between art and player</span><br><span class="line">            dist &#x3D; Vector3.Distance(transform.position, playerTransform.position);</span><br><span class="line">            if (dist &lt; displayTextDistance)</span><br><span class="line">            &#123;</span><br><span class="line">                displayArtTitle.text &#x3D; title;</span><br><span class="line">                displayArtDescription.text &#x3D; description;</span><br><span class="line">                check &#x3D; true;</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F; turn off display</span><br><span class="line">            if (dist &gt; displayTextDistance &amp;&amp; check &#x3D;&#x3D; true)</span><br><span class="line">            &#123;</span><br><span class="line">                Start();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="构建测试"><a href="#构建测试" class="headerlink" title="构建测试"></a>构建测试</h1><p>MacOS 没问题</p><p>Android 试了一下，场景没问题，操作混乱</p><p>​    安卓导出参考<a href="https://coconutnutx.github.io/2020/09/26/note-arfoundation-01/" target="_blank" rel="noopener">AR Foundation笔记01 安卓Setup</a></p><p>​    目前的操作方式针对电脑，手机端以后再看要不要做</p><p>WebGL 整了半天</p><p>​    参考<a href="https://www.youtube.com/watch?v=G7TK0-vbEYc&ab_channel=UGuruz" target="_blank" rel="noopener">WebGL Export in Unity 2020</a></p><p>​    成功发布到itch.io，但是靠近显示介绍没有了？</p><p>​    本地Firefox打开，也没有</p><h2 id="WebGL-Debug"><a href="#WebGL-Debug" class="headerlink" title="WebGL Debug"></a>WebGL Debug</h2><p>Unity里跑没问题</p><p>Debug.Log人物和画的距离，可以显示，所以可能是</p><p>​    UI显示出了问题</p><p>​    文字没有赋值成功</p><p>​    位置偏了</p><p>给Text设了默认值，再试</p><img src="/images/2021/screencapture2021-02-16 PM9.59.05.jpg"><p>默认值显示了</p><img src="/images/2021/screencapture2021-02-16 PM9.59.12.jpg"><p>靠近没有了</p><p>所以应该是位置不对</p><p>不过后面准备改显示方法，暂时MARK，以后放UI的时候也有可能碰到这个问题</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;做了个初版试试水~😃&lt;/p&gt;
&lt;h1 id=&quot;功能&quot;&gt;&lt;a href=&quot;#功能&quot; class=&quot;headerlink&quot; title=&quot;功能&quot;&gt;&lt;/a&gt;功能&lt;/h1&gt;&lt;h2 id=&quot;点击寻路&quot;&gt;&lt;a href=&quot;#点击寻路&quot; class=&quot;headerlink&quot; title
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity Note - Project09 Movement</title>
    <link href="http://yoursite.com/2021/02/15/unity-09/"/>
    <id>http://yoursite.com/2021/02/15/unity-09/</id>
    <published>2021-02-15T12:17:07.000Z</published>
    <updated>2021-02-16T08:53:52.765Z</updated>
    
    <content type="html"><![CDATA[<p>最终想要做的移动方式：</p><ul><li>点击地面导航</li><li>拖拽旋转</li><li>缩放平移</li><li>点击画导航</li></ul><p>交互方式参考：</p><blockquote><p><a href="https://sketchfab.com/3d-models/richards-art-gallery-audio-tour-0e3e19faa6474fd5974e6a7ed1b221d8" target="_blank" rel="noopener">https://sketchfab.com/3d-models/richards-art-gallery-audio-tour-0e3e19faa6474fd5974e6a7ed1b221d8</a></p></blockquote><h1 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h1><h2 id="点击移动"><a href="#点击移动" class="headerlink" title="点击移动"></a>点击移动</h2><p>参考Project02，AI导航+NavMeshAgent</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if(Input.GetMouseButtonDown(0))&#123;</span><br><span class="line">  RaycastHit hit;</span><br><span class="line">  Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">  if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">    agent.SetDestination(hit.point);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>判断落点，只有是地面才移动（地面打Tag）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if(Input.GetMouseButtonDown(0))&#123;</span><br><span class="line">RaycastHit hit;</span><br><span class="line">Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">if(hit.transform.tag &#x3D;&#x3D; &quot;Floor&quot;)&#123;</span><br><span class="line">agent.SetDestination(hit.point);</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>点击特效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; click to navigate</span><br><span class="line">if(Input.GetMouseButtonDown(0))&#123;</span><br><span class="line">    RaycastHit hit;</span><br><span class="line">    Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">    if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">        &#x2F;&#x2F; move when hit floor</span><br><span class="line">        if(hit.transform.tag &#x3D;&#x3D; &quot;Floor&quot;)&#123;</span><br><span class="line">            agent.SetDestination(hit.point);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; click effect</span><br><span class="line">            GameObject clickEffectObject &#x3D; Instantiate(clickEffect);</span><br><span class="line">            clickEffectObject.transform.position &#x3D; hit.point;</span><br><span class="line">            Destroy(clickEffectObject, 0.5f);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拖拽旋转视角"><a href="#拖拽旋转视角" class="headerlink" title="拖拽旋转视角"></a>拖拽旋转视角</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; get mouse position</span><br><span class="line">float mouseX &#x3D; Input.GetAxis(&quot;Mouse X&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line">float mouseY &#x3D; Input.GetAxis(&quot;Mouse Y&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; rotate camera up and down</span><br><span class="line">cameraRotation -&#x3D; mouseY;</span><br><span class="line">cameraRotation &#x3D; Mathf.Clamp(cameraRotation, -30f, 30f);</span><br><span class="line">cameraTransform.localRotation &#x3D; Quaternion.Euler(cameraRotation, 0f, 0f);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; rotate player left and right</span><br><span class="line">transform.Rotate(Vector3.up * (mouseX));</span><br></pre></td></tr></table></figure><p>此时长按拖拽和点击寻路会混，加一个mouseDownCount计数</p><h2 id="缩放前后移动"><a href="#缩放前后移动" class="headerlink" title="缩放前后移动"></a>缩放前后移动</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; stop navigation</span><br><span class="line">agent.ResetPath();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; scroll to move forward and backward</span><br><span class="line">Vector3 move &#x3D; transform.forward * Input.GetAxis(&quot;Mouse ScrollWheel&quot;) * scrollSensitivity;</span><br><span class="line">agent.Move(move * Time.deltaTime);</span><br></pre></td></tr></table></figure><p>！这里一定要先停止寻路，否则会乱抖</p><h1 id="最终"><a href="#最终" class="headerlink" title="最终"></a>最终</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class PlayerController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField, Range(0f,100f)]</span><br><span class="line">    private float scrollSensitivity &#x3D; 10f;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(0f,500f)]</span><br><span class="line">    private float mouseSensitivity &#x3D; 200f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform cameraTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private float cameraRotation &#x3D; 0f;</span><br><span class="line">    private int mouseDownCount &#x3D; 0;</span><br><span class="line"></span><br><span class="line">    UnityEngine.AI.NavMeshAgent agent;</span><br><span class="line"></span><br><span class="line">    GameObject clickEffect;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;UnityEngine.AI.NavMeshAgent&gt;();</span><br><span class="line"></span><br><span class="line">        clickEffect &#x3D; Resources.Load&lt;GameObject&gt;(&quot;Prefabs&#x2F;ClickEffect&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(Input.GetMouseButtonUp(0))&#123;</span><br><span class="line">            &#x2F;&#x2F; if is click</span><br><span class="line">            if(mouseDownCount &lt; 2)&#123;</span><br><span class="line">                &#x2F;&#x2F; click to navigate</span><br><span class="line">                RaycastHit hit;</span><br><span class="line">                Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">                if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">                    &#x2F;&#x2F; move when hit floor</span><br><span class="line">                    if(hit.transform.tag &#x3D;&#x3D; &quot;Floor&quot;)&#123;</span><br><span class="line">                        agent.SetDestination(hit.point);</span><br><span class="line"></span><br><span class="line">                        &#x2F;&#x2F; click effect</span><br><span class="line">                        GameObject clickEffectObject &#x3D; Instantiate(clickEffect);</span><br><span class="line">                        clickEffectObject.transform.position &#x3D; hit.point;</span><br><span class="line">                        Destroy(clickEffectObject, 1);</span><br><span class="line">                    &#125; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            mouseDownCount &#x3D; 0;</span><br><span class="line">        &#125;else if(Input.GetAxis(&quot;Mouse ScrollWheel&quot;) !&#x3D; 0)&#123;</span><br><span class="line">            &#x2F;&#x2F; stop navigation</span><br><span class="line">            agent.ResetPath();</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; scroll to move forward and backward</span><br><span class="line">            Vector3 move &#x3D; transform.forward * Input.GetAxis(&quot;Mouse ScrollWheel&quot;) * scrollSensitivity;</span><br><span class="line">            agent.Move(move * Time.deltaTime);</span><br><span class="line">        &#125;else if(Input.GetMouseButton(0))&#123;</span><br><span class="line">            &#x2F;&#x2F; stop navigation</span><br><span class="line">            agent.ResetPath();</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; get mouse position</span><br><span class="line">            float mouseX &#x3D; Input.GetAxis(&quot;Mouse X&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line">            float mouseY &#x3D; Input.GetAxis(&quot;Mouse Y&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; rotate camera up and down</span><br><span class="line">            cameraRotation -&#x3D; mouseY;</span><br><span class="line">            cameraRotation &#x3D; Mathf.Clamp(cameraRotation, -30f, 30f);</span><br><span class="line">            cameraTransform.localRotation &#x3D; Quaternion.Euler(cameraRotation, 0f, 0f);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; rotate player left and right</span><br><span class="line">            transform.Rotate(Vector3.up * (mouseX));</span><br><span class="line"></span><br><span class="line">            mouseDownCount++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>点击寻路</p><img src="/images/2021/Feb-16-2021 16-49-06.gif"><p>滚动前后平移</p><img src="/images/2021/Feb-16-2021 16-49-24.gif"><p>拖拽旋转视角</p><img src="/images/2021/Feb-16-2021 16-49-34.gif"><p>且寻路过程中，滚动或拖拽均打断寻路</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;最终想要做的移动方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;点击地面导航&lt;/li&gt;
&lt;li&gt;拖拽旋转&lt;/li&gt;
&lt;li&gt;缩放平移&lt;/li&gt;
&lt;li&gt;点击画导航&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;交互方式参考：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://ske
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity Note - Project08 Gallery</title>
    <link href="http://yoursite.com/2021/02/15/unity/"/>
    <id>http://yoursite.com/2021/02/15/unity/</id>
    <published>2021-02-15T09:59:21.000Z</published>
    <updated>2021-02-15T11:38:13.511Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://learn.unity.com/project/create-a-personal-3d-gallery-project-with-unity" target="_blank" rel="noopener">Create a Personal 3D Gallery Project with Unity</a></p></blockquote><ol><li><p>Use the [first person controller](First Person All-in-One) in asset store</p></li><li><p>Model scale ~= Cube 40*40</p></li></ol><img src="/images/2021/screencapture2021-02-15 PM6.13.09.jpg"><ol start="3"><li><p>Add Component-&gt;Physic-&gt;Mesh Collider to models</p></li><li><p>Light: turn off shadow &amp; increase range to 20</p></li><li><p>Sound effect for different walking materials</p><p>Change Material in Mesh Collider, not Mesh Renderer</p></li></ol><img src="/images/2021/screencapture2021-02-15 PM6.26.31.jpg"><ol start="6"><li><p>Add UI-&gt;Text</p><p>When setting Rect Transform, press Alt(Option) to set position as well</p></li><li><p>Add Tag to Text</p></li><li><p>Add Image: Drag jpg onto Plane</p></li><li><p>Close to display text</p></li></ol><p>drag script onto image</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class Proximity : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public string newTitle;</span><br><span class="line">    public string newAuthor;</span><br><span class="line">    public string newDesc;</span><br><span class="line">    private Transform other;</span><br><span class="line">    private Text myTitle;</span><br><span class="line">    private Text myAuthor;</span><br><span class="line">    private Text myDesc;</span><br><span class="line">    private float dist;</span><br><span class="line">    private GameObject player;</span><br><span class="line">    private GameObject message1;</span><br><span class="line">    private GameObject message2;</span><br><span class="line">    private GameObject message3;</span><br><span class="line">    private bool check;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        player &#x3D; GameObject.FindWithTag(&quot;Player&quot;);</span><br><span class="line">        other &#x3D; player.GetComponent&lt;Transform&gt;();</span><br><span class="line">        message1 &#x3D; GameObject.FindWithTag(&quot;ArtTitle&quot;);</span><br><span class="line">        message2 &#x3D; GameObject.FindWithTag(&quot;ArtAuthor&quot;);</span><br><span class="line">        message3 &#x3D; GameObject.FindWithTag(&quot;ArtDescription&quot;);</span><br><span class="line">        myTitle &#x3D; message1.GetComponent&lt;Text&gt;();</span><br><span class="line">        myTitle.text &#x3D; &quot;&quot;;</span><br><span class="line">        myAuthor &#x3D; message2.GetComponent&lt;Text&gt;();</span><br><span class="line">        myAuthor.text &#x3D; &quot;&quot;;</span><br><span class="line">        myDesc &#x3D; message3.GetComponent&lt;Text&gt;();</span><br><span class="line">        myDesc.text &#x3D; &quot;&quot;;</span><br><span class="line">        check &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if (other)</span><br><span class="line">        &#123;</span><br><span class="line">            dist &#x3D; Vector3.Distance(transform.position, other.position);</span><br><span class="line">            print(&quot;Distance to player: &quot; + dist);</span><br><span class="line">            if (dist &lt; 4)</span><br><span class="line">            &#123;</span><br><span class="line">                myTitle.text &#x3D; newTitle;</span><br><span class="line">                myAuthor.text &#x3D; newAuthor;</span><br><span class="line">                myDesc.text &#x3D; newDesc;</span><br><span class="line">                check &#x3D; true;</span><br><span class="line">            &#125;</span><br><span class="line">            if (dist &gt; 4 &amp;&amp; check &#x3D;&#x3D; true)</span><br><span class="line">            &#123;</span><br><span class="line">                Start();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://learn.unity.com/project/create-a-personal-3d-gallery-project-with-unity&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Cre
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity Note - Project07 Scroll</title>
    <link href="http://yoursite.com/2021/02/14/unity/"/>
    <id>http://yoursite.com/2021/02/14/unity/</id>
    <published>2021-02-14T12:09:34.000Z</published>
    <updated>2021-02-15T09:59:40.297Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Test-open-animation"><a href="#Test-open-animation" class="headerlink" title="Test open animation"></a>Test open animation</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using DG.Tweening;</span><br><span class="line"></span><br><span class="line">public class ReelController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float radius &#x3D; 0.1f; &#x2F;&#x2F; Cylinder radius</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float length &#x3D; 8.0f; &#x2F;&#x2F; Quad length</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float innerHeight &#x3D; 1.0f; &#x2F;&#x2F; Quad height</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float outerHeight &#x3D; 0.8f; &#x2F;&#x2F; Cylinder height</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float openDuration &#x3D; 1.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Ease moveEase &#x3D; Ease.Linear;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform leftCylinderTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform middleQuadTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform rightCylinderTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; set original position</span><br><span class="line">        middleQuadTransform.localScale &#x3D; new Vector3(radius*2,innerHeight,0);</span><br><span class="line">        middleQuadTransform.position &#x3D; new Vector3(0,0,radius);</span><br><span class="line"></span><br><span class="line">        leftCylinderTransform.localScale &#x3D; new Vector3(radius*2,outerHeight,radius*2);</span><br><span class="line">        leftCylinderTransform.position &#x3D; new Vector3(-radius,0,0);</span><br><span class="line"></span><br><span class="line">        rightCylinderTransform.localScale &#x3D; new Vector3(radius*2,outerHeight,radius*2);</span><br><span class="line">        rightCylinderTransform.position &#x3D; new Vector3(radius,0,0);</span><br><span class="line"></span><br><span class="line">        OpenReel();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void OpenReel()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; open canvas</span><br><span class="line">        middleQuadTransform.DOScaleX(length + radius*2, openDuration).SetEase(moveEase);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; move cylinders</span><br><span class="line">        leftCylinderTransform.DOMoveX(leftCylinderTransform.position.x - length&#x2F;2, openDuration).SetEase(moveEase);</span><br><span class="line">        rightCylinderTransform.DOMoveX(rightCylinderTransform.position.x + length&#x2F;2, openDuration).SetEase(moveEase);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2021/Feb-14-2021 20-11-48.gif"><h1 id="Display-image"><a href="#Display-image" class="headerlink" title="Display image"></a>Display image</h1><p>Drag images to asset folder -&gt; Set type to Sprite -&gt; Apply</p><p>Canvas -&gt; Set Render Mode to World Space</p><p>Make sure all objects are positioned at (0, 0, 0)</p><img src="/images/2021/screencapture2021-02-14 PM9.43.21.jpg"><p>Test size</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RectTransform rectTransfrom &#x3D; GetComponentInChildren&lt;Image&gt;().GetComponent&lt;RectTransform&gt;();</span><br><span class="line"></span><br><span class="line">Debug.Log(&quot;rectTransfrom: &quot;+rectTransfrom);</span><br><span class="line">Debug.Log(&quot;rectTransfrom.rect: &quot;+rectTransfrom.rect);</span><br><span class="line">Debug.Log(&quot;rectTransfrom.sizeDelta: &quot;+rectTransfrom.sizeDelta);</span><br><span class="line"></span><br><span class="line">Rect rect &#x3D; rectTransfrom.rect;</span><br><span class="line">rectTransfrom.sizeDelta &#x3D; new Vector2(rect.width&#x2F;rect.height*canvasHeight,canvasHeight);</span><br><span class="line"></span><br><span class="line">Debug.Log(&quot;rectTransfrom: &quot;+rectTransfrom);</span><br><span class="line">Debug.Log(&quot;rectTransfrom.rect: &quot;+rectTransfrom.rect);</span><br><span class="line">Debug.Log(&quot;rectTransfrom.sizeDelta: &quot;+rectTransfrom.sizeDelta);</span><br></pre></td></tr></table></figure><img src="/images/2021/screencapture2021-02-14 PM9.45.02.jpg"><h1 id="Set-scroll-size"><a href="#Set-scroll-size" class="headerlink" title="Set scroll size"></a>Set scroll size</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line">using DG.Tweening;</span><br><span class="line"></span><br><span class="line">public class ReelController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float canvasHeight &#x3D; 1000;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float cylinderHeight &#x3D; 600;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float cylinderRadius &#x3D; 30;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float openDuration &#x3D; 1.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Ease moveEase &#x3D; Ease.Linear;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform leftCylinderTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform rightCylinderTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; get image rectTransfrom</span><br><span class="line">        RectTransform rectTransfrom &#x3D; GetComponentInChildren&lt;Image&gt;().GetComponent&lt;RectTransform&gt;();</span><br><span class="line">        &#x2F;&#x2F; get original image size</span><br><span class="line">        Rect rect &#x3D; rectTransfrom.rect;</span><br><span class="line">        &#x2F;&#x2F; scale to default height</span><br><span class="line">        float canvasWidth &#x3D; rect.width &#x2F; rect.height * canvasHeight;</span><br><span class="line">        rectTransfrom.sizeDelta &#x3D; new Vector2(canvasWidth, canvasHeight);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; set original position</span><br><span class="line">        leftCylinderTransform.localScale &#x3D; new Vector3(cylinderRadius*2, cylinderHeight, cylinderRadius*2);</span><br><span class="line">        leftCylinderTransform.position &#x3D; new Vector3(-cylinderRadius - canvasWidth&#x2F;2,0,0);</span><br><span class="line"></span><br><span class="line">        rightCylinderTransform.localScale &#x3D; new Vector3(cylinderRadius*2, cylinderHeight, cylinderRadius*2);</span><br><span class="line">        rightCylinderTransform.position &#x3D; new Vector3(cylinderRadius + canvasWidth&#x2F;2,0,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2021/screencapture2021-02-14 PM10.09.59.jpg"><h1 id="Scroll-animation"><a href="#Scroll-animation" class="headerlink" title="Scroll animation"></a>Scroll animation</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.UI;</span><br><span class="line">using DG.Tweening;</span><br><span class="line"></span><br><span class="line">public class ScrollController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float canvasHeight &#x3D; 1000;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float cylinderHeight &#x3D; 600;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float cylinderRadius &#x3D; 30;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private float openDuration &#x3D; 1.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Ease moveEase &#x3D; Ease.Linear;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform leftCylinderTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Transform rightCylinderTransform &#x3D; null;</span><br><span class="line"></span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Open();</span><br><span class="line"></span><br><span class="line">        OpenAnimation();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void Open()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; get image rectTransfrom</span><br><span class="line">        RectTransform rectTransfrom &#x3D; GetComponentInChildren&lt;Image&gt;().GetComponent&lt;RectTransform&gt;();</span><br><span class="line">        &#x2F;&#x2F; get original image size</span><br><span class="line">        Rect rect &#x3D; rectTransfrom.rect;</span><br><span class="line">        &#x2F;&#x2F; scale to default height</span><br><span class="line">        float canvasWidth &#x3D; rect.width &#x2F; rect.height * canvasHeight;</span><br><span class="line">        rectTransfrom.sizeDelta &#x3D; new Vector2(canvasWidth, canvasHeight);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; set original position</span><br><span class="line">        leftCylinderTransform.localScale &#x3D; new Vector3(cylinderRadius*2, cylinderHeight, cylinderRadius*2);</span><br><span class="line">        leftCylinderTransform.position &#x3D; new Vector3(-cylinderRadius - canvasWidth&#x2F;2,0,0);</span><br><span class="line"></span><br><span class="line">        rightCylinderTransform.localScale &#x3D; new Vector3(cylinderRadius*2, cylinderHeight, cylinderRadius*2);</span><br><span class="line">        rightCylinderTransform.position &#x3D; new Vector3(cylinderRadius + canvasWidth&#x2F;2,0,0);</span><br><span class="line"></span><br><span class="line">        Debug.Log(&quot;Scroll opened: &quot; + rectTransfrom.rect);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void OpenAnimation()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; get image rectTransfrom</span><br><span class="line">        RectTransform rectTransfrom &#x3D; GetComponentInChildren&lt;Image&gt;().GetComponent&lt;RectTransform&gt;();</span><br><span class="line">        &#x2F;&#x2F; get original image size</span><br><span class="line">        Rect rect &#x3D; rectTransfrom.rect;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; set width to 0</span><br><span class="line">        rectTransfrom.DOScaleX(0, 0).SetEase(moveEase);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; scale to default height</span><br><span class="line">        float canvasWidth &#x3D; rect.width &#x2F; rect.height * canvasHeight;</span><br><span class="line">        &#x2F;&#x2F; open canvas</span><br><span class="line">        float scaleX &#x3D; canvasWidth&#x2F;rect.width;</span><br><span class="line">        float scaleY &#x3D; canvasHeight&#x2F;rect.height;</span><br><span class="line">        rectTransfrom.DOScale(new Vector2(scaleX, scaleY), openDuration).SetEase(moveEase);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; move cylinders</span><br><span class="line">        leftCylinderTransform.localScale &#x3D; new Vector3(cylinderRadius*2, cylinderHeight, cylinderRadius*2);</span><br><span class="line">        leftCylinderTransform.DOMoveX(leftCylinderTransform.position.x - canvasWidth&#x2F;2, openDuration).SetEase(moveEase);</span><br><span class="line"></span><br><span class="line">        rightCylinderTransform.localScale &#x3D; new Vector3(cylinderRadius*2, cylinderHeight, cylinderRadius*2);</span><br><span class="line">        rightCylinderTransform.DOMoveX(rightCylinderTransform.position.x + canvasWidth&#x2F;2, openDuration).SetEase(moveEase);</span><br><span class="line"></span><br><span class="line">        Debug.Log(&quot;Scroll opened with animation: &quot; + rectTransfrom.rect);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2021/Feb-14-2021 22-58-33.gif">]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Test-open-animation&quot;&gt;&lt;a href=&quot;#Test-open-animation&quot; class=&quot;headerlink&quot; title=&quot;Test open animation&quot;&gt;&lt;/a&gt;Test open animation&lt;/h1&gt;&lt;figu
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity Note - Project06 DoTween</title>
    <link href="http://yoursite.com/2021/02/14/unity-note/"/>
    <id>http://yoursite.com/2021/02/14/unity-note/</id>
    <published>2021-02-14T08:31:45.000Z</published>
    <updated>2021-02-14T10:21:19.692Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=cKwz4xlQHmo&ab_channel=DilmerValecillos" target="_blank" rel="noopener">Creating Dynamic animations with DOTween for Unity3d</a></p></blockquote><blockquote><p><a href="http://dotween.demigiant.com/documentation.php" target="_blank" rel="noopener">DoTween Documentation</a></p></blockquote><ol><li><p>Add asset <a href="https://assetstore.unity.com/packages/tools/animation/dotween-hotween-v2-27676" target="_blank" rel="noopener">DOTween (HOTween v2)</a></p></li><li><p>Add 3D Objects</p></li></ol><img src="/images/2021/screencapture2021-02-14 PM4.51.38.jpg"><ol start="3"><li>Move one way</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using DG.Tweening;</span><br><span class="line"></span><br><span class="line">public class DoTweenController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Vector3 targetLocation &#x3D; Vector3.zero;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(1.0f, 10.0f)]</span><br><span class="line">    private float moveDuration &#x3D; 1.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Ease moveEase &#x3D; Ease.Linear;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private DoTweenType doTweenType &#x3D; DoTweenType.MovementOneWay;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Different types of animation</span><br><span class="line">    private enum DoTweenType</span><br><span class="line">    &#123;</span><br><span class="line">        MovementOneWay</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        if(doTweenType &#x3D;&#x3D; DoTweenType.MovementOneWay)&#123;</span><br><span class="line">            if(targetLocation &#x3D;&#x3D; Vector3.zero)&#123;</span><br><span class="line">                &#x2F;&#x2F; stay at original position</span><br><span class="line">                targetLocation &#x3D; transform.position;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            transform.DOMove(targetLocation, moveDuration).SetEase(moveEase);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2021/Feb-14-2021 17-43-05.gif"><ol start="4"><li>More types</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using DG.Tweening;</span><br><span class="line"></span><br><span class="line">public class DoTweenController : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Vector3 targetLocation &#x3D; Vector3.zero;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(1.0f, 10.0f)]</span><br><span class="line">    private float moveDuration &#x3D; 1.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Ease moveEase &#x3D; Ease.Linear;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private Color targetColor;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(1.0f, 10.0f)]</span><br><span class="line">    private float colorChangeDuration &#x3D; 1.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField, Range(0.1f, 10.0f)]</span><br><span class="line">    private float scaleMultiplier &#x3D; 3.0f;</span><br><span class="line"></span><br><span class="line">    [SerializeField]</span><br><span class="line">    private DoTweenType doTweenType &#x3D; DoTweenType.MovementOneWay;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Different types of animation</span><br><span class="line">    private enum DoTweenType</span><br><span class="line">    &#123;</span><br><span class="line">        MovementOneWay,</span><br><span class="line">        MovementTwoWay,</span><br><span class="line">        MovementOneWayColorChange,</span><br><span class="line">        MomementOneWayColorChangeScaleChange</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        if(targetLocation &#x3D;&#x3D; Vector3.zero)&#123;</span><br><span class="line">                &#x2F;&#x2F; stay at original position</span><br><span class="line">                targetLocation &#x3D; transform.position;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        if(doTweenType &#x3D;&#x3D; DoTweenType.MovementOneWay)&#123;</span><br><span class="line">            transform.DOMove(targetLocation, moveDuration).SetEase(moveEase);</span><br><span class="line">        &#125;</span><br><span class="line">        else if(doTweenType &#x3D;&#x3D; DoTweenType.MovementTwoWay)&#123;</span><br><span class="line">            StartCoroutine(MoveWithBothWays());</span><br><span class="line">        &#125;</span><br><span class="line">        else if(doTweenType &#x3D;&#x3D; DoTweenType.MovementOneWayColorChange)&#123;</span><br><span class="line">            &#x2F;&#x2F; another way</span><br><span class="line">            DOTween.Sequence()</span><br><span class="line">                .Append(transform.DOMove(targetLocation, moveDuration).SetEase(moveEase))</span><br><span class="line">                .Append(transform.GetComponent&lt;Renderer&gt;().material.DOColor(targetColor, colorChangeDuration).SetEase(moveEase));</span><br><span class="line">        &#125;</span><br><span class="line">        else if(doTweenType &#x3D;&#x3D; DoTweenType.MomementOneWayColorChangeScaleChange)&#123;</span><br><span class="line">            DOTween.Sequence()</span><br><span class="line">                .Append(transform.DOMove(targetLocation, moveDuration).SetEase(moveEase))</span><br><span class="line">                .Append(transform.GetComponent&lt;Renderer&gt;().material.DOColor(targetColor, colorChangeDuration).SetEase(moveEase))</span><br><span class="line">                .Append(transform.DOScale(scaleMultiplier, moveDuration).SetEase(moveEase));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private IEnumerator MoveWithBothWays()&#123;</span><br><span class="line">        &#x2F;&#x2F; save original position</span><br><span class="line">        Vector3 originalLocation &#x3D; transform.position;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; go to traget location</span><br><span class="line">        transform.DOMove(targetLocation, moveDuration).SetEase(moveEase);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; wait</span><br><span class="line">        yield return new WaitForSeconds(moveDuration);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; go to original location</span><br><span class="line">        transform.DOMove(originalLocation, moveDuration).SetEase(moveEase);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/images/2021/Feb-14-2021 18-16-16.gif">]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=cKwz4xlQHmo&amp;ab_channel=DilmerValecillos&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Creating Dy
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Notion Offline记录</title>
    <link href="http://yoursite.com/2021/02/12/notionn/"/>
    <id>http://yoursite.com/2021/02/12/notionn/</id>
    <published>2021-02-12T15:29:15.000Z</published>
    <updated>2021-02-13T01:43:27.912Z</updated>
    
    <content type="html"><![CDATA[<p>Notion的app突然Offline了</p><p>直接访问显示DNS_PROBE_FINISHED_NXDOMAIN</p><p>根据↓尝试</p><blockquote><p><a href="https://linmi.cc/6133.html" target="_blank" rel="noopener">https://linmi.cc/6133.html</a></p></blockquote><p>1.加host<br>cmd中 open /etc<br>host中加一行 104.18.23.110 notion.so<br>此时可以ping通notion.so，但app仍是offline</p><p>2.改DNS<br>加119.29.29.29<br>114.114.114.114<br>没有用，改回默认</p><p>暂时还是不能用，等修复吧<br>哎，失去notion仿佛失去了半个脑子</p><p>更新：<br>然后发现github.io也访问不了了，是运营商的问题<br>DNS改成114.114.114.114后解决</p><p>再更新：<br>notion好了！我活了！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Notion的app突然Offline了&lt;/p&gt;
&lt;p&gt;直接访问显示DNS_PROBE_FINISHED_NXDOMAIN&lt;/p&gt;
&lt;p&gt;根据↓尝试&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://linmi.cc/6133.html&quot; targe
      
    
    </summary>
    
    
      <category term="Memo" scheme="http://yoursite.com/categories/Memo/"/>
    
    
      <category term="tool" scheme="http://yoursite.com/tags/tool/"/>
    
  </entry>
  
  <entry>
    <title>Unity笔记 Project05 地形&amp;Asset</title>
    <link href="http://yoursite.com/2020/12/02/unity-note-3/"/>
    <id>http://yoursite.com/2020/12/02/unity-note-3/</id>
    <published>2020-12-02T13:54:21.000Z</published>
    <updated>2020-12-02T13:57:22.871Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=ddy12WHqt-M&amp;ab_channel=UGuruz" target="_blank" rel="noopener">https://www.youtube.com/watch?v=ddy12WHqt-M&amp;ab_channel=UGuruz</a></p></blockquote><p>试了试地形</p><img src="/images/2020/screencapture2020-12-02 PM8.19.30.jpg"><p>加入人物，按Project04的方式移动</p><img src="/images/2020/screencapture2020-12-02 PM8.20.05.jpg"><p>找了一组模型，能用！</p><img src="/images/2020/screencapture2020-12-02 PM9.53.36.jpg"><p>感觉要起飞了🤩</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=ddy12WHqt-M&amp;amp;ab_channel=UGuruz&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.youtu
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity笔记 Project04 点击移动+旋转摄像头</title>
    <link href="http://yoursite.com/2020/12/02/unity-note-2/"/>
    <id>http://yoursite.com/2020/12/02/unity-note-2/</id>
    <published>2020-12-02T09:43:51.000Z</published>
    <updated>2020-12-02T10:07:55.039Z</updated>
    
    <content type="html"><![CDATA[<p>想做成点击移动，并且摄像头可以根据鼠标位置有限制的旋转</p><h1 id="Step-1-点击移动"><a href="#Step-1-点击移动" class="headerlink" title="Step 1 - 点击移动"></a>Step 1 - 点击移动</h1><p>参照Project02</p><img src="/images/2020/screencapture2020-12-02 PM5.37.22.jpg"><p>完成~</p><img src="/images/2020/Dec-02-2020 17-42-53.gif"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.AI;</span><br><span class="line"></span><br><span class="line">public class PlayerMovement : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public NavMeshAgent agent;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;NavMeshAgent&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Click to Move</span><br><span class="line">        if(Input.GetMouseButtonDown(0))&#123;</span><br><span class="line">            RaycastHit hit;</span><br><span class="line">            Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">            if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">                agent.SetDestination(hit.point);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Step-2-旋转摄像头"><a href="#Step-2-旋转摄像头" class="headerlink" title="Step 2 - 旋转摄像头"></a>Step 2 - 旋转摄像头</h1><p>参照Project03</p><img src="/images/2020/Dec-02-2020 18-05-13.gif"><p>鼠标转向不是很方便，顺便加了方向键旋转</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class CameraLook : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public float mouseSensitivity &#x3D; 100f;</span><br><span class="line">    public float keySensitivity &#x3D; 100f;</span><br><span class="line">    public Transform player &#x3D; null;</span><br><span class="line">    private float xRotation &#x3D; 0f;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Get mouse position</span><br><span class="line">        float mouseX &#x3D; Input.GetAxis(&quot;Mouse X&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line">        float mouseY &#x3D; Input.GetAxis(&quot;Mouse Y&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Get key inout</span><br><span class="line">        float keyX &#x3D; Input.GetAxis(&quot;Horizontal&quot;) * keySensitivity * Time.deltaTime;</span><br><span class="line"></span><br><span class="line">        Debug.Log(mouseX);</span><br><span class="line">        Debug.Log(keyX);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Rotate camera up and down</span><br><span class="line">        xRotation -&#x3D; mouseY;</span><br><span class="line">        xRotation &#x3D; Mathf.Clamp(xRotation, -30f, 30f);</span><br><span class="line">        transform.localRotation &#x3D; Quaternion.Euler(xRotation, 0f, 0f);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Rotate player left and right</span><br><span class="line">        player.Rotate(Vector3.up * (mouseX + keyX));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>耶(＾－＾)V</p><p>目前这个移动方式很满意，暂时就这样</p><p>下一步可以搭场景啦~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;想做成点击移动，并且摄像头可以根据鼠标位置有限制的旋转&lt;/p&gt;
&lt;h1 id=&quot;Step-1-点击移动&quot;&gt;&lt;a href=&quot;#Step-1-点击移动&quot; class=&quot;headerlink&quot; title=&quot;Step 1 - 点击移动&quot;&gt;&lt;/a&gt;Step 1 - 点击移动&lt;/h
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity笔记 Project03 第一人称移动</title>
    <link href="http://yoursite.com/2020/12/02/unity-note-1/"/>
    <id>http://yoursite.com/2020/12/02/unity-note-1/</id>
    <published>2020-12-02T05:58:43.000Z</published>
    <updated>2020-12-02T09:23:36.216Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=_QajrabyTJc&amp;ab_channel=Brackeys" target="_blank" rel="noopener">https://www.youtube.com/watch?v=_QajrabyTJc&amp;ab_channel=Brackeys</a></p></blockquote><img src="/images/2020/screencapture2020-12-02 PM5.18.52.jpg"><h1 id="层级"><a href="#层级" class="headerlink" title="层级"></a>层级</h1><ul><li>Player（空物体）-&gt; 加Character Controller；PlayerMovement（Script）<ul><li>Body（圆柱）-&gt; 删除Collider</li><li>Main Camera -&gt; 放在人物头部的位置；MouseLook（Script）</li></ul></li></ul><h1 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h1><p>x轴横向旋转，转动Player和Camera</p><p>y轴纵向旋转，只转动Camera</p><h1 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h1><p>使用Character Controller的方法</p><h1 id="重力"><a href="#重力" class="headerlink" title="重力"></a>重力</h1><p>Character Controller不能使用Rigidbody🤪，只能代码解决</p><p>还需要通过GroundCheck和Layer来解决碰到地面时下落速度清零的问题</p><h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><ul><li><p>Update()中Time.deltaTime获取从上次调用Update()至今的时间</p></li><li><p>控制爬楼梯跨度&amp;斜坡角度 -&gt; Character Controller中设置</p></li></ul><img src="/images/2020/screencapture2020-12-02_PM2.00.44.jpg"><p>看教程里的总结，用Character Controller和用RigidBody来控制确实挺不一样的，后面得看看用哪个更合适</p><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class MouseLook : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public float mouseSensitivity &#x3D; 100f;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 在Unity中把Player拖过来</span><br><span class="line">    public Transform playerBody &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private float xRotation &#x3D; 0f;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Get Input</span><br><span class="line">        float mouseX &#x3D; Input.GetAxis(&quot;Mouse X&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line">        float mouseY &#x3D; Input.GetAxis(&quot;Mouse Y&quot;) * mouseSensitivity * Time.deltaTime;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 纵向旋转Camera</span><br><span class="line">        xRotation -&#x3D; mouseY;</span><br><span class="line">        &#x2F;&#x2F; 不直接用Rotate，因为要先限制旋转角度</span><br><span class="line">        xRotation &#x3D; Mathf.Clamp(xRotation, -30f, 30f);</span><br><span class="line">        transform.localRotation &#x3D; Quaternion.Euler(xRotation, 0f, 0f);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 横向旋转Player</span><br><span class="line">        playerBody.Rotate(Vector3.up * mouseX);</span><br><span class="line">        Debug.Log(mouseX);</span><br><span class="line">        Debug.Log(&quot;R:&quot;+playerBody.transform.rotation);</span><br><span class="line">        Debug.Log(&quot;LR:&quot;+playerBody.transform.localRotation);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class PlayerMovement : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public CharacterController controller;</span><br><span class="line"></span><br><span class="line">    public float speed &#x3D; 12f;</span><br><span class="line">    public float gravity &#x3D; -9.81f;</span><br><span class="line">    public float jumpHeight &#x3D; 3f;</span><br><span class="line"></span><br><span class="line">    public Transform groundCheck;</span><br><span class="line">    public float groundDistance &#x3D; 0.4f;</span><br><span class="line">    public LayerMask groundMask;</span><br><span class="line"></span><br><span class="line">    Vector3 velocity;</span><br><span class="line">    bool isGrounded;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; 防止向下的速度无限增大</span><br><span class="line">        isGrounded &#x3D; Physics.CheckSphere(groundCheck.position, groundDistance, groundMask);</span><br><span class="line"></span><br><span class="line">        if(isGrounded &amp;&amp; velocity.y &lt; 0)&#123;</span><br><span class="line">            velocity.y &#x3D; -2f;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 移动</span><br><span class="line">        float x &#x3D; Input.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line">        float z &#x3D; Input.GetAxis(&quot;Vertical&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 这样写是全局坐标，不管Player面对什么方向</span><br><span class="line">        &#x2F;&#x2F; Vector3 move &#x3D; new Vector3(x, 0f, z);</span><br><span class="line"></span><br><span class="line">        Vector3 move &#x3D; transform.right * x + transform.forward * z;</span><br><span class="line">        controller.Move(move * speed * Time.deltaTime);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 跳跃</span><br><span class="line">        if(Input.GetButtonDown(&quot;Jump&quot;) &amp;&amp; isGrounded)&#123;</span><br><span class="line">            velocity.y &#x3D; Mathf.Sqrt(jumpHeight * -2f * gravity);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 模拟重力</span><br><span class="line">        velocity.y +&#x3D; gravity * Time.deltaTime;</span><br><span class="line">        controller.Move(velocity * Time.deltaTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=_QajrabyTJc&amp;amp;ab_channel=Brackeys&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.you
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity笔记 Project02 点击移动</title>
    <link href="http://yoursite.com/2020/12/02/unity-note/"/>
    <id>http://yoursite.com/2020/12/02/unity-note/</id>
    <published>2020-12-02T05:36:44.000Z</published>
    <updated>2020-12-02T09:26:35.690Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=y_zdW5LIX5o&ab_channel=PekkeDev" target="_blank" rel="noopener">Click To Move with NavMesh - Unity 3D</a></p></blockquote><p>选中地面</p><p>窗口 → AI → 导航: Static &amp; Walkable</p><img src="/images/2020/screencapture2020-12-02_PM1.26.36.jpg"><p>烘焙 → Bake</p><img src="/images/2020/screencapture2020-12-02_PM1.27.18.jpg"><p>Player加组件Nav Mesh Agent</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.AI;</span><br><span class="line"></span><br><span class="line">public class Player : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    NavMeshAgent agent;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start()</span><br><span class="line">    &#123;</span><br><span class="line">        agent &#x3D; GetComponent&lt;NavMeshAgent&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(Input.GetMouseButtonDown(0))&#123;</span><br><span class="line">            RaycastHit hit;</span><br><span class="line">            Ray ray &#x3D; Camera.main.ScreenPointToRay(Input.mousePosition);</span><br><span class="line">            if(Physics.Raycast(ray, out hit, Mathf.Infinity))&#123;</span><br><span class="line">                agent.SetDestination(hit.point);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=y_zdW5LIX5o&amp;ab_channel=PekkeDev&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Click To Move with 
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>Unity笔记 Project01 Basic</title>
    <link href="http://yoursite.com/2020/11/30/note-unity/"/>
    <id>http://yoursite.com/2020/11/30/note-unity/</id>
    <published>2020-11-30T12:55:58.000Z</published>
    <updated>2020-12-02T09:20:31.015Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=pwZpJzpE2lQ&amp;t=4178s&amp;ab_channel=Imphenzia" target="_blank" rel="noopener">https://www.youtube.com/watch?v=pwZpJzpE2lQ&amp;t=4178s&amp;ab_channel=Imphenzia</a></p></blockquote><img src="/images/2020/screencapture2020-11-30 PM9.13.29.jpg"><h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><ol><li><p>人物跳跃，左右移动</p><ul><li><p>跳跃速度与重量无关 -&gt; ForceMode.VelocityChange</p></li><li><p>跳跃时保持左右速度 -&gt; rigidbodyComponent.velocity</p></li><li><p>不可在空中跳跃 -&gt; 检查Physics.OverlapSphere()</p></li><li><p>左右移动同时检查←→AD -&gt; Input.GetAxis(“Horizontal”)</p></li><li><p>碰到墙壁不会因为长按D贴在墙上 -&gt; 添加物理材质，摩擦力为0</p></li></ul></li><li><p>摄像头跟随角色 -&gt; 层级放在角色下即可</p></li><li><p>收集硬币</p><ul><li>不发生碰撞 -&gt; 勾选是触发器</li><li>检测碰撞 -&gt; OnTriggerEnter()</li><li>碰到后消除 -&gt; Destroy(other.gameObject);</li></ul></li></ol><h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><ol><li>在Update()中获取输入，在FixedUpdate()中apply physics</li><li>用[SerializeField] private，不要用public</li><li>减少不必要的Collider，提高效率</li><li>多用Prefab，善用Layer</li></ol><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line"></span><br><span class="line">public class Player : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    [SerializeField] private Transform groundCheckTransform &#x3D; null;</span><br><span class="line">    [SerializeField] private LayerMask playerMask;</span><br><span class="line">    private bool jumpKeyPressed;</span><br><span class="line">    private float horizontalInput;</span><br><span class="line">    private Rigidbody rigidbodyComponent;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Start is called before the first frame update</span><br><span class="line">    void Start() &#123;</span><br><span class="line">        rigidbodyComponent &#x3D; GetComponent&lt;Rigidbody&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Update is called once per frame</span><br><span class="line">    void Update() &#123;</span><br><span class="line">        horizontalInput &#x3D; Input.GetAxis(&quot;Horizontal&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Avoid jumping in the air (always colliding with the capsule collider)</span><br><span class="line">        if(Physics.OverlapSphere(groundCheckTransform.position, 0.1f, playerMask).Length &#x3D;&#x3D; 0)&#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(Input.GetKeyDown(KeyCode.Space))&#123;</span><br><span class="line">            jumpKeyPressed &#x3D; true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; FixedUpdate is called once every physic update (Default 100&#x2F;s)</span><br><span class="line">    private void FixedUpdate() &#123;</span><br><span class="line">        if(jumpKeyPressed)&#123;</span><br><span class="line">            rigidbodyComponent.AddForce(Vector3.up * 5,ForceMode.VelocityChange);</span><br><span class="line">            jumpKeyPressed &#x3D; false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        rigidbodyComponent.velocity &#x3D; new Vector3(horizontalInput * 2, rigidbodyComponent.velocity.y, 0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void OnTriggerEnter(Collider other) &#123;</span><br><span class="line">        &#x2F;&#x2F; Collide with 9.Coin layer</span><br><span class="line">        if(other.gameObject.layer &#x3D;&#x3D; 9)&#123;</span><br><span class="line">            Destroy(other.gameObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=pwZpJzpE2lQ&amp;amp;t=4178s&amp;amp;ab_channel=Imphenzia&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ht
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="unity" scheme="http://yoursite.com/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>看源码笔记 DeephageTP</title>
    <link href="http://yoursite.com/2020/11/19/code-note/"/>
    <id>http://yoursite.com/2020/11/19/code-note/</id>
    <published>2020-11-19T09:02:01.000Z</published>
    <updated>2020-11-19T10:16:44.490Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/chuym726/DeephageTP" target="_blank" rel="noopener">https://github.com/chuym726/DeephageTP</a></p></blockquote><h1 id="环境搭建-amp-数据准备"><a href="#环境搭建-amp-数据准备" class="headerlink" title="环境搭建&amp;数据准备"></a>环境搭建&amp;数据准备</h1><p>（已有：conda 4.9.2）</p><ol><li><p>下载<a href="https://github.com/chuym726/DeephageTP" target="_blank" rel="noopener">https://github.com/chuym726/DeephageTP</a></p></li><li><p>创建新的虚拟环境deephageTP</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name deephageTP python&#x3D;3.6 numpy theano keras scikit-learn</span><br></pre></td></tr></table></figure><ol start="3"><li><p>新建工程文件夹DeephageTP-test（需要的文件从下载的DeephageTP-master拷）</p></li><li><p>PyCharm打开DeephageTP-test，激活环境</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate deephageTP</span><br></pre></td></tr></table></figure><img src="/images/2020/screencapture2020-11-19 PM5.23.40.jpg"><p>Python Interpreter也改成deephageTP</p><img src="/images/2020/screencapture2020-11-19 PM5.25.35.jpg"><img src="/images/2020/screencapture2020-11-19 PM5.26.51.jpg"><h1 id="测试example-data-fa"><a href="#测试example-data-fa" class="headerlink" title="测试example_data.fa"></a>测试example_data.fa</h1><p>代码里面直接读的training_data.faa，X和Y应该在同一个文件里，</p><p>但是给的training_data.faa.X.npy.tar.gz、training_data.faa.Y.npy.tar.gz是在不同文件</p><p>于是先用example_data.fa试一下（遇到bug #1，解决见Debug）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">(deephageTP) coconutnut@x86_64-apple-darwin13 DeephageTP-test % python DeephageTP_model_training.py</span><br><span class="line">Using TensorFlow backend.</span><br><span class="line">only amino acid code.</span><br><span class="line">ok! there is the same number (193) of labels and sequences. </span><br><span class="line">193</span><br><span class="line">193</span><br><span class="line">193</span><br><span class="line">ok! windows is 900.</span><br><span class="line">ok! raw data has been saved as a npy file example_data.fa.X&#x2F;Y</span><br><span class="line">now runing is DL_Train.</span><br><span class="line">nb_filters:  50</span><br><span class="line">kernel_s:  3</span><br><span class="line">n_batch:  10</span><br><span class="line">n_echos:  20</span><br><span class="line">dropout1:  0.1</span><br><span class="line">dropout2:  0.1</span><br><span class="line">ok! the npy file example_data.fa.X&#x2F;Y.npy are loaded!</span><br><span class="line">ok! all labels are in 4 kinds.</span><br><span class="line">193</span><br><span class="line">now training for all, Be noted here no test part !!!</span><br><span class="line">[[1. 0. 0. 0.]</span><br><span class="line"> [1. 0. 0. 0.]</span><br><span class="line"> [1. 0. 0. 0.]</span><br><span class="line">......</span><br><span class="line"> [0. 0. 0. 1.]</span><br><span class="line"> [0. 0. 0. 1.]</span><br><span class="line"> [0. 0. 0. 1.]</span><br><span class="line"> [0. 0. 0. 1.]]</span><br><span class="line">2020-11-19 17:30:03.895070: I tensorflow&#x2F;core&#x2F;platform&#x2F;cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA</span><br><span class="line">To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.</span><br><span class="line">2020-11-19 17:30:03.895316: I tensorflow&#x2F;core&#x2F;common_runtime&#x2F;process_util.cc:115] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.</span><br><span class="line">Epoch 1&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 12s 64ms&#x2F;step - loss: 1.1962 - accuracy: 0.4767</span><br><span class="line">Epoch 2&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 11s 55ms&#x2F;step - loss: 0.4503 - accuracy: 0.8446</span><br><span class="line">Epoch 3&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 53ms&#x2F;step - loss: 0.1844 - accuracy: 0.9534</span><br><span class="line">Epoch 4&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 52ms&#x2F;step - loss: 0.1079 - accuracy: 0.9845</span><br><span class="line">Epoch 5&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 11s 55ms&#x2F;step - loss: 0.0383 - accuracy: 1.0000</span><br><span class="line">Epoch 6&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 50ms&#x2F;step - loss: 0.0203 - accuracy: 1.0000</span><br><span class="line">Epoch 7&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 12s 61ms&#x2F;step - loss: 0.0105 - accuracy: 1.0000</span><br><span class="line">Epoch 8&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 51ms&#x2F;step - loss: 0.0063 - accuracy: 1.0000</span><br><span class="line">Epoch 9&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 51ms&#x2F;step - loss: 0.0058 - accuracy: 1.0000</span><br><span class="line">Epoch 10&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 50ms&#x2F;step - loss: 0.0104 - accuracy: 0.9948</span><br><span class="line">Epoch 11&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 51ms&#x2F;step - loss: 0.0066 - accuracy: 1.0000</span><br><span class="line">Epoch 12&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 51ms&#x2F;step - loss: 0.0041 - accuracy: 1.0000</span><br><span class="line">Epoch 13&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 52ms&#x2F;step - loss: 0.0017 - accuracy: 1.0000</span><br><span class="line">Epoch 14&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 50ms&#x2F;step - loss: 0.0026 - accuracy: 1.0000</span><br><span class="line">Epoch 15&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 51ms&#x2F;step - loss: 0.0017 - accuracy: 1.0000</span><br><span class="line">Epoch 16&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 50ms&#x2F;step - loss: 0.0013 - accuracy: 1.0000</span><br><span class="line">Epoch 17&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 10s 52ms&#x2F;step - loss: 0.0011 - accuracy: 1.0000</span><br><span class="line">Epoch 18&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 9s 48ms&#x2F;step - loss: 8.4943e-04 - accuracy: 1.0000</span><br><span class="line">Epoch 19&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 9s 49ms&#x2F;step - loss: 8.9927e-04 - accuracy: 1.0000</span><br><span class="line">Epoch 20&#x2F;20</span><br><span class="line">193&#x2F;193 [&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;] - 9s 49ms&#x2F;step - loss: 0.0011 - accuracy: 1.0000</span><br><span class="line">the model (example_data.fa.all.h5) has saved!</span><br></pre></td></tr></table></figure><p>产生了3个文件</p><p>example_data.fa.all.h5</p><p>example_data.fa.X.npy</p><p>example_data.fa.Y.npy</p><p>所以给的training_data.faa.X.npy.tar.gz、training_data.faa.Y.npy.tar.gz也是生成的吗？data文件夹里就一个叫a的空文件，难道是没传training_data.faa？😧</p><p>看了下代码，还真是🙄</p><p>aa_ref2npy()用来转格式，存成one-hot编码后，X和Y分开的形式</p><p>DL_Train()用来训练</p><p>既然如此，直接用training_data.faa.X.npy.tar.gz、training_data.faa.Y.npy.tar.gz解压，不跑aa_ref2npy()，就可以直接训练了</p><h1 id="测试training-data-faa"><a href="#测试training-data-faa" class="headerlink" title="测试training_data.faa"></a>测试training_data.faa</h1><p>解压training_data.faa.X.npy.tar.gz、training_data.faa.Y.npy.tar.gz</p><p>（25.3MB解压后3.97 GB，是得有多少0啊，不愧是one-hot）</p><p>代码改了2处：</p><p>第8行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.cross_validation import train_test_split</span><br></pre></td></tr></table></figure><p>改成</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.model_selection import train_test_split</span><br></pre></td></tr></table></figure><p>最后的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if 1:</span><br><span class="line">aa_ref2npy(ref_Data&#x3D;ref_Data,len_w&#x3D;len_w)</span><br></pre></td></tr></table></figure><p>注释掉</p><p>运行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(deephageTP) coconutnut@x86_64-apple-darwin13 DeephageTP-test % python DeephageTP_model_training.py</span><br><span class="line">Using TensorFlow backend.</span><br><span class="line">only amino acid code.</span><br><span class="line">now runing is DL_Train.</span><br><span class="line">nb_filters:  50</span><br><span class="line">kernel_s:  3</span><br><span class="line">n_batch:  10</span><br><span class="line">n_echos:  20</span><br><span class="line">dropout1:  0.1</span><br><span class="line">dropout2:  0.1</span><br><span class="line">ok! the npy file training_data.faa.X&#x2F;Y.npy are loaded!</span><br><span class="line">ok! all labels are in 4 kinds.</span><br><span class="line">27585</span><br><span class="line">now training for all, Be noted here no test part !!!</span><br><span class="line">[[1. 0. 0. 0.]</span><br><span class="line"> [1. 0. 0. 0.]</span><br><span class="line"> [1. 0. 0. 0.]</span><br><span class="line"> ...</span><br><span class="line"> [0. 0. 0. 1.]</span><br><span class="line"> [0. 0. 0. 1.]</span><br><span class="line"> [0. 0. 0. 1.]]</span><br><span class="line">2020-11-19 17:52:30.350217: I tensorflow&#x2F;core&#x2F;platform&#x2F;cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA</span><br><span class="line">To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.</span><br><span class="line">2020-11-19 17:52:30.350529: I tensorflow&#x2F;core&#x2F;common_runtime&#x2F;process_util.cc:115] Creating new thread pool with default inter op setting: 8. Tune using inter_op_parallelism_threads for best performance.</span><br><span class="line">Epoch 1&#x2F;20</span><br><span class="line"> 1250&#x2F;27585 [&gt;.............................] - ETA: 22:33 - loss: 0.5788 - accuracy: 0.8016</span><br></pre></td></tr></table></figure><p>太大了，不跑了</p><h1 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h1><p>训练部分 DeephageTP_model_training.py</p><h2 id="aa-ref2npy"><a href="#aa-ref2npy" class="headerlink" title="aa_ref2npy()"></a>aa_ref2npy()</h2><p>做one-hot编码用的</p><p>把蛋白质序列↓</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;UniRef100_A0A017QK57 PBSX family phage terminase large subunit n&#x3D;1 Tax&#x3D;Glaesserella parasuis str. Nagasaki TaxID&#x3D;1117322 RepID&#x3D;A0A017QK57_HAEPR 1</span><br><span class="line">MKIQLNLPPKLIPVFTQQNVRYRGAYGGRGSAKTRTFAKMTAVVAYQRAMQGESGVILCGREFMNSLEDSSLEEIKQAIQSEPWLTDFFEVGEKYVRTKCGRISYIFTGLRHNLDSIKSKARILLAWIDEAESVSEMAWRKLLPTVRENGSEIWLTWNPEKKGSATDLRFRQHQDESMAIVEMNYSDNPWFPDVLEQERLRDKARLDDATYRWIWEGAYLEQSEAQIFRDKFQELEFKPNGDFSGPYFGLDFGFAQDPTAAVKCWVFKDELYIEYEAGKVGLELDDTATFLQKGIVGIEQYVIRADSARPESISYLKRHGLPRIDGVSKWKGSVEDGIAHIKSYKKIYIHPRCQQTLNEFRLYSYKTDRLSGDILPVVLDENNHYIDALRYALEPLMKGRQSWFG</span><br></pre></td></tr></table></figure><p>one-hot编码，np.array格式，保存（分别存X和Y）</p><p>把X打出来看下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],  对应M</span><br><span class="line"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],  对应K</span><br><span class="line"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],  对应I</span><br><span class="line"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],</span><br><span class="line"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],</span><br><span class="line"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],</span><br><span class="line"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure><p>就是和蛋白质序列MKI…一一对应的one-hot编码（还是手动写死的）</p><p>大小是(900, 20)，和文中描述一样</p><p>这里Y是0，根据每个蛋白质第一行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;UniRef100_A0A017QK57 PBSX family phage terminase large subunit n&#x3D;1 Tax&#x3D;Glaesserella parasuis str. Nagasaki TaxID&#x3D;1117322 RepID&#x3D;A0A017QK57_HAEPR 1</span><br></pre></td></tr></table></figure><p>最后这个数字-1表示类别</p><p>如下面这个蛋白的类别是2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;UniRef100_A0A072NPV4 Phage terminase, small subunit n&#x3D;1 Tax&#x3D;Bacillus azotoformans MEV2011 TaxID&#x3D;1348973 RepID&#x3D;A0A072NPV4_BACAZ 3</span><br><span class="line">MAKDGTNRGGARVGAGAKKKPLTDKIAEGNPGGRKLTVMEFKDTADLKGLEMPEPNKMLEAIQKDGKALVAGEIYRNTWAWLNERGCAALVSPQLLERYAMSVARWIQCEEAVTEYGFLAKHPTTGNAIQSPYVAMGQNYMNQTNRLWMEIFQIVKENCTGEYSGINPQDDVMERLLTARRGK</span><br></pre></td></tr></table></figure><h2 id="DL-Train"><a href="#DL-Train" class="headerlink" title="DL_Train()"></a>DL_Train()</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DL_Train</span><span class="params">(ref_Data, len_w)</span>:</span></span><br><span class="line"><span class="comment"># 参数设置</span></span><br><span class="line">nb_filters = <span class="number">50</span></span><br><span class="line">kernel_s = <span class="number">3</span></span><br><span class="line">n_batch = <span class="number">10</span></span><br><span class="line">n_echos = <span class="number">20</span></span><br><span class="line">dropout1 = <span class="number">0.10</span></span><br><span class="line">dropout2 = <span class="number">0.10</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"now runing is DL_Train."</span>)</span><br><span class="line"><span class="comment"># end_lossrint("all is ended.")</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"nb_filters: "</span>, nb_filters)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"kernel_s: "</span>, kernel_s)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"n_batch: "</span>, n_batch)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"n_echos: "</span>, n_echos)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"dropout1: "</span>, dropout1)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"dropout2: "</span>, dropout2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理数据</span></span><br><span class="line">X2 = np.load(ref_Data + <span class="string">".X.npy"</span>)</span><br><span class="line">Y2 = np.load(ref_Data + <span class="string">".Y.npy"</span>)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"ok! the npy file "</span> + ref_Data + <span class="string">".X/Y.npy are loaded!"</span> )</span><br><span class="line">n_classes = <span class="number">4</span>    <span class="comment">#len(np.unique(Y))</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"ok! all labels are in "</span> + str(n_classes) + <span class="string">" kinds."</span> )</span><br><span class="line">YY_t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Y2:</span><br><span class="line">ll = np.zeros(n_classes)</span><br><span class="line">ll[i] = <span class="number">1</span></span><br><span class="line">YY_t.append(ll)</span><br><span class="line">YY_t = np.array(YY_t)</span><br><span class="line">print(len(YY_t))</span><br><span class="line">print(<span class="string">"now training for all, Be noted here no test part !!!"</span>)</span><br><span class="line">X_train = X2.reshape(<span class="number">-1</span>,<span class="number">1</span>,len_w,matrix_size)</span><br><span class="line">Y_train = YY_t</span><br><span class="line">print(Y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建模型</span></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Conv2D(filters=nb_filters,kernel_size=(<span class="number">7</span>,<span class="number">1</span>),padding=<span class="string">'same'</span>,input_shape=(<span class="number">1</span>,len_w,matrix_size),data_format=<span class="string">'channels_first'</span>))</span><br><span class="line">model.add(Activation(<span class="string">'relu'</span>))</span><br><span class="line">model.add(MaxPooling2D(pool_size=(<span class="number">3</span>,<span class="number">3</span>)))</span><br><span class="line">model.add(Dropout(dropout1))</span><br><span class="line">model.add(Flatten())</span><br><span class="line">model.add(Dense(<span class="number">100</span>,activation=<span class="string">'relu'</span>))</span><br><span class="line">model.add(Dropout(dropout2))</span><br><span class="line">model.add(Dense(n_classes,activation=<span class="string">'softmax'</span>))</span><br><span class="line">model.compile(loss=<span class="string">'categorical_crossentropy'</span>,optimizer=Adam(),metrics=[<span class="string">'accuracy'</span>])   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练模型</span></span><br><span class="line">model.fit(X_train,Y_train,batch_size=n_batch,epochs=n_echos,verbose=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存模型</span></span><br><span class="line">model.save(ref_Data + <span class="string">'.all.h5'</span>)</span><br><span class="line">print(<span class="string">"the model ("</span> + ref_Data + <span class="string">".all.h5) has saved!"</span>)</span><br></pre></td></tr></table></figure><h1 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h1><h3 id="1"><a href="#1" class="headerlink" title="#1"></a>#1</h3><p>第一次跑DeephageTP_model_training.py时遇到的bug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ModuleNotFoundError: No module named &#39;sklearn.cross_validation&#39;</span><br></pre></td></tr></table></figure><p>解决：</p><p><a href="https://blog.csdn.net/qq_35962520/article/details/85295228" target="_blank" rel="noopener">https://blog.csdn.net/qq_35962520/article/details/85295228</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># from sklearn.cross_validation import train_test_split # cross_validation不再使用，移至model_selection</span><br><span class="line">from sklearn.model_selection import train_test_split</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/chuym726/DeephageTP&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/chuym726/DeephageTP&lt;/a&gt;&lt;/
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="bioinformatics" scheme="http://yoursite.com/tags/bioinformatics/"/>
    
  </entry>
  
  <entry>
    <title>读论文笔记 DeephageTP</title>
    <link href="http://yoursite.com/2020/11/19/paper-note/"/>
    <id>http://yoursite.com/2020/11/19/paper-note/</id>
    <published>2020-11-19T07:39:03.000Z</published>
    <updated>2020-11-19T09:02:48.965Z</updated>
    
    <content type="html"><![CDATA[<p><strong>DeephageTP: A Convolutional Neural Network Framework for Identifying Phage-specific Proteins from metagenomic sequencing data<br> Running title: an alignment-free deep learning framework for identifying phage- specific proteins</strong></p><p>参考：原文 &amp; Github <a href="https://github.com/chuym726/DeephageTP" target="_blank" rel="noopener">https://github.com/chuym726/DeephageTP</a></p><hr><h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>3 specific proteins of the tailed phage:</p><ol><li>Portal (portal protein)</li><li>TerL (large terminase subunit protein) </li><li>TerS (small terminase subunit protein)</li></ol><p>Develop a <strong>CNN-based framework</strong> to identify these 3 proteins from <strong>metagenome data</strong></p><h1 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h1><h2 id="train-test-set"><a href="#train-test-set" class="headerlink" title="train/test set"></a>train/test set</h2><p>(原文位置：106-127行)</p><p>来源：Uniport(<a href="http://www.uniprot.org" target="_blank" rel="noopener">www.uniprot.org</a>)</p><p>预处理过程：</p><ol><li><p>从数据库中获取各类蛋白质序列</p><blockquote><p>according to the taxonomy in the UniProt database, all proteins in archaea, bacteria and viruses were obtained from the database;</p></blockquote><p>看example_data.fa文件，长这样：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;UniRef100_A0A017QK57 PBSX family phage terminase large subunit n&#x3D;1 Tax&#x3D;Glaesserella parasuis str. Nagasaki TaxID&#x3D;1117322 RepID&#x3D;A0A017QK57_HAEPR 1</span><br><span class="line">MKIQLNLPPKLIPVFTQQNVRYRGAYGGRGSAKTRTFAKMTAVVAYQRAMQGESGVILCGREFMNSLEDSSLEEIKQAIQSEPWLTDFFEVGEKYVRTKCGRISYIFTGLRHNLDSIKSKARILLAWIDEAESVSEMAWRKLLPTVRENGSEIWLTWNPEKKGSATDLRFRQHQDESMAIVEMNYSDNPWFPDVLEQERLRDKARLDDATYRWIWEGAYLEQSEAQIFRDKFQELEFKPNGDFSGPYFGLDFGFAQDPTAAVKCWVFKDELYIEYEAGKVGLELDDTATFLQKGIVGIEQYVIRADSARPESISYLKRHGLPRIDGVSKWKGSVEDGIAHIKSYKKIYIHPRCQQTLNEFRLYSYKTDRLSGDILPVVLDENNHYIDALRYALEPLMKGRQSWFG</span><br><span class="line">&gt;UniRef100_A0A017QKX8 PBSX family phage terminase large subunit n&#x3D;1 Tax&#x3D;Glaesserella parasuis str. Nagasaki TaxID&#x3D;1117322 RepID&#x3D;A0A017QKX8_HAEPR 1</span><br><span class="line">MKIQLNLPPKLIPVFTQQNVRYRGAYGGRGSAKTRTFAKMTAVVAYQRAMQGESGVILCGREFMNSLEDSSLEEIKQAIQSEPWLANFFDVGEKYVHTKCGRISYIFTGLRHNLDSIKSKARILLAWIDEAESVSEMAWRKLLPTVRESGSEIWLTWNPEKKGSATDLRFRQYQDESMAIVEMNYNDNPWFPDVLKQERLRDKARLDDATYRWIWEGDYLEESEAQVFRGKYQELEFKPLPDFEGPYHGLDFGFAQDPTAAIKCWVFKDELYIEYEAGKVGLELDDTATFLQKGIVGIEQYVIRADSARPESISYLKRHGLPRIDGVSKWKGSVEDGIAHIKSYKKIYIHPRCQQTLNEFRLYSYKTDRLSGDVLPTLVDAHNHYIDALRYALNPRIQRKGDFSQNPLKLY</span><br><span class="line">...</span><br></pre></td></tr></table></figure></li><li><p>去除无关数据</p><blockquote><p>the protein sequences were searched by the keywords (i.e., portal, large terminase subunit, and small terminase subunit), and the noise sequences with the uncertain keywords (e.g., hypothetical, possible, like, predicted) were removed to ensure that the selected protein sequences in the three categories are veracious;</p></blockquote></li><li><p>其它类过多，随机留一部分</p><blockquote><p>the remaining sequences without the keywords of interest (portal, large terminase subunit and, small terminase subunit) were labeled as the ‘others’ category. However, the size of the ‘others’ category is more than 75 times larger than that of the three categories. To relieve the class-imbalance problem brought by this situation, we randomly selected 20000 protein sequences  from the remaining sequences and labeled as the ‘others’ category;</p></blockquote></li><li><p>去除不正常长度的序列</p><blockquote><p>to further guarantee that the sequences from the database with the three categories are veracious, we calculated length distribution of these sequences (see Fig. S1), then manually checked the sequences with the abnormal length (&lt;5% and &gt; 95%) using Blastp (<a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi" target="_blank" rel="noopener">https://blast.ncbi.nlm.nih.gov/Blast.cgi</a>) against NCBI nr database, and the sequences without hitting to the targeted references were filtered out (almost all the sequences with abnormal length) and labeled as the ‘others’ category.</p></blockquote></li></ol><p>最终结果：</p><img src="/images/2020/screencapture2020-11-19 PM4.09.05.jpg"><h2 id="mimic-metagenomic-dataset"><a href="#mimic-metagenomic-dataset" class="headerlink" title="mimic metagenomic dataset"></a>mimic metagenomic dataset</h2><p>(原文位置：128-140行)</p><p>来源：UniRef100 (<a href="https://www.uniprot.org/uniref/" target="_blank" rel="noopener">https://www.uniprot.org/uniref/</a>)</p><p>处理过程和上面类似</p><p>且：2个数据库有重合，手动删除重合部分</p><p>用这组数据测试了模型在不同数据集大小上的表现效果</p><h2 id="virome-dataset"><a href="#virome-dataset" class="headerlink" title="virome dataset"></a>virome dataset</h2><p>(原文位置：141-147行)</p><p>用于测试模型在真实数据集上的结果</p><p>这组是原始数据，自行获取蛋白质序列</p><h2 id="3个数据集的用途"><a href="#3个数据集的用途" class="headerlink" title="3个数据集的用途"></a>3个数据集的用途</h2><p>(原文位置：193-197行 + Fig.1A)</p><ol><li>用train/test set训练模型，分析可行性</li><li>用mimic dataset测试cutoff value</li><li>用virome dataset测试真实效果</li></ol><blockquote><p>In summary, as shown in Fig. 1A, in this study, the proposed DeephageTP framework was firstly implemented on the training dataset for feasibility analysis, and then the trained model was applied on the mimic dataset for test and the cutoff value of each category of interest was determined according to the responding loss values distributions; finally, we applied the trained model on the real metagenomic datasets for examining the performance of our framework.</p></blockquote><img src="/images/2020/screencapture2020-11-19 PM3.47.08.jpg"><h1 id="蛋白质序列编码"><a href="#蛋白质序列编码" class="headerlink" title="蛋白质序列编码"></a>蛋白质序列编码</h1><p>(原文位置：148-161行)</p><p>方法：one-hot</p><p>对20个氨基酸进行one-hot编码，1个氨基酸占20位</p><img src="/images/2020/screencapture2020-11-19 PM4.20.48.jpg" width="300px"><p>L个氨基酸的蛋白质序列将被编码成 L * 20 的矩阵</p><p>输入需要固定，故设置最大长度为900，多了砍掉，少了填0</p><p>最终每个蛋白质序列都被编码成 900 * 20 的矩阵，作为输入</p><h1 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h1><h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><p>(原文位置：163-170行)</p><ol><li><p>输入层 (ReLu)</p></li><li><p>卷积层</p></li><li><p>最大池化层 (dropout)</p></li><li><p>全连接层1 (ReLu) (dropout)</p></li><li><p>全连接层2</p></li><li><p>输出层 (SoftMax)</p></li></ol><img src="/images/2020/screencapture2020-11-19 PM4.20.481.jpg"><h2 id="超参数选择"><a href="#超参数选择" class="headerlink" title="超参数选择"></a>超参数选择</h2><p>(原文位置：171-189行)</p><p>全连接单元数量、dropout rate、learning rate等的取值，大部分是常用的默认值；一些用5-fold cross-validation确定</p><p>20个氨基酸分成7组（根据dipole moments &amp; side-chain）： {A,G,V}, {I,L,F,P}, {Y,M,T,S}, {H,N,Q,W}, {R,K}, {D,E} and {C} -&gt; 卷积层filter大小设置为 7 * 1</p><h2 id="模型评估指标"><a href="#模型评估指标" class="headerlink" title="模型评估指标"></a>模型评估指标</h2><p>(原文位置：198-213行)</p><ul><li>Accuracy</li><li>Precision</li><li>Recall</li><li>F1-score</li></ul><h2 id="Loss计算"><a href="#Loss计算" class="headerlink" title="Loss计算"></a>Loss计算</h2><p>(原文位置：214-234行)</p><img src="/images/2020/screencapture2020-11-19 PM4.50.00.jpg"><p>yk 第k维的序列的真实标签</p><p>pk 第k维的序列的预测标签</p><h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>(原文位置：190-192行)</p><p>Python 3.6</p><p>Keras</p><p><a href="https://github.com/chuym726/DeephageTP" target="_blank" rel="noopener">https://github.com/chuym726/DeephageTP</a></p><h1 id="没看懂的"><a href="#没看懂的" class="headerlink" title="没看懂的"></a>没看懂的</h1><ol><li>cutoff value是做什么的？怎么算的？</li><li>loss怎么算的？</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;DeephageTP: A Convolutional Neural Network Framework for Identifying Phage-specific Proteins from metagenomic sequencing data&lt;br&gt;
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="bioinformatics" scheme="http://yoursite.com/tags/bioinformatics/"/>
    
  </entry>
  
  <entry>
    <title>读论文笔记 ANN to Detect Structural Proteins</title>
    <link href="http://yoursite.com/2020/11/13/reading-note/"/>
    <id>http://yoursite.com/2020/11/13/reading-note/</id>
    <published>2020-11-13T07:15:21.000Z</published>
    <updated>2020-11-14T03:27:08.465Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Artificial Neural Networks Trained to Detect Viral and Phage Structural Proteins</strong></p><h1 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h1><p>来源：GenBank’s non-redun- dant database</p><p>原始数据：</p><ul><li><p>正样本：6000+噬菌体结构蛋白序列</p></li><li><p>负样本：6000+噬菌体和原核基因组非结构蛋白序列</p></li></ul><p>处理后的网络输入：氨基酸百分比组成（人工标记每个样本是/不是结构蛋白）</p><p>目的：有一段新的序列，计算氨基酸百分比组成，输入网络，预测是否为结构蛋白</p><h1 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h1><h2 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h2><p>目标：找最佳的网络结构&amp;数据集划分</p><p>备选网络结构：</p><ul><li>隐藏层1，1~100个神经元</li><li>隐藏层2，1~30个神经元</li></ul><p>备选train/validation set划分：</p><ul><li>50:50, 60:40, 70:30, 80:20, 95:5</li></ul><p>验证方法：160-fold交叉验证（图3A画的是10-fold交叉验证的结果）</p><p>验证结果：</p><ol><li><p>输入层（20个输入单元）+ 1个隐藏层（90个神经元）+ 输出层（1个输出单元）表现最好，准确率85.6%</p></li><li><p>train/validation set划分80:20表现最好，准确率86.2%</p></li><li><p>由于没有很大差别，最终选了160个网络，投票决定</p></li></ol><h2 id="更多工作"><a href="#更多工作" class="headerlink" title="更多工作"></a>更多工作</h2><p>关注对结构蛋白亚类的分类结果，如：是否是衣壳结构蛋白</p><p>即输入数据的标记，原来标记是否为结构蛋白，现在标记是否为衣壳结构蛋白，重新训练网络，评估分类准确度</p><p>还做了针对古细菌和真核生物衣壳蛋白的</p><p>Isoelectric point？没看懂</p><h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><p>Neural Network Toolbox 7.0 in Matlab version 7.6.0.324</p><p>computations and data manipulations were done with Java, UNIX shell utilities, and Perl and Bash scripts</p><h1 id="web-interface"><a href="#web-interface" class="headerlink" title="web interface"></a>web interface</h1><p><a href="https://vdm.sdsu.edu/ivireons/" target="_blank" rel="noopener">https://vdm.sdsu.edu/ivireons/</a></p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>随便上Genbank找了一个序列<a href="https://www.ncbi.nlm.nih.gov/protein/SYW18879.1" target="_blank" rel="noopener">https://www.ncbi.nlm.nih.gov/protein/SYW18879.1</a></p><p>下载FASTA格式</p><p>sequence.fasta:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;SYW18879.1 putative transcriptional regulator (Immunity repressor; phage) [Oenococcus oeni]</span><br><span class="line">MENKPNIAKNIREIRIKEDLTQEKLAELSGLSINFVSRLERSNNQNVSINKLEAIASALKVDIWRLLKSN</span><br><span class="line">DSEINKKEFPLHTKILFDKLSEFDPERSDRISKTILSLLEELELKQK</span><br></pre></td></tr></table></figure><p>提交测试</p><img src="/images/2020/screencapture2020-11-14 AM11.19.45.jpg"><p><strong>Structural, MCP, &amp; Tail Protein Network Predictions</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">AnnotationStructural</span><br><span class="line">MCP 1:1</span><br><span class="line">MCP 2:1</span><br><span class="line">MCP 3:1</span><br><span class="line">MCP 4:1</span><br><span class="line">MCP 7:1</span><br><span class="line">MCP Lambda:1</span><br><span class="line">MCP Lambda2:1</span><br><span class="line">Tail 1:1</span><br><span class="line">Tail 2:1</span><br><span class="line">Tail 3:1</span><br><span class="line">Tail 4:1</span><br><span class="line">Tail 7:1</span><br><span class="line">Tail Lambda:1</span><br><span class="line">Tail Lambda2:1</span><br><span class="line">SDSSD MCP 1:1</span><br><span class="line">SD MCP 2:1</span><br><span class="line">SD MCP 3:1</span><br><span class="line">SD MCP 4:1</span><br><span class="line">SD MCP 7:1</span><br><span class="line">SD MCP Lambda:1</span><br><span class="line">SD MCP Lambda2:1</span><br><span class="line">SD Tail 1:1</span><br><span class="line">SD Tail 2:1</span><br><span class="line">SD Tail,3:1</span><br><span class="line">SD Tail 4:1</span><br><span class="line">SD Tail 7:1</span><br><span class="line">SD Tail Lambda:1</span><br><span class="line">SD Tail Lambda2:1</span><br></pre></td></tr></table></figure><p><strong>Percent Compositions and Isoelectric Point Estimates (last column)</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0.0427 0.0000 0.0513 0.1197 0.0342 0.0085 0.0085 0.1026 0.1197 0.1453 0.0085 0.0855 0.0256 0.0256 0.0598 0.1026 0.0256 0.0256 0.0085 0.0000 9.07</span><br></pre></td></tr></table></figure><p>根据<a href="http://vdm.sdsu.edu/ivireons/interpret.html" target="_blank" rel="noopener">interpret your results</a>的提示…没看懂</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Artificial Neural Networks Trained to Detect Viral and Phage Structural Proteins&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;数据&quot;&gt;&lt;a href=&quot;#数据&quot; class=&quot;he
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="bioinformatics" scheme="http://yoursite.com/tags/bioinformatics/"/>
    
  </entry>
  
  <entry>
    <title>AR Foundation笔记05 Gaze Interaction</title>
    <link href="http://yoursite.com/2020/09/28/note-arfoundation-05/"/>
    <id>http://yoursite.com/2020/09/28/note-arfoundation-05/</id>
    <published>2020-09-28T13:31:47.000Z</published>
    <updated>2020-09-28T15:49:36.200Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=OE66gtiF8QQ&amp;ab_channel=ThirdAurora" target="_blank" rel="noopener">https://www.youtube.com/watch?v=OE66gtiF8QQ&amp;ab_channel=ThirdAurora</a></p></blockquote><hr><h1 id="First-Try-Failed"><a href="#First-Try-Failed" class="headerlink" title="First Try (Failed)"></a>First Try (Failed)</h1><h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><p>start from : <a href="https://github.com/Third-Aurora/ARFoundationExample" target="_blank" rel="noopener">https://github.com/Third-Aurora/ARFoundationExample</a> </p><p>新建一个Project03，把Assets拷进去</p><p>资源管理器里+ARFoundation &amp; AR Core</p><p>切换平台到Android，一系列设置同笔记01</p><h2 id="Content-Parent"><a href="#Content-Parent" class="headerlink" title="Content Parent"></a>Content Parent</h2><p>已导入资源：</p><img src="/images/2020/screencapture2020-09-28 PM9.39.17.jpg" width=300><p>Content Parent -&gt; Cube xyz都改成0.5</p><p>创建空对象叫SectionInfo</p><p>创建3D Object Quad叫InfoParent</p><p>把SectionInfo拖高一点 Y-&gt;1.5</p><p>旋转InfoParent Y-&gt;180 缩放 X-&gt;2</p><h2 id="Materials"><a href="#Materials" class="headerlink" title="Materials"></a>Materials</h2><p>Assets中新建文件夹Materials</p><p>创建材质trans，拖到InfoParent上</p><p>颜色：Black 0.7Opacity</p><p>Rendering Mode：Transparent</p><p>另外创建一个blue材质，拖到cube上</p><h2 id="InfoParent"><a href="#InfoParent" class="headerlink" title="InfoParent"></a>InfoParent</h2><p>InfoParent下创建Cube，调整一下位置</p><img src="/images/2020/screencapture2020-09-28 PM9.50.14.jpg"><p>也用trans材质</p><p>创建Text - TextMeshPro，import TMP essentials</p><p>调整大小，文字居中，Auto Size（min 0，max 1000）</p><img src="/images/2020/screencapture2020-09-28 PM10.11.12.jpg"><p>InfoParent拖成和SectionInfo同级</p><p>拖动SectionInfo的锚点高度和Cube上方对齐</p><p>再把InfoParent拖进去</p><p>此时调整SetcionInfo Scale的y，牌子像从Box里出来</p><p>(Text -&gt; Extra Setting -&gt; Order in Layer改成1 )</p><h2 id="Script"><a href="#Script" class="headerlink" title="Script"></a>Script</h2><ol><li>让SectionInfo出现</li></ol><p>新建Script叫InfoBehavior，拖到Cube上</p><p>并把SetionInfo拖到变量上</p><img src="/images/2020/screencapture2020-09-28 PM10.42.07.jpg"><ol start="2"><li>SectionInfo旋转对准摄像头</li></ol><p>新建script叫FaceCamera</p><p>AR Camera标签为MainCamera</p><p>script拖到SectionInfo上</p><p>此时拖动camera，牌子就会跟着动了（不行就删了script然后重新拖进去）</p><img src="/images/2020/screencapture2020-09-28 PM11.18.36.jpg" width=400><ol start="3"><li>Gaze</li></ol><p>Cube加标签hasInfo</p><img src="/images/2020/screencapture2020-09-28 PM11.26.14.jpg" width=400><p>新建script叫Gaze，拖到MainCamera上</p><hr><p>测试并没有预期效果？</p><p>而且之前导入的一堆Assets并没有用到？</p><p>重新创建空白项目试试</p><hr><h1 id="Second-Try"><a href="#Second-Try" class="headerlink" title="Second Try"></a>Second Try</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=OE66gtiF8QQ&amp;amp;ab_channel=ThirdAurora&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="ar" scheme="http://yoursite.com/tags/ar/"/>
    
  </entry>
  
  <entry>
    <title>AR Foundation笔记04 Tap to Place Objects in AR</title>
    <link href="http://yoursite.com/2020/09/28/note-arfoundation-04/"/>
    <id>http://yoursite.com/2020/09/28/note-arfoundation-04/</id>
    <published>2020-09-28T13:05:16.000Z</published>
    <updated>2020-09-28T13:26:42.554Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=xguiSueY1Lw&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=5&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=xguiSueY1Lw&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=5&amp;ab_channel=DineshPunni</a></p></blockquote><hr><p>(接笔记03)</p><p>Create New Folder (Scripts)</p><p>Create C# Script</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.XR.ARFoundation;</span><br><span class="line">using UnityEngine.XR.ARSubsystems;</span><br><span class="line"></span><br><span class="line">[RequireComponent(typeof(ARRaycastManager))]</span><br><span class="line">public class ARTapToPlaceObject : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public GameObject gameObjectToInstantiate;</span><br><span class="line">    </span><br><span class="line">    private GameObject spawnedObject;</span><br><span class="line">    private ARRaycastManager arRaycastManager;</span><br><span class="line">    private Vector2 touchPosition;</span><br><span class="line">    </span><br><span class="line">    static List&lt;ARRaycastHit&gt; hits &#x3D; new List&lt;ARRaycastHit&gt;();</span><br><span class="line">    </span><br><span class="line">    private void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        arRaycastManager &#x3D; GetComponent&lt;ARRaycastManager&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    bool TryGetTouchPosition(out Vector2 touchPosition)</span><br><span class="line">    &#123;</span><br><span class="line">        if(Input.touchCount &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            touchPosition &#x3D; Input.GetTouch(0).position;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        touchPosition &#x3D; default;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(!TryGetTouchPosition(out Vector2 touchPosition))</span><br><span class="line">        &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if(arRaycastManager.Raycast(touchPosition,hits,TrackableType.PlaneWithinPolygon))</span><br><span class="line">        &#123;</span><br><span class="line">            var hitPose &#x3D; hits[0].pose;</span><br><span class="line">            </span><br><span class="line">            if(spawnedObject &#x3D;&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                spawnedObject &#x3D; Instantiate(gameObjectToInstantiate, hitPose.position, hitPose.rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                spawnedObject.transform.position &#x3D; hitPose.position;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>把Script拖进AR Session Origin</p><p>Create Cube拖进Prefabs，拖进GameObjectToInstantiate</p><img src="/images/2020/screencapture2020-09-28 PM9.20.08.jpg"><p>Build</p><img src="/images/2020/Screenshot_2020-09-28-21-25-16-503_com.coconutnut.jpg" width=400><p>Yeah~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=xguiSueY1Lw&amp;amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;amp;index=5&amp;amp;ab_channel=
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="ar" scheme="http://yoursite.com/tags/ar/"/>
    
  </entry>
  
  <entry>
    <title>AR Foundation笔记03 Plane Detection</title>
    <link href="http://yoursite.com/2020/09/28/note-arfoundation-03/"/>
    <id>http://yoursite.com/2020/09/28/note-arfoundation-03/</id>
    <published>2020-09-28T12:16:29.000Z</published>
    <updated>2020-09-28T13:05:02.587Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> <a href="https://www.youtube.com/watch?v=uWWiYfPTUtU&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=4&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=uWWiYfPTUtU&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=4&amp;ab_channel=DineshPunni</a></p></blockquote><hr><ol><li>add AR Plane Manager</li></ol><p>AR Session Origin-&gt; add component -&gt; AR Plane Manager</p><ol start="2"><li>Build your own plane object (or use prebuilt prefab)</li></ol><p>Create Empty Object</p><p>Add Components</p><img src="/images/2020/screencapture2020-09-28 PM8.44.02.jpg" width=400><p>Line Renderer</p><img src="/images/2020/screencapture2020-09-28 PM8.46.59.jpg" width=400><ol start="3"><li>Add material to Mesh Renderer</li></ol><p>Create a folder in Assets</p><p>Create Material</p><img src="/images/2020/screencapture2020-09-28 PM8.49.54.jpg"><p>Assign to Mesh Renderer</p><ol start="4"><li>Create prefab of this plane</li></ol><p>Create a folder (Prefabs)</p><p>Drag ARPlane to folder</p><p>Assign to AR Plane Manager</p><img src="/images/2020/screencapture2020-09-28 PM8.52.28.jpg"><ol start="5"><li>Build</li></ol><img src="/images/2020/Screenshot_2020-09-28-20-59-24-106_com.coconutnut.jpg" width=400><p>🧐很是迷惑</p><img src="/images/2020/Screenshot_2020-09-28-21-03-08-471_com.coconutnut.jpg" width=400><p>改了一下顺眼多了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=uWWiYfPTUtU&amp;amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;amp;index=4&amp;amp;ab_channel
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="ar" scheme="http://yoursite.com/tags/ar/"/>
    
  </entry>
  
  <entry>
    <title>AR Foundation笔记02 Image Tracking</title>
    <link href="http://yoursite.com/2020/09/26/note-arfoundation-02/"/>
    <id>http://yoursite.com/2020/09/26/note-arfoundation-02/</id>
    <published>2020-09-26T10:21:08.000Z</published>
    <updated>2020-09-26T10:49:32.732Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.youtube.com/watch?v=o_z_Eb8Yh2g&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=3&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=o_z_Eb8Yh2g&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=3&amp;ab_channel=DineshPunni</a></p></blockquote><hr><p>AR Session Origin -&gt; Add AR Tracked Image Manager</p><p>Assets -&gt; Create -&gt; XR -&gt; Reference Image Library</p><p>拖一张图到Assets里</p><p>Reference Library -&gt; Add Image 把图拖进去，填Physical Size</p><img src="/images/2020/screencapture2020-09-26 PM6.30.20.jpg"><p>AR Session Origin -&gt; 把Reference Library拖到AR Tracked Image Manager中</p><p>Assets -&gt; Create -&gt; C# Script -&gt; 重命名ImageRecognitionExample</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.XR.ARFoundation;</span><br><span class="line"></span><br><span class="line">public class NewBehaviourScript : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    private ARTrackedImageManager _arTrackedImageManager;</span><br><span class="line">    </span><br><span class="line">    private void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        _arTrackedImageManager &#x3D; FindObjectOfType&lt;ARTrackedImageManager&gt;();    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void OnEnable()</span><br><span class="line">    &#123;</span><br><span class="line">        _arTrackedImageManager.trackedImagesChanged +&#x3D; OnImageChanged;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void onDisable()</span><br><span class="line">    &#123;</span><br><span class="line">        _arTrackedImageManager.trackedImagesChanged -&#x3D; OnImageChanged;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void OnImageChanged(ARTrackedImagesChangedEventArgs args)</span><br><span class="line">    &#123;</span><br><span class="line">        foreach (var trackedImage in args.added)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(trackedImage.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Create 3D Object Cube，调整位置、大小</p><img src="/images/2020/screencapture2020-09-26 PM6.44.08.jpg"><p>拖进Assets（变成prefab），在SampleScene中删除</p><p>把prefab拖进AR Tracked Image Manager</p><p>Build</p><img src="/images/2020/Screenshot_2020-09-26-18-48-02-522_com.coconutnut.jpg" width=400><p>成功~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=o_z_Eb8Yh2g&amp;amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;amp;index=3&amp;amp;ab_channel=
      
    
    </summary>
    
    
      <category term="Note" scheme="http://yoursite.com/categories/Note/"/>
    
    
      <category term="ar" scheme="http://yoursite.com/tags/ar/"/>
    
  </entry>
  
</feed>
