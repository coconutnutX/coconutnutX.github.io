<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AR Foundationç¬”è®°04 Tap to Place Objects in AR</title>
    <url>/2020/09/28/note-arfoundation-04/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.youtube.com/watch?v=xguiSueY1Lw&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=5&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=xguiSueY1Lw&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=5&amp;ab_channel=DineshPunni</a></p>
</blockquote>
<hr>
<p>(æ¥ç¬”è®°03)</p>
<p>Create New Folder (Scripts)</p>
<p>Create C# Script</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.XR.ARFoundation;</span><br><span class="line">using UnityEngine.XR.ARSubsystems;</span><br><span class="line"></span><br><span class="line">[RequireComponent(typeof(ARRaycastManager))]</span><br><span class="line">public class ARTapToPlaceObject : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line">    public GameObject gameObjectToInstantiate;</span><br><span class="line">    </span><br><span class="line">    private GameObject spawnedObject;</span><br><span class="line">    private ARRaycastManager arRaycastManager;</span><br><span class="line">    private Vector2 touchPosition;</span><br><span class="line">    </span><br><span class="line">    static List&lt;ARRaycastHit&gt; hits &#x3D; new List&lt;ARRaycastHit&gt;();</span><br><span class="line">    </span><br><span class="line">    private void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        arRaycastManager &#x3D; GetComponent&lt;ARRaycastManager&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    bool TryGetTouchPosition(out Vector2 touchPosition)</span><br><span class="line">    &#123;</span><br><span class="line">        if(Input.touchCount &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            touchPosition &#x3D; Input.GetTouch(0).position;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        touchPosition &#x3D; default;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    void Update()</span><br><span class="line">    &#123;</span><br><span class="line">        if(!TryGetTouchPosition(out Vector2 touchPosition))</span><br><span class="line">        &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if(arRaycastManager.Raycast(touchPosition,hits,TrackableType.PlaneWithinPolygon))</span><br><span class="line">        &#123;</span><br><span class="line">            var hitPose &#x3D; hits[0].pose;</span><br><span class="line">            </span><br><span class="line">            if(spawnedObject &#x3D;&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                spawnedObject &#x3D; Instantiate(gameObjectToInstantiate, hitPose.position, hitPose.rotation);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                spawnedObject.transform.position &#x3D; hitPose.position;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠScriptæ‹–è¿›AR Session Origin</p>
<p>Create Cubeæ‹–è¿›Prefabsï¼Œæ‹–è¿›GameObjectToInstantiate</p>
<img src="/images/2020/screencapture2020-09-28 PM9.20.08.jpg">

<p>Build</p>
<img src="/images/2020/Screenshot_2020-09-28-21-25-16-503_com.coconutnut.jpg" width=400>

<p>Yeah~</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>ar</tag>
      </tags>
  </entry>
  <entry>
    <title>AR Foundationç¬”è®°03 Plane Detection</title>
    <url>/2020/09/28/note-arfoundation-03/</url>
    <content><![CDATA[<blockquote>
<p> <a href="https://www.youtube.com/watch?v=uWWiYfPTUtU&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=4&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=uWWiYfPTUtU&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=4&amp;ab_channel=DineshPunni</a></p>
</blockquote>
<hr>
<ol>
<li>add AR Plane Manager</li>
</ol>
<p>AR Session Origin-&gt; add component -&gt; AR Plane Manager</p>
<ol start="2">
<li>Build your own plane object (or use prebuilt prefab)</li>
</ol>
<p>Create Empty Object</p>
<p>Add Components</p>
<img src="/images/2020/screencapture2020-09-28 PM8.44.02.jpg" width=400>

<p>Line Renderer</p>
<img src="/images/2020/screencapture2020-09-28 PM8.46.59.jpg" width=400>

<ol start="3">
<li>Add material to Mesh Renderer</li>
</ol>
<p>Create a folder in Assets</p>
<p>Create Material</p>
<img src="/images/2020/screencapture2020-09-28 PM8.49.54.jpg">

<p>Assign to Mesh Renderer</p>
<ol start="4">
<li>Create prefab of this plane</li>
</ol>
<p>Create a folder (Prefabs)</p>
<p>Drag ARPlane to folder</p>
<p>Assign to AR Plane Manager</p>
<img src="/images/2020/screencapture2020-09-28 PM8.52.28.jpg">

<ol start="5">
<li>Build</li>
</ol>
<img src="/images/2020/Screenshot_2020-09-28-20-59-24-106_com.coconutnut.jpg" width=400>

<p>ğŸ§å¾ˆæ˜¯è¿·æƒ‘</p>
<img src="/images/2020/Screenshot_2020-09-28-21-03-08-471_com.coconutnut.jpg" width=400>

<p>æ”¹äº†ä¸€ä¸‹é¡ºçœ¼å¤šäº†</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>ar</tag>
      </tags>
  </entry>
  <entry>
    <title>AR Foundationç¬”è®°02 Image Tracking</title>
    <url>/2020/09/26/note-arfoundation-02/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.youtube.com/watch?v=o_z_Eb8Yh2g&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=3&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=o_z_Eb8Yh2g&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=3&amp;ab_channel=DineshPunni</a></p>
</blockquote>
<hr>
<p>AR Session Origin -&gt; Add AR Tracked Image Manager</p>
<p>Assets -&gt; Create -&gt; XR -&gt; Reference Image Library</p>
<p>æ‹–ä¸€å¼ å›¾åˆ°Assetsé‡Œ</p>
<p>Reference Library -&gt; Add Image æŠŠå›¾æ‹–è¿›å»ï¼Œå¡«Physical Size</p>
<img src="/images/2020/screencapture2020-09-26 PM6.30.20.jpg">

<p>AR Session Origin -&gt; æŠŠReference Libraryæ‹–åˆ°AR Tracked Image Managerä¸­</p>
<p>Assets -&gt; Create -&gt; C# Script -&gt; é‡å‘½åImageRecognitionExample</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">using System.Collections;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using UnityEngine;</span><br><span class="line">using UnityEngine.XR.ARFoundation;</span><br><span class="line"></span><br><span class="line">public class NewBehaviourScript : MonoBehaviour</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    private ARTrackedImageManager _arTrackedImageManager;</span><br><span class="line">    </span><br><span class="line">    private void Awake()</span><br><span class="line">    &#123;</span><br><span class="line">        _arTrackedImageManager &#x3D; FindObjectOfType&lt;ARTrackedImageManager&gt;();    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void OnEnable()</span><br><span class="line">    &#123;</span><br><span class="line">        _arTrackedImageManager.trackedImagesChanged +&#x3D; OnImageChanged;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void onDisable()</span><br><span class="line">    &#123;</span><br><span class="line">        _arTrackedImageManager.trackedImagesChanged -&#x3D; OnImageChanged;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void OnImageChanged(ARTrackedImagesChangedEventArgs args)</span><br><span class="line">    &#123;</span><br><span class="line">        foreach (var trackedImage in args.added)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(trackedImage.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Create 3D Object Cubeï¼Œè°ƒæ•´ä½ç½®ã€å¤§å°</p>
<img src="/images/2020/screencapture2020-09-26 PM6.44.08.jpg">

<p>æ‹–è¿›Assetsï¼ˆå˜æˆprefabï¼‰ï¼Œåœ¨SampleSceneä¸­åˆ é™¤</p>
<p>æŠŠprefabæ‹–è¿›AR Tracked Image Manager</p>
<p>Build</p>
<img src="/images/2020/Screenshot_2020-09-26-18-48-02-522_com.coconutnut.jpg" width=400>

<p>æˆåŠŸ~</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>ar</tag>
      </tags>
  </entry>
  <entry>
    <title>AR Foundationç¬”è®°01 å®‰å“Setup</title>
    <url>/2020/09/26/note-arfoundation-01/</url>
    <content><![CDATA[<blockquote>
<p> <a href="https://www.youtube.com/watch?v=0mpsiO2lCx0&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=1&amp;ab_channel=DineshPunni" target="_blank" rel="noopener">https://www.youtube.com/watch?v=0mpsiO2lCx0&amp;list=PL6VJLOFcTt7awvyIGIbLLPOBrW6-Y1R-J&amp;index=1&amp;ab_channel=DineshPunni</a></p>
</blockquote>
<hr>
<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>macOS Catalina 10.15.6</p>
<p>Unity Hub 2.3.10</p>
<p>Unity 2020.1.6f1c1</p>
<h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>File -&gt; Build Settings</p>
<p>åˆ‡æ¢å¹³å°åˆ°Android</p>
<p>-&gt; Player Settings</p>
<ol>
<li><p>Other Settings -&gt; æ”¹Package Name</p>
</li>
<li><p>Disable Multithread Rendering (Android doesnâ€™t support yet)</p>
</li>
<li><p>Graphics APIs -&gt; disable Vulkan</p>
</li>
<li><p>Minimun API level -&gt; 26</p>
</li>
</ol>
<h1 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h1><p>Window -&gt; Package Manager -&gt; Packages : Unity Registry</p>
<img src="/images/2020/screencapture2020-09-26 PM5.51.57.jpg" width=400>

<h1 id="Sample-Scene"><a href="#Sample-Scene" class="headerlink" title="Sample Scene"></a>Sample Scene</h1><ol>
<li><p>åˆ é™¤Main Camera</p>
</li>
<li><p>Right Click -&gt; XR -&gt; AR Session Origin</p>
<p>AR Camera æ ‡ç­¾ MainCamera</p>
</li>
<li><p>Right Click -&gt; XR -&gt; AR Session</p>
</li>
<li><p>Right Click -&gt; 3D Object -&gt; Cube<br>ä½ç½®æ”¹æˆ0ï¼Œ0ï¼Œ0<br>ç¼©æ”¾æ”¹æˆ0.2ï¼Œ0.2ï¼Œ0.2<br>éšä¾¿è½¬è½¬</p>
</li>
</ol>
<h1 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h1><p>æ‰‹æœº -&gt; å¼€å‘è€…æ¨¡å¼</p>
<p>è¿ä¸Š</p>
<p>File -&gt; Build Settings -&gt; Run Device -&gt; é€‰ä¸­æ‰‹æœº</p>
<p> Add Open Scene</p>
<p>Build and Run</p>
<img src="/images/2020/Screenshot_2020-09-26-18-10-31-833_com.coconutnut.jpg" width=400>

<p>æˆåŠŸ<del>~</del></p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>ar</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°å½•éƒ¨ç½²é™æ€é¡µé¢</title>
    <url>/2020/08/10/webpage/</url>
    <content><![CDATA[<p>æŠŠindex.htmlå’Œassetså‡†å¤‡å¥½</p>
<p>sshè¿ä¸ŠæœåŠ¡å™¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get install apache2</span><br></pre></td></tr></table></figure>

<p>æŠŠæ–‡ä»¶ä¼ åˆ°/var/www/html</p>
<p>ï¼ˆä¸€å¼€å§‹ä¼ æˆäº†/root/var/www/htmlï¼Œindex.htmlä¸€ç›´æ˜¾ç¤ºä¸å¯¹ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;apache2&#x2F;apache2.conf</span><br></pre></td></tr></table></figure>

<p>æœ€ååŠ ä¸€å¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ServerName ***.**.**.89</span><br></pre></td></tr></table></figure>

<p>ç„¶å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;apache2&#x2F;mods-available&#x2F;dir.conf</span><br></pre></td></tr></table></figure>

<p>æ”¹æˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;IfModule mod_dir.c&gt;</span><br><span class="line">DirectoryIndex  index.html</span><br><span class="line">&lt;&#x2F;IfModule&gt;</span><br></pre></td></tr></table></figure>

<p>é‡å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apache2ctl -k restart</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è®¿é—®</p>
<p><a href="http://xxx/index.html" target="_blank" rel="noopener">http://xxx/index.html</a></p>
<p>ok</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
  </entry>
  <entry>
    <title>è¯»ä¹¦ç¬”è®° å¤§è„‘ä¿®å¤æœ¯</title>
    <url>/2020/07/25/brain/</url>
    <content><![CDATA[<img src="/images/2020/brain1.png">

<img src="/images/2020/brain2.png">

<img src="/images/2020/brain3.png">

<img src="/images/2020/brain4.png">]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°å½•æœåŠ¡å™¨å®‰è£…Anaconda</title>
    <url>/2020/06/24/memo-python/</url>
    <content><![CDATA[<p>pyenvæ¯æ¬¡éƒ½è¦source ~/.bash_profileæ‰èƒ½ç”Ÿæ•ˆï¼Œæ‰å¿ƒï¼Œå¸äº†</p>
<p>ç°åœ¨ç¬”è®°æœ¬ä¸Šåº”è¯¥åªæœ‰ç³»ç»Ÿè‡ªå¸¦çš„2.7ï¼ˆå’Œæ²¡å¸å¹²å‡€çš„é—ç•™æ–‡ä»¶ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">coconutnut@Ss-MacBook-Pro ~ % python -V</span><br><span class="line">Python 2.7.17</span><br><span class="line">coconutnut@Ss-MacBook-Pro ~ % pip -V</span><br><span class="line">pip 19.3.1 from &#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;site-packages&#x2F;pip (python 2.7)</span><br></pre></td></tr></table></figure>

<p>æƒ³äº†ä¸‹å¹²è„†è£…æœåŠ¡å™¨ä¸Šå¥½äº†</p>
<hr>
<h1 id="å®‰è£…Anaconda"><a href="#å®‰è£…Anaconda" class="headerlink" title="å®‰è£…Anaconda"></a>å®‰è£…Anaconda</h1><blockquote>
<p><a href="https://blog.csdn.net/qq_41813258/article/details/102400325" target="_blank" rel="noopener">https://blog.csdn.net/qq_41813258/article/details/102400325</a></p>
</blockquote>
<blockquote>
<p><a href="https://repo.anaconda.com/archive/" target="_blank" rel="noopener">https://repo.anaconda.com/archive/</a></p>
</blockquote>
<p>å®˜ç½‘ä¸‹äº†ä¸ªæœ€æ–°ç‰ˆanaconda3-2020.02-linux-x86_64.sh/</p>
<p>bashå®‰è£…ï¼Œé…ç½®ç¯å¢ƒå˜é‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># conda -V</span><br><span class="line">conda 4.8.2</span><br></pre></td></tr></table></figure>

<p>å®Œæˆ</p>
<p>åˆ›å»ºä¸€ä¸ª3.7.6çš„ç¯å¢ƒ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># conda create -n env3.7 python&#x3D;3.7.6</span><br><span class="line">...</span><br><span class="line">#</span><br><span class="line"># To activate this environment, use</span><br><span class="line">#</span><br><span class="line">#     $ conda activate env3.7</span><br><span class="line">#</span><br><span class="line"># To deactivate an active environment, use</span><br><span class="line">#</span><br><span class="line">#     $ conda deactivate</span><br></pre></td></tr></table></figure>

<h1 id="é…ç½®Jupyter-notebook"><a href="#é…ç½®Jupyter-notebook" class="headerlink" title="é…ç½®Jupyter notebook"></a>é…ç½®Jupyter notebook</h1><blockquote>
<p><a href="https://blog.csdn.net/qq_43058685/article/details/103804238" target="_blank" rel="noopener">https://blog.csdn.net/qq_43058685/article/details/103804238</a></p>
</blockquote>
<p>ç«¯å£é…çš„2020</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jupyter notebook --ip&#x3D;0.0.0.0 --no-browser --allow-root</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è¯•äº†ä¸€ä¸‹ï¼Œok</p>
<h1 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æ‰“å¼€jupyter notebook</span><br><span class="line">jupyter notebook --allow-root</span><br><span class="line"></span><br><span class="line"># åå°è¿è¡Œ</span><br><span class="line">nohup jupyter notebook --allow-root &amp;</span><br><span class="line"></span><br><span class="line"># æ‰¾åˆ°jupyterè¿›ç¨‹</span><br><span class="line">ps aux | grep jupyter</span><br><span class="line"></span><br><span class="line"># å…³é—­å®ƒ</span><br><span class="line">kill XXX(pid)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>memo</category>
      </categories>
  </entry>
  <entry>
    <title>è¯»ä¹¦ç¬”è®° æ¨èç³»ç»Ÿå®è·µ</title>
    <url>/2020/06/24/recommender-system/</url>
    <content><![CDATA[<img src="/images/2020/recommendation_system.png">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬”è®° æ¨èç³»ç»Ÿ</title>
    <url>/2020/06/23/recommendation/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av30578499/" target="_blank" rel="noopener">https://www.bilibili.com/video/av30578499/</a></p>
</blockquote>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><img src="/images/2020/screencapture2020-06-23 AM9.48.46.jpg">

<h1 id="ä¼ ç»Ÿæ¨èç³»ç»Ÿ"><a href="#ä¼ ç»Ÿæ¨èç³»ç»Ÿ" class="headerlink" title="ä¼ ç»Ÿæ¨èç³»ç»Ÿ"></a>ä¼ ç»Ÿæ¨èç³»ç»Ÿ</h1><p>Content-basedï¼šunstructuredï¼Œæ–‡å­—ã€å›¾åƒç­‰ï¼Œéœ€ç†è§£è¯­ä¹‰ã€æå–å¤§é‡ç‰¹å¾ï¼Œç®—æ³•å¤æ‚å»¶è¿Ÿé«˜</p>
<p>Collaborative filteringååŒè¿‡æ»¤ï¼šåŸºäºUserã€Itemå†å²ï¼Œå¦‚ç‚¹å‡»æ˜¯1ã€ä¸ç‚¹å‡»æ˜¯0</p>
<p>Demographicï¼šåœ°åŸŸä¿¡æ¯</p>
<p>Knowledge-basedï¼šæ ¹æ®ä¸“ä¸šçŸ¥è¯†</p>
<p>Community-basedï¼šç±»ä¼¼Content-basedï¼Œå¦‚ç¤¾äº¤ç½‘ç»œã€äººç¾¤å…´è¶£</p>
<p>Hybridï¼šç»¼åˆ</p>
<h2 id="ååŒè¿‡æ»¤"><a href="#ååŒè¿‡æ»¤" class="headerlink" title="ååŒè¿‡æ»¤"></a>ååŒè¿‡æ»¤</h2><img src="/images/2020/screencapture2020-06-23 AM9.52.31.jpg">

<p>åŸºäºç›¸ä¼¼Useråˆ¤æ–­</p>
<p>è®¡ç®—ç›¸ä¼¼æ€§ </p>
<ul>
<li>Memery-based<ul>
<li>Item-based å¦‚ï¼ŒæŠŠItemè½¬æˆçŸ©é˜µè®¡ç®—ç›¸ä¼¼æ€§</li>
<li>User-based</li>
</ul>
</li>
<li>Model-based å»ºç«‹Userå’ŒItemçš„æ–¹ç¨‹ï¼Œç»™å®šä¸€ä¸ªUserå’ŒItemè¿”å›ä¸€ä¸ªåˆ†æ•°</li>
</ul>
<img src="/images/2020/screencapture2020-06-23 AM9.55.53.jpg">

<p>æ€æƒ³ï¼šæ ¹æ®User-Item RatingçŸ©é˜µï¼Œå­¦åˆ°Userå’ŒItemä½ç»´çš„ç‰¹å¾è¡¨ç¤ºï¼Œç”¨å®ƒè®¡ç®—ç›¸ä¼¼æ€§</p>
<p>è´­ä¹°ä¸º1ï¼Œç‚¹å‡»æœªè´­ä¹°ä¸º0ï¼Œå‰©ä¸‹è¡¥0</p>
<p>çŸ©é˜µåˆ†è§£ï¼šé™ç»´ æ‰¾ä¸€ä¸ªçŸ©é˜µä»£è¡¨Userï¼Œä¸€ä¸ªä»£è¡¨Itemï¼Œç›¸ä¹˜å¾—åˆ°</p>
<p>å¯åšRegularization</p>
<h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>Easy to implementï¼Œç³»ç»Ÿç®€å•ï¼Œå“åº”å¿«</li>
<li>Content-independentï¼Œä¸ç”¨æˆ·å…¶å®ƒç‰¹å¾æ— å…³ï¼Œä¸éœ€è¦è·å–è¿™äº›ä¿¡æ¯å³å¯å®ç°</li>
</ul>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>æ•°æ®ç¨€ç–</li>
<li>Cold-start problem å¦‚æ–°ç”¨æˆ·ç‰¹å¾å‘é‡å…¨0ï¼Œæ— æ³•è®¡ç®—</li>
<li>Do not consider content</li>
</ul>
<h1 id="æ·±åº¦å­¦ä¹ "><a href="#æ·±åº¦å­¦ä¹ " class="headerlink" title="æ·±åº¦å­¦ä¹ "></a>æ·±åº¦å­¦ä¹ </h1><p>ä¼˜åŠ¿ï¼šè¡¨å¾èƒ½åŠ›å¼ºã€ä¸éœ€è¦åšç‰¹å¾å·¥ç¨‹ã€</p>
<p>å…ˆåˆ›å»ºæ·±åº¦å­¦ä¹ çš„ç½‘ç»œç»“æ„å®ç°ååŒè¿‡æ»¤ï¼Œå†åŠ å…¥Content-based</p>
<h2 id="Neural-Collaborative-filtering"><a href="#Neural-Collaborative-filtering" class="headerlink" title="Neural Collaborative filtering"></a>Neural Collaborative filtering</h2><img src="/images/2020/screencapture2020-06-23 AM11.29.37.jpg">

<ul>
<li><p>Embedding Layers</p>
<ul>
<li>æŠŠä»»ä½•ä¸€ä¸ªUserã€Itemå˜æˆä¸€ä¸ªä½ç»´å‘é‡</li>
<li>One-Hot Encoding</li>
</ul>
</li>
<li><p>Neural CF Layers</p>
<ul>
<li>åšçŸ©é˜µåˆ†è§£</li>
<li>å¯ä»¥åŠ éšè—å±‚ï¼Œå­¦ä¹ éçº¿æ€§è¡¨å¾</li>
</ul>
</li>
</ul>
<h2 id="Neural-Matrix-Factorization-Model"><a href="#Neural-Matrix-Factorization-Model" class="headerlink" title="Neural Matrix Factorization Model"></a>Neural Matrix Factorization Model</h2><img src="/images/2020/screencapture2020-06-23 AM11.36.27.jpg">

<p>çº¿æ€§çš„å’Œéçº¿æ€§çš„ç»“åˆåˆ°ä¸€èµ·</p>
<p>é—®é¢˜ï¼šæ²¡æœ‰Content-basedï¼Œå¸Œæœ›åŠ å…¥æ‰‹å·¥æå–çš„ç‰¹å¾</p>
<h2 id="Wide-Deep-Neural-Network"><a href="#Wide-Deep-Neural-Network" class="headerlink" title="Wide Deep Neural Network"></a>Wide Deep Neural Network</h2><p>Wideéƒ¨åˆ†è¾“å…¥æ‰‹å·¥ç‰¹å¾å·¥ç¨‹çš„ç»“æœï¼Œå¦‚ï¼šå¹´é¾„ã€å†å²è®°å½•</p>
<p>Deepéƒ¨åˆ†æ˜¯Userã€Item</p>
<p>æœ€åç»“åˆåˆ°ä¸€èµ·åšå‡ºé¢„æµ‹</p>
<p>Eg: Google Play</p>
<img src="/images/2020/screencapture2020-06-23 AM11.41.51.jpg">

<h2 id="ä¼ ç»Ÿçš„-Factorization-Machines"><a href="#ä¼ ç»Ÿçš„-Factorization-Machines" class="headerlink" title="ä¼ ç»Ÿçš„ Factorization Machines"></a>ä¼ ç»Ÿçš„ Factorization Machines</h2><p>ç›´æ¥å¯¹äº§å“çš„ç±»å‹ä¿¡æ¯åšOne-Hot Encoding</p>
<img src="/images/2020/screencapture2020-06-23 AM11.48.13.jpg">

<p>ç‰¹å¾äº¤å‰ å¦‚æ€§åˆ«=ç”·ï¼Œå¹´é¾„=20 æŠŠå¯¹åº”çš„ç»´ç›¸ä¹˜ï¼Œæ•°æ®è¿‡å¤§æ˜¯éš¾å¤„ç†</p>
<p>ç”¨çŸ©é˜µåˆ†è§£çš„æ€æƒ³ï¼Œwijå˜æˆ&lt;vi,vj&gt;ï¼Œå…¶ä¸­vi,vjéƒ½æ˜¯ä½ç»´å‘é‡</p>
<p>å˜å½¢ç‰ˆæœ¬ï¼š</p>
<h3 id="Field-aware-Factorization-Machines"><a href="#Field-aware-Factorization-Machines" class="headerlink" title="Field-aware Factorization Machines"></a>Field-aware Factorization Machines</h3><img src="/images/2020/screencapture2020-06-23 AM11.53.47.jpg">

<p>è€ƒè™‘ç‰¹å¾æ˜¯æ¥è‡ªå“ªé‡Œçš„</p>
<p>æ¯ä¸€ä¸ªç‰¹å¾ï¼Œä¸å…¶ä»–ç±»åˆ«äº¤å‰æ—¶ï¼Œæœ‰ä¸€ä¸ªä¸ä¸€æ ·çš„ä¾èµ–å‘é‡</p>
<h2 id="Deep-Factorization-Machines"><a href="#Deep-Factorization-Machines" class="headerlink" title="Deep Factorization Machines"></a>Deep Factorization Machines</h2><img src="/images/2020/screencapture2020-06-23 AM11.56.26.jpg">

<p>å·¦ä¾§ï¼šä¼ ç»Ÿéƒ¨åˆ†</p>
<p>æ¯ä¸ªç§ç±»åšEmbedding</p>
<p>ä¸ºäº†å®ç°äº¤å‰ï¼Œä¸¤ä¸¤åšç‰¹å¾äº¤å‰</p>
<p>çº¿æ€§éƒ¨åˆ†ï¼Œæ±‚å’Œï¼ˆæœ€å·¦çš„+ï¼‰</p>
<p>å³ä¾§ï¼šæ·±åº¦éƒ¨åˆ†</p>
<p>ç¾å›¢çš„æµ‹è¯•ç»“æœï¼š</p>
<img src="/images/2020/screencapture2020-06-23 AM11.58.58.jpg">

<p>Wide &amp; Deep è¦åšç‰¹å¾å·¥ç¨‹ï¼ŒDeepFM åšäº†ä¸€é˜¶ã€äºŒé˜¶çš„ç‰¹å¾äº¤å‰ï¼ŒåŒæ—¶ç”¨Deepç¥ç»ç½‘ç»œåšç‰¹å¾å·¥ç¨‹</p>
<h2 id="Deep-Cooperative-Neural-Network"><a href="#Deep-Cooperative-Neural-Network" class="headerlink" title="Deep Cooperative Neural Network"></a>Deep Cooperative Neural Network</h2><p>å·ç§¯ç¥ç»ç½‘ç»œ</p>
<p>æ¶‰åŠå›¾ç‰‡ã€æ–‡å­—æ—¶å¯å‚è€ƒ</p>
<img src="/images/2020/screencapture2020-06-23 PM12.09.24.jpg">

<p>Word-Embedding æŠŠæ¯ä¸ªå•è¯æ˜ å°„æˆå‘é‡ï¼ˆGoogle : word2vecï¼‰</p>
<p>æœ€åå¾—åˆ°Userè®°å½•çš„ä½ç»´è¡¨ç¤ºï¼ŒItemæè¿°çš„ä½ç»´è¡¨ç¤º</p>
<h2 id="Recurrent-Neural-Network"><a href="#Recurrent-Neural-Network" class="headerlink" title="Recurrent Neural Network"></a>Recurrent Neural Network</h2><img src="/images/2020/screencapture2020-06-23 PM1.22.14.jpg">

<p>ç»™ä¸€ä¸ªinputï¼Œæ˜ å°„æˆä½ç»´å‘é‡ï¼Œè¾“å‡ºoutput</p>
<p>åŒæ—¶åå¤è‡ªå·±è¿­ä»£</p>
<p>å¯å­¦ä¹ ä¸æ—¶é—´æœ‰å…³çš„ä¿¡æ¯ï¼Œå¦‚ä¸éœ€è¦loginçš„ç½‘ç«™ä¸Šç”¨æˆ·ç‚¹å‡»çš„è¡Œä¸º</p>
<h3 id="Session-based-Recommendation-with-RNN"><a href="#Session-based-Recommendation-with-RNN" class="headerlink" title="Session-based Recommendation with RNN"></a>Session-based Recommendation with RNN</h3><img src="/images/2020/screencapture2020-06-23 PM1.25.03.jpg">

<p>é¢„æµ‹ç”¨æˆ·ä¸‹ä¸€æ­¥è¡Œä¸º</p>
<h1 id="å¼ºåŒ–å­¦ä¹ "><a href="#å¼ºåŒ–å­¦ä¹ " class="headerlink" title="å¼ºåŒ–å­¦ä¹ "></a>å¼ºåŒ–å­¦ä¹ </h1><p>å› ä¸ºç”¨æˆ·è¡Œä¸ºéšæ—¶åœ¨å˜åŒ–ï¼Œä¼ ç»Ÿæ¨èç³»ç»Ÿæ— æ³•å®æ—¶åšå‡ºè°ƒæ•´</p>
<img src="/images/2020/screencapture2020-06-23 PM1.27.37.jpg">

<p>Stateå¯ä»¥æ˜¯ç”¨æˆ·çš„ç‚¹å‡»è¡Œä¸º</p>
<p>Rewardå¯ä»¥æ˜¯ç‚¹å‡»äº†æ¨èçš„äº§å“</p>
<p>æ ¹æ®å½“å‰çš„Stateå’ŒRewardè¿”å›ä¸‹ä¸€æ­¥Action</p>
<p>ç”¨æˆ·å¯¹Actionåšå‡ºååº”ï¼Œå¾—åˆ°æ–°çš„Stateå’ŒReward</p>
<p>é˜¿é‡Œçš„ä¾‹å­ï¼š</p>
<img src="/images/2020/screencapture2020-06-23 PM1.30.26.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
  </entry>
  <entry>
    <title>é¡¹ç›®Debugè®°å½•</title>
    <url>/2020/06/16/debug/</url>
    <content><![CDATA[<h1 id="æ‰¾ä¸åˆ°â€™xmlModelPluginâ€™"><a href="#æ‰¾ä¸åˆ°â€™xmlModelPluginâ€™" class="headerlink" title="æ‰¾ä¸åˆ°â€™xmlModelPluginâ€™"></a>æ‰¾ä¸åˆ°â€™xmlModelPluginâ€™</h1><p>05.30</p>
<p>cloneçš„å·¥ç¨‹å¯åŠ¨å¤±è´¥ï¼Œæ§åˆ¶å°æŠ¥é”™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Error starting ApplicationContext. To display the conditions report re-run your application with &#39;debug&#39; enabled.</span><br><span class="line">2020-05-30 10:57:39.476 ERROR 1335 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;xmlModelPlugin&#39;: Lookup method resolution failed; nested exception is java.lang.IllegalStateException: Failed to introspect Class [springfox.documentation.schema.XmlModelPlugin] from ClassLoader [jdk.internal.loader.ClassLoaders$AppClassLoader@3d4eac69]</span><br><span class="line">	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.determineCandidateConstructors(AutowiredAnnotationBeanPostProcessor.java:289) ~[spring-beans-5.2.5.RELEASE.jar:5.2.5.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.determineConstructorsFromBeanPostProcessors(AbstractAutowireCapableBeanFactory.java:1286) ~[spring-beans-5.2.5.RELEASE.jar:5.2.5.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1201) ~[spring-beans-5.2.5.RELEASE.jar:5.2.5.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557) ~[spring-beans-5.2.5.RELEASE.jar:5.2.5.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) ~[spring-beans-5.2.5.RELEASE.jar:5.2.5.RELEASE]</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>è§£å†³</p>
<p>æ·»åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="åŠ è½½ymlæ–‡ä»¶é”™è¯¯"><a href="#åŠ è½½ymlæ–‡ä»¶é”™è¯¯" class="headerlink" title="åŠ è½½ymlæ–‡ä»¶é”™è¯¯"></a>åŠ è½½ymlæ–‡ä»¶é”™è¯¯</h1><p>06.12</p>
<p>ä»Šå¤©æ–°pullçš„å·¥ç¨‹æ‰“ä¸å¼€</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java.lang.IllegalStateException: Failed to load property source from location &#39;classpath:&#x2F;bootstrap.yml&#39;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹target -&gt; classes -&gt; bootstrap.yml</p>
<p>å‘ç°ä¸€ä¸ªmainè¢«ç”»äº†æ³¢æµªçº¿ï¼Œè¯´é‡å¤å®šä¹‰</p>
<p>å‘ç°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">main:</span><br><span class="line">  allow-bean-definition-overriding: true</span><br></pre></td></tr></table></figure>

<p>å†™äº†2æ¬¡</p>
<p>æ³¨é‡Šæ‰ä¸€ä¸ªå°±å¥½äº†</p>
<h1 id="æ‰¾ä¸åˆ°â€™springSecurityFilterChainâ€™"><a href="#æ‰¾ä¸åˆ°â€™springSecurityFilterChainâ€™" class="headerlink" title="æ‰¾ä¸åˆ°â€™springSecurityFilterChainâ€™"></a>æ‰¾ä¸åˆ°â€™springSecurityFilterChainâ€™</h1><p>06.16</p>
<p>æ–°pullçš„åˆæ‰“ä¸å¼€äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;springSecurityFilterChain&#39;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™é‡Œçš„ä¸€ä¸ªå›ç­”</p>
<blockquote>
<p><a href="https://github.com/spring-guides/tut-spring-boot-oauth2/issues/68" target="_blank" rel="noopener">https://github.com/spring-guides/tut-spring-boot-oauth2/issues/68</a></p>
</blockquote>
<p>åŠ ä¸Šäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.glassfish.jaxb&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;jaxb-runtime&lt;&#x2F;artifactId&gt;</span><br><span class="line">  &lt;version&gt;2.3.0&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt;</span><br><span class="line">  &lt;!-- JAXB needs javax.activation module (jdk9) --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;javax.activation&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;javax.activation-api&lt;&#x2F;artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.2.0&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸå¯åŠ¨</p>
]]></content>
      <categories>
        <category>Debug</category>
      </categories>
  </entry>
  <entry>
    <title>äº”æœˆæ¯æ—¥ä¸€é¢˜æ‰“å¡å®Œå·¥çºªå¿µ</title>
    <url>/2020/05/31/memo/</url>
    <content><![CDATA[<img src="/images/2020/screencapture2020-05-31 AM10.18.55.jpg" width=300>

<p>å±…ç„¶å‡ºå¾½ç« äº†ï¼Œå¤ªæˆ³æˆ‘äº†</p>
<img src="/images/2020/screencapture2020-05-31 AM10.19.04.jpg" width=300>]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>Ankiä¹Ÿå¤ªä¼˜ç§€äº†å§ï¼</title>
    <url>/2020/05/12/memo/</url>
    <content><![CDATA[<p>ä»¥å‰çœ‹å‰§çš„æ—¶å€™å–œæ¬¢æˆªå±ï¼ŒæŠŠä¸è®¤è¯†çš„è¯è®°å½•ä¸‹æ¥ï¼Œé›¶é›¶æ•£æ•£å±¯äº†å¥½å¤šè¯</p>
<img src="/images/2020/screencapture2020-05-12 PM11.34.40.jpg">

<p>ä½†æ˜¯å¹¶ä¸å¥½å¤ä¹ ï¼ŒèƒŒå•è¯çš„æ—¶å€™è¿˜æ˜¯ä¸è®¤è¯†</p>
<p>è€ŒAnkiï¼åŠ ä¸ŠImage Occlusion Enhancedæ’ä»¶ï¼å®Œç¾è§£å†³ï¼</p>
<img src="/images/2020/screencapture2020-05-12 PM11.37.57.jpg">

<p>æ‹–ä¸ªæ¡†é®ä½å•è¯å°±å¥½äº†ï¼Œå†åœ¨headeré‡Œé¢å¡«ä¸Šå•è¯</p>
<p>ä»¥åçš„å¤ä¹ å®‰æ’å°±ä¸ç”¨è‡ªå·±ç®¡äº†~</p>
<img src="/images/2020/screencapture2020-05-12 PM11.38.57.jpg">

<p>ä¸€ä¸ªé—®é¢˜æ˜¯headeré‡Œå¡«çš„å•è¯ä¼šåœ¨å¤ä¹ æ—¶æ˜¾ç¤º</p>
<p>ä½†æ˜¯ï¼</p>
<p>è¿˜èƒ½ç¼–è¾‘å¡ç‰‡æ¨¡æ¿æ˜¯ä»€ä¹ˆç¥ä»™åŠŸèƒ½å•Šï¼æ³¨é‡Šæ‰headerå°±è¡Œäº†å—·~</p>
<img src="/images/2020/screencapture2020-05-12 PM11.41.31.jpg">

<p>å¤ªç¾å¦™äº†å¿«ä¹å¾—åŸåœ°è½¬åœˆ~</p>
<p>ä»¿ä½›èƒ½çœ‹è§æ—¥åè¹­è¹­å¢é•¿çš„è¯æ±‡é‡</p>
<p>æˆ‘çˆ±AnkiğŸ˜ğŸ˜ğŸ˜</p>
<hr>
<p>å‘ç°ç°åœ¨çœŸçš„æ˜¯ç”¨äº†å¥½å¤šæ•ˆç‡è½¯ä»¶ï¼Œç®€ç›´æ˜¯å¼ºè¿«ç—‡ï¼Œä¸ºäº†æ‰¾ä¸ªæ»¡æ„çš„èƒ½ä»å®‰å“åº”ç”¨å•†åº—åˆ°App Storeåˆ°Google Playç¿»ä¸ªéï¼Œå°¤å…¶æ˜¯èƒŒå•è¯å’Œä»»åŠ¡ç®¡ç†ï¼Œæ‰‡è´ä¸èƒŒç™¾è¯æ–©ã€æ»´ç­”ToDoæ°´æ»´â€¦æœ€åå‰©ä¸‹çš„éƒ½æ˜¯ç°åœ¨æœ€å–œæ¬¢çš„ï¼Œä¸çŸ¥é“ä»¥åè¿˜èƒ½ä¸èƒ½å‘ç°æ›´å¥½çš„~</p>
<ul>
<li>æ—¥ç¨‹ç®¡ç†ï¼šAppleè‡ªå¸¦çš„æ—¥å†ğŸ“…</li>
<li>ä»»åŠ¡ç®¡ç†ï¼šTrello</li>
<li>èƒŒå•è¯ï¼šå¢¨å¢¨</li>
<li>èƒŒè¯—ï¼šå¹´è½®ï¼ˆä¼°è®¡è¦è½¬ç§»åˆ°Ankiäº†å“ˆå“ˆï¼‰</li>
<li>ä¹ æƒ¯æ‰“å¡ï¼šDot Habitï¼ˆè¿˜æ²¡ç”¨åˆ°ä¸€ä¸ªæœˆï¼Œå¾…å®šï¼‰</li>
</ul>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
  </entry>
  <entry>
    <title>pyenvé…ç½®ä¸ç”Ÿæ•ˆ</title>
    <url>/2020/05/07/debug/</url>
    <content><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>ä»¥å‰è£…è¿‡pyenvï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨</p>
<p>ä»Šå¤©ç”¨çš„æ—¶å€™å‘ç°é…ç½®çš„ç‰ˆæœ¬æ²¡æœ‰ç”Ÿæ•ˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">coconutnut@Ss-MacBook-Pro ~ % pyenv versions</span><br><span class="line">* system (set by &#x2F;Users&#x2F;coconutnut&#x2F;.pyenv&#x2F;version)</span><br><span class="line">  3.7.4</span><br><span class="line">coconutnut@Ss-MacBook-Pro ~ % pyenv global 3.7.4</span><br><span class="line">coconutnut@Ss-MacBook-Pro ~ % python -V</span><br><span class="line">Python 2.7.17</span><br></pre></td></tr></table></figure>

<h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><blockquote>
<p><a href="https://blog.csdn.net/vencent7/article/details/76849849" target="_blank" rel="noopener">https://blog.csdn.net/vencent7/article/details/76849849</a></p>
</blockquote>
<p>ä¹Ÿè®¸æ˜¯ä»¥å‰è£…Jupiteræˆ–è€…ç”¨Tensorflowçš„æ—¶å€™æŠŠç¯å¢ƒæåäº†ï¼Ÿ</p>
<p>è¯•è¯•æŠŠpyenvçš„é…ç½®æ”¾åœ¨.bash_profileçš„æœ€å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># pyenv</span><br><span class="line">export PYENV_ROOT&#x3D;&quot;$HOME&#x2F;.pyenv&quot;</span><br><span class="line">export PATH&#x3D;&quot;$PYENV_ROOT&#x2F;bin:$PATH&quot;</span><br><span class="line">eval &quot;$(pyenv init -)&quot;</span><br><span class="line"># eval &quot;$(pyenv virtualenv-init -)&quot;</span><br></pre></td></tr></table></figure>

<p>å†è¯•è¯•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">coconutnut@Ss-MacBook-Pro ~ % source ~&#x2F;.bash_profile</span><br><span class="line">coconutnut@Ss-MacBook-Pro ~ % python -V            </span><br><span class="line">Python 3.7.4</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸ</p>
<p>PSï¼š</p>
<p>å®‰è£…pyenvçš„æ•™ç¨‹æœ‰çš„æ”¹.bash_profileæœ‰çš„æ”¹.bashrc</p>
<blockquote>
<p><a href="https://www.bbsmax.com/A/lk5aj7Eld1/" target="_blank" rel="noopener">https://www.bbsmax.com/A/lk5aj7Eld1/</a></p>
<p>åœ¨å®‰è£…æˆåŠŸä¹‹åéœ€è¦åœ¨<code>.bashrc</code>æˆ–è€…<code>.bash_profile</code>ä¸­æ·»åŠ ä¸‰è¡Œæ¥å¼€å¯è‡ªåŠ¨è¡¥å…¨</p>
</blockquote>
<p>åº”è¯¥éƒ½æ˜¯å¯ä»¥çš„</p>
]]></content>
      <categories>
        <category>Debug</category>
      </categories>
  </entry>
  <entry>
    <title>è®°å½•æœåŠ¡å™¨éƒ¨ç½²</title>
    <url>/2020/05/07/memo-server/</url>
    <content><![CDATA[<p>ä»¥å‰çš„æœåŠ¡å™¨è¿‡æœŸäº†ï¼Œé‡æ–°ä¹°äº†éƒ¨ç½²ï¼Œå¸Œæœ›è¿™æ¬¡å°‘è¸©ç‚¹å‘</p>
<p>æœåŠ¡å™¨ç¯å¢ƒï¼šUbuntu 16.04 64ä½</p>
<h1 id="æœåŠ¡å™¨é…ç½®"><a href="#æœåŠ¡å™¨é…ç½®" class="headerlink" title="æœåŠ¡å™¨é…ç½®"></a>æœåŠ¡å™¨é…ç½®</h1><ol>
<li><p>é‡ç½®å¯†ç &amp;é‡å¯å®ä¾‹</p>
</li>
<li><p>æ·»åŠ å®‰å…¨ç»„è§„åˆ™</p>
<blockquote>
<p><a href="https://help.aliyun.com/document_detail/151694.html?spm=a2c4g.11186623.6.582.56d15bbbDfXG8X" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/151694.html?spm=a2c4g.11186623.6.582.56d15bbbDfXG8X</a></p>
</blockquote>
<p>é¡ºä¾¿æŠŠ8000~9000éƒ½å¼€äº†</p>
</li>
</ol>
<h1 id="ç»ˆç«¯è®¿é—®"><a href="#ç»ˆç«¯è®¿é—®" class="headerlink" title="ç»ˆç«¯è®¿é—®"></a>ç»ˆç«¯è®¿é—®</h1><ol>
<li><p>sshè¿æ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh root@&lt;å®ä¾‹å…¬ç½‘IPåœ°å€&gt;</span><br></pre></td></tr></table></figure>

<p>âœŒï¸</p>
</li>
</ol>
<h1 id="å®‰è£…jdkå’ŒTomcat"><a href="#å®‰è£…jdkå’ŒTomcat" class="headerlink" title="å®‰è£…jdkå’ŒTomcat"></a>å®‰è£…jdkå’ŒTomcat</h1><ol>
<li><p>ä¸‹è½½jdk-14.0.1_linux-x64_bin.tar.gzå’Œapache-tomcat-9.0.34.tar.gz</p>
<blockquote>
<p><a href="https://www.oracle.com/java/technologies/javase-jdk14-downloads.html" target="_blank" rel="noopener">https://www.oracle.com/java/technologies/javase-jdk14-downloads.html</a></p>
<p><a href="https://tomcat.apache.org/download-90.cgi" target="_blank" rel="noopener">https://tomcat.apache.org/download-90.cgi</a></p>
</blockquote>
<p>ï¼ˆä¹‹å‰è£…çš„æ˜¯jdk12ï¼Œä¸çŸ¥é“è¿™æ ·ä¼šä¸ä¼šæœ‰æ¯›ç—…ï¼‰</p>
</li>
<li><p>FileZillaè¿æ¥æœåŠ¡å™¨ï¼Œä¸Šé¢ä¸¤ä¸ªåŒ…ä¼ åˆ°rootæ–‡ä»¶å¤¹ä¸‹</p>
</li>
<li><p>å›åˆ°ç»ˆç«¯ï¼Œæ–°å»ºjavaeeæ–‡ä»¶å¤¹ï¼Œè§£å‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# ls</span><br><span class="line">apache-tomcat-9.0.34.tar.gz jdk-14.0.1_linux-x64_bin.tar.gz</span><br><span class="line">~# mkdir javaee</span><br><span class="line">~# tar zxvf jdk-14.0.1_linux-x64_bin.tar.gz -C javaee</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®javaç¯å¢ƒå˜é‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# vim &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure>

<p>æœ€ååŠ ä¸Š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># set java environment</span><br><span class="line">export JAVA_HOME&#x3D;&#x2F;root&#x2F;javaee&#x2F;jdk-14.0.1</span><br><span class="line">export PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# source &#x2F;etc&#x2F;profile</span><br><span class="line">~# java -version</span><br><span class="line">java version &quot;14.0.1&quot; 2020-04-14</span><br><span class="line">Java(TM) SE Runtime Environment (build 14.0.1+7)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 14.0.1+7, mixed mode, sharing)</span><br></pre></td></tr></table></figure>

<p>âœŒï¸</p>
</li>
<li><p>å®‰è£…tomcat</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~# tar zxvf apache-tomcat-9.0.34.tar.gz -C javaee</span><br></pre></td></tr></table></figure>

<p>é…ç½®catalina.sh</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin# vim &#x2F;catalina.sh</span><br></pre></td></tr></table></figure>

<p>åŠ ä¸€å¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export JAVA_HOME&#x3D;&#x2F;root&#x2F;javaee&#x2F;jdk-14.0.1</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin# .&#x2F;startup.sh </span><br><span class="line">Using CATALINA_BASE:   &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34</span><br><span class="line">Using CATALINA_HOME:   &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34</span><br><span class="line">Using CATALINA_TMPDIR: &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;temp</span><br><span class="line">Using JRE_HOME:        &#x2F;root&#x2F;javaee&#x2F;jdk-14.0.1</span><br><span class="line">Using CLASSPATH:       &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin&#x2F;bootstrap.jar:&#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin&#x2F;tomcat-juli.jar</span><br><span class="line">Tomcat started.</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-05-07 PM12.21.05.jpg">

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin# .&#x2F;shutdown.sh </span><br><span class="line">Using CATALINA_BASE:   &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34</span><br><span class="line">Using CATALINA_HOME:   &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34</span><br><span class="line">Using CATALINA_TMPDIR: &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;temp</span><br><span class="line">Using JRE_HOME:        &#x2F;root&#x2F;javaee&#x2F;jdk-14.0.1</span><br><span class="line">Using CLASSPATH:       &#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin&#x2F;bootstrap.jar:&#x2F;root&#x2F;javaee&#x2F;apache-tomcat-9.0.34&#x2F;bin&#x2F;tomcat-juli.jar</span><br><span class="line">NOTE: Picked up JDK_JAVA_OPTIONS:  --add-opens&#x3D;java.base&#x2F;java.lang&#x3D;ALL-UNNAMED --add-opens&#x3D;java.base&#x2F;java.io&#x3D;ALL-UNNAMED --add-opens&#x3D;java.rmi&#x2F;sun.rmi.transport&#x3D;ALL-UNNAMED</span><br></pre></td></tr></table></figure>

<p>âœŒï¸</p>
</li>
</ol>
<hr>
<p>å®Œå·¥ï¼</p>
<p>ä¸€éè¿‡å¤ªå¿«ä¹äº†</p>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
  </entry>
  <entry>
    <title>Android 10 é—ªé€€é—®é¢˜</title>
    <url>/2020/05/04/debug/</url>
    <content><![CDATA[<p>ï¼ˆæœªè§£å†³ï¼‰</p>
<h1 id="bugæè¿°"><a href="#bugæè¿°" class="headerlink" title="bugæè¿°"></a>bugæè¿°</h1><p>æ‰“å¼€å·¥ç¨‹å¯ä»¥å®‰è£…ï¼Œä½†æ˜¯é—ªé€€</p>
<p>Buildä¸­æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ³¨: æŸäº›è¾“å…¥æ–‡ä»¶ä½¿ç”¨æˆ–è¦†ç›–äº†å·²è¿‡æ—¶çš„ APIã€‚</span><br><span class="line">æ³¨: æœ‰å…³è¯¦ç»†ä¿¡æ¯, è¯·ä½¿ç”¨ -Xlint:deprecation é‡æ–°ç¼–è¯‘ã€‚</span><br></pre></td></tr></table></figure>

<h1 id="å°è¯•è§£å†³"><a href="#å°è¯•è§£å†³" class="headerlink" title="å°è¯•è§£å†³"></a>å°è¯•è§£å†³</h1><h2 id="å°è¯•1"><a href="#å°è¯•1" class="headerlink" title="å°è¯•1"></a>å°è¯•1</h2><blockquote>
<p><a href="https://blog.csdn.net/caidi1988314/article/details/52460922?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3" target="_blank" rel="noopener">https://blog.csdn.net/caidi1988314/article/details/52460922?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-3</a></p>
</blockquote>
<p>build.gradle android {}é‡ŒåŠ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">  gradle.projectsEvaluated &#123;</span><br><span class="line">    tasks.withType(JavaCompile) &#123;</span><br><span class="line">    	options.compilerArgs &lt;&lt; &quot;-Xlint:unchecked&quot; &lt;&lt; &quot;-Xlint:deprecation&quot;                       		&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> å‡ºç°</p>
<img src="/images/2020/screencapture2020-05-04 PM9.09.01.jpg">

<p>åœ¨æŠ¥é”™çš„å‡½æ•°ä¸ŠåŠ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@SuppressWarnings(&quot;deprecation&quot;)</span><br></pre></td></tr></table></figure>

<p>BuildæˆåŠŸï¼Œä½†è¿˜æ˜¯é—ªé€€</p>
<h2 id="å°è¯•2"><a href="#å°è¯•2" class="headerlink" title="å°è¯•2"></a>å°è¯•2</h2><p>çœ‹åˆ°activity_main.xmlé‡Œæœ‰</p>
<img src="/images/2020/screencapture2020-05-04 PM9.28.55.jpg">

<p>æŒ‰æç¤ºä¿®æ”¹</p>
<p>è¿˜æ˜¯é—ªé€€</p>
<blockquote>
<p><a href="https://blog.csdn.net/yogima/article/details/89416885?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">https://blog.csdn.net/yogima/article/details/89416885?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1</a></p>
</blockquote>
<p>æŠŠMainActivityæ‰€æœ‰å‡½æ•°éƒ½æ³¨é‡Šæ‰ï¼Œå¯ä»¥æ‰“å¼€</p>
<p>ä¸€ç‚¹ä¸€ç‚¹æ”¾å¼€</p>
<p>å‘ç°é—®é¢˜åœ¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">File path = <span class="keyword">new</span> File(dir);</span><br><span class="line">String[] list = path.list();</span><br><span class="line">len = list.length;</span><br><span class="line"><span class="keyword">if</span> (len == <span class="number">0</span>) &#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br></pre></td></tr></table></figure>

<p>listç©ºçš„æ—¶å€™ï¼Œlist.lengthä¼šå¼‚å¸¸</p>
<p>åŠ äº†ä¸ªä¸ºç©ºè¿”å›0</p>
<p>ä½†æ˜¯è¿™ä¸ªå¼‚å¸¸æ€ä¹ˆä¸æç¤ºå‘¢ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>è¿™é‡Œä¼šä¸ºç©ºåº”è¯¥è¯»æ–‡ä»¶æƒé™æ²¡æœ‰è·å–åˆ°</p>
<h2 id="å°è¯•3"><a href="#å°è¯•3" class="headerlink" title="å°è¯•3"></a>å°è¯•3</h2><p>åƒä¸Šæ¬¡é‚£æ ·åŠ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">android:requestLegacyExternalStorage&#x3D;&quot;true&quot;</span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">AAPT: error: attribute android:requestLegacyExternalStorage not found.</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://blog.csdn.net/DeMonliuhui/article/details/99718553" target="_blank" rel="noopener">https://blog.csdn.net/DeMonliuhui/article/details/99718553</a></p>
</blockquote>
<p>ç°åœ¨è¿™ä¸ªå·¥ç¨‹çš„ç‰ˆæœ¬æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">compileSdkVersion 28</span><br><span class="line">buildToolsVersion &#39;28.0.3&#39;</span><br><span class="line">defaultConfig &#123;</span><br><span class="line">  applicationId &quot;com.example.mydoppler&quot;</span><br><span class="line">  minSdkVersion 15</span><br><span class="line">  targetSdkVersion 28</span><br><span class="line">  versionCode 1</span><br><span class="line">  versionName &quot;1.0&quot;</span><br><span class="line">  testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ”¹æˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">compileSdkVersion 29</span><br><span class="line">buildToolsVersion &quot;29.0.2&quot;</span><br><span class="line">defaultConfig &#123;</span><br><span class="line">  applicationId&quot;com.example.mydoppler&quot;</span><br><span class="line">  minSdkVersion 26</span><br><span class="line">  targetSdkVersion 29</span><br><span class="line">  versionCode 1</span><br><span class="line">  versionName &quot;1.0&quot;</span><br><span class="line">  testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>requestLegacyExternalStorageå±æ€§å¯ä»¥åŠ äº†</p>
<p>è¾“å‡ºé‚£ä¸ªè·å–çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿˜æ˜¯null</p>
<h2 id="å°è¯•4"><a href="#å°è¯•4" class="headerlink" title="å°è¯•4"></a>å°è¯•4</h2><p>åœ¨Runé‡Œé¢åˆå‘ç°ä¸€å¥çº¢çš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">E&#x2F;libc: Access denied finding property &quot;ro.vendor.df.effect.conflict&quot;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Debug</category>
      </categories>
  </entry>
  <entry>
    <title>è¯»ä¹¦ç¬”è®° æ·±åº¦å·¥ä½œ</title>
    <url>/2020/05/02/deepwork/</url>
    <content><![CDATA[<blockquote>
<p>ã€Šæ·±åº¦å·¥ä½œã€‹ [ç¾] å¡å°”Â·çº½æ³¢ç‰¹</p>
</blockquote>
<img src="/images/2020/deepwork.png">]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>gitç¬”è®°</title>
    <url>/2020/05/02/note-git/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://github.com/pcottle/learnGitBranching" target="_blank" rel="noopener">https://github.com/pcottle/learnGitBranching</a></p>
</blockquote>
<img src="/images/2020/git.png">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>tool</tag>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>å››æœˆæ¯æ—¥ä¸€é¢˜æ‰“å¡å®Œå·¥çºªå¿µ</title>
    <url>/2020/04/30/memo/</url>
    <content><![CDATA[<img src="/images/2020/screencapture2020-04-30 PM4.03.43.jpg" width=300>

<p>ä¸‰æœˆå·®ä¸€ç‚¹ç‚¹ï¼Œå››æœˆæˆåŠŸå’¯~</p>
<img src="/images/2020/screencapture2020-04-30 PM4.04.55.jpg" width=300>

]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°07 æ€»ç»“</title>
    <url>/2020/04/25/note-springcloud-07/</url>
    <content><![CDATA[<img src="/images/2020/SpringCloud.png">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°06 GatewayæœåŠ¡ç½‘å…³</title>
    <url>/2020/04/25/note-springcloud-06/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/103757927" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103757927</a></p>
</blockquote>
<p>Gatewayæ˜¯åœ¨Springç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„APIç½‘å…³æœåŠ¡ï¼Œæ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹APIè¿›è¡Œè·¯ç”±ï¼Œä»¥åŠæä¾›ä¸€äº›å¼ºå¤§çš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œ ä¾‹å¦‚ï¼šç†”æ–­ã€é™æµã€é‡è¯•ç­‰</p>
<p>é›†æˆHystrixçš„æ–­è·¯å™¨åŠŸèƒ½å’ŒSpring CloudæœåŠ¡å‘ç°åŠŸèƒ½</p>
<h1 id="åˆ›å»ºapi-gatewayæ¨¡å—"><a href="#åˆ›å»ºapi-gatewayæ¨¡å—" class="headerlink" title="åˆ›å»ºapi-gatewayæ¨¡å—"></a>åˆ›å»ºapi-gatewayæ¨¡å—</h1><h2 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸éœ€è¦æ³¨å†Œï¼Ÿ</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9201</span></span><br><span class="line"></span><br><span class="line"><span class="attr">service-url:</span></span><br><span class="line">  <span class="attr">user-service:</span> <span class="string">http://localhost:8201</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">          <span class="comment"># è·¯ç”±çš„ID</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">path_route</span></span><br><span class="line">          <span class="comment"># åŒ¹é…åè·¯ç”±åœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">$&#123;service-url.user-service&#125;/user/&#123;id&#125;</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">              <span class="comment"># æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/user/&#123;id&#125;</span></span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨consul-serverã€user-serviceå’Œapi-gateway</p>
<p>æµ‹è¯• <a href="http://localhost:9201/user/1" target="_blank" rel="noopener">http://localhost:9201/user/1</a></p>
<img src="/images/2020/screencapture2020-04-25 AM9.58.55.jpg">

<h1 id="Route-Predicate-çš„ä½¿ç”¨"><a href="#Route-Predicate-çš„ä½¿ç”¨" class="headerlink" title="Route Predicate çš„ä½¿ç”¨"></a>Route Predicate çš„ä½¿ç”¨</h1><ul>
<li><p>After Route Predicate : åœ¨æŒ‡å®šæ—¶é—´ä¹‹åçš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
</li>
<li><p>Before Route Predicate : åœ¨æŒ‡å®šæ—¶é—´ä¹‹å‰çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
</li>
<li><p>Between Route Predicate : åœ¨æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
</li>
<li><p>Cookie Route Predicate : å¸¦æœ‰æŒ‡å®šCookieçš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username&#x3D;jourwon</span><br></pre></td></tr></table></figure>
</li>
<li><p>Header Route Predicate : å¸¦æœ‰æŒ‡å®šè¯·æ±‚å¤´çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">X-Request-Id:123</span><br></pre></td></tr></table></figure>
</li>
<li><p>Host Route Predicate : å¸¦æœ‰æŒ‡å®šHostçš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Host:www.jourwon.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>Method Route Predicate : å‘é€æŒ‡å®šæ–¹æ³•çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET</span><br></pre></td></tr></table></figure>
</li>
<li><p>Path Route Predicate : å‘é€æŒ‡å®šè·¯å¾„çš„è¯·æ±‚ä¼šåŒ¹é…è¯¥è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;user&#x2F;1</span><br></pre></td></tr></table></figure>
</li>
<li><p>Query Route Predicate : å¸¦æŒ‡å®šæŸ¥è¯¢å‚æ•°çš„è¯·æ±‚å¯ä»¥åŒ¹é…è¯¥è·¯ç”±</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username&#x3D;jourwon</span><br></pre></td></tr></table></figure>
</li>
<li><p>RemoteAddr Route Predicate : ä»æŒ‡å®šè¿œç¨‹åœ°å€å‘èµ·çš„è¯·æ±‚å¯ä»¥åŒ¹é…è¯¥è·¯ç”±</p>
</li>
<li><p>Weight Route Predicate : ä½¿ç”¨æƒé‡æ¥è·¯ç”±ç›¸åº”è¯·æ±‚</p>
<p>å¦‚80%çš„è¯·æ±‚è·¯ç”±åˆ°localhost:8201ï¼Œ20%è·¯ç”±åˆ°localhost:8202</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">weight_high</span></span><br><span class="line">        <span class="attr">uri:</span> <span class="string">http://localhost:8201</span></span><br><span class="line">        <span class="attr">predicates:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">Weight=group1,</span> <span class="number">8</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">weight_low</span></span><br><span class="line">        <span class="attr">uri:</span> <span class="string">http://localhost:8202</span></span><br><span class="line">        <span class="attr">predicates:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">Weight=group1,</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="Route-Filterçš„ä½¿ç”¨"><a href="#Route-Filterçš„ä½¿ç”¨" class="headerlink" title="Route Filterçš„ä½¿ç”¨"></a>Route Filterçš„ä½¿ç”¨</h1><p>å¯ç”¨äºä¿®æ”¹è¿›å…¥çš„HTTPè¯·æ±‚å’Œè¿”å›çš„HTTPå“åº”ï¼Œåªèƒ½æŒ‡å®šè·¯ç”±è¿›è¡Œä½¿ç”¨</p>
<ul>
<li>AddRequestParameter GatewayFilter : ç»™è¯·æ±‚æ·»åŠ å‚æ•°çš„è¿‡æ»¤å™¨</li>
<li>StripPrefix GatewayFilter : å¯¹æŒ‡å®šæ•°é‡çš„è·¯å¾„å‰ç¼€è¿›è¡Œå»é™¤çš„è¿‡æ»¤å™¨</li>
<li>PrefixPath GatewayFilter : ä¸StripPrefixè¿‡æ»¤å™¨ç›¸åï¼Œä¼šå¯¹åŸæœ‰è·¯å¾„è¿›è¡Œå¢åŠ æ“ä½œçš„è¿‡æ»¤å™¨</li>
<li>Retry GatewayFilter : å¯¹è·¯ç”±è¯·æ±‚è¿›è¡Œé‡è¯•çš„è¿‡æ»¤å™¨ï¼Œæ ¹æ®è·¯ç”±è¯·æ±‚è¿”å›çš„HTTPçŠ¶æ€ç æ¥ç¡®å®šæ˜¯å¦è¿›è¡Œé‡è¯•</li>
</ul>
<h2 id="Hystrix-GatewayFilter"><a href="#Hystrix-GatewayFilter" class="headerlink" title="Hystrix GatewayFilter"></a>Hystrix GatewayFilter</h2><p>å°†æ–­è·¯å™¨åŠŸèƒ½æ·»åŠ åˆ°ç½‘å…³è·¯ç”±ä¸­</p>
<p>éœ€æ·»åŠ Hystrixçš„ç›¸å…³ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ·»åŠ ç›¸å…³æœåŠ¡é™çº§çš„å¤„ç†ç±»FallbackController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FallbackController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/fallback"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">fallback</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">"data"</span>,<span class="keyword">null</span>);</span><br><span class="line">        result.put(<span class="string">"message"</span>,<span class="string">"Get request fallback!"</span>);</span><br><span class="line">        result.put(<span class="string">"code"</span>,<span class="number">500</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é…ç½®æœåŠ¡é™çº§</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">filters:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Hystrix</span></span><br><span class="line">    <span class="attr">args:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">fallbackcmd</span></span><br><span class="line">      <span class="attr">fallback-uri:</span> <span class="string">forward:/fallback</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼ˆå…ˆé‡å¯api-gatewayï¼‰</p>
<p>å…³é—­user-serviceï¼Œè°ƒç”¨<a href="http://localhost:9201/user/1" target="_blank" rel="noopener">http://localhost:9201/user/1</a> </p>
<img src="/images/2020/screencapture2020-04-25 AM10.13.57.jpg">

<p>å‘ç”Ÿäº†é™çº§</p>
<h2 id="RequestRateLimiter-GatewayFilter"><a href="#RequestRateLimiter-GatewayFilter" class="headerlink" title="RequestRateLimiter GatewayFilter"></a>RequestRateLimiter GatewayFilter</h2><p>å¯ä»¥ç”¨äºé™æµ</p>
<p>æ·»åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis-reactive<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ·»åŠ é™æµç­–ç•¥çš„é…ç½®ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisRateLimiterConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> KeyResolver <span class="title">userKeyResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®è¯·æ±‚å‚æ•°ä¸­çš„usernameè¿›è¡Œé™æµ</span></span><br><span class="line">        <span class="keyword">return</span> exchange -&gt; Mono.just(exchange.getRequest().getQueryParams().getFirst(<span class="string">"username"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> KeyResolver <span class="title">ipKeyResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®è®¿é—®IPè¿›è¡Œé™æµ</span></span><br><span class="line">        <span class="keyword">return</span> exchange -&gt; Mono.just(exchange.getRequest().getRemoteAddress().getHostName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ Rediså’ŒRequestRateLimiterçš„é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RequestRateLimiter</span></span><br><span class="line">  <span class="attr">args:</span></span><br><span class="line">    <span class="comment"># æ¯ç§’å…è®¸å¤„ç†çš„è¯·æ±‚æ•°é‡</span></span><br><span class="line">    <span class="attr">redis-rate-limiter.replenishRate:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># æ¯ç§’æœ€å¤§å¤„ç†çš„è¯·æ±‚æ•°é‡</span></span><br><span class="line">    <span class="attr">redis-rate-limiter.burstCapacity:</span> <span class="number">2</span></span><br><span class="line">    <span class="comment"># é™æµç­–ç•¥ï¼Œå¯¹åº”ç­–ç•¥çš„Bean</span></span><br><span class="line">    <span class="attr">key-resolver:</span> <span class="string">"#&#123;@ipKeyResolver&#125;"</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•</p>
<p>å¯åŠ¨æœåŠ¡ï¼Œå¤šæ¬¡è¯·æ±‚ <a href="http://localhost:9201/user/1" target="_blank" rel="noopener">http://localhost:9201/user/1</a></p>
<img src="/images/2020/screencapture2020-04-25 AM10.35.06.jpg">

<p>æŠ¥é”™429</p>
<h2 id="DEBUGï¼šå¯åŠ¨å¤±è´¥"><a href="#DEBUGï¼šå¯åŠ¨å¤±è´¥" class="headerlink" title="DEBUGï¼šå¯åŠ¨å¤±è´¥"></a>DEBUGï¼šå¯åŠ¨å¤±è´¥</h2><p>æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">***************************</span><br><span class="line">APPLICATION FAILED TO START</span><br><span class="line">***************************</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line"></span><br><span class="line">Parameter 1 of method requestRateLimiterGatewayFilterFactory in org.springframework.cloud.gateway.config.GatewayAutoConfiguration required a single bean, but 2 were found:</span><br><span class="line">	- userKeyResolver: defined by method &#39;userKeyResolver&#39; in class path resource [com&#x2F;coconutnut&#x2F;apigateway&#x2F;config&#x2F;RedisRateLimiterConfig.class]</span><br><span class="line">	- ipKeyResolver: defined by method &#39;ipKeyResolver&#39; in class path resource [com&#x2F;coconutnut&#x2F;apigateway&#x2F;config&#x2F;RedisRateLimiterConfig.class]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Action:</span><br><span class="line"></span><br><span class="line">Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Process finished with exit code 1</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®æç¤ºåŠ ä¸Š@Primaryï¼Œè§£å†³</p>
<h2 id="DEBUGï¼šRedisè¿æ¥å¤±è´¥"><a href="#DEBUGï¼šRedisè¿æ¥å¤±è´¥" class="headerlink" title="DEBUGï¼šRedisè¿æ¥å¤±è´¥"></a>DEBUGï¼šRedisè¿æ¥å¤±è´¥</h2><p>è®¿é—®<a href="http://localhost:9201/user/1æ—¶æ•°æ®æ­£å¸¸ï¼Œä½†æ§åˆ¶å°æŠ¥é”™" target="_blank" rel="noopener">http://localhost:9201/user/1æ—¶æ•°æ®æ­£å¸¸ï¼Œä½†æ§åˆ¶å°æŠ¥é”™</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost:6379</span><br><span class="line">	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1199) ~[spring-data-redis-2.2.3.RELEASE.jar:2.2.3.RELEASE]</span><br><span class="line">	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1178) ~[spring-data-redis-2.2.3.RELEASE.jar:2.2.3.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½å®‰è£…</p>
<blockquote>
<p><a href="http://www.redis.cn/download.html" target="_blank" rel="noopener">http://www.redis.cn/download.html</a></p>
</blockquote>
<p>å¯åŠ¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">redis-5.0.5 % src&#x2F;redis-server</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-25 AM10.37.45.jpg">

<p>å¥½å¯çˆ±ğŸ™€</p>
<h1 id="ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨"><a href="#ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨" class="headerlink" title="ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨"></a>ç»“åˆæ³¨å†Œä¸­å¿ƒä½¿ç”¨</h1><p>ï¼ˆå¼ƒï¼‰</p>
<p>æ•™ç¨‹ç»™çš„æ˜¯eurekaï¼Œè¿™é‡Œå°è¯•æ”¹æˆconsul</p>
<p>åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ”¹é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">application:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">api-gateway</span></span><br><span class="line">    <span class="attr">consul:</span></span><br><span class="line">      <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">locator:</span></span><br><span class="line">          <span class="comment">#å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="comment">#ä½¿ç”¨å°å†™æœåŠ¡åï¼Œé»˜è®¤æ˜¯å¤§å†™</span></span><br><span class="line">          <span class="attr">lower-case-service-id:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="DEBUGï¼šå¯åŠ¨å¤±è´¥-1"><a href="#DEBUGï¼šå¯åŠ¨å¤±è´¥-1" class="headerlink" title="DEBUGï¼šå¯åŠ¨å¤±è´¥"></a>DEBUGï¼šå¯åŠ¨å¤±è´¥</h2><p>æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¯åŠ¨ç±»å¿˜åŠ æ³¨é‡Šäº†ï¼ŒåŠ ä¸Šå…ˆ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹ä¾èµ–ï¼Œæ²¡æœ‰å†²çª</p>
<img src="/images/2020/screencapture2020-04-25 AM10.49.46.jpg">

<p>ä½†æ˜¯ç¡®å®æ˜¯åŠ äº†consulçš„ä¾èµ–ä¹‹åæ‰æŠ¥é”™çš„</p>
<p>å»æ‰å®ƒçš„ä¾èµ–å°±å¯ä»¥æ­£å¸¸å¯åŠ¨</p>
<blockquote>
<p><a href="https://blog.csdn.net/jiazhiyuan0/article/details/84033595" target="_blank" rel="noopener">https://blog.csdn.net/jiazhiyuan0/article/details/84033595</a></p>
<p><a href="https://blog.csdn.net/maduo_duo/article/details/84866137" target="_blank" rel="noopener">https://blog.csdn.net/maduo_duo/article/details/84866137</a></p>
</blockquote>
<p>ç¡®å®å¯èƒ½æ˜¯æœ‰å†²çª</p>
<p>ç°åœ¨çš„Spring Bootç‰ˆæœ¬æ˜¯2.2.2.RELEASEï¼ŒSpring Cloudç‰ˆæœ¬æ˜¯2.2.0.RELEASE</p>
<p><strong>å°è¯•1</strong></p>
<p>æŠŠSpring Booté™åˆ°2.2.0</p>
<p>å¹¶ä¸è¡Œ</p>
<p><strong>å°è¯•2</strong></p>
<blockquote>
<p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/319" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/319</a></p>
<p>Finchley is not compatible with boot 2.1.0. Either downgrade to boot 2.0.6 or use Greenwich.M3</p>
</blockquote>
<p>è¿™é‡Œç”¨çš„æ˜¯Hoxtonç‰ˆæœ¬</p>
<p>æ‰¾ä¸‹æ–‡æ¡£</p>
<blockquote>
<p><a href="https://spring.io/blog/2019/11/28/spring-cloud-hoxton-released" target="_blank" rel="noopener">https://spring.io/blog/2019/11/28/spring-cloud-hoxton-released</a></p>
</blockquote>
<p>Consulå’ŒGatewayçš„ç‰ˆæœ¬ä¹Ÿæ˜¯2.2.0.RELEASE</p>
<blockquote>
<p><a href="https://spring.io/projects/spring-cloud#overview" target="_blank" rel="noopener">https://spring.io/projects/spring-cloud#overview</a></p>
</blockquote>
<p>Hoxtonå¯¹åº”çš„Boot Versionæ˜¯2.2.x</p>
<p>åº”è¯¥æ²¡é”™</p>
<p>å¥½å‡ ä¸ªåœ°æ–¹çœ‹åˆ°è¯´æ˜¯spring-boot-starter-webçš„é—®é¢˜</p>
<img src="/images/2020/screencapture2020-04-25 AM11.49.26.jpg">

<p>æœä¸€ä¸‹ï¼Œç¡®å®å¼•ç”¨äº†</p>
<p>æŠŠå®ƒæ’é™¤</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-25 AM11.55.17.jpg">

<p>å¹¶ä¸è¡Œ</p>
<p><strong>å°è¯•3</strong></p>
<p>æ‰¾æ‰¾Spring Cloud Hoxton + Gatway + Consulçš„æ•™ç¨‹</p>
<blockquote>
<p><a href="https://piotrminkowski.com/2019/11/06/microservices-with-spring-boot-spring-cloud-gateway-and-consul-cluster/" target="_blank" rel="noopener">https://piotrminkowski.com/2019/11/06/microservices-with-spring-boot-spring-cloud-gateway-and-consul-cluster/</a></p>
</blockquote>
<p>è¿™ä¸ªæ•™ç¨‹çš„ä¾èµ–æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å·²æœ‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>æŠŠä¹‹å‰spring-boot-starterçš„ä¾èµ–æ”¹æˆspring-boot-starter-web</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯æ²¡å¯åŠ¨æˆåŠŸï¼Œä½†æ˜¯æŠ¥é”™å˜æˆäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-25 12:09:53.083 ERROR 4989 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat</span><br><span class="line">	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) ~[spring-boot-2.2.2.RELEASE.jar:2.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://blog.csdn.net/fly_west/article/details/101229871?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">https://blog.csdn.net/fly_west/article/details/101229871?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1</a></p>
</blockquote>
<p>è¿˜æ˜¯spring-boot-starter-webå†²çªçš„é—®é¢˜</p>
<p>ç°åœ¨å†æŠŠgatewayé‡Œçš„webfluxæ’é™¤è¯•è¯•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-25 12:12:38.331 ERROR 5002 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat</span><br><span class="line">	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) ~[spring-boot-2.2.2.RELEASE.jar:2.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p><strong>å°è¯•4</strong></p>
<p>ä¾èµ–å…¨æ”¹å¾—å’Œåˆšé‚£ä¸ªæ•™ç¨‹ä¸€æ ·è¯•è¯•</p>
<p>hystrixå’Œredisç›¸å…³çš„éƒ½æ³¨é‡Šæ‰</p>
<p>ç‰ˆæœ¬</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.RC1<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯å´©äº†</p>
<p>å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œä¾èµ–çš„æœ€ä¸‹é¢æ€ä¹ˆè¿˜æœ‰ä¸ª</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¼°è®¡æ˜¯åˆ›å»ºçš„æ—¶å€™å¯¼å…¥çš„ï¼Œåˆ æ‰</p>
<p>é‡å¯</p>
<p>å´©</p>
<p><strong>å°è¯•5</strong></p>
<p>è¿˜æ˜¯æŠŠç‰ˆæœ¬æ”¹å›Spring Boot 2.2.0å’ŒSpring Cloud Hoxton</p>
<p>ç°åœ¨çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--            &lt;exclusions&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                &lt;exclusion&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                    &lt;artifactId&gt;spring-cloud-starter-webflux&lt;/artifactId&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--                &lt;/exclusion&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--            &lt;/exclusions&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç°åœ¨çš„æŠ¥é”™</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">2020-04-25 12:32:36.436 ERROR 5170 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat</span><br><span class="line">	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) ~[spring-boot-2.2.2.RELEASE.jar:2.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>åˆšæ‰çœ‹ä¾èµ–å›¾å‘ç°gatewayä¾èµ–çš„æ˜¯webflux</p>
<p>è¿™é‡Œä¾èµ–çš„æ˜¯web</p>
<p>å¦‚æœæ”¹æˆwebfluxï¼Ÿ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-25 12:33:57.502 ERROR 5182 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åº”è¯¥æ˜¯ï¼Œå¯åŠ¨éœ€è¦webï¼Œå¦åˆ™æŠ¥BeanCreationException</p>
<p>è€Œgatewayä¾èµ–äº†webfluxï¼Œå’Œwebå†²çªï¼ŒæŠ¥ApplicationContextException</p>
<p>å†æŠŠexclusionåŠ ä¸Š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-25 12:35:30.492 ERROR 5188 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>æŠŠexclusionå»æ‰ï¼Œwebfluxåˆ äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-25 12:37:30.419 ERROR 5199 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webHandler&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;autoconfigure&#x2F;web&#x2F;reactive&#x2F;WebFluxAutoConfiguration$EnableWebFluxConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;webEndpointReactiveHandlerMapping&#39; defined in class path resource [org&#x2F;springframework&#x2F;boot&#x2F;actuate&#x2F;autoconfigure&#x2F;endpoint&#x2F;web&#x2F;reactive&#x2F;WebFluxEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.reactive.WebFluxEndpointHandlerMapping]: Factory method &#39;webEndpointReactiveHandlerMapping&#39; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.ServiceRegistryAutoConfiguration$ServiceRegistryEndpointConfiguration&#39;: Unsatisfied dependency expressed through field &#39;registration&#39;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<img src="/images/2020/a.gif" width=200>

<p><strong>å°è¯•6</strong></p>
<blockquote>
<p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/319" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/319</a></p>
</blockquote>
<p>ä¹‹å‰è¿™ä¸ªissueé‡Œé¢æœ‰äººè¯´</p>
<blockquote>
<p>spring cloud gateway is not compatible with spring mvc and servlet containers, what you get when you depend on <code>spring-boot-starter-web</code>.</p>
</blockquote>
<p>è¯•è¯•æŠŠspring-boot-starter-webé‡Œçš„spring mvcå’Œservletæ’é™¤äº†ï¼Ÿ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸è¡Œ</p>
<blockquote>
<p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/1004" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/1004</a></p>
<p><code>spring-cloud-gateway-mvc</code> is not compatible with gateway core. You need to use <code>spring-cloud-gateway-webflux</code>.</p>
</blockquote>
<blockquote>
<p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/1473" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/1473</a></p>
<p>Spring MVC found on classpath, which is incompatible with Spring Cloud Gateway at this time. Please remove spring-boot-starter-web dependency.</p>
</blockquote>
<p>ç°åœ¨å°±åªæœ‰è¿™å‡ ä¸ªä¾èµ–ï¼Œä¸ºä»€ä¹ˆè¿˜æ˜¯å¯åŠ¨ä¸äº†å‘¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-gateway&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>éš¾é“actuatoré‡Œé¢ä¹Ÿæœ‰webï¼Ÿ</p>
<p>æŠŠå®ƒæ³¨é‡Šæ‰</p>
<p>æŠ¥é”™å˜æˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-25 13:17:36.860 ERROR 5310 --- [           main] o.s.boot.SpringApplication               : Application run failed</span><br><span class="line"></span><br><span class="line">org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;org.springframework.cloud.client.serviceregistry.AutoServiceRegistrationAutoConfiguration&#39;: Unsatisfied dependency expressed through field &#39;autoServiceRegistration&#39;; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;consulAutoServiceRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Unsatisfied dependency expressed through method &#39;consulAutoServiceRegistration&#39; parameter 3; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;consulRegistration&#39; defined in class path resource [org&#x2F;springframework&#x2F;cloud&#x2F;consul&#x2F;serviceregistry&#x2F;ConsulAutoServiceRegistrationAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.cloud.consul.serviceregistry.ConsulAutoRegistration]: Factory method &#39;consulRegistration&#39; threw exception; nested exception is java.lang.IllegalArgumentException: Consul service ids must not be empty, must start with a letter, end with a letter or digit, and have as interior characters only letters, digits, and hyphen: 9201</span><br><span class="line">	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:643) ~[spring-beans-5.2.2.RELEASE.jar:5.2.2.RELEASE]</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://github.com/spring-cloud/spring-cloud-gateway/issues/802" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-gateway/issues/802</a></p>
<p>Gateway is thought to be used as a separate technical component in your architecture. It usually does not make sense to add a gateway dependency directly to your business code.</p>
</blockquote>
<p>é€‚åˆå•ç‹¬ä½¿ç”¨â€¦</p>
<p>å•ç‹¬ä½¿ç”¨â€¦</p>
<p>å•ç‹¬â€¦</p>
<p>fine</p>
<p>æš‚æ—¶å°±ä¸ç»“åˆæ³¨å†Œä¸­å¿ƒäº†</p>
<p>ä»¥åæœ‰éœ€è¦å†è¯´</p>
<p>å†è§</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisPlusç¬”è®°06 è‡ªåŠ¨å¡«å……ã€é€»è¾‘åˆ é™¤ã€é€šç”¨æšä¸¾ç­‰</title>
    <url>/2020/04/24/note-mybatisplus-06/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p>
<p>P55~62</p>
</blockquote>
<h1 id="sqlæ³¨å…¥å™¨"><a href="#sqlæ³¨å…¥å™¨" class="headerlink" title="sqlæ³¨å…¥å™¨"></a>sqlæ³¨å…¥å™¨</h1><p>é»˜è®¤çš„Mapperä¸­æ–¹æ³•ä¸å¤Ÿç”¨æ—¶ï¼Œè‡ªå·±æ‰©å……BaseMapperä¸­çš„æ–¹æ³•</p>
<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR?p=55" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR?p=55</a></p>
</blockquote>
<h1 id="è‡ªåŠ¨å¡«å……"><a href="#è‡ªåŠ¨å¡«å……" class="headerlink" title="è‡ªåŠ¨å¡«å……"></a>è‡ªåŠ¨å¡«å……</h1><p>æ’å…¥æˆ–è€…æ›´æ–°æ•°æ®æ—¶ï¼Œå¸Œæœ›æœ‰äº›å­—æ®µå¯ä»¥è‡ªåŠ¨å¡«å……æ•°æ®ï¼Œæ¯”å¦‚å¯†ç ã€version ç­‰</p>
<h2 id="æ·»åŠ -TableFieldæ³¨è§£"><a href="#æ·»åŠ -TableFieldæ³¨è§£" class="headerlink" title="æ·»åŠ @TableFieldæ³¨è§£"></a>æ·»åŠ @TableFieldæ³¨è§£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="meta">@TableField</span>(fill = FieldFill.INSERT)</span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure>

<p>FieldFillå¯é€‰ï¼š</p>
<ul>
<li>DEFAULT é»˜è®¤ä¸å¤„ç†</li>
<li>INSERT æ’å…¥è¯•å¡«å……å­—æ®µ</li>
<li>UPDATE æ›´æ–°æ—¶å¡«å……å­—æ®µ</li>
<li>INSERT_UPDATE æ’å…¥å’Œæ›´æ–°æ—¶å¡«å……å­—æ®µ</li>
</ul>
<h2 id="ç¼–å†™MyMetaObjectHandler"><a href="#ç¼–å†™MyMetaObjectHandler" class="headerlink" title="ç¼–å†™MyMetaObjectHandler"></a>ç¼–å†™MyMetaObjectHandler</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        Object version = getFieldValByName(<span class="string">"version"</span>, metaObject);</span><br><span class="line">        <span class="keyword">if</span>(version == <span class="keyword">null</span>)&#123;</span><br><span class="line">            setFieldValByName(<span class="string">"version"</span>, <span class="number">1</span>, metaObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsertFill</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setName(<span class="string">"å¼ å››"</span>);</span><br><span class="line">  user.setUserName(<span class="string">"zhangsi"</span>);</span><br><span class="line">  user.setPassword(<span class="string">"123123"</span>);</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setEmail(<span class="string">"zhangsi@itast.cn"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.insert(user);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Timeï¼š9 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.insert</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    INSERT </span><br><span class="line">    INTO</span><br><span class="line">        tb_user</span><br><span class="line">        ( user_name, password, name, age, email, version ) </span><br><span class="line">    VALUES</span><br><span class="line">        ( &#39;zhangsi&#39;, &#39;123123&#39;, &#39;å¼ å››&#39;, 30, &#39;zhangsi@itast.cn&#39;, 1 )</span><br><span class="line"></span><br><span class="line">result &#x3D; 1</span><br></pre></td></tr></table></figure>

<h1 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h1><p>å°†æ•°æ®æ ‡è®°ä¸ºåˆ é™¤ï¼Œè€Œå¹¶éçœŸæ­£åˆ é™¤</p>
<p>æŸ¥è¯¢æ—¶éœ€è¦æºå¸¦çŠ¶æ€æ¡ä»¶ï¼Œç¡®ä¿è¢«æ ‡è®°çš„æ•°æ®ä¸è¢«æŸ¥è¯¢åˆ°</p>
<h2 id="ä¿®æ”¹è¡¨ç»“æ„"><a href="#ä¿®æ”¹è¡¨ç»“æ„" class="headerlink" title="ä¿®æ”¹è¡¨ç»“æ„"></a>ä¿®æ”¹è¡¨ç»“æ„</h2><p>ä¸ºtb_userè¡¨å¢åŠ deletedå­—æ®µï¼Œç”¨äºè¡¨ç¤ºæ•°æ®æ˜¯å¦è¢«åˆ é™¤ï¼Œ1ä»£è¡¨åˆ é™¤ï¼Œ0ä»£è¡¨æœªåˆ é™¤</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`deleted`</span> <span class="built_in">int</span>(<span class="number">1</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> <span class="keyword">COMMENT</span> <span class="string">'1ä»£è¡¨åˆ é™¤ï¼Œ0ä»£è¡¨æœªåˆ é™¤'</span> <span class="keyword">AFTER</span> <span class="string">`version`</span>;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹Userå®ä½“ï¼Œå¢åŠ deletedå±æ€§å¹¶ä¸”æ·»åŠ @TableLogicæ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableLogic</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>application.propertiesä¸­</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1) mybatis-plus.global-config.db-config.logic-delete-value=1</span></span><br><span class="line"><span class="comment"># é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0) mybatis-plus.global-config.db-config.logic-not-delete-value=0</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç”¨é»˜è®¤å€¼å¯ä»¥çœç•¥</p>
<h2 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User(); user.setId(<span class="number">2L</span>);</span><br><span class="line">  <span class="keyword">boolean</span> delete = user.deleteById();</span><br><span class="line">  System.out.println(delete);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Timeï¼š2 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.deleteById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    UPDATE</span><br><span class="line">        tb_user </span><br><span class="line">    SET</span><br><span class="line">        deleted&#x3D;1 </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND deleted&#x3D;0</span><br><span class="line"></span><br><span class="line">true</span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šå˜æˆäº†UPDATE</p>
<img src="/images/2020/screencapture2020-04-24 PM7.42.26.jpg">

<p>ç„¶åæŸ¥è¯¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">2L</span>);</span><br><span class="line">  User user2 = user.selectById();</span><br><span class="line">  System.out.println(user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Timeï¼š5 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.selectById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    SELECT</span><br><span class="line">        id,</span><br><span class="line">        user_name,</span><br><span class="line">        password,</span><br><span class="line">        name,</span><br><span class="line">        age,</span><br><span class="line">        email,</span><br><span class="line">        version,</span><br><span class="line">        deleted </span><br><span class="line">    FROM</span><br><span class="line">        tb_user </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND deleted&#x3D;0</span><br><span class="line"></span><br><span class="line">null</span><br></pre></td></tr></table></figure>

<p>SQLä¸­æ·»åŠ äº†deleted=0çš„æ¡ä»¶ï¼Œæ²¡æœ‰æŸ¥åˆ°æ•°æ®</p>
<h1 id="é€šç”¨æšä¸¾"><a href="#é€šç”¨æšä¸¾" class="headerlink" title="é€šç”¨æšä¸¾"></a>é€šç”¨æšä¸¾</h1><h2 id="ä¿®æ”¹è¡¨ç»“æ„-1"><a href="#ä¿®æ”¹è¡¨ç»“æ„-1" class="headerlink" title="ä¿®æ”¹è¡¨ç»“æ„"></a>ä¿®æ”¹è¡¨ç»“æ„</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`sex`</span> <span class="built_in">int</span>(<span class="number">1</span>) <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> <span class="keyword">COMMENT</span> <span class="string">'1-ç”·ï¼Œ2-å¥³'</span> <span class="keyword">AFTER</span> <span class="string">`deleted`</span>;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹Userå®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> SexEnum sex;</span><br></pre></td></tr></table></figure>

<h2 id="å®šä¹‰æšä¸¾"><a href="#å®šä¹‰æšä¸¾" class="headerlink" title="å®šä¹‰æšä¸¾"></a>å®šä¹‰æšä¸¾</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.enums.IEnum;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> SexEnum implements IEnum&lt;Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">    MAN(<span class="number">1</span>,<span class="string">"ç”·"</span>),</span><br><span class="line">    WOMAN(<span class="number">2</span>,<span class="string">"å¥³"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    SexEnum(<span class="keyword">int</span> value, String desc) &#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æšä¸¾åŒ…æ‰«æ</span><br><span class="line">mybatis-plus.type-enums-package&#x3D;com.coconutnut.demo.enums</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setName(<span class="string">"å¼ äº”"</span>);</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line">  user.setUserName(<span class="string">"zhangwu"</span>);</span><br><span class="line">  user.setEmail(<span class="string">"zhangwu@itcast.cn"</span>);</span><br><span class="line">  user.setSex(SexEnum.WOMAN);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">boolean</span> insert = user.insert();</span><br><span class="line">  System.out.println(insert);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Timeï¼š6 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.insert</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    INSERT </span><br><span class="line">    INTO</span><br><span class="line">        tb_user</span><br><span class="line">        ( user_name, password, name, age, email, sex, version ) </span><br><span class="line">    VALUES</span><br><span class="line">        ( &#39;zhangwu&#39;, &#39;123456&#39;, &#39;å¼ äº”&#39;, 30, &#39;zhangwu@itcast.cn&#39;, 2, 1 )</span><br><span class="line"></span><br><span class="line">true</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-24 PM7.51.09.jpg">

<h1 id="ä»£ç ç”Ÿæˆå™¨"><a href="#ä»£ç ç”Ÿæˆå™¨" class="headerlink" title="ä»£ç ç”Ÿæˆå™¨"></a>ä»£ç ç”Ÿæˆå™¨</h1><p>AutoGenerator æ˜¯ MyBatis-Plus çš„ä»£ç ç”Ÿæˆå™¨ï¼Œé€šè¿‡ AutoGenerator å¯ä»¥å¿«é€Ÿç”Ÿæˆ Entityã€Mapperã€MapperXMLã€Serviceã€Controller ç­‰å„ä¸ªæ¨¡å—çš„ä»£ç ï¼Œæå‡å¼€å‘æ•ˆç‡</p>
<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR?p=60" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR?p=60</a></p>
</blockquote>
<h1 id="MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶"><a href="#MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶" class="headerlink" title="MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶"></a>MyBatisXå¿«é€Ÿå¼€å‘æ’ä»¶</h1><p>åŸºäº IDEA çš„å¿«é€Ÿå¼€å‘æ’ä»¶</p>
<p>å®‰è£…ï¼šFile -&gt; Settings -&gt; Pluginsï¼Œæœç´¢å¹¶å®‰è£…</p>
<p>åŠŸèƒ½ï¼šJavaå’Œå¯¹åº”XMLè·³è½¬ï¼›Mapperæ–¹æ³•è‡ªåŠ¨ç”Ÿæˆ XML</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis_plus</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisPlusç¬”è®°05 æ’ä»¶</title>
    <url>/2020/04/24/note-mybatisplus-05/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p>
<p>P49~54</p>
</blockquote>
<h1 id="mybatisçš„æ’ä»¶æœºåˆ¶"><a href="#mybatisçš„æ’ä»¶æœºåˆ¶" class="headerlink" title="mybatisçš„æ’ä»¶æœºåˆ¶"></a>mybatisçš„æ’ä»¶æœºåˆ¶</h1><p>MyBatis å…è®¸åœ¨å·²æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆª</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬:</p>
<ul>
<li><p>Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) </p>
</li>
<li><p>ParameterHandler (getParameterObject, setParameters)</p>
</li>
<li><p>ResultSetHandler (handleResultSets, handleOutputParameters)</p>
</li>
<li><p>StatementHandler (prepare, parameterize, batch, update, query)</p>
</li>
</ul>
<p>å¯ä»¥æ‹¦æˆªï¼š</p>
<ul>
<li>æ‰§è¡Œå™¨çš„æ–¹æ³•</li>
<li>å‚æ•°çš„å¤„ç†</li>
<li>ç»“æœé›†çš„å¤„ç†</li>
<li>Sqlè¯­æ³•æ„å»ºçš„å¤„ç†</li>
</ul>
<p>è‡ªå®šä¹‰æ‹¦æˆªå™¨å¯ä»¥å®ç°Interceptoræ¥å£ï¼Œæ³¨å…¥åˆ°Springå®¹å™¨</p>
<h1 id="æ‰§è¡Œåˆ†ææ’ä»¶"><a href="#æ‰§è¡Œåˆ†ææ’ä»¶" class="headerlink" title="æ‰§è¡Œåˆ†ææ’ä»¶"></a>æ‰§è¡Œåˆ†ææ’ä»¶</h1><p>å¯ç”¨ä½œé˜»æ–­å…¨è¡¨æ›´æ–°ã€åˆ é™¤çš„æ“ä½œ</p>
<p>æ³¨æ„:è¯¥æ’ä»¶ä»…é€‚ç”¨äºå¼€å‘ç¯å¢ƒï¼Œä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒï¼ˆæ€§èƒ½é—®é¢˜ï¼‰</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>MybatisPlusConfigä¸­é…ç½®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SqlExplainInterceptor <span class="title">sqlExplainInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">  SqlExplainInterceptor sqlExplainInterceptor = <span class="keyword">new</span> SqlExplainInterceptor();</span><br><span class="line">  List&lt;ISqlParser&gt; sqlParserList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  sqlParserList.add(<span class="keyword">new</span> BlockAttackSqlParser());</span><br><span class="line">  sqlExplainInterceptor.setSqlParserList(sqlParserList);</span><br><span class="line">  <span class="keyword">return</span> sqlExplainInterceptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">20</span>);</span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.update(user, <span class="keyword">null</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“æœï¼šå…¨è¡¨æ›´æ–°è¢«é˜»æ–­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Prohibition of table update operation</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-24 PM6.51.47.jpg">

<h1 id="æ€§èƒ½åˆ†ææ’ä»¶"><a href="#æ€§èƒ½åˆ†ææ’ä»¶" class="headerlink" title="æ€§èƒ½åˆ†ææ’ä»¶"></a>æ€§èƒ½åˆ†ææ’ä»¶</h1><p>ç”¨äºè¾“å‡ºæ¯æ¡ SQL è¯­å¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå¯ä»¥è®¾ç½®æœ€å¤§æ‰§è¡Œæ—¶é—´ï¼Œè¶…è¿‡æ—¶é—´ä¼šæŠ›å‡ºå¼‚å¸¸</p>
<h2 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>ä¸¤ç§æ–¹å¼ï¼Œå¯ä»¥åƒä¸Šé¢ä¸€æ ·åœ¨Configä¸­é…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨xmlä¸­é…ç½®</p>
<p>è¿™é‡Œç”¨xmlæ–¹å¼</p>
<p>mybatis-config.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL æ‰§è¡Œæ€§èƒ½åˆ†æï¼Œå¼€å‘ç¯å¢ƒä½¿ç”¨ï¼Œçº¿ä¸Šä¸æ¨èã€‚ maxTime æŒ‡çš„æ˜¯ sql æœ€å¤§æ‰§è¡Œæ—¶é•¿ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.baomidou.mybatisplus.extension.plugins.PerformanceInterceptor"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxTime"</span> <span class="attr">value</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--SQLæ˜¯å¦æ ¼å¼åŒ– é»˜è®¤false--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"format"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æ‰§è¡ŒtestSelectById()</p>
<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Timeï¼š10 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.selectById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    SELECT</span><br><span class="line">        id,</span><br><span class="line">        user_name,</span><br><span class="line">        password,</span><br><span class="line">        name,</span><br><span class="line">        age,</span><br><span class="line">        email </span><br><span class="line">    FROM</span><br><span class="line">        tb_user </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line"></span><br><span class="line">User(id&#x3D;2, userName&#x3D;lisi, password&#x3D;123456, name&#x3D;æå››, age&#x3D;20, email&#x3D;test2@itcast.cn)</span><br></pre></td></tr></table></figure>

<h1 id="ä¹è§‚é”æ’ä»¶"><a href="#ä¹è§‚é”æ’ä»¶" class="headerlink" title="ä¹è§‚é”æ’ä»¶"></a>ä¹è§‚é”æ’ä»¶</h1><p>å½“è¦æ›´æ–°ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œå¸Œæœ›è¿™æ¡è®°å½•æ²¡æœ‰è¢«åˆ«äººæ›´æ–°</p>
<p>å®ç°æ–¹å¼:</p>
<ul>
<li>å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰version</li>
<li>æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ªversion</li>
<li>æ‰§è¡Œæ›´æ–°æ—¶ï¼Œ set version = newVersion where version = oldVersion</li>
<li>å¦‚æœversionä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</li>
</ul>
<h2 id="é…ç½®-2"><a href="#é…ç½®-2" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Versionå­—æ®µ"><a href="#Versionå­—æ®µ" class="headerlink" title="Versionå­—æ®µ"></a>Versionå­—æ®µ</h2><p>ä¸ºè¡¨æ·»åŠ versionå­—æ®µï¼Œå¹¶ä¸”è®¾ç½®åˆå§‹å€¼ä¸º1</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`version`</span> <span class="built_in">int</span>(<span class="number">10</span>) <span class="literal">NULL</span> <span class="keyword">AFTER</span> <span class="string">`email`</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> <span class="string">`tb_user`</span> <span class="keyword">SET</span> <span class="string">`version`</span>=<span class="string">'1'</span>;</span><br></pre></td></tr></table></figure>

<p>ä¸ºUserå®ä½“ç±»æ·»åŠ versionå­—æ®µå’Œæ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateVersion</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setId(<span class="number">2L</span>);</span><br><span class="line">  user.setVersion(<span class="number">1</span>); <span class="comment">// å½“å‰versionä¸º1</span></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.updateById(user);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Timeï¼š2 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.updateById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    UPDATE</span><br><span class="line">        tb_user </span><br><span class="line">    SET</span><br><span class="line">        age&#x3D;30,</span><br><span class="line">        version&#x3D;2 </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND version&#x3D;1</span><br><span class="line"></span><br><span class="line">result &#x3D; 1</span><br></pre></td></tr></table></figure>

<p>ä¹è§‚é”æ’ä»¶æ·»åŠ äº†versionæ¡ä»¶ï¼Œå¹¶è®¾ç½®æ–°çš„versionä¸º2</p>
<img src="/images/2020/screencapture2020-04-24 PM7.07.07.jpg">

<p>å¦‚æœå†æ‰§è¡Œä¸€æ¬¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Timeï¼š1 ms - IDï¼šcom.coconutnut.demo.mapper.UserMapper.updateById</span><br><span class="line">Execute SQLï¼š</span><br><span class="line">    UPDATE</span><br><span class="line">        tb_user </span><br><span class="line">    SET</span><br><span class="line">        age&#x3D;30,</span><br><span class="line">        version&#x3D;2 </span><br><span class="line">    WHERE</span><br><span class="line">        id&#x3D;2 </span><br><span class="line">        AND version&#x3D;1</span><br><span class="line"></span><br><span class="line">result &#x3D; 0</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶versionå·²ç»æ˜¯2ï¼Œä¸èƒ½æ‰§è¡Œäº†</p>
<p>æ­£å¸¸çš„ä½¿ç”¨æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateVersion</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">2L</span>); <span class="comment">// æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"></span><br><span class="line">  User userVersion = user.selectById(); <span class="comment">// å½“å‰ç‰ˆæœ¬</span></span><br><span class="line">  user.setAge(<span class="number">30</span>);  <span class="comment">// æ›´æ–°çš„æ•°æ®</span></span><br><span class="line">  user.setVersion(userVersion.getVersion()); <span class="comment">// ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.updateById(user);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç‰¹åˆ«è¯´æ˜"><a href="#ç‰¹åˆ«è¯´æ˜" class="headerlink" title="ç‰¹åˆ«è¯´æ˜"></a>ç‰¹åˆ«è¯´æ˜</h2><ul>
<li>æ”¯æŒçš„æ•°æ®ç±»å‹åªæœ‰:int,Integer,long,Long,Date,Timestamp,LocalDateTime</li>
<li>æ•´æ•°ç±»å‹ä¸‹ newVersion = oldVersion + 1</li>
<li>newVersion ä¼šå›å†™åˆ° entity ä¸­</li>
<li>ä»…æ”¯æŒ updateById(id) ä¸ update(entity, wrapper) æ–¹æ³•</li>
<li>åœ¨ update(entity, wrapper) æ–¹æ³•ä¸‹, wrapper ä¸èƒ½å¤ç”¨</li>
</ul>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis_plus</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisPlusç¬”è®°04 ActiveRecord</title>
    <url>/2020/04/24/note-mybatisplus-04/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p>
<p>P40~45</p>
</blockquote>
<p>å±äºORM(å¯¹è±¡å…³ç³»æ˜ å°„)å±‚</p>
<p>ä¸»è¦æ€æƒ³:</p>
<ul>
<li>æ¯ä¸€ä¸ªæ•°æ®åº“è¡¨å¯¹åº”åˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»çš„æ¯ä¸€ä¸ªå¯¹è±¡å®ä¾‹å¯¹åº”äºæ•°æ®åº“ä¸­è¡¨çš„ä¸€è¡Œè®°å½•;é€šå¸¸è¡¨çš„æ¯ä¸ªå­—æ®µåœ¨ç±»ä¸­éƒ½æœ‰ç›¸åº”çš„Field;</li>
<li>ActiveRecordåŒæ—¶è´Ÿè´£æŠŠè‡ªå·±æŒä¹…åŒ–ï¼Œåœ¨ActiveRecordä¸­å°è£…äº†å¯¹æ•°æ®åº“çš„è®¿é—®ï¼Œå³CURD;</li>
<li>ActiveRecordæ˜¯ä¸€ç§é¢†åŸŸæ¨¡å‹(Domain Model)ï¼Œå°è£…äº†éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘;</li>
</ul>
<h1 id="å¼€å¯AR"><a href="#å¼€å¯AR" class="headerlink" title="å¼€å¯AR"></a>å¼€å¯AR</h1><p>å®ä½“å¯¹è±¡ç»§æ‰¿Modelå³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName</span>(<span class="string">"tb_user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableId</span>(type = IdType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>ä¸éœ€è¦UserMapperäº†ï¼Œç›´æ¥æŸ¥è¯¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">2L</span>);</span><br><span class="line">  User user2 = user.selectById();</span><br><span class="line">  System.out.println(user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">User(id&#x3D;2, userName&#x3D;lisi, password&#x3D;123456, name&#x3D;æå››, age&#x3D;20, email&#x3D;test2@itcast.cn)</span><br></pre></td></tr></table></figure>

<p>å¯¹æ¯”ä»¥å‰çš„æŸ¥è¯¢æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  User user = <span class="keyword">this</span>.userMapper.selectById(<span class="number">2L</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ARåï¼Œä¸éœ€è¦æ˜¾ç¤ºçš„æ³¨å…¥UserMapperï¼Œä½†æ˜¯è¿™ä¸ªç±»è¿˜æ˜¯éœ€è¦çš„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæŠŠè¿™ä¸ªåˆ äº†å°±è¿è¡Œä¸äº†äº†</p>
<h1 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h1><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>æ–¹æ³•ä¸€ï¼šåŒä¸Š</p>
<p>æ–¹æ³•äºŒï¼šæ¡ä»¶æŸ¥è¯¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  QueryWrapper&lt;User&gt; userQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">  userQueryWrapper.le(<span class="string">"age"</span>,<span class="string">"20"</span>);</span><br><span class="line">  List&lt;User&gt; users = user.selectList(userQueryWrapper);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (User user1 : users) &#123;</span><br><span class="line">    System.out.println(user1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setName(<span class="string">"åˆ˜å¤‡"</span>);</span><br><span class="line">  user.setAge(<span class="number">30</span>);</span><br><span class="line">  user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line">  user.setUserName(<span class="string">"liubei"</span>);</span><br><span class="line">  user.setEmail(<span class="string">"liubei@itcast.cn"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">boolean</span> insert = user.insert();</span><br><span class="line"></span><br><span class="line">  System.out.println(insert);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿”å›æ’å…¥æ˜¯å¦æˆåŠŸ</p>
<img src="/images/2020/screencapture2020-04-24 PM6.15.09.jpg" width=500>

<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">5L</span>);</span><br><span class="line">  user.setAge(<span class="number">35</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">boolean</span> update = user.updateById();</span><br><span class="line">  System.out.println(update);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-24 PM6.16.55.jpg" width=500>

<p>ä¹Ÿå¯ä»¥æ ¹æ®æ¡ä»¶ï¼ˆç”¨Wrapperï¼‰æ›´æ–°</p>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User(); user.setId(<span class="number">7L</span>);</span><br><span class="line">  <span class="keyword">boolean</span> delete = user.deleteById();</span><br><span class="line">  System.out.println(delete);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-24 PM6.18.54.jpg" width=500>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis_plus</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisPlusç¬”è®°03 æ¡ä»¶æ„é€ å™¨</title>
    <url>/2020/04/22/note-mybatisplus-03/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p>
<p>p33~39</p>
</blockquote>
<p>Wrapperæ¥å£å®ç°ç±»é‡ç‚¹æœ‰AbstractWrapperå’ŒAbstractChainWrapper</p>
<p>åŒºåˆ«åœ¨äºAbstractChainWrapperé‡‡ç”¨lambdaè¡¨è¾¾å¼ç¼–å†™</p>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>ä»¥allEqä¸ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ¡ä»¶</span></span><br><span class="line">Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;(); </span><br><span class="line">params.put(<span class="string">"name"</span>, <span class="string">"å¼ ä¸‰"</span>);</span><br><span class="line">params.put(<span class="string">"age"</span>, <span class="string">"20"</span>); </span><br><span class="line">params.put(<span class="string">"password"</span>, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">wrapper.allEq(params);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢</span></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">	System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç”Ÿæˆçš„sqlè¯­å¥ä¸º</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_user <span class="keyword">WHERE</span> <span class="keyword">password</span> <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">AND</span> <span class="keyword">name</span> = ? <span class="keyword">AND</span> age = ?</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªå‚æ•°ä¸ºfalseæ—¶å¿½ç•¥å€¼ä¸ºnullçš„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">wrapper.allEq(params,<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„sqlè¯­å¥ä¸º</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_user <span class="keyword">WHERE</span> <span class="keyword">name</span> = ? <span class="keyword">AND</span> age = ?</span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥è®¾ç½®è¿‡æ»¤å™¨</p>
<h1 id="åŸºæœ¬æ¯”è¾ƒæ“ä½œ"><a href="#åŸºæœ¬æ¯”è¾ƒæ“ä½œ" class="headerlink" title="åŸºæœ¬æ¯”è¾ƒæ“ä½œ"></a>åŸºæœ¬æ¯”è¾ƒæ“ä½œ</h1><p><a href="https://mybatis.plus/guide/wrapper.html#abstractwrapper" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<h1 id="æ¨¡ç³ŠæŸ¥è¯¢"><a href="#æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢"></a>æ¨¡ç³ŠæŸ¥è¯¢</h1><p>likeã€notLikeã€likeLeftã€likeRight</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line">wrapper.like(<span class="string">"name"</span>, <span class="string">"æ›¹"</span>); <span class="comment">// %æ›¹%</span></span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">	System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h1><p>orderByï¼ˆé»˜è®¤Ascï¼‰ã€orderByAscã€orderByDesc</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT id,user_name,password,name,age,email FROM tb_user ORDER BY age DESC</span></span><br><span class="line">wrapper.orderByDesc(<span class="string">"age"</span>);</span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">	System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="é€»è¾‘æŸ¥è¯¢"><a href="#é€»è¾‘æŸ¥è¯¢" class="headerlink" title="é€»è¾‘æŸ¥è¯¢"></a>é€»è¾‘æŸ¥è¯¢</h1><p>orã€and</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT id,user_name,password,name,age,email FROM tb_user WHERE name = ? OR age = ?</span></span><br><span class="line">wrapper.eq(<span class="string">"name"</span>,<span class="string">"æå››"</span>).or().eq(<span class="string">"age"</span>, <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">	System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æŒ‡å®šæŸ¥è¯¢å­—æ®µ"><a href="#æŒ‡å®šæŸ¥è¯¢å­—æ®µ" class="headerlink" title="æŒ‡å®šæŸ¥è¯¢å­—æ®µ"></a>æŒ‡å®šæŸ¥è¯¢å­—æ®µ</h1><p>select</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// SELECT id,name,age FROM tb_user WHERE name = ? OR age = ?</span></span><br><span class="line">wrapper.eq(<span class="string">"name"</span>, <span class="string">"æå››"</span>)</span><br><span class="line">.or()</span><br><span class="line">.eq(<span class="string">"age"</span>, <span class="number">24</span>)</span><br><span class="line">.select(<span class="string">"id"</span>, <span class="string">"name"</span>, <span class="string">"age"</span>);</span><br><span class="line"></span><br><span class="line">List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line"><span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">	System.out.println(user); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis_plus</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisPlusç¬”è®°02 é…ç½®</title>
    <url>/2020/04/22/note-mybatisplus-02/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p>
<p>p27~32</p>
</blockquote>
<p><a href="https://mybatis.plus/config/#åŸºæœ¬é…ç½®" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<h1 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h1><h2 id="configLocation"><a href="#configLocation" class="headerlink" title="configLocation"></a>configLocation</h2><p>MyBatis é…ç½®æ–‡ä»¶ä½ç½®</p>
<p>egï¼šresourcesæ–‡ä»¶å¤¹ä¸‹æœ‰mybatis-config.xmlï¼Œè¦å°†å…¶ä½œä¸ºMyBatisé…ç½®æ–‡ä»¶</p>
<p>åˆ™éœ€åœ¨applications.propertiesä¸­é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># æŒ‡å®šå…¨å±€çš„é…ç½®æ–‡ä»¶</span><br><span class="line">mybatis-plus.config-location &#x3D; classpath:mybatis-config.xml</span><br></pre></td></tr></table></figure>

<h2 id="mapperLocations"><a href="#mapperLocations" class="headerlink" title="mapperLocations"></a>mapperLocations</h2><p>æŒ‡å®šmapperæ–‡ä»¶ä½ç½®</p>
<p>å½“é»˜è®¤çš„Mapperä¸å¤Ÿç”¨ï¼ˆå¦‚éœ€è¦å¤šè¡¨æŸ¥è¯¢æ—¶ï¼‰ï¼Œå¯ä»¥æŒ‡å®šè‡ªå®šä¹‰çš„mapperï¼Œåœ¨é‡Œé¢å†™sqlè¯­å¥</p>
<p>ä¾‹å¦‚resourcesä¸­æ–°å»ºmybatisæ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ªUserMapper.xml</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mybatis-plus.mapper-locations &#x3D; classpath*:mybatis&#x2F;*.xml</span><br></pre></td></tr></table></figure>

<p>Mavenå¤šæ¨¡å—é¡¹ç›®çš„æ‰«æè·¯å¾„éœ€ä»¥classpath*å¼€å¤´ï¼ˆå³åŠ åœ¨å¤šä¸ªjaråŒ…ä¸‹çš„xmlæ–‡ä»¶ï¼‰</p>
<h2 id="typeAliasesPackage"><a href="#typeAliasesPackage" class="headerlink" title="typeAliasesPackage"></a>typeAliasesPackage</h2><p>ç»™åŒ…ä¸­çš„ç±»æ³¨å†Œåˆ«åï¼Œæ³¨å†Œååœ¨ Mapper å¯¹åº”çš„ XML æ–‡ä»¶ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»åï¼Œè€Œä¸ç”¨ä½¿ç”¨å…¨é™å®šçš„ç±»å</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mybatis-plus.type-aliases-package &#x3D; cn.itcast.mp.pojo</span><br></pre></td></tr></table></figure>

<h1 id="è¿›é˜¶é…ç½®"><a href="#è¿›é˜¶é…ç½®" class="headerlink" title="è¿›é˜¶é…ç½®"></a>è¿›é˜¶é…ç½®</h1><p>å¤§éƒ½ä¸º MyBatis åŸç”Ÿæ”¯æŒçš„é…ç½®</p>
<p>æ³¨æ„ï¼šå¦‚æœåˆ¶å®šäº†å…¨å±€é…ç½®æ–‡ä»¶ï¼Œéœ€è¦åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œå’Œapplication.propertiesä¸èƒ½å…±å­˜</p>
<h2 id="mapUnderscoreToCamelCase"><a href="#mapUnderscoreToCamelCase" class="headerlink" title="mapUnderscoreToCamelCase"></a>mapUnderscoreToCamelCase</h2><p>æ˜¯å¦å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™æ˜ å°„</p>
<h2 id="cacheEnabled"><a href="#cacheEnabled" class="headerlink" title="cacheEnabled"></a>cacheEnabled</h2><p>å¼€å¯MybatisäºŒçº§ç¼“å­˜ï¼Œé»˜è®¤ä¸º true</p>
<h1 id="DB-ç­–ç•¥é…ç½®"><a href="#DB-ç­–ç•¥é…ç½®" class="headerlink" title="DB ç­–ç•¥é…ç½®"></a>DB ç­–ç•¥é…ç½®</h1><h2 id="idType"><a href="#idType" class="headerlink" title="idType"></a>idType</h2><p>å…¨å±€é»˜è®¤ä¸»é”®ç±»å‹ï¼Œè®¾ç½®åï¼Œå³å¯çœç•¥å®ä½“å¯¹è±¡ä¸­çš„@TableId(type = IdType.AUTO)é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mybatis-plus.global-config.db-config.id-type &#x3D; auto</span><br></pre></td></tr></table></figure>

<h2 id="tablePrefix"><a href="#tablePrefix" class="headerlink" title="tablePrefix"></a>tablePrefix</h2><p>æŒ‡å®šè¡¨åå‰ç¼€ï¼Œå…¨å±€é…ç½®åå¯çœç•¥@TableName()é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mybatis-plus.global-config.db-config.table-prefix &#x3D; tb_</span><br></pre></td></tr></table></figure>

<p>å¦‚ï¼ŒUserç±»é»˜è®¤ä¼šå»æ‰¾userè¡¨ï¼Œå¦‚æœè¦æ‰¾tb_userè¡¨ï¼Œéœ€è¦ä½¿ç”¨æ³¨è§£ï¼Œæˆ–è€…å…¨å±€é…ç½®å‰ç¼€</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis_plus</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisPlusç¬”è®°01 CRUD</title>
    <url>/2020/04/21/note-mybatisplus-01/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1rE41197jR" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1rE41197jR</a></p>
<p>p1~25</p>
</blockquote>
<h1 id="æ•°æ®åº“å‡†å¤‡"><a href="#æ•°æ®åº“å‡†å¤‡" class="headerlink" title="æ•°æ®åº“å‡†å¤‡"></a>æ•°æ®åº“å‡†å¤‡</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºæµ‹è¯•è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb_user`</span> (</span><br><span class="line"><span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'ä¸»é”®ID'</span>, <span class="string">`user_name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'ç”¨æˆ·å'</span>, <span class="string">`password`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'å¯†ç '</span>,</span><br><span class="line"><span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'å§“å'</span>,</span><br><span class="line"><span class="string">`age`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'å¹´é¾„'</span>, <span class="string">`email`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'é‚®ç®±'</span>, PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥æµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'1'</span>, <span class="string">'zhangsan'</span>, <span class="string">'123456'</span>, <span class="string">'å¼ ä¸‰'</span>, <span class="string">'18'</span>, <span class="string">'test1@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'2'</span>, <span class="string">'lisi'</span>, <span class="string">'123456'</span>, <span class="string">'æå››'</span>, <span class="string">'20'</span>, <span class="string">'test2@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'3'</span>, <span class="string">'wangwu'</span>, <span class="string">'123456'</span>, <span class="string">'ç‹äº”'</span>, <span class="string">'28'</span>, <span class="string">'test3@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'4'</span>, <span class="string">'zhaoliu'</span>, <span class="string">'123456'</span>, <span class="string">'èµµå…­'</span>, <span class="string">'21'</span>, <span class="string">'test4@itcast.cn'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_user`</span> (<span class="string">`id`</span>, <span class="string">`user_name`</span>, <span class="string">`password`</span>, <span class="string">`name`</span>, <span class="string">`age`</span>, <span class="string">`email`</span>) <span class="keyword">VALUES</span> (<span class="string">'5'</span>, <span class="string">'sunqi'</span>, <span class="string">'123456'</span>, <span class="string">'å­™ä¸ƒ'</span>, <span class="string">'24'</span>, <span class="string">'test5@itcast.cn'</span>);</span><br></pre></td></tr></table></figure>

<h1 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h1><h2 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mybatis-plusçš„springbootæ”¯æŒ--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--ç®€åŒ–beanä»£ç çš„å·¥å…·åŒ…--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="log4j-properties"><a href="#log4j-properties" class="headerlink" title="log4j.properties"></a>log4j.properties</h3><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,A1</span></span><br><span class="line"><span class="meta">log4j.appender.A1</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.A1.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.A1.layout.ConversionPattern</span>=<span class="string">[%t] [%c]-[%p] %m%n</span></span><br></pre></td></tr></table></figure>

<h3 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h3><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">spring.application.name</span> = <span class="string">itcast-mp-springboot</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/groot? useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">iamgroot</span></span><br></pre></td></tr></table></figure>

<h2 id="å®ä½“ç±»"><a href="#å®ä½“ç±»" class="headerlink" title="å®ä½“ç±»"></a>å®ä½“ç±»</h2><p>ä½¿ç”¨lombokæ³¨è§£ç”Ÿæˆgetã€setæ–¹æ³•</p>
<p>ä½¿ç”¨MybatisPlusæ³¨è§£æŒ‡å®šè¡¨å</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName</span>(<span class="string">"tb_user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  	<span class="meta">@TableId</span>(type = IdType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨@TableIdæŒ‡å®šidçš„å¢é•¿ç­–ç•¥</p>
<h3 id="TableField"><a href="#TableField" class="headerlink" title="@TableField"></a>@TableField</h3><p>å¯è§£å†³çš„é—®é¢˜ï¼š</p>
<ol>
<li><p>å¯¹è±¡ä¸­çš„å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜(éé©¼å³°)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableField</span>(value = <span class="string">"email"</span>)</span><br><span class="line"><span class="keyword">private</span> String mail;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¯¹è±¡ä¸­çš„å±æ€§å­—æ®µåœ¨è¡¨ä¸­ä¸å­˜åœ¨çš„é—®é¢˜</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableField</span>(exist = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> String address;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥è¯¢æ—¶ä¸è¿”å›è¯¥å­—æ®µçš„å€¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableField</span>(select = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> String password;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Mapperæ¥å£"><a href="#Mapperæ¥å£" class="headerlink" title="Mapperæ¥å£"></a>Mapperæ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringBootå¯åŠ¨ç±»"><a href="#SpringBootå¯åŠ¨ç±»" class="headerlink" title="SpringBootå¯åŠ¨ç±»"></a>SpringBootå¯åŠ¨ç±»</h2><p>ä½¿ç”¨@MapperScanè®¾ç½®mapperæ¥å£çš„æ‰«æåŒ…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.coconutnut.demo.mapper"</span>) </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/screencapture2020-04-21 PM12.22.59.jpg" width=300>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">DemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<img src="/images/2020/screencapture2020-04-21 PM12.19.07.jpg">

<h2 id="DEBUG-ä¾èµ–é‡å¤"><a href="#DEBUG-ä¾èµ–é‡å¤" class="headerlink" title="DEBUG ä¾èµ–é‡å¤"></a>DEBUG ä¾èµ–é‡å¤</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤ä¾èµ–ä¸­çš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.slf4j&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;slf4j-log4j12&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<h1 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h1><p>æŸ¥çœ‹UserMapperç»§æ‰¿çš„BaseMapperæºç </p>
<img src="/images/2020/screencapture2020-04-21 PM12.28.46.jpg">

<p>CRUDæ–¹æ³•éƒ½æœ‰äº†</p>
<p>å®˜ç½‘æ–‡æ¡£</p>
<blockquote>
<p><a href="https://mybatis.plus/guide/crud-interface.html#mapper-crud-æ¥å£" target="_blank" rel="noopener">https://mybatis.plus/guide/crud-interface.html#mapper-crud-%E6%8E%A5%E5%8F%A3</a></p>
</blockquote>
<p>ç›´æ¥æµ‹è¯•</p>
<h2 id="æ’å…¥"><a href="#æ’å…¥" class="headerlink" title="æ’å…¥"></a>æ’å…¥</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(T entity)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.demo.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">TestUserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setAge(<span class="number">20</span>);</span><br><span class="line">        user.setUserName(<span class="string">"zhangsi"</span>);</span><br><span class="line">        user.setName(<span class="string">"å¼ å››"</span>);</span><br><span class="line">        user.setEmail(<span class="string">"zhangsi@163.com"</span>);</span><br><span class="line">        user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.insert(user); <span class="comment">// è¿”å›çš„resultæ˜¯å—å½±å“çš„è¡Œæ•°ï¼Œå¹¶ä¸æ˜¯è‡ªå¢åçš„id</span></span><br><span class="line">        System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">        System.out.println(user.getId()); <span class="comment">// è‡ªå¢åçš„idä¼šå›å¡«åˆ°å¯¹è±¡ä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œåï¼Œæ•°æ®åº“å˜åŒ–</p>
<img src="/images/2020/screencapture2020-04-21 PM12.57.42.jpg">

<p>è¾“å‡º</p>
<img src="/images/2020/screencapture2020-04-21 PM12.57.29.jpg">

<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® whereEntity æ¡ä»¶ï¼Œæ›´æ–°è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(@Param(Constants.ENTITY)</span> T entity, @<span class="title">Param</span><span class="params">(Constants.WRAPPER)</span> Wrapper&lt;T&gt; updateWrapper)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® ID ä¿®æ”¹</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateById</span><span class="params">(@Param(Constants.ENTITY)</span> T entity)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="æ ¹æ®idæ›´æ–°"><a href="#æ ¹æ®idæ›´æ–°" class="headerlink" title="æ ¹æ®idæ›´æ–°"></a>æ ¹æ®idæ›´æ–°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setId(<span class="number">1L</span>);</span><br><span class="line">  user.setAge(<span class="number">21</span>);</span><br><span class="line">  <span class="comment">//æ ¹æ®idæ›´æ–°ï¼Œæ›´æ–°ä¸ä¸ºnullçš„å­—æ®µ</span></span><br><span class="line">  <span class="keyword">this</span>.userMapper.updateById(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.29.48.jpg">

<h3 id="æ ¹æ®æ¡ä»¶æ›´æ–°"><a href="#æ ¹æ®æ¡ä»¶æ›´æ–°" class="headerlink" title="æ ¹æ®æ¡ä»¶æ›´æ–°"></a>æ ¹æ®æ¡ä»¶æ›´æ–°</h3><h4 id="QueryWrapper"><a href="#QueryWrapper" class="headerlink" title="QueryWrapper"></a>QueryWrapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">22</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°çš„æ¡ä»¶</span></span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">  <span class="comment">// wrapper.eq("id", 6);</span></span><br><span class="line">  wrapper.eq(<span class="string">"user_name"</span>,<span class="string">"zhangsan"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.update(user, wrapper);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>wrapperä¸­è®¾ç½®å±æ€§ç”¨çš„æ˜¯mysqlè¡¨ä¸­çš„åç§°</p>
<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.35.03.jpg">

<h4 id="UpdateWrapper"><a href="#UpdateWrapper" class="headerlink" title="UpdateWrapper"></a>UpdateWrapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//æ›´æ–°çš„æ¡ä»¶ä»¥åŠå­—æ®µ</span></span><br><span class="line">  UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">  wrapper.eq(<span class="string">"id"</span>, <span class="number">6</span>).set(<span class="string">"age"</span>, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ‰§è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.update(<span class="keyword">null</span>, wrapper);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.37.47.jpg">

<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; wrapper)</span>;</span><br><span class="line"><span class="comment">// åˆ é™¤ï¼ˆæ ¹æ®ID æ‰¹é‡åˆ é™¤ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteBatchIds</span><span class="params">(@Param(Constants.COLLECTION)</span> Collection&lt;? extends Serializable&gt; idList)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® ID åˆ é™¤</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"><span class="comment">// æ ¹æ® columnMap æ¡ä»¶ï¼Œåˆ é™¤è®°å½•</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteByMap</span><span class="params">(@Param(Constants.COLUMN_MAP)</span> Map&lt;String, Object&gt; columnMap)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="deleteById"><a href="#deleteById" class="headerlink" title="deleteById"></a>deleteById</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.deleteById(<span class="number">6L</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.41.34.jpg">

<h3 id="deleteByMap"><a href="#deleteByMap" class="headerlink" title="deleteByMap"></a>deleteByMap</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// å°†columnMapä¸­çš„å…ƒç´ è®¾ç½®ä¸ºåˆ é™¤çš„æ¡ä»¶ï¼Œå¤šä¸ªä¹‹é—´ä¸ºandå…³ç³»</span></span><br><span class="line">  Map&lt;String, Object&gt; columnMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  columnMap.put(<span class="string">"age"</span>,<span class="number">20</span>);</span><br><span class="line">  columnMap.put(<span class="string">"name"</span>,<span class="string">"å¼ ä¸‰"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.deleteByMap(columnMap);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.43.36.jpg">

<p>æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„</p>
<h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ç”¨æ³•1</span></span><br><span class="line"><span class="comment">//        QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;();</span></span><br><span class="line"><span class="comment">//        wrapper.eq("user_name","zhangsan");</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ç”¨æ³•2</span></span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setAge(<span class="number">20</span>);</span><br><span class="line">  user.setName(<span class="string">"å¼ ä¸‰"</span>);</span><br><span class="line">  <span class="comment">// å°†å®ä½“å¯¹è±¡è¿›è¡ŒåŒ…è£…ï¼ŒåŒ…è£…ä¸ºæ“ä½œæ¡ä»¶</span></span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;(user);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.delete(wrapper);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¨èä½¿ç”¨ç”¨æ³•2</p>
<h3 id="deleteByIds"><a href="#deleteByIds" class="headerlink" title="deleteByIds"></a>deleteByIds</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result = <span class="keyword">this</span>.userMapper.deleteBatchIds(Arrays.asList(<span class="number">1L</span>,<span class="number">10L</span>,<span class="number">20L</span>)); </span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® ID æŸ¥è¯¢</span></span><br><span class="line"><span class="function">T <span class="title">selectById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="function">T <span class="title">selectOne</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢ï¼ˆæ ¹æ®ID æ‰¹é‡æŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectBatchIds</span><span class="params">(@Param(Constants.COLLECTION)</span> Collection&lt;? extends Serializable&gt; idList)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectList</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"><span class="comment">// æŸ¥è¯¢ï¼ˆæ ¹æ® columnMap æ¡ä»¶ï¼‰</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectByMap</span><span class="params">(@Param(Constants.COLUMN_MAP)</span> Map&lt;String, Object&gt; columnMap)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; selectMaps(<span class="meta">@Param</span>(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ã€‚æ³¨æ„ï¼š åªè¿”å›ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼</span></span><br><span class="line"><span class="function">List&lt;Object&gt; <span class="title">selectObjs</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ® entity æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ï¼ˆå¹¶ç¿»é¡µï¼‰</span></span><br><span class="line"><span class="function">IPage&lt;T&gt; <span class="title">selectPage</span><span class="params">(IPage&lt;T&gt; page, @Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢å…¨éƒ¨è®°å½•ï¼ˆå¹¶ç¿»é¡µï¼‰</span></span><br><span class="line">IPage&lt;Map&lt;String, Object&gt;&gt; selectMapsPage(IPage&lt;T&gt; page, <span class="meta">@Param</span>(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"><span class="comment">// æ ¹æ® Wrapper æ¡ä»¶ï¼ŒæŸ¥è¯¢æ€»è®°å½•æ•°</span></span><br><span class="line"><span class="function">Integer <span class="title">selectCount</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="selectById"><a href="#selectById" class="headerlink" title="selectById"></a>selectById</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  User user = <span class="keyword">this</span>.userMapper.selectById(<span class="number">2L</span>);</span><br><span class="line">  System.out.println(<span class="string">"result = "</span> + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.52.44.jpg">

<p>æ²¡æŸ¥åˆ°ä¸ºnull</p>
<h3 id="selectOne"><a href="#selectOne" class="headerlink" title="selectOne"></a>selectOne</h3><p>ä¸å­˜åœ¨è¿”å›null</p>
<p>æŸ¥åˆ°å¤šæ¡æŠ¥é”™</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.eq(<span class="string">"name"</span>, <span class="string">"æå››"</span>);</span><br><span class="line">  User user = <span class="keyword">this</span>.userMapper.selectOne(wrapper);</span><br><span class="line">  System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">User(id&#x3D;2, userName&#x3D;lisi, password&#x3D;123456, name&#x3D;æå››, age&#x3D;20, email&#x3D;test2@itcast.cn)</span><br></pre></td></tr></table></figure>

<h3 id="selectBatchIds"><a href="#selectBatchIds" class="headerlink" title="selectBatchIds"></a>selectBatchIds</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectBatchIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectBatchIds(Arrays.asList(<span class="number">2L</span>, <span class="number">3L</span>, <span class="number">100L</span>));</span><br><span class="line">  <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM2.54.08.jpg">

<h3 id="selectCount"><a href="#selectCount" class="headerlink" title="selectCount"></a>selectCount</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.gt(<span class="string">"age"</span>, <span class="number">23</span>); <span class="comment">// å¹´é¾„å¤§äº23å²</span></span><br><span class="line">  Integer count = <span class="keyword">this</span>.userMapper.selectCount(wrapper);</span><br><span class="line">  System.out.println(<span class="string">"count = "</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">count &#x3D; 2</span><br></pre></td></tr></table></figure>

<h3 id="selectList"><a href="#selectList" class="headerlink" title="selectList"></a>selectList</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.gt(<span class="string">"age"</span>, <span class="number">23</span>); <span class="comment">// å¹´é¾„å¤§äº23å²</span></span><br><span class="line">  <span class="comment">//æ ¹æ®æ¡ä»¶æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">  List&lt;User&gt; users = <span class="keyword">this</span>.userMapper.selectList(wrapper);</span><br><span class="line">  <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">    System.out.println(<span class="string">"user = "</span> + user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM3.03.34.jpg">

<h3 id="selectPage"><a href="#selectPage" class="headerlink" title="selectPage"></a>selectPage</h3><p>é…ç½®åˆ†é¡µæ’ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.coconutnut.demo.mapper"</span>) <span class="comment">// è®¾ç½®mapperæ¥å£çš„æ‰«æåŒ…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¿™ä¸ªé…ç½®ç±»ä¹‹åï¼ŒDemoApplicationä¸­çš„@MapperScanå¯ä»¥å»æ‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;User&gt;();</span><br><span class="line">  wrapper.gt(<span class="string">"age"</span>, <span class="number">20</span>); <span class="comment">// å¹´é¾„å¤§äº20å²</span></span><br><span class="line">  Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">  IPage&lt;User&gt; iPage = <span class="keyword">this</span>.userMapper.selectPage(page, wrapper);</span><br><span class="line"></span><br><span class="line">  System.out.println(<span class="string">"æ•°æ®æ€»æ¡æ•°:"</span> + iPage.getTotal());</span><br><span class="line">  System.out.println(<span class="string">"æ€»é¡µæ•°:"</span> + iPage.getPages());</span><br><span class="line">  List&lt;User&gt; users = iPage.getRecords();</span><br><span class="line">  <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">    System.out.println(<span class="string">"user = "</span> + user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå</p>
<img src="/images/2020/screencapture2020-04-21 PM3.11.25.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis_plus</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°05 OpenFeignæœåŠ¡æ¶ˆè´¹è€…</title>
    <url>/2020/04/21/note-springcloud-05/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/103735751" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103735751</a></p>
</blockquote>
<p>Spring Cloud OpenFeign æ˜¯å£°æ˜å¼çš„æœåŠ¡è°ƒç”¨å·¥å…·ï¼Œå®ƒæ•´åˆäº†Ribbonå’ŒHystrixï¼Œæ‹¥æœ‰è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å®¹é”™åŠŸèƒ½</p>
<h1 id="åˆ›å»ºfeign-serviceæ¨¡å—"><a href="#åˆ›å»ºfeign-serviceæ¨¡å—" class="headerlink" title="åˆ›å»ºfeign-serviceæ¨¡å—"></a>åˆ›å»ºfeign-serviceæ¨¡å—</h1><h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><p>æ•™ç¨‹ç»™çš„ä¾èµ–æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¢æˆconsulæ³¨å†Œä¸­å¿ƒï¼Œæ”¹æˆ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°æ²¡æœ‰spring cloudç‰ˆæœ¬å’Œä¾èµ–ç®¡ç†ï¼ŒåŠ ä¸Š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.RELEASE<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹å³ä¾§Mavenæ ä¸­æ²¡æœ‰çº¢çº¿</p>
<p>ä¸‹ä¸€æ­¥</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>æ•™ç¨‹ç»™çš„é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8701</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">feign-service</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8001/eureka/</span></span><br></pre></td></tr></table></figure>

<p>æ¢æˆconsul</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#eureka:</span></span><br><span class="line"><span class="comment">#  client:</span></span><br><span class="line"><span class="comment">#    register-with-eureka: true</span></span><br><span class="line"><span class="comment">#    fetch-registry: true</span></span><br><span class="line"><span class="comment">#    service-url:</span></span><br><span class="line"><span class="comment">#      defaultZone: http://localhost:8001/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cloud:</span></span><br><span class="line">  <span class="attr">consul:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">    <span class="attr">discovery:</span></span><br><span class="line">      <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="EnableFeignClientså¯åŠ¨åŠŸèƒ½"><a href="#EnableFeignClientså¯åŠ¨åŠŸèƒ½" class="headerlink" title="@EnableFeignClientså¯åŠ¨åŠŸèƒ½"></a>@EnableFeignClientså¯åŠ¨åŠŸèƒ½</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@EnableFeignClients</span><br><span class="line">@EnableDiscoveryClient</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class FeignServiceApplication &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(FeignServiceApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ¥å£å’Œæ§åˆ¶å™¨"><a href="#æ¥å£å’Œæ§åˆ¶å™¨" class="headerlink" title="æ¥å£å’Œæ§åˆ¶å™¨"></a>æ¥å£å’Œæ§åˆ¶å™¨</h2><p>æ ¹æ®æºç è¡¥é½å…¶å®ƒä»£ç </p>
<img src="/images/2020/screencapture2020-04-21 AM9.49.59.jpg" width=300>

<h1 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h1><p>å¯åŠ¨consulæœåŠ¡å™¨ï¼Œä¸¤ä¸ªuser-serviceï¼Œfeign-serviceæœåŠ¡</p>
<img src="/images/2020/screencapture2020-04-21 AM9.52.28.jpg">

<p>è°ƒç”¨<a href="http://localhost:8701/user/1å››æ¬¡" target="_blank" rel="noopener">http://localhost:8701/user/1å››æ¬¡</a></p>
<img src="/images/2020screencapture2020-04-21 AM9.53.09.jpg">

<p>äº¤æ›¿æ‰“å°</p>
<img src="/images/2020/screencapture2020-04-21 AM9.53.16.jpg">

<h1 id="æœåŠ¡é™çº§"><a href="#æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h1><p>å‰é¢UserFallbackServiceä¹Ÿæ‹·è¿‡æ¥äº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"user-service"</span>, fallback = UserFallbackService<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨é‡Šä¹ŸåŠ äº†</p>
<p>ä¿®æ”¹application.ymlï¼Œå¼€å¯HystrixåŠŸèƒ½</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åœ¨Feignä¸­å¼€å¯Hystrix</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>å…³é—­ä¸¤ä¸ªuser-serviceæœåŠ¡ï¼Œé‡æ–°å¯åŠ¨feign-service</p>
<p>è°ƒç”¨<a href="http://localhost:8701/user/1è¿›è¡Œæµ‹è¯•" target="_blank" rel="noopener">http://localhost:8701/user/1è¿›è¡Œæµ‹è¯•</a></p>
<p>å‘ç°è¢«é™çº§</p>
<img src="/images/2020/screencapture2020-04-21 AM9.57.28.jpg">

<h1 id="æ—¥å¿—æ‰“å°åŠŸèƒ½"><a href="#æ—¥å¿—æ‰“å°åŠŸèƒ½" class="headerlink" title="æ—¥å¿—æ‰“å°åŠŸèƒ½"></a>æ—¥å¿—æ‰“å°åŠŸèƒ½</h1><p>ç”¨FeignConfigé…ç½®ç±»</p>
<p>åœ¨application.ymlä¸­é…ç½®éœ€è¦å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯</p>
<p>å¯è®¾ç½®æ—¥å¿—çº§åˆ«</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-21 AM10.11.43.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°04 ConsulæœåŠ¡æ²»ç†</title>
    <url>/2020/04/20/note-springcloud-04/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.consul.io/" target="_blank" rel="noopener">https://www.consul.io/</a></p>
</blockquote>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><blockquote>
<p><a href="https://learn.hashicorp.com/consul/getting-started/install.html" target="_blank" rel="noopener">https://learn.hashicorp.com/consul/getting-started/install.html</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">% brew install consul</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">% consul version</span><br><span class="line">Consul v1.6.3</span><br><span class="line">Protocol 2 spoken by default, understands 2 to 3 (agent will automatically use protocol &gt;2 when speaking to compatible agents)</span><br></pre></td></tr></table></figure>

<h1 id="å®˜æ–¹æ•™ç¨‹"><a href="#å®˜æ–¹æ•™ç¨‹" class="headerlink" title="å®˜æ–¹æ•™ç¨‹"></a>å®˜æ–¹æ•™ç¨‹</h1><blockquote>
<p><a href="https://learn.hashicorp.com/consul/getting-started/agent" target="_blank" rel="noopener">https://learn.hashicorp.com/consul/getting-started/agent</a></p>
</blockquote>
<h2 id="å¯åŠ¨æœåŠ¡å™¨"><a href="#å¯åŠ¨æœåŠ¡å™¨" class="headerlink" title="å¯åŠ¨æœåŠ¡å™¨"></a>å¯åŠ¨æœåŠ¡å™¨</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ consul agent -dev</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹èŠ‚ç‚¹"><a href="#æŸ¥çœ‹èŠ‚ç‚¹" class="headerlink" title="æŸ¥çœ‹èŠ‚ç‚¹"></a>æŸ¥çœ‹èŠ‚ç‚¹</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ consul members</span><br></pre></td></tr></table></figure>

<p><strong>å°è¯•</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">% consul members</span><br><span class="line">Node                  Address         Status  Type    Build  Protocol  DC   Segment</span><br><span class="line">Ss-MacBook-Pro.local  127.0.0.1:8301  alive   server  1.6.3  2         dc1  &lt;all&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">coconutnut@Ss-MacBook-Pro ~ % consul members -detailed</span><br><span class="line">Node                  Address         Status  Tags</span><br><span class="line">Ss-MacBook-Pro.local  127.0.0.1:8301  alive   acls&#x3D;0,build&#x3D;1.6.3:7f3b5f3+,dc&#x3D;dc1,id&#x3D;d9c5a17b-cc6b-1ca6-7c72-07304fbcccdc,port&#x3D;8300,raft_vsn&#x3D;3,role&#x3D;consul,segment&#x3D;&lt;all&gt;,vsn&#x3D;2,vsn_max&#x3D;3,vsn_min&#x3D;2,wan_join_port&#x3D;8302</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯memberå‘½ä»¤è·å–çš„ä¿¡æ¯åªæ˜¯eventually consistentçš„</p>
<p>ä¸€è‡´æ€§æ›´å¼ºçš„æ–¹å¼æ˜¯ä½¿ç”¨http api</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl localhost:8500&#x2F;v1&#x2F;catalog&#x2F;nodes</span><br></pre></td></tr></table></figure>

<p><strong>å°è¯•</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">% curl localhost:8500&#x2F;v1&#x2F;catalog&#x2F;nodes</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;ID&quot;: &quot;d9c5a17b-cc6b-1ca6-7c72-07304fbcccdc&quot;,</span><br><span class="line">        &quot;Node&quot;: &quot;Ss-MacBook-Pro.local&quot;,</span><br><span class="line">        &quot;Address&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">        &quot;Datacenter&quot;: &quot;dc1&quot;,</span><br><span class="line">        &quot;TaggedAddresses&quot;: &#123;</span><br><span class="line">            &quot;lan&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">            &quot;wan&quot;: &quot;127.0.0.1&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Meta&quot;: &#123;</span><br><span class="line">            &quot;consul-network-segment&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;CreateIndex&quot;: 10,</span><br><span class="line">        &quot;ModifyIndex&quot;: 11</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç”¨dns</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">% dig @127.0.0.1 -p 8600 Judiths-MBP.node.consul</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @127.0.0.1 -p 8600 Judiths-MBP.node.consul</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NXDOMAIN, id: 33684</span><br><span class="line">;; flags: qr aa rd; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1</span><br><span class="line">;; WARNING: recursion requested but not available</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;Judiths-MBP.node.consul.	IN	A</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">consul.			0	IN	SOA	ns.consul. hostmaster.consul. 1587353730 3600 600 86400 0</span><br><span class="line"></span><br><span class="line">;; Query time: 0 msec</span><br><span class="line">;; SERVER: 127.0.0.1#8600(127.0.0.1)</span><br><span class="line">;; WHEN: Mon Apr 20 11:35:30 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 102</span><br></pre></td></tr></table></figure>

<h2 id="ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹"><a href="#ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹" class="headerlink" title="ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹"></a>ä¼˜é›…çš„å…³é—­èŠ‚ç‚¹</h2><p>ctrl+C æš‚åœæœåŠ¡å™¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ consul leave</span><br></pre></td></tr></table></figure>

<h1 id="æ³¨å†Œåˆ°consul"><a href="#æ³¨å†Œåˆ°consul" class="headerlink" title="æ³¨å†Œåˆ°consul"></a>æ³¨å†Œåˆ°consul</h1><blockquote>
<p><a href="https://juejin.im/post/5db05582f265da4d4c20180f" target="_blank" rel="noopener">https://juejin.im/post/5db05582f265da4d4c20180f</a></p>
</blockquote>
<p>å°†ä»¥å‰æ³¨å†Œåˆ°eurekaçš„æœåŠ¡æ”¹åˆ°consul</p>
<p>user-serviceæ¨¡å—</p>
<p>ä¿®æ”¹ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-consul-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#eureka:</span></span><br><span class="line"><span class="comment">#  client:</span></span><br><span class="line"><span class="comment">#    register-with-eureka: true</span></span><br><span class="line"><span class="comment">#    fetch-registry: true</span></span><br><span class="line"><span class="comment">#    service-url:</span></span><br><span class="line"><span class="comment">#      defaultZone: http://localhost:8001/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cloud:</span></span><br><span class="line">  <span class="attr">consul:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8500</span></span><br><span class="line">    <span class="attr">discovery:</span></span><br><span class="line">      <span class="attr">service-name:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br></pre></td></tr></table></figure>

<p>ribbon-serviceæ¨¡å—ä¹Ÿæ˜¯</p>
<img src="/images/2020/screencapture2020-04-20 AM11.50.55.jpg">

<p> Service Checksæ˜¯Xï¼Œä½†æ˜¯å¯ä»¥è®¿é—®ï¼Ÿ</p>
<img src="/images/2020/screencapture2020-04-20 AM11.51.51.jpg">

<p>ä½†æ˜¯<a href="http://localhost:8301/user/1è·å–ä¸äº†" target="_blank" rel="noopener">http://localhost:8301/user/1è·å–ä¸äº†</a></p>
<p>æŠ¥é”™ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java.lang.IllegalStateException: No instances available for user-service</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://blog.csdn.net/kxj19980524/article/details/86935415" target="_blank" rel="noopener">https://blog.csdn.net/kxj19980524/article/details/86935415</a></p>
</blockquote>
<p>è¿˜éœ€è¦åŠ ä¸€ä¸ªç›‘æ§ä¸­å¿ƒçš„ä¾èµ–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>é‡å¯</p>
<img src="/images/2020/screencapture2020-04-20 AM11.58.30.jpg">

<p>è®¿é—®<a href="http://localhost:8301/user/1å››æ¬¡" target="_blank" rel="noopener">http://localhost:8301/user/1å››æ¬¡</a></p>
<p>æ§åˆ¶å°è¾“å‡º</p>
<img src="/images/2020/screencapture2020-04-20 AM11.58.49.jpg">

<p>äº¤æ›¿è°ƒç”¨</p>
<img src="/images/2020/screencapture2020-04-20 AM11.58.58.jpg">

<p>æˆåŠŸ</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç»ˆç«¯å¯åŠ¨consulæœåŠ¡å™¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ consul agent -dev</span><br></pre></td></tr></table></figure>

<p>Ideaæ¨¡å— consulå®¢æˆ·ç«¯</p>
<p>ä¾èµ–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.cloud&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cloud:</span><br><span class="line">  consul:</span><br><span class="line">    host: localhost</span><br><span class="line">    port: 8500</span><br><span class="line">    discovery:</span><br><span class="line">      service-name: $&#123;spring.application.name&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>axiosè¯·æ±‚è·¨åŸŸé—®é¢˜</title>
    <url>/2020/04/18/debug/</url>
    <content><![CDATA[<img src="/images/2020/screencapture2020-04-18 PM12.01.36.jpg">

<p>å‘ç°æœ‰è·¨åŸŸé—®é¢˜</p>
<p>æŸ¥åˆ°</p>
<blockquote>
<p><a href="https://www.cnblogs.com/l-y-h/p/11815452.html" target="_blank" rel="noopener">https://www.cnblogs.com/l-y-h/p/11815452.html</a></p>
</blockquote>
<p>ç…§ç€æ”¹äº†ä¸€ä¸‹</p>
<p>ä½†æ˜¯åˆå‡ºç°äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Cannot set property $http of #&lt;Vue&gt; which has only a getter at eval axios</span><br></pre></td></tr></table></figure>

<p>æœ€åè§£å†³æ–¹æ³•</p>
<p>vue.config.js</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        proxy: &#123;</span><br><span class="line">            &#39;&#x2F;api&#39;: &#123;</span><br><span class="line">                target: &#39;http:&#x2F;&#x2F;***:3000&#x2F;&#39;,</span><br><span class="line">                &#x2F;&#x2F; å…è®¸è·¨åŸŸ</span><br><span class="line">                changeOrigin: true,</span><br><span class="line">                ws: true,</span><br><span class="line">                pathRewrite: &#123;</span><br><span class="line">                    &#39;^&#x2F;api&#39;: &#39;&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$axios.get(<span class="string">'/api/findall'</span>).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(response.data)</span><br><span class="line">            &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                alert(error);</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Debug</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Axureç¬”è®°</title>
    <url>/2020/04/16/note-axure/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Yx411f7d6" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Yx411f7d6</a></p>
</blockquote>
<h1 id="æ ‡å°º"><a href="#æ ‡å°º" class="headerlink" title="æ ‡å°º"></a>æ ‡å°º</h1><p>æŒ‰ä½å°ºå­æ‹–ä¸‹æ¥</p>
<img src="/images/2020/screencapture2020-04-16 AM11.19.53.jpg">

<p>å·¦ä¾§ä¹Ÿæ˜¯</p>
<h1 id="åœ†è§’"><a href="#åœ†è§’" class="headerlink" title="åœ†è§’"></a>åœ†è§’</h1><p>æŒ‰ä½é»„è‰²ä¸‰è§’æ‹–åŠ¨</p>
<img src="/images/2020/screencapture2020-04-16 AM11.34.03.jpg">

<h1 id="å¹³å‡æ’å¸ƒ"><a href="#å¹³å‡æ’å¸ƒ" class="headerlink" title="å¹³å‡æ’å¸ƒ"></a>å¹³å‡æ’å¸ƒ</h1><p>é€‰ä¸­å‡ ä¸ªå…ƒç´ ï¼Œç‚¹æ°´å¹³</p>
<img src="/images/2020/screencapture2020-04-16 AM11.37.11.jpg">

<h1 id="åˆ‡å‰²é¡¶æ "><a href="#åˆ‡å‰²é¡¶æ " class="headerlink" title="åˆ‡å‰²é¡¶æ "></a>åˆ‡å‰²é¡¶æ </h1><p>å³é”®-&gt;åˆ†å‰²å›¾ç‰‡</p>
<img src="/images/2020/screencapture2020-04-16 PM12.08.32.jpg">

<h1 id="åŠ¨ä½œ"><a href="#åŠ¨ä½œ" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h1><p>å…ˆå»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªé¡µé¢å¯¹åº”ä¸€é¡µï¼Œå¤§å°ã€ä½ç½®ç›¸åŒ</p>
<p>ç”¨çƒ­åŒºç½©åœ¨ç‚¹å‡»åŒºåŸŸä¸Š</p>
<p>æ·»åŠ äº¤äº’</p>
<img src="/images/2020/screencapture2020-04-16 PM12.27.48.jpg">

<p>è·³è½¬é¡µé¢ å¯é€‰æ‹©æ‰“å¼€é“¾æ¥</p>
<hr>
<p>ä¸Šæ‰‹å®Œæˆ</p>
<img src="/images/2020/screencapture2020-04-16 PM12.31.48.jpg">

<img src="/images/2020/screencapture2020-04-16 PM12.31.52.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>tool</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°03 Hystrixæ–­è·¯å™¨</title>
    <url>/2020/04/12/note-springcloud-03/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/103732497" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103732497</a></p>
</blockquote>
<p>HystrixåŠŸèƒ½ï¼šæœåŠ¡é™çº§ã€æœåŠ¡ç†”æ–­ã€çº¿ç¨‹éš”ç¦»ã€è¯·æ±‚ç¼“å­˜ã€è¯·æ±‚åˆå¹¶ã€æœåŠ¡ç›‘æ§ç­‰</p>
<h1 id="åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—"><a href="#åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—" class="headerlink" title="åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—"></a>åˆ›å»ºä¸€ä¸ªhystrix-serviceæ¨¡å—</h1><p>ç»è¿‡å‰é¢ä¸€ç³»åˆ—æ‰å¿ƒæ“ä½œï¼Œè¿™æ¬¡åˆ›å»ºçš„æ—¶å€™æ²¡æœ‰ç”¨Spring InitializeråŠ ä¾èµ–ï¼Œç›´æ¥æ”¹çš„pom.xmlå¹¶ä¿®æ”¹ç‰ˆæœ¬</p>
<p>@EnableCircuitBreakerå¼€å¯æ–­è·¯å™¨åŠŸèƒ½</p>
<p>pomä¸­è¿˜è¦åŠ ä¸€ä¸ªä¾èµ–</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;cn.hutool&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;hutool-all&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;version&gt;5.1.0&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ¨¡å—ä¹Ÿæ·»åŠ äº†Ribbonçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½</p>
<p>ä½†æ˜¯pomä¸­å¹¶æ²¡æœ‰é…ç½®è¿™ä¸ªä¾èµ–</p>
<p>çœ‹äº†ä¸‹ä¾èµ–å›¾å‘ç°æ˜¯eureka-clientä¾èµ–çš„</p>
<img src="/images/2020/screencapture2020-04-12 PM4.24.37.jpg">

<h2 id="æœåŠ¡é™çº§"><a href="#æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h2><p>åœ¨UserHystrixControllerä¸­æ·»åŠ ç”¨äºæµ‹è¯•æœåŠ¡é™çº§çš„æ¥å£</p>
<p>åœ¨UserServiceä¸­æ·»åŠ è°ƒç”¨æ–¹æ³•ä¸æœåŠ¡é™çº§æ–¹æ³•ï¼Œå¹¶æ·»åŠ @HystrixCommandæ³¨è§£</p>
<p>å¯åŠ¨eureka-serverã€user-serviceã€hystrix-serviceæœåŠ¡</p>
<img src="/images/2020/screencapture2020-04-12 PM5.16.10.jpg">

<p>å…³é—­user-serviceæœåŠ¡é‡æ–°æµ‹è¯•è¯¥æ¥å£</p>
<img src="/images/2020/screencapture2020-04-12 PM5.16.42.jpg">

<p>åé¢æµ‹è¯•å¿½ç•¥æŸäº›å¼‚å¸¸é™çº§ã€ç¼“å­˜ã€è¯·æ±‚åˆå¹¶è¡¨ç°å‡å’Œæ•™ç¨‹ä¸€æ ·</p>
<img src="/images/2020/screencapture2020-04-12 PM5.35.06.jpg">

<h2 id="DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥"><a href="#DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥" class="headerlink" title="DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥"></a>DEBUGï¼šè°ƒç”¨æœåŠ¡å¤±è´¥</h2><p>å¯åŠ¨åæ³¨å†Œä¸­å¿ƒ</p>
<img src="/images/2020/screencapture2020-04-12 PM4.31.04.jpg">

<p>è°ƒç”¨æµ‹è¯•æ–¹æ³•å</p>
<img src="/images/2020/screencapture2020-04-12 PM4.31.10.jpg">

<p>ç›´æ¥å¤±è´¥äº†ï¼Ÿ</p>
<p>è¯•è¯•åŸæœåŠ¡åœ°å€</p>
<img src="/images/2020/screencapture2020-04-12 PM4.32.40.jpg">

<p>æ²¡é—®é¢˜</p>
<p>è¿™ä¸ªbugä¼¼æ›¾ç›¸è¯†</p>
<p>ä¸Šæ¬¡åœ¨ribbon-serviceä¸­æ·»åŠ äº†ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.netflix.ribbon<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ribbon-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>hystrix-serviceä¸­ä¹ŸåŠ ä¸€ä¸ªè¯•è¯•</p>
<p>æ³¨å†Œä¸­å¿ƒå¤šäº†è­¦å‘Š</p>
<img src="/images/2020/screencapture2020-04-12 PM4.35.28.jpg">

<p>è¿è¡Œ*2</p>
<p>è¿˜æ˜¯å¤±è´¥äº†</p>
<p>çœ‹ä¸‹Maven</p>
<img src="/images/2020/screencapture2020-04-12 PM4.43.25.jpg">

<p>åŠ ä¸ªç‰ˆæœ¬</p>
<p>ribbonæ¨¡å—ç”¨çš„æ˜¯2.3.0</p>
<p>è¿è¡Œ*3</p>
<p>è¿˜æ˜¯æŒ‚äº†</p>
<p>æ‹¿æºç çš„è¿™ä¸‰ä¸ªæ¨¡å—è¯•è¯•</p>
<img src="/images/2020/screencapture2020-04-12 PM4.47.14.jpg">

<p>æ˜¯å¯ä»¥çš„</p>
<p>å¯¹æ¯”ç‰ˆæœ¬</p>
<img src="/images/2020/screencapture2020-04-12 PM4.49.02.jpg">

<p>å…¨éƒ¨æ”¹æˆä¸€æ ·çš„</p>
<p>å‘ç°æºç pomä¸­è¿˜å¤šäº†ä¸€ä¸ª</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥åŠ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>éš¾æ€ªå‰é¢springframework-cloudçš„æ¨¡å—æ€»æ˜¯æ²¡æœ‰ç‰ˆæœ¬å·ï¼ŒåŸæ¥æ˜¯æ²¡åŠ è¿™ä¸ª</p>
<p>ï¼ˆè§£å†³äº†å‰é¢ç¬”è®°02ä¸­ä¸€ä¸ªMARKï¼‰</p>
<p>è¿è¡Œ*4</p>
<p>è¿˜ğŸ¥¶æ˜¯ğŸ¥¶æŒ‚ğŸ¥¶äº†</p>
<p>å†æ¥ä¸€ä¸ªä¸ªæ¯”ä»£ç </p>
<p>æ²¡å·®å•Šï¼Ÿ</p>
<p>éš¾é“æ˜¯å…¶å®ƒæ¨¡å—çš„ä¾èµ–ä¹Ÿè¦æ”¹ï¼Ÿæ”¹å§</p>
<p>å‘ç°å‰é¢å¤§éƒ¨åˆ†éƒ½æ˜¯æœ‰dependencyManagementçš„ï¼Œæ‰€ä»¥å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå˜åŠ¨</p>
<p>è¿è¡Œ*5</p>
<p>æŒ‚</p>
<p>åˆšæ‰æŠŠspring-boot-starter-actuatoråˆ äº†ï¼Œé‡æ–°åŠ ä¸Š</p>
<p>è¿è¡Œ*6</p>
<p>ï¼æˆåŠŸäº†</p>
<p>å¯æ˜¯è¿™ä¸ªæ—¶å€™å…¶å®ƒç‰ˆæœ¬éƒ½å’Œæºç ä¸€æ ·äº†ï¼Œä½†æ˜¯æºç æ²¡æœ‰ç”¨è¿™ä¸ªå•Šï¼Ÿ-MARK-</p>
<h2 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h2><ol>
<li><p>ç‰ˆæœ¬ ç‰ˆæœ¬ ç‰ˆæœ¬</p>
</li>
<li><p>æ³¨å†Œä¸­å¿ƒæœ‰ï¼Œä½†æ‰¾ä¸åˆ°æœåŠ¡ï¼Œè¯•è¯•åŠ ä¸Š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-12 PM5.36.45.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°02 Ribbonè´Ÿè½½å‡è¡¡</title>
    <url>/2020/04/09/note-springcloud-02/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/103729080" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103729080</a></p>
</blockquote>
<h1 id="user-serviceæ¨¡å—"><a href="#user-serviceæ¨¡å—" class="headerlink" title="user-serviceæ¨¡å—"></a>user-serviceæ¨¡å—</h1><ol>
<li>åˆ›å»ºuser-serviceæ¨¡å—</li>
<li>pom.xmlæ·»åŠ ä¾èµ–</li>
<li>é…ç½®application.yml</li>
<li>å®ä½“ç±»å’Œå“åº”ç±»</li>
<li>æ§åˆ¶å™¨</li>
<li>Serviceæ¥å£å’Œå®ç°ç±»</li>
</ol>
<h1 id="ribbon-serviceæ¨¡å—"><a href="#ribbon-serviceæ¨¡å—" class="headerlink" title="ribbon-serviceæ¨¡å—"></a>ribbon-serviceæ¨¡å—</h1><ol>
<li>åˆ›å»ºribbon-serviceæ¨¡å—</li>
<li>pom.xmlæ·»åŠ ä¾èµ–</li>
<li>é…ç½®application.yml</li>
<li>@LoadBalancedæ³¨è§£èµ‹äºˆRestTemplateè´Ÿè½½å‡è¡¡çš„èƒ½åŠ›</li>
<li>å®ä½“ç±»å’Œå“åº”ç±»</li>
<li>æ§åˆ¶å™¨</li>
</ol>
<h1 id="è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º"><a href="#è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º" class="headerlink" title="è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º"></a>è´Ÿè½½å‡è¡¡åŠŸèƒ½æ¼”ç¤º</h1><ol>
<li>å¼€å¯æœåŠ¡</li>
</ol>
<p>8001å¼€ä¸€ä¸ªServerï¼ˆä¸Šæ¬¡çš„æ¨¡å—ï¼‰</p>
<p>8201ã€8202å„å¼€ä¸€ä¸ªService</p>
<img src="/images/2020/screencapture2020-04-09 PM7.55.27.jpg">

<p>è¿™æ¬¡æ˜¯åŒæ ·çš„é…ç½®æ–‡ä»¶ï¼Œ2ä¸ªç«¯å£å„å¼€ä¸€ä¸ªï¼Œæ”¹Active profiles</p>
<p>ä¸Šæ¬¡æ˜¯ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œå¼€åœ¨ä¸åŒçš„ç«¯å£ï¼Œç”¨Override parameters</p>
<p>8301å¼€Ribbon Service</p>
<img src="/images/2020/screencapture2020-04-09 PM9.36.41.jpg">

<ol start="2">
<li>è°ƒç”¨æ¥å£è¿›è¡Œæµ‹è¯•</li>
</ol>
<img src="/images/2020/screencapture2020-04-10 AM10.28.54.jpg">

<p>8201</p>
<img src="/images/2020/screencapture2020-04-10 AM10.32.24.jpg">

<p>8202</p>
<img src="/images/2020/screencapture2020-04-10 AM10.32.33.jpg">

<h2 id="DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ"><a href="#DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ" class="headerlink" title="DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ"></a>DEBUGï¼šè¿è¡Œåæ²¡æœ‰æ³¨å†Œ</h2><p>å¯åŠ¨å‡ ä¸ªæœåŠ¡å</p>
<img src="/images/2020/screencapture2020-04-09 PM7.59.13.jpg">

<p>ä½†æ˜¯æµè§ˆå™¨ä¸­æŸ¥çœ‹</p>
<img src="/images/2020/screencapture2020-04-09 PM7.59.23.jpg">

<p>å‘ç°åˆå¿˜è®°åŠ @EnableDiscoveryClientäº†</p>
<p>é‡å¯</p>
<p>è¿˜æ˜¯æ²¡æœ‰æ³¨å†Œä¸Š</p>
<p><strong>å°è¯•1</strong></p>
<blockquote>
<p><a href="https://blog.csdn.net/yangyongming_888/article/details/83859092" target="_blank" rel="noopener">https://blog.csdn.net/yangyongming_888/article/details/83859092</a></p>
</blockquote>
<p>è¯´æ˜¯ä¾èµ–å¸¦starterå’Œä¸å¸¦starter</p>
<p>ä½†æ˜¯çœ‹äº†ä¸‹ä¸‰ä¸ªpom.xmlä¸­éƒ½æ˜¯å¸¦starterçš„</p>
<p>å†æ¯”è¾ƒä¸€ä¸‹ä¾èµ–</p>
<p>æºç -eureka-server</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¡¹ç›®-eureka-server</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æºç -ribbon-service</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¡¹ç›®-ribbon-service</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æºç -user-service</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¡¹ç›®-user-service</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸€æ ·ï¼Œçœ‹æ¥ä¸æ˜¯è¿™ä¸ªé—®é¢˜</p>
<p><strong>å°è¯•2</strong></p>
<p>å…³é—­serverï¼Œç›´æ¥å¯åŠ¨serviceï¼Œå‘ç°ä¹Ÿå¯åŠ¨äº†ï¼Œå¹¶æ²¡æœ‰æŠ¥é”™</p>
<p>ä½†æ˜¯ä¸Šæ¬¡çš„clientå¦‚æœåœ¨æ²¡å¼€serviceçš„æ—¶å€™å¯åŠ¨ä¼šæŠ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">com.sun.jersey.api.client.ClientHandlerException: java.net.ConnectException: Connection refused (Connection refused)</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ä¹Ÿè®¸æ ¹æœ¬å°±æ²¡æœ‰è¿ä¸ŠæœåŠ¡å™¨ï¼Ÿ</p>
<p>éš¾é“æ˜¯ymlæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mvn -X clean install</span><br></pre></td></tr></table></figure>

<p>æ²¡ç”¨</p>
<blockquote>
<p><a href="https://segmentfault.com/q/1010000012008825" target="_blank" rel="noopener">https://segmentfault.com/q/1010000012008825</a></p>
</blockquote>
<p>æœ‰è¯´æ˜¯ymlçš„ç¼©è¿›é—®é¢˜</p>
<p>çœ‹äº†ä¸€ä¸‹ä¸Šæ¬¡å¯ä»¥æ³¨å†Œçš„æœåŠ¡çš„yml</p>
<img src="/images/2020/screencapture2020-04-09 PM8.49.31.jpg">

<p>è¿™æ¬¡çš„</p>
<img src="/images/2020/screencapture2020-04-09 PM8.49.35.jpg">

<p>å‘ç°æ³¨å†Œçš„trueæ˜¯ç™½è‰²çš„</p>
<p>æç¤º</p>
<img src="/images/2020/screencapture2020-04-09 PM8.53.23.jpg">

<p>ç¡®å®æœ‰é—®é¢˜</p>
<p>æŠŠpom.xmlä¸­spring-cloud-starter-netflix-eureka-clientçš„ä¾èµ–æ³¨é‡Šçš„ï¼Œä¾ç„¶èƒ½å¯åŠ¨</p>
<blockquote>
<p><a href="https://ask.csdn.net/questions/719186" target="_blank" rel="noopener">https://ask.csdn.net/questions/719186</a></p>
</blockquote>
<p>æœ‰è¯´åŠ ç‰ˆæœ¬å·çš„</p>
<p>æ²¡ç”¨</p>
<p>æƒ³æƒ³å’Œä¸Šæ¬¡åˆ›å»ºçš„åŒºåˆ«ï¼Œä¸Šæ¬¡æ˜¯åœ¨åˆ›å»ºæ¨¡å—çš„æ—¶å€™é€šè¿‡Spring Initializeré€‰æ‹©äº†Eureka Discovery Clientçš„ä¾èµ–</p>
<p>è¯•è¯•åˆ›å»ºä¸€ä¸ªuser-service2ï¼Œåˆ›å»ºçš„æ—¶å€™é€‰ä¸ŠEureka Discovery Client</p>
<p>æŠŠapplication.ymlçš„å†…å®¹å¤åˆ¶è¿‡å»ï¼Œå¯ä»¥è§£æ</p>
<p>å®ƒçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>user-serviceçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ²¡å·®å•Š</p>
<p>é‚£éš¾é“æ˜¯ä¾èµ–æ²¡æœ‰å¯¼å…¥</p>
<p>çœ‹ä¸‹Maven</p>
<img src="/images/2020/screencapture2020-04-09 PM9.14.59.jpg">

<p>???</p>
<p>éš¾é“çœŸæ˜¯æ²¡æœ‰ç‰ˆæœ¬å·</p>
<p>è€Œä¸”ä¸ºä»€ä¹ˆå‰é¢çš„æ¨¡å—ä¹Ÿéƒ½æ˜¯çº¢çš„ï¼Œé‚£æ˜¯æ€ä¹ˆè¿è¡ŒæˆåŠŸçš„ è¿·æƒ‘</p>
<p>ç‚¹è¿›å»çœ‹ä¸€ä¸‹</p>
<img src="/images/2020/screencapture2020-04-09 PM9.15.46.jpg">

<p>ä¹Ÿè®¸åªæ˜¯éƒ¨åˆ†å†²çªæ‰€ä»¥è¿˜èƒ½è¿è¡Œï¼Ÿ</p>
<p>æ€»ä¹‹å…ˆåŠ ä¸ªç‰ˆæœ¬å·</p>
<img src="/images/2020/screencapture2020-04-09 PM9.23.48.jpg">

<p>åŠ äº†ä¹‹åè¿˜æ˜¯unknown</p>
<p>é‡å¯ä¹Ÿæ˜¯</p>
<p>å‘ç°å³ä¸‹è§’åœ¨ä¸‹è½½</p>
<p>ä¸‹å®Œä¹‹åå˜æˆäº†Mavenä¸­å˜æˆäº†2.2.2.RELEASE</p>
<p>æ¿€åŠ¨åœ°æ“æ“æ‰‹</p>
<img src="/images/2020/screencapture2020-04-09 PM9.27.27.jpg">

<p>æˆåŠŸï¼</p>
<img src="/images/2020/screencapture2020-04-09 PM9.29.40.jpg">

<p>æ³¨å†Œä¸Šäº†</p>
<p>ç»™ribbon-serviceä¹ŸåŠ ä¸ªç‰ˆæœ¬</p>
<p>åŠ åœ¨propertiesé‡Œä¼¼ä¹ä¸ç®¡ç”¨ï¼Œæš‚æ—¶éƒ½åŠ åœ¨dependencyé‡Œå¥½äº†</p>
<img src="/images/2020/screencapture2020-04-09 PM9.31.51.jpg">

<h2 id="DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜"><a href="#DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜" class="headerlink" title="DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜"></a>DEBUGï¼šè°ƒç”¨æ¥å£è°ƒè¯•çš„é—®é¢˜</h2><p>å‡ºç°Whitelabel Error Page</p>
<p>æŠ¥é”™æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-09 21:37:37.483 ERROR 3503 --- [nio-8301-exec-1] o.a.c.c.C.[.[.[&#x2F;].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Failed to process import candidates for configuration class [org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration]; nested exception is java.lang.IllegalStateException: Failed to introspect annotated methods on class org.springframework.cloud.netflix.ribbon.RestClientRibbonConfiguration] with root cause</span><br><span class="line"></span><br><span class="line">java.lang.ClassNotFoundException: com.netflix.niws.client.http.RestClient</span><br><span class="line">	at java.net.URLClassLoader.findClass(URLClassLoader.java:382) ~[na:1.8.0_241]</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:418) ~[na:1.8.0_241]</span><br></pre></td></tr></table></figure>

<p>æ‰¾ä¸åˆ°com.netflix.niws.client.http.RestClient</p>
<p>çœ‹ä¸€ä¸‹ä¾èµ–</p>
<img src="/images/2020/screencapture2020-04-09 PM9.46.14.jpg">

<p>ä¼¼ä¹æœ‰å¾ˆå¤šå†²çª</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/50675895/java-lang-classnotfoundexception-com-netflix-discovery-eurekaclientconfig" target="_blank" rel="noopener">https://stackoverflow.com/questions/50675895/java-lang-classnotfoundexception-com-netflix-discovery-eurekaclientconfig</a></p>
<p>You should select only <em>Eureka Server</em> using <em>spring Initializr</em> while creating eureka server project.</p>
</blockquote>
<p>â€¦</p>
<p>è¯•ä¸€ä¸‹é‡æ–°åˆ›å»º</p>
<img src="/images/2020/screencapture2020-04-09 PM10.00.26.jpg" width=400>

<p>å°±æ²¡æœ‰å†²çªäº†</p>
<p>è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java.lang.ClassNotFoundException: com.netflix.niws.client.http.RestClient</span><br></pre></td></tr></table></figure>

<p>æ€ä¹ˆè¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>æŠŠribbonçš„ä¾èµ–æŒªåˆ°å‰é¢æ¥ä¼˜å…ˆæ‰¾å‘¢ï¼Ÿ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯ä¸è¡Œ</p>
<p>å†ç¿»ä¸€ä¸‹æŠ¥é”™å‘ç°æ˜¯getUserå‡½æ•°çš„é—®é¢˜</p>
<img src="/images/2020/screencapture2020-04-09 PM10.19.03.jpg">

<p>åœ¨é‡Œé¢æ‰“å°ä¸€ä¸‹è·¯å¾„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">getUser</span><span class="params">(@PathVariable Long id)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"ã€getUserä¸­ã€‘userServiceUrlï¼š"</span>+userServiceUrl);</span><br><span class="line">  <span class="keyword">return</span> restTemplate.getForObject(userServiceUrl + <span class="string">"/user/&#123;1&#125;"</span>, Result<span class="class">.<span class="keyword">class</span>, <span class="title">id</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ã€getUserä¸­ã€‘userServiceUrlï¼šhttp:&#x2F;&#x2F;user-service</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰localhost?</p>
<p>æµè§ˆå™¨è®¿é—®ä¸€ä¸‹</p>
<p>æ‰¾ä¸åˆ° <strong>user-service</strong> çš„æœåŠ¡å™¨ IP åœ°å€</p>
<p>ä¸Šæ¬¡å¥½åƒæ³¨å†Œè¿‡ipæ¥ç€</p>
<p>ä½†æ˜¯æ³¨å†Œæ˜¯hostname</p>
<p>è¿™é‡Œåº”è¯¥æ˜¯è¦é€šè¿‡æœåŠ¡åç§°è®¿é—®2ä¸ªServiceï¼Œä¼¼ä¹ä¸ä¸€æ ·</p>
<p>è¯•è¯•ç›´æ¥ç”¨localhoståŠ ç«¯å£è®¿é—®</p>
<img src="/images/2020/screencapture2020-04-09 PM10.33.08.jpg">

<p>å•ä¸ªèŠ‚ç‚¹çš„æœåŠ¡æ²¡æœ‰é—®é¢˜</p>
<p>é‚£åº”è¯¥å°±æ˜¯åœ¨æ³¨å†ŒæœåŠ¡åç§°åˆ°ipçš„è½¬æ¢ä¸Šå‡ºäº†é—®é¢˜</p>
<blockquote>
<p><a href="https://bbs.csdn.net/topics/392414113" target="_blank" rel="noopener">https://bbs.csdn.net/topics/392414113</a></p>
</blockquote>
<p>æŠŠ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RestTemplate restTemplate;</span><br></pre></td></tr></table></figure>

<p>æ”¹æˆ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RestOperations restTemplate;</span><br></pre></td></tr></table></figure>

<p>ä¸è¡Œ</p>
<blockquote>
<p><a href="https://www.liangzl.com/get-article-detail-174951.html" target="_blank" rel="noopener">https://www.liangzl.com/get-article-detail-174951.html</a></p>
</blockquote>
<p>å¯¹æ¯”äº†ä¸€ä¸‹è¿™ä¸ªæ•™ç¨‹ï¼Œä¹Ÿæ²¡æ‰¾åˆ°é—®é¢˜</p>
<p>ç½‘é¡µä¸Šçš„é”™è¯¯ä¿¡æ¯æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">There was an unexpected error (type&#x3D;Internal Server Error, status&#x3D;500).</span><br><span class="line">Failed to process import candidates for configuration class [org.springframework.cloud.netflix.ribbon.RibbonClientConfiguration]; nested exception is java.lang.IllegalStateException: Failed to introspect annotated methods on class org.springframework.cloud.netflix.ribbon.RestClientRibbonConfiguration</span><br></pre></td></tr></table></figure>

<p>ä¼¼ä¹æ˜¯æ³¨é‡Šçš„é—®é¢˜</p>
<p>â€¦</p>
<p>å¾ˆä¹…å¾ˆä¹…ä»¥å</p>
<p>â€¦</p>
<p>è¯•è¯•æºç èƒ½ä¸èƒ½è·‘</p>
<p>æ¼«é•¿çš„ä¸‹è½½ä¾èµ–</p>
<p><strong>ç¬¬äºŒå¤©</strong></p>
<p>è¿è¡Œæºç </p>
<img src="/images/2020/screencapture2020-04-10 AM10.05.19.jpg">

<img src="/images/2020/screencapture2020-04-10 AM10.05.28.jpg">

<p>æ²¡æœ‰é—®é¢˜</p>
<p>è€Œä¸”Mavenä¸€ä¸ªéƒ½æ²¡çº¢</p>
<img src="/images/2020/screencapture2020-04-10 AM10.06.09.jpg" width=300>

<p>å¯¹æ¯”ä¸€ä¸‹ä¾èµ–ç‰ˆæœ¬</p>
<p>æºç eureka-server</p>
<img src="/images/2020/screencapture2020-04-10 AM10.08.50.jpg">

<p>é¡¹ç›®eureka-server</p>
<img src="/images/2020/screencapture2020-04-10 AM10.08.58.jpg">

<p>spring-cloud-starter-netflix-eureka-serverç‰ˆæœ¬ä¸ä¸€æ ·</p>
<p>diffä¸€ä¸‹pomæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">8c8</span><br><span class="line">&lt;         &lt;version&gt;2.2.2.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line">---</span><br><span class="line">&gt;         &lt;version&gt;2.2.6.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line">11c11</span><br><span class="line">&lt;     &lt;groupId&gt;com.jourwon.springcloud&lt;&#x2F;groupId&gt;</span><br><span class="line">---</span><br><span class="line">&gt;     &lt;groupId&gt;com.coconutnut&lt;&#x2F;groupId&gt;</span><br><span class="line">19c19</span><br><span class="line">&lt;         &lt;spring-cloud.version&gt;Hoxton.RELEASE&lt;&#x2F;spring-cloud.version&gt;</span><br><span class="line">---</span><br><span class="line">&gt;         &lt;spring-cloud.version&gt;Hoxton.SR3&lt;&#x2F;spring-cloud.version&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªæ˜¯spring-boot-starter-parentçš„ç‰ˆæœ¬ä¸ä¸€æ ·</p>
<p>ä¸€ä¸ªæ˜¯spring-cloudçš„ç‰ˆæœ¬ä¸ä¸€æ ·</p>
<p>ä¿®æ”¹spring-cloudçš„ç‰ˆæœ¬ï¼ŒMavençš„å†²çªå°±æ²¡æœ‰äº†</p>
<p>äºæ˜¯æŠŠå…¶å®ƒpomçš„ç‰ˆæœ¬ä¹Ÿæ”¹äº†</p>
<p>spring-boot-starter-parentçš„ç‰ˆæœ¬æš‚æ—¶æ²¡æ”¹ï¼Œä¿æŒæœ€æ–°</p>
<img src="/images/2020/screencapture2020-04-10 AM10.22.11.jpg">

<p>å¯åŠ¨</p>
<img src="/images/2020/screencapture2020-04-10 AM10.22.23.jpg">

<p>æ³¨å†Œä¸Šäº†</p>
<img src="/images/2020/screencapture2020-04-10 AM10.22.18.jpg">

<p>åˆå´©äº†</p>
<p>ä½†æ˜¯è¿™æ¬¡æ§åˆ¶å°æ²¡æœ‰Erroräº†</p>
<p>é”™è¯¯ä¿¡æ¯å˜æˆäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">There was an unexpected error (type&#x3D;Internal Server Error, status&#x3D;500).</span><br><span class="line">No instances available for user-service</span><br></pre></td></tr></table></figure>

<p>å•ç‹¬è®¿é—®<a href="http://localhost:8201/user/1æˆ–è€…http://localhost:8202/user/1éƒ½æ˜¯å¯ä»¥çš„" target="_blank" rel="noopener">http://localhost:8201/user/1æˆ–è€…http://localhost:8202/user/1éƒ½æ˜¯å¯ä»¥çš„</a></p>
<blockquote>
<p><a href="https://blog.csdn.net/choice_of_door/article/details/85467105" target="_blank" rel="noopener">https://blog.csdn.net/choice_of_door/article/details/85467105</a></p>
</blockquote>
<p>æŒ‰ç…§è¿™ä¸ªåŠ äº†ä¸ªä¾èµ–</p>
<p>ï¼ˆæºç é‡Œå¹¶æ²¡æœ‰ ä½†æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<del>MARK</del> (ç¬”è®°03ä¸­è§£å†³)ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.netflix.ribbon<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ribbon-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆåŠŸäº†ï¼</p>
<p>å—·ï¼</p>
<h2 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h2><p>éƒ½æ˜¯ç‰ˆæœ¬çš„å‘</p>
<p>åˆ›å»ºæ—¶ç”¨Spring InitializeråŠ è¿˜æ˜¯åæœŸåœ¨pom.xmlä¸­åŠ ä¸é‡è¦</p>
<p>ä½†æœ€å¥½å’Œæ•™ç¨‹ä¿æŒä¸€è‡´</p>
<p>è‡³å°‘æ£€æŸ¥å³è¾¹Mavenæ ä¸­æ²¡æœ‰çº¢çº¿</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-10 AM10.51.52.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringCloudç¬”è®°01 Eurekaæ³¨å†Œä¸­å¿ƒ</title>
    <url>/2020/04/08/note-springcloud-01/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/103726655" target="_blank" rel="noopener">https://blog.csdn.net/ThinkWon/article/details/103726655</a></p>
</blockquote>
<hr>
<blockquote>
<p>Spring Cloud Netflix Eurekaæ˜¯Spring Cloud Netflixå­é¡¹ç›®çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºå¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡æ²»ç†</p>
</blockquote>
<p>å…ˆç–‘æƒ‘äº†ä¸€ä¸‹æ­¤Netflixæ˜¯ä¸æ˜¯å½¼Netflix</p>
<p>æŸ¥äº†ä¸€ä¸‹ <a href="https://www.cnblogs.com/EasonJim/p/7795816.html" target="_blank" rel="noopener">Netflixæ˜¯ä»€ä¹ˆï¼Œä¸Spring Cloudæœ‰ä»€ä¹ˆå…³ç³»</a> è¿˜çœŸæ˜¯</p>
<p>çˆ±äº†çˆ±äº†</p>
<hr>
<h1 id="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ"><a href="#æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ" class="headerlink" title="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ"></a>æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒ</h1><ol>
<li><p>åˆ›å»ºeureka-serveræ¨¡å—</p>
</li>
<li><p>@EnableEurekaServerå¯ç”¨Euerkaæ³¨å†Œä¸­å¿ƒåŠŸèƒ½</p>
</li>
<li><p>application.ymlæ·»åŠ é…ç½®</p>
<p>é¡¹ç›®é»˜è®¤æ˜¯application.propertiesï¼Œä¸ºäº†å’Œæ•™ç¨‹ä¿æŒä¸€è‡´</p>
<p>åˆ é™¤application.propertiesï¼Œæ‰§è¡Œ mvn -X clean install</p>
</li>
<li><p>Run Dashboardè¿è¡Œåº”ç”¨</p>
</li>
<li><p>æµè§ˆå™¨æ‰“å¼€æ³¨å†Œä¸­å¿ƒ</p>
</li>
</ol>
<img src="/images/2020/screencapture2020-04-09 AM10.00.53.jpg">

<p>æˆåŠŸ</p>
<hr>
<p>ä¾èµ–ä¸‹äº†æŒºä¹…ï¼Œçœ‹çœ¼éƒ½æœ‰äº›ä»€ä¹ˆ</p>
<img src="/images/2020/screencapture2020-04-09 AM9.33.00.jpg" width=400>

<p>ğŸ˜±ğŸ˜±ğŸ˜±</p>
<p>ä¸Šé¢æ˜¯spring-cloud-starter-netflix-eureka-server</p>
<img src="/images/2020/screencapture2020-04-09 AM9.34.40.jpg">

<p>ä¸‹é¢æ˜¯spring-boot-starter-test</p>
<img src="/images/2020/screencapture2020-04-09 AM9.35.06.jpg">

<h2 id="DEBUGï¼šæ²¡æœ‰Run-Dashboard"><a href="#DEBUGï¼šæ²¡æœ‰Run-Dashboard" class="headerlink" title="DEBUGï¼šæ²¡æœ‰Run Dashboard"></a>DEBUGï¼šæ²¡æœ‰Run Dashboard</h2><p><strong>å°è¯•1</strong></p>
<blockquote>
<p><a href="https://blog.csdn.net/chinoukin/article/details/80577890" target="_blank" rel="noopener">https://blog.csdn.net/chinoukin/article/details/80577890</a></p>
</blockquote>
<p>æ”¹.idea/workspace.xmlçš„</p>
<p>åŸæœ¬æ˜¯è¿™æ ·</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">name</span>=<span class="string">"RunDashboard"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">"configurationTypes"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"SpringBootApplicationConfigurationType"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶æ¯æ¬¡æ”¹äº†command+så°±åˆå›å»äº†</p>
<p><strong>å°è¯•2</strong></p>
<blockquote>
<p><a href="https://blog.csdn.net/feixiangsmile/article/details/96908744" target="_blank" rel="noopener">https://blog.csdn.net/feixiangsmile/article/details/96908744</a></p>
</blockquote>
<p>Edit Configurationsä¸­</p>
<p>Templatesä¸­</p>
<p>ç‚¹å‡»åŠ å·æ·»åŠ Applicationå’ŒSpring Boot</p>
<p>workspace.xmlå˜æˆäº†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">name</span>=<span class="string">"RunDashboard"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">"configurationTypes"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"Application"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"SpringBootApplicationConfigurationType"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†è¿˜æ˜¯æ²¡æœ‰</p>
<p><strong>å°è¯•3</strong></p>
<blockquote>
<p><a href="https://www.cnblogs.com/JealousGirl/p/openorcloserundash.html" target="_blank" rel="noopener">https://www.cnblogs.com/JealousGirl/p/openorcloserundash.html</a></p>
<p><a href="https://blog.csdn.net/icebox126/article/details/78861943" target="_blank" rel="noopener">https://blog.csdn.net/icebox126/article/details/78861943</a></p>
</blockquote>
<p>åœ¨workspace.xmlä¸­æ·»åŠ ï¼ˆè¿™æ¬¡å¯ä»¥åŠ äº†ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show.run.dashboard.notification"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯é‡å¯è¿˜æ˜¯ä¸ä¼šå¼¹å‡ºæç¤º</p>
<p><strong>å°è¯•4</strong></p>
<blockquote>
<p><a href="https://intellij-support.jetbrains.com/hc/en-us/community/posts/115000428264-New-Spring-Boot-Run-dashboard-not-showing-up" target="_blank" rel="noopener">https://intellij-support.jetbrains.com/hc/en-us/community/posts/115000428264-New-Spring-Boot-Run-dashboard-not-showing-up</a></p>
<p><a href="https://blog.csdn.net/jianxia801/article/details/99576764" target="_blank" rel="noopener">https://blog.csdn.net/jianxia801/article/details/99576764</a></p>
</blockquote>
<img src="/images/2020/screencapture2020-04-09 AM10.30.31.jpg">

<p>â€¦</p>
<p>fine</p>
<p>åŸæ¥ä¸€ç›´éƒ½åœ¨å•Š</p>
<img src="/images/2020/screencapture2020-04-09 AM10.31.24.jpg">

<h1 id="æ­å»ºEurekaå®¢æˆ·ç«¯"><a href="#æ­å»ºEurekaå®¢æˆ·ç«¯" class="headerlink" title="æ­å»ºEurekaå®¢æˆ·ç«¯"></a>æ­å»ºEurekaå®¢æˆ·ç«¯</h1><ol>
<li><p>åˆ›å»ºeureka-clientæ¨¡å—</p>
</li>
<li><p>æ·»åŠ ä¾èµ–</p>
</li>
<li><p>åŠ @EnableDiscoveryClientè¡¨æ˜æ˜¯ä¸€ä¸ªEurekaå®¢æˆ·ç«¯</p>
</li>
<li><p>é…ç½®</p>
</li>
</ol>
<h2 id="DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client"><a href="#DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client" class="headerlink" title="DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client"></a>DEBUGï¼šæ³¨å†Œä¸­å¿ƒä¸­æ²¡æœ‰æ˜¾ç¤ºeureka-client</h2><p><strong>å°è¯•1</strong></p>
<p>åŸæ¥çš„pom.xmlä¸­çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•™ç¨‹ä¸­è¯´è¦æ·»åŠ çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸€å¼€å§‹ç”±äºspring-cloud-starter-netflix-eureka-clientå·²ç»æœ‰äº†</p>
<p>ç›´æ¥æ·»åŠ äº†ä¸Šé¢è¿™ä¸ªspring-boot-starter-web</p>
<p>ä½†æ˜¯è§‰å¾—å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Ÿ</p>
<p>spring-boot-starter-testå’Œspring-boot-starter-webä¼šä¸ä¼šå†²çªå‘¢?</p>
<img src="/images/2020/screencapture2020-04-09 AM10.39.19.jpg">

<p>æ²¡å†²çª</p>
<p>ä½†æ˜¯spring-boot-starter-testä¼¼ä¹å¤šäº†å¾ˆå¤šä¸œè¥¿ï¼ˆè¯•äº†ä¸€ä¸‹å¹¶ä¸èƒ½åˆ ï¼‰</p>
<p><strong>å°è¯•2</strong></p>
<p>çœ‹ä¸‹æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-09 10:43:38.777 ERROR 1243 --- [           main] c.n.d.s.t.d.RedirectingEurekaHttpClient  : Request execution error. endpoint&#x3D;DefaultEndpoint&#123; serviceUrl&#x3D;&#39;http:&#x2F;&#x2F;localhost:8001&#x2F;eureka&#x2F;&#125;</span><br><span class="line"></span><br><span class="line">com.sun.jersey.api.client.ClientHandlerException: java.net.ConnectException: Connection refused (Connection refused)</span><br></pre></td></tr></table></figure>

<p>å¥½åƒå¹²äº†ä¸ªè ¢äº‹</p>
<img src="/images/2020/screencapture2020-04-09 AM10.44.58.jpg">

<p>æœç„¶ æœåŠ¡å™¨æ²¡å¼€</p>
<p>é‡æ¥ å…ˆå¼€eureka-server å†å¼€eureka-client</p>
<img src="/images/2020/screencapture2020-04-09 AM10.46.19.jpg">

<img src="/images/2020/screencapture2020-04-09 AM10.46.31.jpg">

<p>æ³¨å†ŒæˆåŠŸ</p>
<h1 id="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤"><a href="#æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤" class="headerlink" title="æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤"></a>æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤</h1><p>ç›®çš„ï¼šé˜²æ­¢æ³¨å†Œä¸­å¿ƒæŒ‚äº†æ•´ä¸ªå®æ‰ æ­å»ºåŒèŠ‚ç‚¹çš„æ³¨å†Œä¸­å¿ƒé›†ç¾¤</p>
<ol>
<li><p>2ä¸ªé…ç½®æ–‡ä»¶</p>
<p>ï¼ˆä¸çŸ¥é“åŸæœ¬çš„application.ymlè¦ä¸è¦åˆ ï¼Ÿçœ‹äº†ä¸‹æºç æ²¡æœ‰åˆ ï¼‰</p>
</li>
<li><p>æœ¬æœºé…ç½®åŸŸå</p>
<p>macOSåœ¨/etc/hosts</p>
<p>æ”¹ä¹‹å‰çš„å­˜ä¸ªæ¡£</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">##</span><br><span class="line"># Host Database</span><br><span class="line">#</span><br><span class="line"># localhost is used to configure the loopback interface</span><br><span class="line"># when the system is booting.  Do not change this entry.</span><br><span class="line">##</span><br><span class="line">127.0.0.1	localhost</span><br><span class="line">255.255.255.255	broadcasthost</span><br><span class="line">::1             localhost</span><br><span class="line">127.0.0.1 xmind.net</span><br><span class="line">127.0.0.1 www.xmind.net</span><br></pre></td></tr></table></figure>

<p>åŠ ä¸¤è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">127.0.0.1 replica1</span><br><span class="line">127.0.0.1 replica2</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¯åŠ¨</p>
</li>
<li><p>ä¿®æ”¹é…ç½®ï¼Œè®©eureka-clientè¿æ¥åˆ°é›†ç¾¤</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€</span><br><span class="line"># defaultZone: http:&#x2F;&#x2F;localhost:8001&#x2F;eureka</span><br><span class="line"># åŒæ—¶æ³¨å†Œåˆ°ä¸¤ä¸ªæ³¨å†Œä¸­å¿ƒ</span><br><span class="line">defaultZone: http:&#x2F;&#x2F;replica1:8002&#x2F;eureka&#x2F;,http:&#x2F;&#x2F;replica2:8003&#x2F;eureka&#x2F;</span><br></pre></td></tr></table></figure>

<h2 id="DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ"><a href="#DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ" class="headerlink" title="DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ"></a>DEBUGï¼šæœåŠ¡å™¨æ²¡æœ‰æ³¨å†Œ</h2><p>å¤åˆ¶ä¸€ä»½åŸå¯åŠ¨é…ç½®ï¼Œä¿®æ”¹ä¸ºä»replica1å¯åŠ¨</p>
<img src="/images/2020/screencapture2020-04-09 AM10.57.57.jpg">

<p>Run</p>
<img src="/images/2020/screencapture2020-04-09 AM10.59.41.jpg">

<p>å‘ç°æœ‰å¤‡ä»½ï¼Œä½†æ˜¯æ²¡æœ‰æ³¨å†Œï¼Ÿ</p>
<img src="/images/2020/screencapture2020-04-09 AM10.59.52.jpg">

<p>ä¼¼ä¹æ˜¯åªå¤åˆ¶äº†ä¸€ä»½é…ç½®ï¼Œreplica2æ²¡æœ‰å¯åŠ¨</p>
<p>åŠ ä¸Š</p>
<img src="/images/2020/screencapture2020-04-09 AM11.10.28.jpg">

<p>å¥½äº†</p>
<img src="/images/2020/screencapture2020-04-09 AM11.11.58.jpg">

<h1 id="ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯"><a href="#ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯" class="headerlink" title="ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯"></a>ç»™Eurekaæ³¨å†Œä¸­å¿ƒæ·»åŠ è®¤è¯</h1><ol>
<li>åˆ›å»ºeureka-security-serveræ¨¡å—</li>
<li>æ·»åŠ ä¾èµ–</li>
<li>é…ç½®pom.xml</li>
<li>æ·»åŠ WebSecurityConfig</li>
<li>eureka-clientæ³¨å†Œåˆ°æœ‰ç™»å½•è®¤è¯çš„æ³¨å†Œä¸­å¿ƒ</li>
<li>ä»¥application-security.ymlé…ç½®è¿è¡Œeureka-client</li>
</ol>
<h2 id="DEBUGï¼šSpringSecurityæ¨¡å—"><a href="#DEBUGï¼šSpringSecurityæ¨¡å—" class="headerlink" title="DEBUGï¼šSpringSecurityæ¨¡å—"></a>DEBUGï¼šSpringSecurityæ¨¡å—</h2><p>è¦æ·»åŠ SpringSecurityæ¨¡å—ï¼Œä¹Ÿè®¸æ˜¯Spring Cloud Securityä¸‹çš„Cloud Securityï¼Ÿå…ˆè¯•è¯•</p>
<p>åˆ›å»ºå‡ºçš„pom.xmlä¸­ä¾èµ–æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•™ç¨‹ä¸­è¦åŠ çš„ä¾èµ–æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¥½åƒä¸æ˜¯è¿™ä¸ª</p>
<p>é‡æ–°åˆ›å»º</p>
<p>è¿™æ¬¡ç›´æ¥æœç´¢Spring Security å‘ç°æœ‰è¿™ä¸ªæ¨¡å—</p>
<img src="/images/2020/screencapture2020-04-09 AM11.18.28.jpg">

<p>ï¼ˆæœ€åå‘ç°éƒ½è¡Œï¼Œä¸”æ²¡å¿…è¦åˆ›å»ºæ—¶æ·»åŠ ï¼Œéšæ—¶åœ¨pom.xmlä¸­ä¿®æ”¹éƒ½å¯ï¼‰</p>
<h2 id="DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®"><a href="#DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®" class="headerlink" title="DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®"></a>DEBUGï¼šæ–°çš„æ¨¡å—æ²¡æœ‰è¢«è¯†åˆ«ä¸ºMavené¡¹ç›®</h2><blockquote>
<p><a href="https://www.jianshu.com/p/909eb8a48d49" target="_blank" rel="noopener">https://www.jianshu.com/p/909eb8a48d49</a></p>
</blockquote>
<p>å³è¾¹Mavenæ ï¼‹å¯¹åº”çš„pom.xml</p>
<h2 id="DEBUGï¼šå¯åŠ¨æŠ¥é”™-amp-Whitelabel-Error-Page"><a href="#DEBUGï¼šå¯åŠ¨æŠ¥é”™-amp-Whitelabel-Error-Page" class="headerlink" title="DEBUGï¼šå¯åŠ¨æŠ¥é”™&amp;Whitelabel Error Page"></a>DEBUGï¼šå¯åŠ¨æŠ¥é”™&amp;Whitelabel Error Page</h2><img src="/images/2020/screencapture2020-04-09 AM11.27.19.jpg">

<blockquote>
<p><a href="https://blog.csdn.net/qq_28379809/article/details/102789716" target="_blank" rel="noopener">https://blog.csdn.net/qq_28379809/article/details/102789716</a></p>
</blockquote>
<p>æ·»åŠ ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨</p>
<img src="/images/2020/screencapture2020-04-09 AM11.32.17.jpg">

<p>è¾“å…¥è´¦å·å¯†ç </p>
<img src="/images/2020/screencapture2020-04-09 AM11.32.27.jpg">

<p>å‘ç°EurekaSecurityServerApplicationæ²¡æœ‰åŠ @EnableEurekaServer</p>
<img src="/images/2020/screencapture2020-04-09 AM11.45.35.jpg">

<p>pom.xmlä¸­æœ‰spring-cloud-starter-netflix-eureka-serverï¼Œä¸ºä»€ä¹ˆå¯¼ä¸è¿›æ¥å‘¢</p>
<p>å’Œeureka-serverçš„é…ç½®æ¯”è¾ƒï¼Œå‘ç°å°‘ä¸€å¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.SR3<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åŠ ä¸Š</p>
<p>è¿˜æ˜¯ä¸è¡Œ</p>
<p>æºç ä¸­æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.RELEASE<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç°åœ¨çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.security<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-security-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æºç ä¸­çš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶è¿‡å»</p>
<p>Reimport Maven Projects</p>
<p>å‘ç°æ­£åœ¨ä¸‹è½½çš„è¿›åº¦æ¡</p>
<p>æ‰€ä»¥éš¾é“åˆšæ‰æ˜¯å› ä¸ºä¾èµ–è¿˜æ²¡ä¸‹è½½å®Œå—</p>
<p>ä¸‹è½½å®Œæˆ</p>
<p>å…¨çº¢äº†â€¦</p>
<img src="/images/2020/screencapture2020-04-09 AM11.58.06.jpg">

<p>æ”¹å›åŸæœ¬çš„ä¾èµ– åˆ æ‰spring-boot-starter-web ä¸çº¢äº†</p>
<p>å¯åŠ¨</p>
<img src="/images/2020/screencapture2020-04-09 AM11.59.54.jpg">

<p>ğŸ™ƒ</p>
<p>ä»”ç»†çœ‹ä¸‹æºç çš„é…ç½®æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è€Œä¸æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥éš¾é“è¿˜æ˜¯åº”è¯¥å¼•å…¥Spring Cloud Securityæ¨¡å—ï¼Ÿ</p>
<p>é‡æ–°åˆ›å»ºè¯•è¯•</p>
<p>æˆåŠŸï¼</p>
<h2 id="DEBUGï¼šä»¥application-security-ymlé…ç½®è¿è¡Œeureka-client"><a href="#DEBUGï¼šä»¥application-security-ymlé…ç½®è¿è¡Œeureka-client" class="headerlink" title="DEBUGï¼šä»¥application-security.ymlé…ç½®è¿è¡Œeureka-client"></a>DEBUGï¼šä»¥application-security.ymlé…ç½®è¿è¡Œeureka-client</h2><p>ç°åœ¨eureka-clientæœ‰2ä¸ªyml</p>
<img src="/images/2020/screencapture2020-04-09 PM3.55.10.jpg">

<p>ç›´æ¥è¿è¡Œè¿˜æ˜¯application.ymlçš„8101ç«¯å£</p>
<p>æ ¹æ®åˆšæ‰eureka-serverçš„å¤šä¸ªyml</p>
<p>æ˜¯ä¿®æ”¹äº†æŒ‡å®šä¸»æœºåœ°å€</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># application.yml</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">localhost</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># application-replica1.yml</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">replica1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># application-replica2.yml</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">replica2</span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨Edit Configurationsä¸­å¤åˆ¶Configurationï¼Œç„¶åä¿®æ”¹ä¸»æœºå</p>
<p>äºæ˜¯è¿™é‡Œä¹ŸåŠ ä¸ŠæŒ‡å®šä¸»æœºå</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">instance:</span></span><br><span class="line">  <span class="attr">hostname:</span> <span class="string">eureka-client-security</span></span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶ä¸€ä¸ªEurekaClientApplicationçš„é…ç½®ï¼ŒActive profileså¤„æ”¹ä¸ºä¸»æœºå</p>
<img src="/images/2020/screencapture2020-04-09 PM4.01.03.jpg">

<p>ä½†è¿˜æ˜¯8101ï¼Ÿ</p>
<img src="/images/2020/screencapture2020-04-09 PM4.04.44.jpg">

<p>è§‚å¯Ÿå‘ç°</p>
<p>Serverçš„é…ç½®æ–‡ä»¶1å«application-replica1.ymlï¼Œhostnameæ˜¯replica1ï¼ŒActive profileså¡«çš„replica1</p>
<p>é…ç½®æ–‡ä»¶2å«application-replica2.ymlï¼Œhostnameæ˜¯replica2ï¼ŒActive profileså¡«çš„replica2</p>
<p>éš¾é“â€¦</p>
<p>æŠŠClientçš„application-security.ymlä¸­æ”¹æˆ</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">instance:</span></span><br><span class="line">  <span class="attr">hostname:</span> <span class="string">security</span></span><br></pre></td></tr></table></figure>

<p>Active profilesæ”¹æˆsecurity</p>
<p>Run</p>
<img src="/images/2020/screencapture2020-04-09 PM4.10.10.jpg">

<p>æ‰“å¼€äº†ï¼</p>
<img src="/images/2020/screencapture2020-04-09 PM4.11.03.jpg">

<p>æœ‰ä¸ª<strong>EMERGENCY!</strong> </p>
<p>ä¿æŠ¤æœºåˆ¶åé¢å†çœ‹</p>
<p>å…ˆè¯•è¯•è¿™ä¸ªæŒ‡å®šymlåˆ°åº•æ˜¯æ€ä¹ˆæŒ‡å®šçš„</p>
<table>
<thead>
<tr>
<th>æ–‡ä»¶å</th>
<th>hostname</th>
<th>Active profiles</th>
<th>èƒ½å¦å¯åŠ¨</th>
</tr>
</thead>
<tbody><tr>
<td>application-security.yml</td>
<td>eureka-client-security</td>
<td>eureka-client-security</td>
<td>å¦</td>
</tr>
<tr>
<td>application-security.yml</td>
<td>security</td>
<td>security</td>
<td>å¯</td>
</tr>
<tr>
<td>application-security.yml</td>
<td>securityX</td>
<td>security</td>
<td>å¯</td>
</tr>
<tr>
<td>application-securityX.yml</td>
<td>security</td>
<td>security</td>
<td>å¦</td>
</tr>
</tbody></table>
<p>çœ‹æ¥Active profilesè¦å¡«æ–‡ä»¶ååé¢çš„éƒ¨åˆ†</p>
<p>æ•™ç¨‹æœ€ä¸‹é¢çš„å¸¸ç”¨é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span> <span class="comment">#eurekaå®¢æˆ·ç«¯é…ç½®</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span> <span class="comment">#æ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ°eurekaæœåŠ¡ç«¯ä¸Šå»</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span> <span class="comment">#æ˜¯å¦è·å–eurekaæœåŠ¡ç«¯ä¸Šæ³¨å†Œçš„æœåŠ¡åˆ—è¡¨</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8001/eureka/</span> <span class="comment"># æŒ‡å®šæ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment"># å¯ç”¨eurekaå®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="attr">registry-fetch-interval-seconds:</span> <span class="number">30</span> <span class="comment">#å®šä¹‰å»eurekaæœåŠ¡ç«¯è·å–æœåŠ¡åˆ—è¡¨çš„æ—¶é—´é—´éš”</span></span><br><span class="line">  <span class="attr">instance:</span> <span class="comment">#eurekaå®¢æˆ·ç«¯å®ä¾‹é…ç½®</span></span><br><span class="line">    <span class="attr">lease-renewal-interval-in-seconds:</span> <span class="number">30</span> <span class="comment">#å®šä¹‰æœåŠ¡å¤šä¹…å»æ³¨å†Œä¸­å¿ƒç»­çº¦</span></span><br><span class="line">    <span class="attr">lease-expiration-duration-in-seconds:</span> <span class="number">90</span> <span class="comment">#å®šä¹‰æœåŠ¡å¤šä¹…ä¸å»ç»­çº¦è®¤ä¸ºæœåŠ¡å¤±æ•ˆ</span></span><br><span class="line">    <span class="attr">metadata-map:</span></span><br><span class="line">      <span class="attr">zone:</span> <span class="string">guangdong</span> <span class="comment">#æ‰€åœ¨åŒºåŸŸ</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">localhost</span> <span class="comment">#æœåŠ¡ä¸»æœºåç§°</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">false</span> <span class="comment">#æ˜¯å¦ä¼˜å…ˆä½¿ç”¨ipæ¥ä½œä¸ºä¸»æœºå</span></span><br><span class="line">  <span class="attr">server:</span> <span class="comment">#eurekaæœåŠ¡ç«¯é…ç½®</span></span><br><span class="line">    <span class="attr">enable-self-preservation:</span> <span class="literal">false</span> <span class="comment">#å…³é—­eurekaæœåŠ¡ç«¯çš„ä¿æŠ¤æœºåˆ¶</span></span><br></pre></td></tr></table></figure>

<p>äºæ˜¯åœ¨eureka-serverçš„ymlä¸­åŠ ä¸Š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span> <span class="comment">#eurekaæœåŠ¡ç«¯é…ç½®</span></span><br><span class="line">    <span class="attr">enable-self-preservation:</span> <span class="literal">true</span> <span class="comment">#å…³é—­eurekaæœåŠ¡ç«¯çš„ä¿æŠ¤æœºåˆ¶</span></span><br></pre></td></tr></table></figure>

<p>å°±æ²¡æœ‰<strong>EMERGENCY!</strong> äº†</p>
<h2 id="å…³äºeureka-security-serverçš„ä¾èµ–"><a href="#å…³äºeureka-security-serverçš„ä¾èµ–" class="headerlink" title="å…³äºeureka-security-serverçš„ä¾èµ–"></a>å…³äºeureka-security-serverçš„ä¾èµ–</h2><p>å‘ç°æ•™ç¨‹é‡Œå†™çš„ä¾èµ–æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æºç é‡Œç”¨çš„ä¾èµ–æ˜¯</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è‡ªå·±åˆšæ‰å¯åŠ¨æˆåŠŸçš„æ˜¯spring-cloud-starter-security</p>
<p>æ”¹æˆspring-boot-starter-securityè¯•äº†ä¸€ä¸‹ä¹ŸæˆåŠŸäº†</p>
<h2 id="é—®é¢˜è§£å†³æ€»ç»“"><a href="#é—®é¢˜è§£å†³æ€»ç»“" class="headerlink" title="é—®é¢˜è§£å†³æ€»ç»“"></a>é—®é¢˜è§£å†³æ€»ç»“</h2><ol>
<li>ç”¨Spring Cloud Securityæ¨¡å—ï¼Œä¸æ˜¯Spring Securityæ¨¡å—</li>
<li>EurekaSecurityServerApplicationè¦è®°å¾—åŠ @EnableEurekaServer</li>
<li>ç”¨æŒ‡å®šçš„ymlï¼ˆapplication-XXX.ymlï¼‰å¯åŠ¨Spring Bootï¼Œåœ¨Edit Configurationsä¸­å¤åˆ¶ä¸€ä¸ªåŸConfigurationï¼ŒActive profileså¡«æŒ‡å®šymlæ–‡ä»¶ååŠéƒ¨åˆ†ï¼ˆXXXï¼‰ï¼Œè¿è¡Œè¿™ä¸ªConfiguration</li>
</ol>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><img src="/images/2020/screencapture2020-04-09 PM4.44.05.jpg">]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ·é¢˜é˜¶æ®µä¸€å®Œå·¥çºªå¿µï¼</title>
    <url>/2020/04/08/memo/</url>
    <content><![CDATA[<p>è¿™ä¸ª<a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Leetcode%20%E9%A2%98%E8%A7%A3%20-%20%E7%9B%AE%E5%BD%95.md" title="" target="">ç›®å½•</a>ç»ˆäºå®Œå·¥äº†</p>
<p>LeetCodeä»å»å¹´å‡†å¤‡ç®—æ³•è€ƒè¯•å¼€å§‹åˆ·</p>
<p>åˆ°ç°åœ¨åˆšå¥½2222ä¸ªç¡¬å¸ğŸ˜ƒ</p>
<p>æ£’çƒå¸½ï¼å†²é¸­ï¼</p>
<img src="/images/2020/screencapture2020-04-08 PM7.47.28.jpg" width=300>

<p>3æœˆæ¯æ—¥1é¢˜å¿˜äº†1å¤© å°±é‚£ä¹ˆ å¹²å¹²å‡€å‡€ æ— å¿§æ— è™‘çš„ å¿˜äº†ğŸ˜­</p>
<p>4æœˆæäº†å¼ æ—¥å†è´´åœ¨åºŠå¯¹é¢çš„ç™½æ¿ä¸Š ä½†æ„¿â€¦</p>
<hr>
<p>æœ€è¿‘å‘¨èµ›è¿˜ä¸å¦‚åˆšå¼€å§‹åšå¾—å¥½</p>
<p>æœ‰ä¸€ä¸ä¸å‡„å‡‰</p>
<p>å¸Œæœ›çƒ§æ‰çš„è„‘ç»†èƒç»™æ–°çš„ç¥ç»å›è·¯æä¾›å…»æ–™äº†å§</p>
<img src="/images/2020/img-91ef518e959886326719c5d07a824772.jpg" width=400>

<p>æœ€è¿‘çœ‹åˆ°è¿™å¼ å›¾è§‰å¾—è²Œä¼¼å¾ˆæœ‰é“ç†</p>
<p>æ”¾åœ¨è¿™é‡Œ</p>
<p>ä¸çŸ¥é“ä»¥åä¼šä¸ä¼šæœ‰ä»€ä¹ˆæ„Ÿå—</p>
<hr>
<p>æœ€åæ˜¯ä¸€å¤§æ¡çœ‹æ¿çš„å®Œå·¥è®°å½•</p>
<img src="/images/2020/Apr-09-2020 15-35-04.gif">

<p>å¿«ä¹</p>
<p>å®…å®¶è¿åŠ¨è®¡åˆ’è¿›è¡Œä¸­</p>
<p>ä¸¤ä¸ªæœˆæ²¡å‡ºé—¨è¿˜è½»äº†ä¹Ÿæ˜¯å¾ˆéœ‡æƒŠ</p>
<p>ç»§ç»­æ‰“å¡ï¼å˜¿å’»ï¼</p>
<p>ä¹Ÿè®¸å“ªå¤©å°±èƒ½åŠˆå‰äº†å‘¢</p>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°07 SSMæ•´åˆ</title>
    <url>/2020/04/07/note-springmvc-07/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>P46~54</p>
</blockquote>
<p><strong>ä¸‰å±‚æ¶æ„</strong></p>
<img src="/images/2020/screencapture2020-04-07 AM10.29.11.jpg">

<p>å…ˆä¿è¯æ¯ä¸ªæ¡†æ¶èƒ½å•ç‹¬è¿è¡Œ</p>
<p>ç„¶åç”¨Springæ•´åˆå¦å¤–2ä¸ª</p>
<h1 id="å‡†å¤‡æ•°æ®åº“"><a href="#å‡†å¤‡æ•°æ®åº“" class="headerlink" title="å‡†å¤‡æ•°æ®åº“"></a>å‡†å¤‡æ•°æ®åº“</h1><p>accountè¡¨ï¼Œä»¥å‰å»ºè¿‡äº†ï¼Œç»§ç»­ç”¨</p>
<img src="/images/2020/screencapture2020-04-07 AM10.34.27.jpg" width=300>

<h1 id="æ­å»ºç¯å¢ƒ"><a href="#æ­å»ºç¯å¢ƒ" class="headerlink" title="æ­å»ºç¯å¢ƒ"></a>æ­å»ºç¯å¢ƒ</h1><p>åˆ›å»ºMavenå·¥ç¨‹ï¼Œé€‰webapp</p>
<p>è§£å†³åˆ›å»ºé¡¹ç›®è¿‡æ…¢ï¼ŒåŠ ä¸€å¯¹archetypeCatalogï¼šinternal</p>
<h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><p>ç‰ˆæœ¬é”å®š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slf4j.version</span>&gt;</span>1.6.6<span class="tag">&lt;/<span class="name">slf4j.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">log4j.version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">log4j.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åŠ ä¾èµ–</p>
<img src="/images/2020/screencapture2020-04-07 AM10.54.56.jpg" width=400>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- spring IOC --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- spring AOP --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- JdbcTemplate --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- äº‹åŠ¡ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- æµ‹è¯• --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- mysqlé©±åŠ¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- è¿æ¥æ±  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- spring MVC --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- servlet --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- jspæ ‡ç­¾ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- log --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;log4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="åˆ›å»ºç›®å½•"><a href="#åˆ›å»ºç›®å½•" class="headerlink" title="åˆ›å»ºç›®å½•"></a>åˆ›å»ºç›®å½•</h2><p>javaå’Œresourcesæ–‡ä»¶å¤¹</p>
<img src="/images/2020/screencapture2020-04-07 AM10.57.25.jpg" width=300>

<p>ç”¨åˆ°çš„ç±»</p>
<img src="/images/2020/screencapture2020-04-07 AM11.07.04.jpg" width=300>

<p>Accountä¸‰ä¸ªå±æ€§</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Double money;</span><br></pre></td></tr></table></figure>

<p>åš2ä¸ªæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">(Account account)</span></span>;</span><br></pre></td></tr></table></figure>

<h1 id="Springæ¡†æ¶"><a href="#Springæ¡†æ¶" class="headerlink" title="Springæ¡†æ¶"></a>Springæ¡†æ¶</h1><h2 id="é…ç½®-applicationContext-xml"><a href="#é…ç½®-applicationContext-xml" class="headerlink" title="é…ç½® applicationContext.xml"></a>é…ç½® applicationContext.xml</h2><p>resourcesä¸‹æ–°å»ºapplicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€å¯æ³¨è§£çš„æ‰«æï¼Œå¸Œæœ›å¤„ç†serviceå’Œdaoï¼Œcontrollerä¸éœ€è¦Springæ¡†æ¶å»å¤„ç† --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.coconutnut"</span> &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®å“ªäº›æ³¨è§£ä¸æ‰«æ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>controlleræ˜¯è¡¨ç°å±‚çš„ï¼ŒSpringæ¡†æ¶ä¸ç®¡</p>
<h2 id="åŠ æ³¨è§£"><a href="#åŠ æ³¨è§£" class="headerlink" title="åŠ æ³¨è§£"></a>åŠ æ³¨è§£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¸šåŠ¡å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¸šåŠ¡å±‚ï¼šä¿å­˜è´¦æˆ·"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>ç”¨junitå•å…ƒæµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:applicationContext.xml"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–å¯¹è±¡</span></span><br><span class="line">        IAccountService as = (IAccountService) ac.getBean(<span class="string">"accountService"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        as.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-04-07 AM11.21.45.jpg">

<p>WARNINGè¯´æ²¡æœ‰log4jçš„é…ç½®æ–‡ä»¶</p>
<p>å¤åˆ¶ä¸€ä¸ªlog4j.propertiesåˆ°resourcesç›®å½•ä¸‹å³å¯</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Set root category priority to INFO and its only appender to CONSOLE.</span></span><br><span class="line"><span class="comment">#log4j.rootCategory=INFO, CONSOLE            debug   info   warn error fatal</span></span><br><span class="line"><span class="meta">log4j.rootCategory</span>=<span class="string">info, CONSOLE, LOGFILE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the enterprise logger category to FATAL and its only appender to CONSOLE.</span></span><br><span class="line"><span class="meta">log4j.logger.org.apache.axis.enterprise</span>=<span class="string">FATAL, CONSOLE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CONSOLE is set to be a ConsoleAppender using a PatternLayout.</span></span><br><span class="line"><span class="meta">log4j.appender.CONSOLE</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.CONSOLE.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.CONSOLE.layout.ConversionPattern</span>=<span class="string">%d&#123;ISO8601&#125; %-6r [%15.15t] %-5p %30.30c %x - %m\n</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LOGFILE is set to be a File appender using a PatternLayout.</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.File</span>=<span class="string">/Users/coconutnut/TREE/Midgard/Idea/SSM/axis.log</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.Append</span>=<span class="string">true</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.layout.ConversionPattern</span>=<span class="string">%d&#123;ISO8601&#125; %-6r [%15.15t] %-5p %30.30c %x - %m\n</span></span><br></pre></td></tr></table></figure>

<p>è¦æ”¹ä¸€ä¸‹è·¯å¾„</p>
<h1 id="SpringMVCæ¡†æ¶"><a href="#SpringMVCæ¡†æ¶" class="headerlink" title="SpringMVCæ¡†æ¶"></a>SpringMVCæ¡†æ¶</h1><h2 id="é…ç½®-web-xml"><a href="#é…ç½®-web-xml" class="headerlink" title="é…ç½® web.xml"></a>é…ç½® web.xml</h2><p>WEB-INFæ–‡ä»¶å¤¹ä¸‹çš„web.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Archetype Created Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®å‰ç«¯æ§åˆ¶å™¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åŠ è½½springmvc.xmlé…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯åŠ¨æœåŠ¡å™¨ï¼Œåˆ›å»ºè¯¥servlet --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- è§£å†³ä¸­æ–‡ä¹±ç çš„è¿‡æ»¤å™¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®-springmvc-xml"><a href="#é…ç½®-springmvc-xml" class="headerlink" title="é…ç½® springmvc.xml"></a>é…ç½® springmvc.xml</h2><p>resourcesæ–‡ä»¶å¤¹ä¸‹æ–°å»ºspringmvc.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span> <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€å¯æ³¨è§£æ‰«æï¼Œåªæ‰«æControlleræ³¨è§£ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.coconutnut"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®çš„è§†å›¾è§£æå™¨å¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/pages/"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è¿‡æ»¤é™æ€èµ„æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/css/"</span> <span class="attr">mapping</span>=<span class="string">"/css/**"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/images/"</span> <span class="attr">mapping</span>=<span class="string">"/images/**"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼€å¯SpringMVCæ³¨è§£çš„æ”¯æŒ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="é¡µé¢"><a href="#é¡µé¢" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h2><p>index.jspä¸­åŠ ä¸€ä¸ªè¶…é“¾æ¥</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;a href="account/findAll"&gt;æµ‹è¯•&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>WEB-INFä¸­æ–°å»ºpagesæ–‡ä»¶å¤¹ï¼Œæ–°å»ºlist.jsp</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h3&gt;æŸ¥è¯¢æ‰€æœ‰çš„è´¦æˆ·ä¿¡æ¯&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/account"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è¡¨ç°å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"TODO"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><img src="/images/2020/screencapture2020-04-07 AM11.40.21.jpg">

<h2 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><img src="/images/2020/screencapture2020-04-07 AM11.41.33.jpg">

<img src="/images/2020/screencapture2020-04-07 AM11.41.38.jpg">

<h1 id="Springæ•´åˆSpringMVC"><a href="#Springæ•´åˆSpringMVC" class="headerlink" title="Springæ•´åˆSpringMVC"></a>Springæ•´åˆSpringMVC</h1><p>ç›®æ ‡ï¼šControllerä¸­è°ƒç”¨ä¸šåŠ¡å±‚æ–¹æ³•</p>
<p>æ–¹æ³•ï¼šè¦æŠŠServiceæ³¨å…¥åˆ°Controllerä¸­</p>
<p>é—®é¢˜ï¼šweb.xmlä¸­é…ç½®äº†springmvc.xmlï¼Œspringmvc.xmlä¸­é…ç½®äº†å¯¹Controllerçš„æ‰«æï¼Œå…¶å®ƒæ‰«æçš„é…ç½®åœ¨applicationContext.xmlä¸­ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å§‹ç»ˆæ²¡æœ‰è¢«åŠ è½½è¿‡</p>
<p>è§£å†³ï¼šå¯åŠ¨tomcatæœåŠ¡å™¨æ—¶ï¼ŒåŠ è½½Springçš„é…ç½®æ–‡ä»¶applicationContext.xml</p>
<p>ServletContextå¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’ŒæœåŠ¡å™¨ç›¸åŒï¼Œå¯ä»¥ç”¨ç›‘å¬å™¨ç›‘å¬å…¶åˆ›å»ºå’Œé”€æ¯</p>
<p>äºæ˜¯ï¼Œå¯ä»¥åœ¨web.xmlä¸­ç”¨ç›‘å¬å™¨åŠ è½½Springçš„é…ç½®æ–‡ä»¶</p>
<p>ç›‘å¬å™¨æ˜¯spring-webæä¾›çš„</p>
<p>å®ƒé»˜è®¤åªåŠ è½½WEB-INFç›®å½•ä¸‹çš„applicationContext.xmlé…ç½®æ–‡ä»¶</p>
<p>å¯ä»¥å¤åˆ¶ä¸€ä»½ä¸¢åˆ°WEB-INFç›®å½•ï¼Œæˆ–è€…æ‰‹åŠ¨è®¾ç½®è·¯å¾„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®Springçš„ç›‘å¬å™¨ï¼Œé»˜è®¤åªåŠ è½½WEB-INFç›®å½•ä¸‹çš„applicationContext.xmlé…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è®¾ç½®é…ç½®æ–‡ä»¶çš„è·¯å¾„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯åŠ¨æœåŠ¡å™¨æ—¶ï¼ŒSpringçš„é…ç½®æ–‡ä»¶ä¹ŸåŠ è½½äº†</p>
<p>Serviceå’ŒControlleréƒ½æ”¾åˆ°å®¹å™¨ä¸­äº†</p>
<p>äºæ˜¯å¯ä»¥åœ¨AccountControllerä¸­è¿›è¡Œä¾èµ–æ³¨å…¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/account"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountService accountService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è¡¨ç°å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰"</span>);</span><br><span class="line">        accountService.findAll();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•-2"><a href="#æµ‹è¯•-2" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>ç‚¹å‡»æµè§ˆå™¨ä¸­æµ‹è¯•æŒ‰é’®</p>
<img src="/images/2020/screencapture2020-04-07 PM12.00.15.jpg">

<p>æˆåŠŸ</p>
<h1 id="MyBatisæ¡†æ¶"><a href="#MyBatisæ¡†æ¶" class="headerlink" title="MyBatisæ¡†æ¶"></a>MyBatisæ¡†æ¶</h1><h2 id="åŠ æ³¨è§£-1"><a href="#åŠ æ³¨è§£-1" class="headerlink" title="åŠ æ³¨è§£"></a>åŠ æ³¨è§£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from account"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"insert into account (name,money) values (#&#123;name&#125;,#&#123;money&#125;)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®-sqlMapConfig-xml"><a href="#é…ç½®-sqlMapConfig-xml" class="headerlink" title="é…ç½® sqlMapConfig.xml"></a>é…ç½® sqlMapConfig.xml</h2><p>åœ¨resourcesä¸­æ–°å»ºsqlMapConfig.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®ç¯å¢ƒ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/groot?characterEncoding=utf8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"iamgroot"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥æ˜ å°„é…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.coconutnut.dao"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•-3"><a href="#æµ‹è¯•-3" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMyBatis</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        InputStream in = Resources.getResourceAsStream(<span class="string">"sqlMapConfig.xml"</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºSqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">// åˆ›å»ºSqlSessionå¯¹è±¡</span></span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line">        <span class="comment">// è·å–åˆ°ä»£ç†å¯¹è±¡</span></span><br><span class="line">        IAccountDao dao = session.getMapper(IAccountDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span></span><br><span class="line">        List&lt;Account&gt; list = dao.findAll();</span><br><span class="line">        <span class="keyword">for</span>(Account account : list)&#123;</span><br><span class="line">            System.out.println(account);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…³é—­èµ„æº</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setName(<span class="string">"ç†Šå¤§"</span>);</span><br><span class="line">        account.setMoney(<span class="number">400</span>d);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        InputStream in = Resources.getResourceAsStream(<span class="string">"sqlMapConfig.xml"</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºSqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">// åˆ›å»ºSqlSessionå¯¹è±¡</span></span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line">        <span class="comment">// è·å–åˆ°ä»£ç†å¯¹è±¡</span></span><br><span class="line">        IAccountDao dao = session.getMapper(IAccountDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¿å­˜</span></span><br><span class="line">        dao.saveAccount(account);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">        session.commit();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…³é—­èµ„æº</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•æŸ¥è¯¢</p>
<img src="/images/2020/screencapture2020-04-07 PM12.12.50.jpg">

<p>æµ‹è¯•ä¿å­˜</p>
<img src="/images/2020/screencapture2020-04-07 PM12.14.12.jpg">

<h1 id="Springæ•´åˆMyBatis"><a href="#Springæ•´åˆMyBatis" class="headerlink" title="Springæ•´åˆMyBatis"></a>Springæ•´åˆMyBatis</h1><p>ç›®æ ‡ï¼šServiceèƒ½è°ƒç”¨Dao</p>
<p>æ­¤æ—¶Serviceå·²ç»åœ¨å®¹å™¨ä¸­äº†ï¼Œéœ€è¦æŠŠç”Ÿæˆçš„Daoçš„ä»£ç†å¯¹è±¡ä¹Ÿå­˜åˆ°å®¹å™¨ä¸­</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>åœ¨Springçš„é…ç½®æ–‡ä»¶applicationContext.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Springæ•´åˆMyBatisæ¡†æ¶ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®è¿æ¥æ±  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/groot?characterEncoding=utf8"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"iamgroot"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®SqlSessionFactoryå·¥å‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®AccountDaoæ¥å£æ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"mapperScanner"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.coconutnut.dao"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¿™æ®µé…ç½®ï¼ŒsqlMapConfig.xmlå…¶å®å°±ä¸éœ€è¦äº†ï¼Œå¯ä»¥åˆ é™¤</p>
<h2 id="åŠ æ³¨è§£-2"><a href="#åŠ æ³¨è§£-2" class="headerlink" title="åŠ æ³¨è§£"></a>åŠ æ³¨è§£</h2><p>åœ¨AccountDaoä¸ŠåŠ @Repositoryæ³¨è§£</p>
<p>åœ¨AccountServiceImplä¸­æ³¨å…¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¸šåŠ¡å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰"</span>);</span><br><span class="line">        <span class="keyword">return</span> accountDao.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä¸šåŠ¡å±‚ï¼šä¿å­˜è´¦æˆ·"</span>);</span><br><span class="line">        accountDao.saveAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨AccountControllerä¸­æŠŠæŸ¥å‡ºçš„æ•°æ®å­˜å…¥Model</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/account"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountService accountService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findAll</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è¡¨ç°å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰"</span>);</span><br><span class="line">        List&lt;Account&gt; list = accountService.findAll();</span><br><span class="line">        model.addAttribute(<span class="string">"list"</span>,list);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é¡µé¢-1"><a href="#é¡µé¢-1" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h2><p>åœ¨list.jspä¸­æ‰“å°å‡ºæ¥</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> isELIgnored=<span class="string">"false"</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h3&gt;æŸ¥è¯¢æ‰€æœ‰çš„å¸æˆ·&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">&lt;c:forEach items=<span class="string">"$&#123;list&#125;"</span> <span class="keyword">var</span>=<span class="string">"account"</span>&gt;</span><br><span class="line">    $&#123;account.name&#125;</span><br><span class="line">&lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•æŸ¥è¯¢"><a href="#æµ‹è¯•æŸ¥è¯¢" class="headerlink" title="æµ‹è¯•æŸ¥è¯¢"></a>æµ‹è¯•æŸ¥è¯¢</h2><p>å‡ºäº†ä¸€ä¸ªå¼‚å¸¸</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2020-04-07 12:31:59,102 36291  [r$PoolThread-#0] WARN  resourcepool.BasicResourcePool  - com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@64fe7a60 -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: </span><br><span class="line">java.sql.SQLException: Unknown system variable &#39;tx_isolation&#39;</span><br><span class="line">	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)</span><br><span class="line">	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢å‘ç°æ˜¯mysql-connector-javaç‰ˆæœ¬å¤ªä½å¯¼è‡´</p>
<p>åœ¨pom.xmlä¸­å°†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ”¹ä¸º</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.48<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å†è¯•</p>
<img src="/images/2020/screencapture2020-04-07 PM12.46.36.jpg">

<p>æˆåŠŸ</p>
<h2 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h2><p>ä¿å­˜æ–¹æ³•è¿˜éœ€ç®¡ç†äº‹åŠ¡</p>
<p>Springä¸­è¿›è¡Œå£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼Œåœ¨applicationContext.xmlä¸­å¢åŠ </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®Springæ¡†æ¶å£°æ˜å¼äº‹åŠ¡ç®¡ç†--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡ç®¡ç†å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡é€šçŸ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">isolation</span>=<span class="string">"DEFAULT"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®AOPå¢å¼º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.coconutnut.service.impl.*ServiceImpl.*(..))"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="é¡µé¢-2"><a href="#é¡µé¢-2" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h2><p>åœ¨index.jspä¸­æ–°å¢è¡¨å•</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;a href="account/findAll"&gt;æµ‹è¯•æŸ¥è¯¢&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h3&gt;æµ‹è¯•ä¿å­˜&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form action=<span class="string">"account/save"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">        å§“åï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span> /&gt;&lt;br/&gt;</span><br><span class="line">        é‡‘é¢ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"money"</span> /&gt;&lt;br/&gt;</span><br><span class="line">        &lt;input type=<span class="string">"submit"</span> value=<span class="string">"ä¿å­˜"</span>/&gt;&lt;br/&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ§åˆ¶å™¨-1"><a href="#æ§åˆ¶å™¨-1" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><p>å¢åŠ saveæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Account account, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  accountService.saveAccount(account);</span><br><span class="line">  response.sendRedirect(request.getContextPath()+<span class="string">"/account/findAll"</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å­˜å®Œé‡å®šå‘åˆ°listé¡µé¢</p>
<h2 id="æµ‹è¯•ä¿å­˜"><a href="#æµ‹è¯•ä¿å­˜" class="headerlink" title="æµ‹è¯•ä¿å­˜"></a>æµ‹è¯•ä¿å­˜</h2><img src="/images/2020/screencapture2020-04-07 PM12.54.47.jpg">

<p>ç‚¹å‡»ä¿å­˜</p>
<img src="/images/2020/screencapture2020-04-07 PM12.54.54.jpg">

<p>æˆåŠŸ</p>
<h1 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h1><img src="/images/2020/screencapture2020-04-07 PM12.56.33.jpg" width=300>]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°06 å¼‚å¸¸å¤„ç†ä¸æ‹¦æˆªå™¨</title>
    <url>/2020/04/07/note-springmvc-06/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>P39~45</p>
</blockquote>
<h1 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h1><img src="/images/2020/screencapture2020-04-07 AM9.52.33.jpg">

<p>å¦‚æœä»€ä¹ˆéƒ½ä¸åšï¼Œäº§ç”Ÿå¼‚å¸¸æ—¶ï¼ˆæ¨¡æ‹Ÿå¯ä»¥é™¤0ï¼‰ï¼Œä¼šå‡ºç°500 Internal Server Error</p>
<p>æ•™åŠ¡ç³»ç»Ÿå°±æ˜¯è¿™æ ·ğŸ™ƒ</p>
<p><strong>è§£å†³æ­¥éª¤</strong></p>
<ol>
<li>ç¼–å†™è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼ˆç”¨ä½œæç¤ºä¿¡æ¯ï¼‰</li>
<li>ç¼–å†™å¼‚å¸¸å¤„ç†å™¨</li>
<li>é…ç½®å¼‚å¸¸å¤„ç†å™¨ï¼ˆè·³è½¬åˆ°æç¤ºé¡µé¢ï¼‰</li>
</ol>
<h2 id="è‡ªå®šä¹‰å¼‚å¸¸ç±»"><a href="#è‡ªå®šä¹‰å¼‚å¸¸ç±»" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸ç±»"></a>è‡ªå®šä¹‰å¼‚å¸¸ç±»</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysException</span> <span class="keyword">extends</span> <span class="title">Exception</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨æç¤ºä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get set constructor ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><p>æ•è·å¼‚å¸¸ï¼ŒæŠ›è‡ªå®šä¹‰å¼‚å¸¸</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testException"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testException</span><span class="params">()</span> <span class="keyword">throws</span> SysException</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">int</span> a = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="comment">// æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> SysException(<span class="string">"æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·å‡ºç°é”™è¯¯äº†..."</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¼‚å¸¸å¤„ç†å™¨"><a href="#å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="å¼‚å¸¸å¤„ç†å™¨"></a>å¼‚å¸¸å¤„ç†å™¨</h2><p>å®ç°HandlerExceptionResolveræ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SysExceptionResolver</span> <span class="keyword">implements</span> <span class="title">HandlerExceptionResolver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// å¤„ç†å¼‚å¸¸çš„é€»è¾‘</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveException</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–åˆ°å¼‚å¸¸å¯¹è±¡</span></span><br><span class="line">        SysException e = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(ex <span class="keyword">instanceof</span> SysException)&#123;</span><br><span class="line">            e = (SysException)ex;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            e = <span class="keyword">new</span> SysException(<span class="string">"ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤...."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ›å»ºModelAndViewå¯¹è±¡</span></span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.addObject(<span class="string">"errorMsg"</span>,e.getMessage());</span><br><span class="line">        mv.setViewName(<span class="string">"error"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®å¼‚å¸¸å¤„ç†å™¨"><a href="#é…ç½®å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="é…ç½®å¼‚å¸¸å¤„ç†å™¨"></a>é…ç½®å¼‚å¸¸å¤„ç†å™¨</h2><p>åœ¨springmvc.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®å¼‚å¸¸å¤„ç†å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sysExceptionResolver"</span> <span class="attr">class</span>=<span class="string">"cn.itcast.exception.SysExceptionResolver"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="é”™è¯¯æç¤ºé¡µé¢"><a href="#é”™è¯¯æç¤ºé¡µé¢" class="headerlink" title="é”™è¯¯æç¤ºé¡µé¢"></a>é”™è¯¯æç¤ºé¡µé¢</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> isELIgnored=<span class="string">"false"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    $&#123;errorMsg&#125;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h1 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h1><p>SpringMVCçš„æ‹¦æˆªå™¨ç”¨äºå¯¹å¤„ç†å™¨è¿›è¡Œé¢„å¤„ç†å’Œåå¤„ç†ï¼Œç±»ä¼¼Servletçš„è¿‡æ»¤å™¨ Filter</p>
<p>æ˜¯AOPçš„ä½“ç°</p>
<p><strong>æ‹¦æˆªå™¨é“¾</strong></p>
<p>å°†æ‹¦æˆªå™¨æŒ‰ä¸€å®šçš„é¡ºåºè”ç»“æˆä¸€æ¡é“¾ï¼ŒæŒ‰é¡ºåºè°ƒç”¨</p>
<p><strong>ä¸è¿‡æ»¤å™¨çš„åŒºåˆ«</strong></p>
<p>è¿‡æ»¤å™¨æ˜¯Servletè§„èŒƒä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä»»ä½•java webå·¥ç¨‹éƒ½å¯ä»¥ç”¨ï¼›æ‹¦æˆªå™¨æ˜¯Spring MVCæ¡†æ¶çš„</p>
<p>è¿‡æ»¤å™¨åœ¨url-patternä¸­é…ç½®äº†â€/*â€åï¼Œå¯ä»¥å¯¹æ‰€æœ‰è¦è®¿é—®çš„èµ„æºæ‹¦æˆªï¼›æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªè®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œä¸ä¼šæ‹¦æˆªjspã€htmlç­‰</p>
<p><strong>ä½¿ç”¨æ­¥éª¤</strong></p>
<ol>
<li>ç¼–å†™æ‹¦æˆªå™¨ï¼Œå®ç°HandlerInterceptoræ¥å£</li>
<li>é…ç½®æ‹¦æˆªå™¨</li>
</ol>
<h2 id="æ§åˆ¶å™¨-1"><a href="#æ§åˆ¶å™¨-1" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/testInterceptor"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"testInterceptoræ‰§è¡Œäº†..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor1</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// é¢„å¤„ç†ï¼Œcontrolleræ–¹æ³•æ‰§è¡Œå‰</span></span><br><span class="line">  	<span class="comment">// return true æ”¾è¡Œï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ‰§è¡Œcontrollerä¸­çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// return false ä¸æ”¾è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MyInterceptor1æ‰§è¡Œäº†...å‰"</span>);</span><br><span class="line">      	<span class="comment">// ä¹Ÿå¯ä»¥è¯·æ±‚è½¬å‘</span></span><br><span class="line">        <span class="comment">// request.getRequestDispatcher("/WEB-INF/pages/error.jsp").forward(request,response);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åå¤„ç†æ–¹æ³•ï¼Œcontrolleræ–¹æ³•æ‰§è¡Œåï¼Œsuccess.jspæ‰§è¡Œä¹‹å‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MyInterceptor1æ‰§è¡Œäº†...å"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// success.jspé¡µé¢æ‰§è¡Œåï¼Œè¯¥æ–¹æ³•ä¼šæ‰§è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"MyInterceptor1æ‰§è¡Œäº†...æœ€å"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>springmvc.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è¦æ‹¦æˆªçš„å…·ä½“çš„æ–¹æ³•--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/user/*"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä¸è¦æ‹¦æˆªçš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">            &lt;mvc:exclude-mapping path=""/&gt; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨å¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"cn.itcast.controller.cn.itcast.interceptor.MyInterceptor1"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¦æ‹¦æˆªçš„æ–¹æ³•å’Œä¸è¦æ‹¦æˆªçš„æ–¹æ³•é…ç½®ä¸€ä¸ªå°±å¯ä»¥äº†</p>
<p>è¿™æ ·é…ç½®æ‹¦æˆªå™¨åï¼Œæµ‹è¯•è¾“å‡ºä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MyInterceptor1æ‰§è¡Œäº†...å‰</span><br><span class="line">testInterceptoræ‰§è¡Œäº†</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...å</span><br><span class="line">success.jspæ‰§è¡Œäº†</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...æœ€å</span><br></pre></td></tr></table></figure>

<h2 id="2ä¸ªæ‹¦æˆªå™¨"><a href="#2ä¸ªæ‹¦æˆªå™¨" class="headerlink" title="2ä¸ªæ‹¦æˆªå™¨"></a>2ä¸ªæ‹¦æˆªå™¨</h2><img src="/images/2020/screencapture2020-04-07 AM10.26.39.jpg">

<p>æ‹¦æˆªå™¨ä»£ç å’Œç¬¬ä¸€ä¸ªä¸€æ ·</p>
<p><strong>é…ç½®</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/user/*"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨å¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"cn.itcast.controller.cn.itcast.interceptor.MyInterceptor1"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--é…ç½®ç¬¬äºŒä¸ªæ‹¦æˆªå™¨--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ‹¦æˆªæ‰€æœ‰æ–¹æ³•--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®æ‹¦æˆªå™¨å¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"cn.itcast.controller.cn.itcast.interceptor.MyInterceptor2"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>è¾“å‡º</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MyInterceptor1æ‰§è¡Œäº†...å‰1</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...å‰2</span><br><span class="line">testInterceptoræ‰§è¡Œäº†</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...å2</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...å1</span><br><span class="line">success.jspæ‰§è¡Œäº†</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...æœ€å2</span><br><span class="line">MyInterceptor1æ‰§è¡Œäº†...æœ€å1</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>Underwelming</title>
    <url>/2020/04/06/excerpt/</url>
    <content><![CDATA[<blockquote>
<p>è½¯ä»¶æœ€å¤§çš„å¥½å¤„å°±æ˜¯è®©ä¸€åˆ‡å˜å¾—ç®€å•ã€‚ä½†æ˜¯ï¼Œåšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•æ˜¯æ­£ç¡®è®¾ç½®é»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯é™åˆ¶ç”¨æˆ·çš„é€‰æ‹©ã€‚</p>
<p>â€”â€” Paul Grahamã€Šé»‘å®¢ä¸ç”»å®¶ã€‹</p>
</blockquote>
<p>ä¸Šæ¬¡çœ‹è¿™æœ¬ä¹¦çš„æ—¶å€™éƒ½æ²¡æœ‰æ³¨æ„åˆ°è¿™å¥è¯</p>
<p>è¿™æ¬¡è§åˆ°è§†çº¿éƒ½æŒªä¸èµ°äº†</p>
<p>å¯èƒ½æ˜¯Springåé—ç—‡</p>
<p>æƒ³èµ·æ›¾ç»æŸæ¬¡å¬åˆ°çš„ä»‹ç»Apple Design Award Winning App</p>
<p>å…¶ä¸­Pixelmator Photoçš„é­”æ³•æ£’å¯ä»¥ç”¨â€Underwelmingâ€æ¥å½¢å®¹</p>
<p>ä¸ä»…æ˜¯æ­£ç¡®è®¾ç½®é»˜è®¤å€¼ï¼ŒåŒæ—¶åŠ¨æ€å±•ç¤ºè¯¸å¤šå‚æ•°çš„å˜åŒ–ï¼Œè®©ç”¨æˆ·çœ‹åˆ°å˜åŒ–çš„èµ·å› å’Œç»“æœ</p>
<blockquote>
<ul>
<li><p>Reaveal whatâ€™s behind the Appâ€™s intelligence</p>
</li>
<li><p>Allow adjustments</p>
</li>
</ul>
</blockquote>
<p>è¿™æ¡è§„å¾‹ä¼¼ä¹é€‚ç”¨å¾ˆå¹¿å‘¢</p>
<p>å”‰ è¿™ä¹ˆçœ‹çš„è¯ä¹‹å‰è‡ªå·±çš„Appä¸ºäº†ç®€åŒ–æ“ä½œè€Œç–¯ç‹‚ç¼©å‡å¯è°ƒèŠ‚çš„å‚æ•°å®åœ¨ä¸å¦¥</p>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°05 æ–‡ä»¶ä¸Šä¼ </title>
    <url>/2020/04/06/note-springmvc-05/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>P33~38</p>
</blockquote>
<h1 id="ä¼ ç»Ÿæ–¹å¼"><a href="#ä¼ ç»Ÿæ–¹å¼" class="headerlink" title="ä¼ ç»Ÿæ–¹å¼"></a>ä¼ ç»Ÿæ–¹å¼</h1><p>ä¸Šä¼ çš„æ–‡ä»¶å’Œè®¿é—®çš„åº”ç”¨åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Š</p>
<h2 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><p>ä½¿ç”¨ Commons-fileupload ç»„ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="jspé¡µé¢"><a href="#jspé¡µé¢" class="headerlink" title="jspé¡µé¢"></a>jspé¡µé¢</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/user/fileupload1"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">  é€‰æ‹©æ–‡ä»¶ï¼š&lt;input type=<span class="string">"file"</span> name=<span class="string">"upload"</span> /&gt;&lt;br/&gt;</span><br><span class="line">  &lt;input type=<span class="string">"submit"</span> value=<span class="string">"ä¸Šä¼ "</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨fileuploadç»„ä»¶å®Œæˆæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/fileupload1"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">fileuoload1</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä¸Šä¼ çš„ä½ç½®</span></span><br><span class="line">  String path = request.getSession().getServletContext().getRealPath(<span class="string">"/uploads/"</span>);</span><br><span class="line">  <span class="comment">// åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">  File file = <span class="keyword">new</span> File(path);</span><br><span class="line">  <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¯¥æ–‡ä»¶å¤¹</span></span><br><span class="line">    file.mkdirs();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è§£ærequestå¯¹è±¡ï¼Œè·å–ä¸Šä¼ æ–‡ä»¶é¡¹</span></span><br><span class="line">  DiskFileItemFactory factory = <span class="keyword">new</span> DiskFileItemFactory();</span><br><span class="line">  ServletFileUpload upload = <span class="keyword">new</span> ServletFileUpload(factory);</span><br><span class="line">  <span class="comment">// è§£ærequest</span></span><br><span class="line">  List&lt;FileItem&gt; items = upload.parseRequest(request);</span><br><span class="line">  <span class="comment">// éå†</span></span><br><span class="line">  <span class="keyword">for</span>(FileItem item:items)&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å½“å‰itemå¯¹è±¡æ˜¯å¦æ˜¯ä¸Šä¼ æ–‡ä»¶é¡¹</span></span><br><span class="line">    <span class="keyword">if</span>(item.isFormField())&#123;</span><br><span class="line">      <span class="comment">// æ™®é€šè¡¨å•å‘</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„åç§°</span></span><br><span class="line">      String filename = item.getName();</span><br><span class="line">      <span class="comment">// æŠŠæ–‡ä»¶çš„åç§°è®¾ç½®å”¯ä¸€å€¼ï¼Œuuid</span></span><br><span class="line">      String uuid = UUID.randomUUID().toString().replace(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">      filename = uuid+<span class="string">"_"</span>+filename;</span><br><span class="line">      <span class="comment">// å®Œæˆæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">      item.write(<span class="keyword">new</span> File(path,filename));</span><br><span class="line">      <span class="comment">// åˆ é™¤ä¸´æ—¶æ–‡ä»¶</span></span><br><span class="line">      item.delete();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä¸Šä¼ å</p>
<p>åœ¨target/uploadsä¸­æ‰¾åˆ°ä¸Šä¼ çš„æ–‡ä»¶</p>
<h1 id="SpringMVCä¼ ç»Ÿæ–¹å¼ä¸Šä¼ "><a href="#SpringMVCä¼ ç»Ÿæ–¹å¼ä¸Šä¼ " class="headerlink" title="SpringMVCä¼ ç»Ÿæ–¹å¼ä¸Šä¼ "></a>SpringMVCä¼ ç»Ÿæ–¹å¼ä¸Šä¼ </h1><h2 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h2><img src="/images/2020/screencapture2020-04-06 AM11.14.41.jpg">

<h2 id="jspé¡µé¢-1"><a href="#jspé¡µé¢-1" class="headerlink" title="jspé¡µé¢"></a>jspé¡µé¢</h2><p>å’Œä¼ ç»Ÿæ–¹å¼ä¸€æ ·</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/user/fileupload2"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">  é€‰æ‹©æ–‡ä»¶ï¼š&lt;input type=<span class="string">"file"</span> name=<span class="string">"upload"</span> /&gt;&lt;br/&gt;</span><br><span class="line">  &lt;input type=<span class="string">"submit"</span> value=<span class="string">"ä¸Šä¼ "</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ–‡ä»¶è§£æå™¨"><a href="#é…ç½®æ–‡ä»¶è§£æå™¨" class="headerlink" title="é…ç½®æ–‡ä»¶è§£æå™¨"></a>é…ç½®æ–‡ä»¶è§£æå™¨</h2><p>spingmvc.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®æ–‡ä»¶è§£æå™¨å¯¹è±¡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"10*1024*1024"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é‡Œé¢å¯ä»¥è®¾ç½®ä¸€äº›å±æ€§ï¼Œå¦‚æ–‡ä»¶å¤§å°</p>
<h2 id="æ§åˆ¶å™¨-1"><a href="#æ§åˆ¶å™¨-1" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/fileupload2"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">fileuoload2</span><span class="params">(HttpServletRequest request, MultipartFile upload)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸Šä¼ çš„ä½ç½®</span></span><br><span class="line">  String path = request.getSession().getServletContext().getRealPath(<span class="string">"/uploads/"</span>);</span><br><span class="line">  <span class="comment">// åˆ¤æ–­è¯¥è·¯å¾„æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">  File file = <span class="keyword">new</span> File(path);</span><br><span class="line">  <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè¯¥æ–‡ä»¶å¤¹</span></span><br><span class="line">    file.mkdirs();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„åç§°</span></span><br><span class="line">  String filename = upload.getOriginalFilename();</span><br><span class="line">  <span class="comment">// æŠŠæ–‡ä»¶çš„åç§°è®¾ç½®å”¯ä¸€å€¼ï¼Œuuid</span></span><br><span class="line">  String uuid = UUID.randomUUID().toString().replace(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">  filename = uuid+<span class="string">"_"</span>+filename;</span><br><span class="line">  <span class="comment">// å®Œæˆæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">  upload.transferTo(<span class="keyword">new</span> File(path,filename));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸è¾ƒä¼ ç»Ÿæ–¹å¼ï¼Œçœäº†è§£ææ“ä½œï¼Œç®€åŒ–ä¸Šä¼ æ­¥éª¤</p>
<h1 id="SpringMVCè·¨æœåŠ¡å™¨ä¸Šä¼ "><a href="#SpringMVCè·¨æœåŠ¡å™¨ä¸Šä¼ " class="headerlink" title="SpringMVCè·¨æœåŠ¡å™¨ä¸Šä¼ "></a>SpringMVCè·¨æœåŠ¡å™¨ä¸Šä¼ </h1><img src="/images/2020/screencapture2020-04-06 AM11.25.56.jpg">

<p>ç”¨2ä¸ªtomcatæœåŠ¡å™¨ï¼Œæ–‡ä»¶æœåŠ¡å™¨ç«¯å£å·æ­¤å¤„ç”¨çš„9090</p>
<h2 id="æ–‡ä»¶æœåŠ¡å™¨"><a href="#æ–‡ä»¶æœåŠ¡å™¨" class="headerlink" title="æ–‡ä»¶æœåŠ¡å™¨"></a>æ–‡ä»¶æœåŠ¡å™¨</h2><p>æ–°å»ºä¸€ä¸ªå·¥ç¨‹</p>
<p>åœ¨webappä¸‹æ–°å»ºuploadsæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ–‡ä»¶</p>
<p>å¯åŠ¨</p>
<h2 id="ä¾èµ–-1"><a href="#ä¾èµ–-1" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="jspé¡µé¢-2"><a href="#jspé¡µé¢-2" class="headerlink" title="jspé¡µé¢"></a>jspé¡µé¢</h2><p>ä»æ²¡ä»€ä¹ˆåŒºåˆ«</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/user/fileupload3"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">  é€‰æ‹©æ–‡ä»¶ï¼š&lt;input type=<span class="string">"file"</span> name=<span class="string">"upload"</span> /&gt;&lt;br/&gt;</span><br><span class="line">  &lt;input type=<span class="string">"submit"</span> value=<span class="string">"ä¸Šä¼ "</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ§åˆ¶å™¨-2"><a href="#æ§åˆ¶å™¨-2" class="headerlink" title="æ§åˆ¶å™¨"></a>æ§åˆ¶å™¨</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/fileupload3"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">fileuoload3</span><span class="params">(MultipartFile upload)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å®šä¹‰ä¸Šä¼ æ–‡ä»¶æœåŠ¡å™¨è·¯å¾„</span></span><br><span class="line">  String path = <span class="string">"http://localhost:9090/uploads/"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„åç§°</span></span><br><span class="line">  String filename = upload.getOriginalFilename();</span><br><span class="line">  <span class="comment">// æŠŠæ–‡ä»¶çš„åç§°è®¾ç½®å”¯ä¸€å€¼ï¼Œuuid</span></span><br><span class="line">  String uuid = UUID.randomUUID().toString().replace(<span class="string">"-"</span>, <span class="string">""</span>);</span><br><span class="line">  filename = uuid+<span class="string">"_"</span>+filename;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯çš„å¯¹è±¡</span></span><br><span class="line">  Client client = Client.create();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å’Œå›¾ç‰‡æœåŠ¡å™¨è¿›è¡Œè¿æ¥</span></span><br><span class="line">  WebResource webResource = client.resource(path + filename);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">  webResource.put(upload.getBytes());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡ºç°409å¼‚å¸¸å¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸‹uploadsæ–‡ä»¶å¤¹</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°04 å“åº”æ•°æ®å’Œç»“æœè§†å›¾</title>
    <url>/2020/04/06/note-springmvc-04/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>P25~32</p>
</blockquote>
<h1 id="è¿”å›å€¼ç±»å‹"><a href="#è¿”å›å€¼ç±»å‹" class="headerlink" title="è¿”å›å€¼ç±»å‹"></a>è¿”å›å€¼ç±»å‹</h1><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testReturnString"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testReturnString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿”å›å­—ç¬¦ä¸²å¯ä»¥æŒ‡å®šé€»è¾‘è§†å›¾åï¼Œé€šè¿‡è§†å›¾è§£æå™¨è§£æä¸ºç‰©ç†è§†å›¾åœ°å€</p>
<p>æ­¤å¤„è¿”å›â€successâ€å°†è·³è½¬åˆ°success.jsp</p>
<p><strong>åº”ç”¨</strong></p>
<p>ä»æ•°æ®åº“ä¸­å–Userå¹¶å­˜å…¥Model</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testReturnString"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testReturnString</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// æ¨¡æ‹Ÿä»æ•°æ®åº“æŸ¥è¯¢å‡ºUserå¯¹è±¡</span></span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setUsername(<span class="string">"ha"</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å­˜å…¥Model</span></span><br><span class="line">  model.addAttribute(<span class="string">"user"</span>,user);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·³è½¬åˆ°success.jsp</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨success.jspä¸­å–å‡ºUser</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> isELIgnored=<span class="string">"false"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h3&gt;æ‰§è¡ŒæˆåŠŸ&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">    $&#123;user.username&#125;</span><br><span class="line">    $&#123;user.password&#125;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="void"><a href="#void" class="headerlink" title="void"></a>void</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testVoid"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testReturnString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ²¡æœ‰è¿”å›å€¼ï¼Œé»˜è®¤æ ¹æ®è¯·æ±‚è·¯å¾„è·³è½¬ï¼Œå¦‚æ­¤å¤„ä¼šæ‰¾testVoid.jsp</p>
<p>ä¿®æ”¹éœ€è¦ç”¨åˆ°Requestã€Responseå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testVoid"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testReturnString</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  <span class="comment">// è¯·æ±‚è½¬å‘</span></span><br><span class="line">  request.getRequestDispatcher(<span class="string">"/WEB-INF/pages/success.jsp"</span>).forward(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç”¨responseé‡å®šå‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¾‹1</span></span><br><span class="line">response.sendRedirect(request.getContextPath()+<span class="string">"index.jsp"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¾‹2</span></span><br><span class="line">response.sendRedirect(<span class="string">"testRetrunString"</span>);</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…æŒ‡å®šå“åº”ç»“æœï¼Œä¾‹å¦‚å“åº”jsonæ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">response.setCharacterEncoding(<span class="string">"utf-8"</span>); response.setContentType(<span class="string">"application/json;charset=utf-8"</span>); response.getWriter().write(<span class="string">"HELLO"</span>);</span><br></pre></td></tr></table></figure>

<h2 id="ModelAndView"><a href="#ModelAndView" class="headerlink" title="ModelAndView"></a>ModelAndView</h2><p>ModelAndView æ˜¯ SpringMVC æä¾›çš„ä¸€ä¸ªå¯¹è±¡</p>
<p>å†…éƒ¨æœ‰ä¸€ä¸ªModelï¼Œå¯ä»¥å­˜æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testReturnModelAndView"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">testReturnModelAndView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºModelAndViewå¯¹è±¡</span></span><br><span class="line">	ModelAndView mv = <span class="keyword">new</span> ModelAndView(); </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æ¨¡æ‹Ÿä»æ•°æ®åº“æŸ¥è¯¢å‡ºUserå¯¹è±¡</span></span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setUsername(<span class="string">"ha"</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å¯ä»¥å­˜å¯¹è±¡</span></span><br><span class="line">  mv.addObject(<span class="string">"user"</span>,user);</span><br><span class="line">  <span class="comment">// ä¹Ÿå¯ä»¥ç›´æ¥å­˜é”®å€¼å¯¹</span></span><br><span class="line">  mv.addObject(<span class="string">"username"</span>, <span class="string">"å¼ ä¸‰"</span>); </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// æŒ‡å®šè·³è½¬åˆ°å“ªä¸ªé¡µé¢</span></span><br><span class="line">  mv.setViewName(<span class="string">"success"</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> mv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="è½¬å‘å’Œé‡å®šå‘"><a href="#è½¬å‘å’Œé‡å®šå‘" class="headerlink" title="è½¬å‘å’Œé‡å®šå‘"></a>è½¬å‘å’Œé‡å®šå‘</h1><p>ä½¿ç”¨å…³é”®å­—è¿›è¡Œè½¬å‘å’Œé‡å®šå‘æ—¶ï¼Œæ— æ³•ä½¿ç”¨è§†å›¾è§£æå™¨ï¼Œéœ€è¦è‡ªå·±å†™è·¯å¾„ï¼Œç”¨å¾—ä¸å¤š</p>
<h2 id="forward"><a href="#forward" class="headerlink" title="forward"></a>forward</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testForward"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testForward</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"forward:/WEB-INF/pages/success.jsp"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è·¯å¾„å¿…é¡»å†™å®é™…è§†å›¾urlï¼Œä¸èƒ½å†™é€»è¾‘è§†å›¾</p>
<p>æ—¢å¯ä»¥è½¬å‘åˆ°jspï¼Œä¹Ÿå¯ä»¥è½¬å‘åˆ°å…¶ä»–çš„æ§åˆ¶å™¨æ–¹æ³•</p>
<h2 id="redirect"><a href="#redirect" class="headerlink" title="redirect"></a>redirect</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testRedirect"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRedirect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// return "redirect:/index.jsp"</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">"redirect:testReturnModelAndView"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœé‡å®šå‘åˆ°jspé¡µé¢ï¼Œé¡µé¢ä¸èƒ½å†WEB-INFä¸­ï¼Œä¼šæ‰¾ä¸åˆ°</p>
<h1 id="å“åº”json"><a href="#å“åº”json" class="headerlink" title="å“åº”json"></a>å“åº”json</h1><p>ä½¿ç”¨@ResponseBody æ³¨è§£å®ç°å°† controller æ–¹æ³•è¿”å›å¯¹è±¡è½¬æ¢ä¸º json å“åº”ç»™å®¢æˆ·ç«¯</p>
<p>åœ¨webappç›®å½•ä¸‹æ–°å»ºjsæ–‡ä»¶å¤¹ï¼ŒæŠŠjquery.main.jså¤åˆ¶è¿›å»ï¼Œè¦ç”¨çš„jspä¸­å¼•å…¥</p>
<p><strong>response.jsp</strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script src="js/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="comment">// é¡µé¢åŠ è½½ï¼Œç»‘å®šå•å‡»äº‹ä»¶</span></span><br><span class="line">        $(function()&#123;</span><br><span class="line">            $(<span class="string">"#btn"</span>).click(function()&#123;</span><br><span class="line">                 alert(<span class="string">"hello btn"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    &lt;button id="btn"&gt;å‘é€ajaxçš„è¯·æ±‚&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œæ­¤æ—¶åœ¨é¡µé¢ä¸­ç‚¹å‡»æŒ‰é’®ï¼Œä¸ä¼šæœ‰å“åº”</p>
<p>å› ä¸ºè™½ç„¶å¼•å…¥äº†jquery.min.js</p>
<p>ä½†æ˜¯åœ¨web.xmlä¸­é…ç½®çš„DispatcherServletæ‹¦æˆªè·¯å¾„â€/â€œï¼Œä¹Ÿä¼šæ‹¦æˆªé™æ€çš„èµ„æºæ–‡ä»¶</p>
<h2 id="è¿‡æ»¤é™æ€èµ„æº"><a href="#è¿‡æ»¤é™æ€èµ„æº" class="headerlink" title="è¿‡æ»¤é™æ€èµ„æº"></a>è¿‡æ»¤é™æ€èµ„æº</h2><p>åœ¨springmvc.xmlä¸­é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å‰ç«¯æ§åˆ¶å™¨ï¼Œå“ªäº›é™æ€èµ„æºä¸æ‹¦æˆª--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/css/"</span> <span class="attr">mapping</span>=<span class="string">"/css/**"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/images/"</span> <span class="attr">mapping</span>=<span class="string">"/images/**"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>é…ç½®ä¹‹åå†ç‚¹å‡»æŒ‰é’®ï¼Œå°±ä¼šæœ‰å¼¹æ¡†äº†</p>
<h2 id="å‘é€ajaxè¯·æ±‚"><a href="#å‘é€ajaxè¯·æ±‚" class="headerlink" title="å‘é€ajaxè¯·æ±‚"></a>å‘é€ajaxè¯·æ±‚</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="comment">// é¡µé¢åŠ è½½ï¼Œç»‘å®šå•å‡»äº‹ä»¶</span></span><br><span class="line">  $(function()&#123;</span><br><span class="line">    $(<span class="string">"#btn"</span>).click(function()&#123;</span><br><span class="line">      <span class="comment">// å‘é€ajaxè¯·æ±‚</span></span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">        <span class="comment">// ç¼–å†™jsonæ ¼å¼ï¼Œè®¾ç½®å±æ€§å’Œå€¼</span></span><br><span class="line">        url:<span class="string">"user/testAjax"</span>,</span><br><span class="line">        contentType:<span class="string">"application/json;charset=UTF-8"</span>,</span><br><span class="line">        data:<span class="string">'&#123;"username":"hehe","password":"123","age":30&#125;'</span>,</span><br><span class="line">        dataType:<span class="string">"json"</span>,</span><br><span class="line">        type:<span class="string">"post"</span>,</span><br><span class="line">        success:function(data)&#123;</span><br><span class="line">          <span class="comment">// dataæ˜¯æœåŠ¡å™¨ç«¯å“åº”çš„jsonæ•°æ®</span></span><br><span class="line">          alert(data);</span><br><span class="line">          alert(data.username);</span><br><span class="line">          alert(data.password);</span><br><span class="line">          alert(data.age);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="å“åº”jsonæ ¼å¼æ•°æ®"><a href="#å“åº”jsonæ ¼å¼æ•°æ®" class="headerlink" title="å“åº”jsonæ ¼å¼æ•°æ®"></a>å“åº”jsonæ ¼å¼æ•°æ®</h2><p>Springmvc é»˜è®¤ç”¨ MappingJacksonHttpMessageConverter å¯¹ json æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œéœ€è¦åŠ å…¥ jackson çš„åŒ…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯å‘é€çš„ajaxè¯·æ±‚ï¼Œä¼ çš„æ˜¯jsonå­—ç¬¦ä¸²ï¼Œåç«¯å°†å…¶å°è£…åˆ°userå¯¹è±¡ä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚å“åº”</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testAjax"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@ResponseBody</span> <span class="function">User <span class="title">testAjax</span><span class="params">(@RequestBody User user)</span></span>&#123;</span><br><span class="line">  <span class="comment">// å“åº”ï¼Œæ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“</span></span><br><span class="line">  user.setUsername(<span class="string">"haha"</span>);</span><br><span class="line">  user.setAge(<span class="number">40</span>);</span><br><span class="line">  <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ @ResponseBodyï¼ŒæŠŠuserè½¬æˆjson</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°03 å¸¸ç”¨æ³¨è§£</title>
    <url>/2020/04/04/note-springmvc-03/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>P17~24</p>
</blockquote>
<h1 id="RequestParam"><a href="#RequestParam" class="headerlink" title="RequestParam"></a>RequestParam</h1><p>ä½œç”¨ï¼šæŠŠè¯·æ±‚ä¸­çš„æŒ‡å®šåç§°çš„å‚æ•°ä¼ é€’ç»™æ§åˆ¶å™¨ä¸­çš„å½¢å‚èµ‹å€¼</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valueï¼šè¯·æ±‚å‚æ•°ä¸­çš„åç§°</li>
<li>requiredï¼šè¯·æ±‚å‚æ•°ä¸­æ˜¯å¦å¿…é¡»æä¾›æ­¤å‚æ•°ï¼Œé»˜è®¤å€¼æ˜¯trueï¼Œå¿…é¡»æä¾›</li>
</ul>
<p>å¦‚ï¼Œæ–¹æ³•ä¸­éœ€è¦nameå±æ€§ï¼Œä½†æ˜¯urlä¸­ä¼ çš„æ˜¯usernameå±æ€§ï¼Œå°±ä¼šå°è£…ä¸ä¸Š</p>
<p>å¯ä»¥ç”¨@RequestParamä¿®é¥°å‚æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(path=<span class="string">"/hello"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(@RequestParam(value=<span class="string">"username"</span>,required=<span class="keyword">false</span>)</span>String name) </span>&#123;</span><br><span class="line">  System.out.println(name); </span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="RequestBody"><a href="#RequestBody" class="headerlink" title="RequestBody"></a>RequestBody</h1><p>ä½œç”¨ï¼šç”¨äºè·å–è¯·æ±‚ä½“çš„å†…å®¹ï¼ˆgetæ–¹æ³•ä¸é€‚ç”¨ï¼‰</p>
<p>ç›´æ¥ä½¿ç”¨å¾—åˆ°çš„æ˜¯key=value&amp;key=valueç»“æ„çš„æ•°æ®</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>requiredï¼šæ˜¯å¦å¿…é¡»æœ‰è¯·æ±‚ä½“ï¼Œé»˜è®¤å€¼æ˜¯true</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"anno/testRequestBody"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  ç”¨æˆ·å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"age"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(path=<span class="string">"/testRequestBody"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(@RequestBody String body)</span> </span>&#123;</span><br><span class="line">	System.out.println(body);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åé¢ä¼ jsonæ•°æ®æ—¶ä¼šç”¨åˆ°</p>
<h1 id="PathVariable"><a href="#PathVariable" class="headerlink" title="PathVariable"></a>PathVariable</h1><p>ä½œç”¨ï¼šç”¨äºç»‘å®š url ä¸­çš„å ä½ç¬¦ï¼ˆå¦‚:è¯·æ±‚ /delete/{id}ä¸­çš„{id}ï¼‰</p>
<p>ç”¨äºæ”¯æŒRESTfulé£æ ¼</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valueï¼šç”¨äºæŒ‡å®š url ä¸­å ä½ç¬¦åç§°</li>
<li>requiredï¼šæ˜¯å¦å¿…é¡»æä¾›å ä½ç¬¦</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"springmvc/usePathVariable/100"</span>&gt;</span>pathVariable æ³¨è§£<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/usePathVariable/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">usePathVariable</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">	System.out.println(id);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨RESTfulé£æ ¼æ—¶</p>
<p>ç”±äºæµè§ˆå™¨formè¡¨å•åªæ”¯æŒGETä¸POSTè¯·æ±‚ï¼Œè€Œä¸æ”¯æŒDELETEã€PUT</p>
<p>Spring3.0æä¾›äº†ä¸€ä¸ªè¿‡æ»¤å™¨HiddentHttpMethodFilterï¼Œå¯ä»¥å°†æµè§ˆå™¨è¯·æ±‚ä¿®æ”¹ä¸ºæŒ‡å®šæ–¹å¼ï¼Œä½†æ¯”è¾ƒéº»çƒ¦</p>
<p>è¿˜æœ‰WebClientç±»å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•æ¨¡æ‹Ÿå„ç§è¯·æ±‚æ–¹å¼</p>
<p>æˆ–è€…å¯ä»¥ç»™æµè§ˆå™¨è£…æ’ä»¶</p>
<h1 id="RequestHeader"><a href="#RequestHeader" class="headerlink" title="RequestHeader"></a>RequestHeader</h1><p>ä½œç”¨ï¼šè·å–è¯·æ±‚æ¶ˆæ¯å¤´</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valueï¼šæä¾›æ¶ˆæ¯å¤´åç§°</li>
<li>requiredï¼šæ˜¯å¦å¿…é¡»æœ‰æ­¤æ¶ˆæ¯å¤´</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/useRequestHeader"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">useRequestHeader</span><span class="params">(@RequestHeader(value=<span class="string">"Accept-Language"</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">required=<span class="keyword">false</span>)</span>String requestHeader)</span>&#123; </span><br><span class="line">  System.out.println(requestHeader);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="CookieValue"><a href="#CookieValue" class="headerlink" title="CookieValue"></a>CookieValue</h1><p>ä½œç”¨ï¼šè·å–Cookieçš„å€¼</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valueï¼šæŒ‡å®š cookie çš„åç§°</li>
<li>requiredï¼šæ˜¯å¦å¿…é¡»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/useCookieValue"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">useCookieValue</span><span class="params">(@CookieValue(value=<span class="string">"JSESSIONID"</span>,required=<span class="keyword">false</span>)</span> String cookieValue)</span>&#123;</span><br><span class="line">	System.out.println(cookieValue);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ModelAttribute"><a href="#ModelAttribute" class="headerlink" title="ModelAttribute"></a>ModelAttribute</h1><p>ä½œç”¨ï¼šåŠ åœ¨æ–¹æ³•ä¸Šï¼Œè¯¥æ–¹æ³•åœ¨æ§åˆ¶å™¨çš„æ–¹æ³•æ‰§è¡Œå‰å…ˆæ‰§è¡Œï¼›åŠ åœ¨å‚æ•°ä¸Šï¼Œè·å–æŒ‡å®šçš„æ•°æ®ç»™å‚æ•°èµ‹å€¼</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valueï¼šç”¨äºè·å–æ•°æ®çš„ keyï¼ˆkey å¯ä»¥æ˜¯ POJO çš„å±æ€§åç§°ï¼Œä¹Ÿå¯ä»¥æ˜¯ map ç»“æ„çš„ keyï¼‰</li>
</ul>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<p>è¡¨å•æäº¤æ•°æ®ä¸å®Œæ•´æ—¶ï¼Œå…ˆä»æ•°æ®åº“æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼Œæ²¡æœ‰æäº¤æ•°æ®çš„å­—æ®µç”¨åŸå€¼</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"springmvc/updateUser"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span> </span><br><span class="line">  ç”¨æˆ·åç§°:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> &gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">	ç”¨æˆ·å¹´é¾„:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"age"</span> &gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"ä¿å­˜"</span>&gt;</span> <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ModelAttribute-ä¿®é¥°æ–¹æ³•å¸¦è¿”å›å€¼"><a href="#ModelAttribute-ä¿®é¥°æ–¹æ³•å¸¦è¿”å›å€¼" class="headerlink" title="ModelAttribute ä¿®é¥°æ–¹æ³•å¸¦è¿”å›å€¼"></a>ModelAttribute ä¿®é¥°æ–¹æ³•å¸¦è¿”å›å€¼</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ModelAttribute</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">showModel</span><span class="params">(String username)</span> </span>&#123; </span><br><span class="line">  <span class="comment">//æ¨¡æ‹Ÿå»æ•°æ®åº“æŸ¥è¯¢</span></span><br><span class="line">	User abc = findUserByName(username); </span><br><span class="line">  System.out.println(<span class="string">"æ‰§è¡Œäº† showModel æ–¹æ³•"</span>+abc);</span><br><span class="line">	<span class="keyword">return</span> abc; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/updateUser"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testModelAttribute</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">	System.out.println(<span class="string">"æ§åˆ¶å™¨ä¸­å¤„ç†è¯·æ±‚çš„æ–¹æ³•:ä¿®æ”¹ç”¨æˆ·:"</span>+user);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ModelAttribute-ä¿®é¥°æ–¹æ³•ä¸å¸¦è¿”å›å€¼"><a href="#ModelAttribute-ä¿®é¥°æ–¹æ³•ä¸å¸¦è¿”å›å€¼" class="headerlink" title="ModelAttribute ä¿®é¥°æ–¹æ³•ä¸å¸¦è¿”å›å€¼"></a>ModelAttribute ä¿®é¥°æ–¹æ³•ä¸å¸¦è¿”å›å€¼</h2><p>æ”¾åˆ°mapä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ModelAttribute</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showModel</span><span class="params">(String username,Map&lt;String,User&gt; map)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//æ¨¡æ‹Ÿå»æ•°æ®åº“æŸ¥è¯¢</span></span><br><span class="line">	User user = findUserByName(username); </span><br><span class="line">  System.out.println(<span class="string">"æ‰§è¡Œäº† showModel æ–¹æ³•"</span>+user); </span><br><span class="line">  map.put(<span class="string">"abc"</span>,user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/updateUser"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testModelAttribute</span><span class="params">(@ModelAttribute(<span class="string">"abc"</span>)</span>User user) </span>&#123;</span><br><span class="line">	System.out.println(<span class="string">"æ§åˆ¶å™¨ä¸­å¤„ç†è¯·æ±‚çš„æ–¹æ³•:ä¿®æ”¹ç”¨æˆ·:"</span>+user);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="SessionAttribute"><a href="#SessionAttribute" class="headerlink" title="SessionAttribute"></a>SessionAttribute</h1><p>ä½œç”¨ï¼šå¤šæ¬¡æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•é—´çš„å‚æ•°å…±äº«</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>valueï¼šæŒ‡å®šå­˜å…¥çš„å±æ€§åç§°</li>
<li>typeï¼šæŒ‡å®šå­˜å…¥çš„æ•°æ®ç±»å‹</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- SessionAttribute æ³¨è§£çš„ä½¿ç”¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"springmvc/testPut"</span>&gt;</span>å­˜å…¥SessionAttribute<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"springmvc/testGet"</span>&gt;</span>å–å‡ºSessionAttribute<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"springmvc/testClean"</span>&gt;</span>æ¸…é™¤SessionAttribute<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span>(<span class="string">"sessionAttributeController"</span>)</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/springmvc"</span>)</span><br><span class="line"><span class="meta">@SessionAttributes</span>(value =&#123;<span class="string">"username"</span>,<span class="string">"password"</span>&#125;,types=&#123;Integer<span class="class">.<span class="keyword">class</span>&#125;) <span class="title">public</span> <span class="title">class</span> <span class="title">SessionAttributeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/testPut"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">testPut</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">"username"</span>, <span class="string">"æ³°æ–¯ç‰¹"</span>);</span><br><span class="line">    model.addAttribute(<span class="string">"password"</span>,<span class="string">"123456"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/testGet"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">testGet</span><span class="params">(ModelMap model)</span></span>&#123;</span><br><span class="line">    System.out.println(model.get(<span class="string">"username"</span>)+<span class="string">";"</span>+model.get(<span class="string">"password"</span>));</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@RequestMapping</span>(<span class="string">"/testClean"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">complete</span><span class="params">(SessionStatus sessionStatus)</span></span>&#123;</span><br><span class="line">		sessionStatus.setComplete();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"success"</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°02 è¯·æ±‚å‚æ•°çš„ç»‘å®š</title>
    <url>/2020/04/04/note-springmvc-02/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>P11~16</p>
</blockquote>
<h1 id="ç®€å•å‚æ•°"><a href="#ç®€å•å‚æ•°" class="headerlink" title="ç®€å•å‚æ•°"></a>ç®€å•å‚æ•°</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"param/testParam?username=hehe&amp;password=123"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testParam"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam</span><span class="params">(String username,String password)</span></span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ç»‘å®šå®ä½“ç±»å‹"><a href="#ç»‘å®šå®ä½“ç±»å‹" class="headerlink" title="ç»‘å®šå®ä½“ç±»å‹"></a>ç»‘å®šå®ä½“ç±»å‹</h1><p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"param/saveAccount"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  é‡‘é¢ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"money"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»‘å®š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* è¯·æ±‚å‚æ•°ç»‘å®šæŠŠæ•°æ®å°è£…åˆ°JavaBeançš„ç±»ä¸­</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/saveAccount"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">saveAccount</span><span class="params">(Account account)</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"æ‰§è¡Œäº†..."</span>);</span><br><span class="line">  System.out.println(account);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h2><p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String uname;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">   	<span class="keyword">private</span> User user;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"param/saveAccount"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  é‡‘é¢ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"money"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user.uname"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user.age"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="é›†åˆç±»å‹"><a href="#é›†åˆç±»å‹" class="headerlink" title="é›†åˆç±»å‹"></a>é›†åˆç±»å‹</h2><p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; list;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,User&gt; map;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¡¨å•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"param/saveAccount"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  é‡‘é¢ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"money"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  ç”¨æˆ·å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"list[0].uname"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"list[0].age"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  ç”¨æˆ·å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"map['one'].uname"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"map['one'].age"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>mapä¸­æ”¾keyå€¼ï¼Œè¿™é‡Œæ˜¯â€™oneâ€™</p>
<h1 id="è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨"><a href="#è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨" class="headerlink" title="è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨"></a>è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨</h1><p>é¡µé¢æäº¤çš„æ•°æ®éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹</p>
<p>åŸºæœ¬ç±»å‹å¯ä»¥è‡ªåŠ¨è½¬ï¼Œå¦‚Integer</p>
<p>ä½†æ—¥æœŸç±»å‹å¯èƒ½ä¸æ”¯æŒæŸäº›æ ¼å¼ï¼Œéœ€è¦è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨</p>
<p>ä¾‹å¦‚ï¼Œç»™UseråŠ ä¸€ä¸ªDateå±æ€§</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String uname;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"param/saveUser"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  ç”¨æˆ·å§“åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"uname"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·å¹´é¾„ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"age"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  ç”¨æˆ·ç”Ÿæ—¥ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"date"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"æäº¤"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/saveUser"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">saveUser</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"æ‰§è¡Œäº†..."</span>);</span><br><span class="line">  System.out.println(user);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ç”Ÿæ—¥æ¡†ä¸­è¾“å…¥â€2000/11/11â€å‘ç°å¯ä»¥æ­£å¸¸å°è£…</p>
<p>ä½†æ˜¯â€2000-11-11â€å‡ºç°Bad Request</p>
<p>éœ€è¦å†™ä¸€ä¸ªç±»å‹è½¬æ¢ç±»å¹¶æ³¨å†Œ</p>
<p>éœ€è¦å®ç°Converteræ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringToDateConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>,<span class="title">Date</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">convert</span><span class="params">(String source)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(source == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"è¯·æ‚¨ä¼ å…¥æ•°æ®"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        DateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> df.parse(source);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"æ•°æ®ç±»å‹è½¬æ¢å‡ºç°é”™è¯¯"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨springmvc.xmlä¸­é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"conversionService"</span> <span class="attr">class</span>=<span class="string">"org.springframework.context.support.ConversionServiceFactoryBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"converters"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"cn.itcast.utils.StringToDateConverter"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¼€å¯SpringMVCæ¡†æ¶æ³¨è§£çš„æ”¯æŒ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">"conversionService"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="è§£å†³ä¸­æ–‡ä¹±ç "><a href="#è§£å†³ä¸­æ–‡ä¹±ç " class="headerlink" title="è§£å†³ä¸­æ–‡ä¹±ç "></a>è§£å†³ä¸­æ–‡ä¹±ç </h1><p>åœ¨web.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®è§£å†³ä¸­æ–‡ä¹±ç çš„è¿‡æ»¤å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="è·å–ServletåŸç”Ÿçš„API"><a href="#è·å–ServletåŸç”Ÿçš„API" class="headerlink" title="è·å–ServletåŸç”Ÿçš„API"></a>è·å–ServletåŸç”Ÿçš„API</h1><p>ç›´æ¥åœ¨æ–¹æ³•ä¸ŠåŠ å‚æ•°å³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testServlet"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testServlet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"æ‰§è¡Œäº†..."</span>);</span><br><span class="line">  System.out.println(request);</span><br><span class="line"></span><br><span class="line">  HttpSession session = request.getSession();</span><br><span class="line">  System.out.println(session);</span><br><span class="line"></span><br><span class="line">  ServletContext servletContext = session.getServletContext();</span><br><span class="line">  System.out.println(servletContext);</span><br><span class="line"></span><br><span class="line">  System.out.println(response);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVCç¬”è®°01 å…¥é—¨</title>
    <url>/2020/04/03/note-springmvc-01/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Sb411s7qa" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Sb411s7qa</a></p>
<p>p1~9</p>
</blockquote>
<p>SpringMVCæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ã€å®ç°MVCè®¾è®¡æ¨¡å‹çš„ã€è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§Webæ¡†æ¶</p>
<p>ä½¿ç”¨Springè¿›è¡Œwebå¼€å‘æ—¶ï¼Œå¯ä»¥é€‰æ‹©SpringMVCï¼Œä¹Ÿå¯ä»¥é›†æˆå…¶å®ƒæ¡†æ¶å¦‚Struts2</p>
<p>å®ƒé€šè¿‡ä¸€å¥—æ³¨è§£ï¼Œè®©ä¸€ä¸ªç®€å•çš„Javaç±»æˆä¸ºå¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨ï¼Œè€Œæ— éœ€å®ç°ä»»ä½•æ¥å£</p>
<p>æ”¯æŒRESTfulé£æ ¼çš„è¯·æ±‚</p>
<img src="/images/2020/screencapture2020-03-26PM10.20.30.jpg">

<h1 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h1><p>éœ€æ±‚ï¼š</p>
<img src="/images/2020/screencapture2020-04-03 AM10.39.54.jpg">

<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>Ideaåˆ›å»ºMavenå·¥ç¨‹ï¼Œé€‰æ‹©webapp</p>
<p>mavené¡¹ç›®åˆ›å»ºæ—¶ï¼Œå¯ä»¥åŠ ä¸€ç»„é”®å€¼å¯¹archetypeCatalog : internalï¼Œè§£å†³åŠ è½½æ…¢çš„é—®é¢˜</p>
<p>å»ºç«‹çš„å·¥ç¨‹ç›®å½•æ˜¯ä¸å…¨çš„ï¼Œåœ¨src/mainä¸‹æ‰‹åŠ¨åŠ ä¸Šjavaã€resourceæ–‡ä»¶å¤¹ï¼Œå¹¶å³é”®Mark Directory asè®¾ç½®ä¸ºæºç ã€èµ„æºæ–‡ä»¶å¤¹</p>
<h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ç¼–è¯‘ç‰ˆæœ¬æ”¹æˆ1.8 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- springç‰ˆæœ¬é”å®šï¼Œä¸‹é¢ç›´æ¥å¼•ç”¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml"></a>web.xml</h2><p>é…ç½®å‰ç«¯æ§åˆ¶å™¨ï¼ˆservletï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Archetype Created Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åŠ è½½springmvcçš„é…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯åŠ¨æœåŠ¡å™¨æ—¶åŠ è½½ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="springmvcçš„é…ç½®æ–‡ä»¶"><a href="#springmvcçš„é…ç½®æ–‡ä»¶" class="headerlink" title="springmvcçš„é…ç½®æ–‡ä»¶"></a>springmvcçš„é…ç½®æ–‡ä»¶</h2><p>åœ¨resourcesä¸­New-&gt;XML Configuration File-&gt;Spring Config</p>
<p>åç§°æ²¡æœ‰è¦æ±‚ï¼Œè¿™é‡Œå«springmvc</p>
<p>å¯¼å…¥åç§°ç©ºé—´ï¼Œå¼€å¯æ³¨è§£æ‰«æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€å¯æ³¨è§£æ‰«æ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.test"</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line">  	<span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®æ–‡ä»¶ç›®å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/pages"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®åç¼€å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  	<span class="comment">&lt;!-- å¼€å¯SpringMVCæ¡†æ¶æ³¨è§£æ”¯æŒ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="éƒ¨ç½²æœåŠ¡å™¨"><a href="#éƒ¨ç½²æœåŠ¡å™¨" class="headerlink" title="éƒ¨ç½²æœåŠ¡å™¨"></a>éƒ¨ç½²æœåŠ¡å™¨</h2><p>Add Configuration</p>
<p>åŠ ä¸€ä¸ªæœ¬åœ°çš„Tomcat</p>
<p>åœ¨Deploymentä¸­æ·»åŠ </p>
<img src="/images/2020/screencapture2020-04-03 AM11.15.26.jpg">

<h1 id="ä»£ç ç¼–å†™"><a href="#ä»£ç ç¼–å†™" class="headerlink" title="ä»£ç ç¼–å†™"></a>ä»£ç ç¼–å†™</h1><h2 id="index-jsp"><a href="#index-jsp" class="headerlink" title="index.jsp"></a>index.jsp</h2><p>é»˜è®¤è‡ªå¸¦çš„index.jspæ²¡æœ‰å¤´æ–‡ä»¶ä¿¡æ¯ï¼Œä¸­æ–‡å¯èƒ½ä¼šæœ‰ä¹±ç é—®é¢˜</p>
<p>å¯ä»¥åˆ äº†é‡æ–°åˆ›å»ºä¸€ä¸ª</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;å…¥é—¨ç¨‹åº&lt;/h1&gt;</span><br><span class="line">    &lt;a href="hello"&gt;ç‚¹è¿™é‡Œ&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="HelloController-java"><a href="#HelloController-java" class="headerlink" title="HelloController.java"></a>HelloController.java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(path=<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello Spring"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿”å›â€successâ€ï¼Œè§„åˆ™é»˜è®¤è¿”å›è¿™ä¸ªåå­—çš„jsp</p>
<h2 id="success-jsp"><a href="#success-jsp" class="headerlink" title="success.jsp"></a>success.jsp</h2><p>å¯ä»¥åœ¨WEB-INFä¸­æ–°å»ºpagesæ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢æ–°å»ºsuccess.jsp</p>
<p>åŠ ä¸€ä¸ªä¸€çº§æ ‡é¢˜</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;h1&gt;æˆåŠŸ&lt;/h1&gt;</span><br></pre></td></tr></table></figure>

<h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><img src="/images/2020/screencapture2020-04-03 AM11.39.30.jpg">

<p>ç‚¹å‡»</p>
<img src="/images/2020/screencapture2020-04-03 AM11.40.09.jpg">

<p>æ§åˆ¶å°è¾“å‡º</p>
<img src="/images/2020/screencapture2020-04-03 AM11.40.58.jpg">

<p>æˆåŠŸ</p>
<h1 id="å…¥é—¨æ¡ˆä¾‹æµç¨‹æ€»ç»“"><a href="#å…¥é—¨æ¡ˆä¾‹æµç¨‹æ€»ç»“" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹æµç¨‹æ€»ç»“"></a>å…¥é—¨æ¡ˆä¾‹æµç¨‹æ€»ç»“</h1> <img src="/images/2020/screencapture2020-04-04 PM5.05.25.jpg">

 <img src="/images/2020/screencapture2020-04-04 PM5.06.01.jpg">

<h1 id="RequestMappingæ³¨è§£"><a href="#RequestMappingæ³¨è§£" class="headerlink" title="RequestMappingæ³¨è§£"></a>RequestMappingæ³¨è§£</h1><p><strong>ä½œç”¨</strong></p>
<p>å»ºç«‹è¯·æ±‚urlå’Œå¤„ç†è¯·æ±‚æ–¹æ³•ä¹‹é—´çš„å¯¹åº”å…³ç³»</p>
<p>å¯ä»¥åŠ åœ¨æ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥åŠ åœ¨ç±»ä¸Šï¼ˆç›¸å½“äºä¸€çº§ç›®å½•ï¼‰</p>
<p>å¦‚ç±»ä¸ŠåŠ â€/userâ€ï¼Œæ–¹æ³•ä¸ŠåŠ â€/helloâ€ï¼Œè·³è½¬æ—¶è¯·æ±‚è·¯å¾„ä¸ºâ€user/helloâ€</p>
<p><strong>å±æ€§</strong></p>
<p>pathå’Œvalueï¼šä½œç”¨ç›¸åŒï¼ŒæŒ‡æ˜ å°„è·¯å¾„ï¼Œå½“åªæœ‰valueä¸€ä¸ªå±æ€§æ—¶ï¼Œâ€value=â€å¯ä»¥çœç•¥ä¸å†™</p>
<p>methodï¼šæŒ‡å½“å‰æ–¹æ³•å¯ä»¥æ¥å—çš„è¯·æ±‚æ–¹å¼ï¼Œå‚æ•°å¯ä»¥æ˜¯æ•°ç»„ï¼Œé‡Œé¢æ˜¯æšä¸¾ç±»å‹ï¼ˆå¦‚RequestMathod.POSTï¼‰</p>
<p>paramsï¼šç”¨äºæŒ‡å®šé™åˆ¶è¯·æ±‚å‚æ•°çš„æ¡ä»¶ï¼Œæ”¯æŒç®€å•çš„è¡¨è¾¾å¼ï¼ˆå¦‚params={â€œusername=heâ€}ï¼Œè¡¨ç¤ºè¯·æ±‚å‚æ•°ä¸­å¿…é¡»æœ‰usernameï¼Œä¸”å€¼å¿…é¡»ä¸ºheï¼‰</p>
<p>headersï¼šå‘é€çš„è¯·æ±‚å¿…é¡»åŒ…å«è¯·æ±‚å¤´</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>springmvc</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°09 æ³¨è§£å¼€å‘</title>
    <url>/2020/04/02/note-mybatis-09/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Db411s7F5" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Db411s7F5</a></p>
<p>P68~75</p>
</blockquote>
<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><h2 id="å¯¼åæ ‡"><a href="#å¯¼åæ ‡" class="headerlink" title="å¯¼åæ ‡"></a>å¯¼åæ ‡</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å‡†å¤‡å®ä½“ç±»å’Œæ¥å£"><a href="#å‡†å¤‡å®ä½“ç±»å’Œæ¥å£" class="headerlink" title="å‡†å¤‡å®ä½“ç±»å’Œæ¥å£"></a>å‡†å¤‡å®ä½“ç±»å’Œæ¥å£</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><p>æ˜ å°„é…ç½®æ–‡ä»¶å¯ä»¥ä¸è¦äº†ï¼Œä½†ä¸»é…ç½®æ–‡ä»¶ä¸èƒ½çœç•¥</p>
<p>ï¼ˆå¦‚æœä½¿ç”¨æ³¨è§£å¼€å‘ï¼Œä½†ç›¸åº”è·¯å¾„ä¸‹å­˜åœ¨å¯¹åº”çš„xmlï¼Œä¸ç®¡ç”¨ä¸ç”¨éƒ½ä¼šæŠ¥é”™ï¼‰</p>
<p>SqlMapConfig.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"jdbcConfig.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®åˆ«å--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.itheima.domain"</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®ç¯å¢ƒ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šå¸¦æœ‰æ³¨è§£çš„daoæ¥å£æ‰€åœ¨ä½ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.itheima.dao"</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>jdbcConfig.propertiesä¸­é…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jdbc.driver&#x3D;com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url&#x3D;jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;eesy_mybatis</span><br><span class="line">jdbc.username&#x3D;root</span><br><span class="line">jdbc.password&#x3D;1234</span><br></pre></td></tr></table></figure>

<h1 id="å•è¡¨CRUD"><a href="#å•è¡¨CRUD" class="headerlink" title="å•è¡¨CRUD"></a>å•è¡¨CRUD</h1><p>åœ¨mybatisä¸­é’ˆå¯¹CRUDå…±æœ‰å››ä¸ªæ³¨è§£ï¼š@Select @Insert @Update @Delete</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// å¢</span></span><br><span class="line">  	<span class="meta">@Insert</span>(<span class="string">"insert into user(username,address,sex,birthday)values(#&#123;username&#125;,#&#123;address&#125;,#&#123;sex&#125;,#&#123;birthday&#125;)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// åˆ </span></span><br><span class="line">  	<span class="meta">@Delete</span>(<span class="string">"delete from user where id=#&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// æ”¹</span></span><br><span class="line">  	<span class="meta">@Update</span>(<span class="string">"update user set username=#&#123;username&#125;,sex=#&#123;sex&#125;,birthday=#&#123;birthday&#125;,address=#&#123;address&#125; where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// æŸ¥</span></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@Select</span>(<span class="string">"select * from user  where id=#&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// æ–¹æ³•ä¸€ï¼šè¿™é‡Œ#&#123;username&#125;æ²¡æœ‰%ï¼ŒæŸ¥è¯¢æ—¶è¦ä¼ å…¥å¦‚â€œ%ç‹%â€</span></span><br><span class="line">  	<span class="meta">@Select</span>(<span class="string">"select * from user where username like #&#123;username&#125; "</span>)</span><br><span class="line">  	<span class="comment">// æ–¹æ³•äºŒï¼š$&#123;&#125;ä¸­å›ºå®šå†™valueï¼Œä¼ å‚æ—¶ä¸ç”¨å†™%</span></span><br><span class="line">  	<span class="meta">@Select</span>(<span class="string">"select * from user where username like '%$&#123;value&#125;%' "</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findUserByName</span><span class="params">(String username)</span></span>;</span><br><span class="line">  	<span class="comment">// åŒºåˆ«å’Œä¹‹å‰ä¸€æ ·ï¼Œä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä¸€ä¸ªæ˜¯å‚æ•°å ä½ç¬¦</span></span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@Select</span>(<span class="string">"select count(*) from user "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findTotalUser</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationCRUDTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    <span class="keyword">private</span> IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å­—èŠ‚è¾“å…¥æµ</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">"SqlMapConfig.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.æ ¹æ®å­—èŠ‚è¾“å…¥æµæ„å»ºSqlSessionFactory</span></span><br><span class="line">        factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">// 3.æ ¹æ®SqlSessionFactoryç”Ÿäº§ä¸€ä¸ªSqlSession</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">// 4.ä½¿ç”¨SqlSessionè·å–Daoçš„ä»£ç†å¯¹è±¡</span></span><br><span class="line">        userDao = session.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span><span class="keyword">throws</span>  Exception</span>&#123;</span><br><span class="line">        <span class="comment">// æäº¤</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSave</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">"mybatis annotation"</span>);</span><br><span class="line">        user.setAddress(<span class="string">"åŒ—äº¬å¸‚æ˜Œå¹³åŒº"</span>);</span><br><span class="line"></span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®ä½“ç±»å±æ€§å’Œæ•°æ®åº“ä¸å¯¹åº”é—®é¢˜"><a href="#å®ä½“ç±»å±æ€§å’Œæ•°æ®åº“ä¸å¯¹åº”é—®é¢˜" class="headerlink" title="å®ä½“ç±»å±æ€§å’Œæ•°æ®åº“ä¸å¯¹åº”é—®é¢˜"></a>å®ä½“ç±»å±æ€§å’Œæ•°æ®åº“ä¸å¯¹åº”é—®é¢˜</h2><p>å®ä½“ç±»ä¸­åç§°å’Œè¡¨ä¸­å¯¹ä¸ä¸Šæ—¶ï¼ˆuserName &amp; usernameï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String userAddress;</span><br><span class="line">    <span class="keyword">private</span> String userSex;</span><br><span class="line">    <span class="keyword">private</span> Date userBirthday;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨åˆ«åï¼Œä½†æ˜¯æ‰€æœ‰ä½ç½®éƒ½è¦ä½¿ç”¨åˆ«åï¼Œæ¯”è¾ƒéº»çƒ¦</p>
<p>å¯ä»¥ä½¿ç”¨@Resultsæ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line">    <span class="meta">@Results</span>(id=<span class="string">"userMap"</span>,value=&#123;</span><br><span class="line">            <span class="meta">@Result</span>(id=<span class="keyword">true</span>,column = <span class="string">"id"</span>,property = <span class="string">"userId"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(column = <span class="string">"username"</span>,property = <span class="string">"userName"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(column = <span class="string">"address"</span>,property = <span class="string">"userAddress"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(column = <span class="string">"sex"</span>,property = <span class="string">"userSex"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(column = <span class="string">"birthday"</span>,property = <span class="string">"userBirthday"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@Select</span>(<span class="string">"select * from user  where id=#&#123;id&#125; "</span>)</span><br><span class="line">    <span class="meta">@ResultMap</span>(<span class="string">"userMap"</span>)</span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸»é”®ï¼šid=true</p>
<p>å…¶å®ƒä½ç½®ç”¨@ResultMapå¼•ç”¨</p>
<p>æ ‡å‡†å†™æ³•@ResultMap(value={â€œuserMapâ€})</p>
<p>ç”±äºåªæœ‰ä¸€ä¸ªå±æ€§ï¼Œvalueå¯ä»¥çœç•¥ï¼›æ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œ{}å¯ä»¥çœç•¥</p>
<p>äºæ˜¯å¯ä»¥ç›´æ¥å†™@ResultMap(â€œuserMapâ€)</p>
<h1 id="å¤šè¡¨æŸ¥è¯¢"><a href="#å¤šè¡¨æŸ¥è¯¢" class="headerlink" title="å¤šè¡¨æŸ¥è¯¢"></a>å¤šè¡¨æŸ¥è¯¢</h1><h2 id="å®ä½“ç±»å’Œæ¥å£"><a href="#å®ä½“ç±»å’Œæ¥å£" class="headerlink" title="å®ä½“ç±»å’Œæ¥å£"></a>å®ä½“ç±»å’Œæ¥å£</h2><p>å†å»ºä¸€ä¸ªè´¦æˆ·</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">//å¤šå¯¹ä¸€ï¼ˆmybatisä¸­ç§°ä¸ºä¸€å¯¹ä¸€ï¼‰çš„æ˜ å°„ï¼šä¸€ä¸ªè´¦æˆ·åªèƒ½å±äºä¸€ä¸ªç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ç”¨æˆ·å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String userAddress;</span><br><span class="line">    <span class="keyword">private</span> String userSex;</span><br><span class="line">    <span class="keyword">private</span> Date userBirthday;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸€å¯¹å¤šå…³ç³»æ˜ å°„ï¼šä¸€ä¸ªç”¨æˆ·å¯¹åº”å¤šä¸ªè´¦æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Account&gt; accounts;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸€å¯¹ä¸€æŸ¥è¯¢"><a href="#ä¸€å¯¹ä¸€æŸ¥è¯¢" class="headerlink" title="ä¸€å¯¹ä¸€æŸ¥è¯¢"></a>ä¸€å¯¹ä¸€æŸ¥è¯¢</h2><p>æŸ¥è´¦æˆ·ä»¥åŠæ‰€å±çš„ç”¨æˆ·</p>
<p>IAccountDaoä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> 	<span class="meta">@Select</span>(<span class="string">"select * from account"</span>)</span><br><span class="line">	<span class="meta">@Results</span>(id=<span class="string">"accountMap"</span>,value = &#123;</span><br><span class="line">  <span class="meta">@Result</span>(id=<span class="keyword">true</span>,column = <span class="string">"id"</span>,property = <span class="string">"id"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(column = <span class="string">"uid"</span>,property = <span class="string">"uid"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(column = <span class="string">"money"</span>,property = <span class="string">"money"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(property = <span class="string">"user"</span>,column = <span class="string">"uid"</span>,one=<span class="meta">@One</span>(select=<span class="string">"com.itheima.dao.IUserDao.findById"</span>,fetchType= FetchType.EAGER))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function">List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¸ä½¿ç”¨left outer joinï¼Œä½¿ç”¨@One</p>
<p>selectè¦æ‰¾åˆ°èƒ½å®ç°åŠŸèƒ½çš„æ–¹æ³•ï¼Œå³IUserDaoä¸­findByIdï¼Œæ¥æŸ¥è¯¢è´¦æˆ·æ‰€å±çš„ç”¨æˆ·</p>
<p>FetchTypeå¯ä»¥é…ç½®å»¶è¿ŸåŠ è½½ï¼ˆLAZYï¼‰ï¼Œæˆ–ç«‹å³åŠ è½½ï¼ˆEAGERï¼‰</p>
<p>å®é™…å¼€å‘æ—¶å¯¹ä¸€ä¸€èˆ¬é€‰æ‹©ç«‹å³åŠ è½½ï¼Œå¯¹å¤šä¸€èˆ¬é€‰æ‹©å»¶è¿ŸåŠ è½½</p>
<h2 id="ä¸€å¯¹å¤šæŸ¥è¯¢"><a href="#ä¸€å¯¹å¤šæŸ¥è¯¢" class="headerlink" title="ä¸€å¯¹å¤šæŸ¥è¯¢"></a>ä¸€å¯¹å¤šæŸ¥è¯¢</h2><p>æŸ¥ä¸€ä¸ªç”¨æˆ·ï¼Œå’Œè¯¥ç”¨æˆ·å¯¹åº”çš„å¤šä¸ªè´¦æˆ·</p>
<p>IUserDaoä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line"><span class="meta">@Results</span>(id=<span class="string">"userMap"</span>,value=&#123;</span><br><span class="line">  <span class="meta">@Result</span>(id=<span class="keyword">true</span>,column = <span class="string">"id"</span>,property = <span class="string">"userId"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(column = <span class="string">"username"</span>,property = <span class="string">"userName"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(column = <span class="string">"address"</span>,property = <span class="string">"userAddress"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(column = <span class="string">"sex"</span>,property = <span class="string">"userSex"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(column = <span class="string">"birthday"</span>,property = <span class="string">"userBirthday"</span>),</span><br><span class="line">  <span class="meta">@Result</span>(property = <span class="string">"accounts"</span>,column = <span class="string">"id"</span>,</span><br><span class="line">          many = <span class="meta">@Many</span>(select = <span class="string">"com.itheima.dao.IAccountDao.findAccountByUid"</span>,</span><br><span class="line">                       fetchType = FetchType.LAZY))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>ç”¨@Many</p>
<p>IAccountDaoä¸­åŠ ä¸€ä¸ªæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from account where uid = #&#123;userId&#125;"</span>)</span><br><span class="line"><span class="function">List&lt;Account&gt; <span class="title">findAccountByUid</span><span class="params">(Integer userId)</span></span>;</span><br></pre></td></tr></table></figure>

<h1 id="ç¼“å­˜é…ç½®"><a href="#ç¼“å­˜é…ç½®" class="headerlink" title="ç¼“å­˜é…ç½®"></a>ç¼“å­˜é…ç½®</h1><p>ä¸ç®¡ç”¨xmlè¿˜æ˜¯æ³¨è§£ï¼Œä¸€çº§ç¼“å­˜é»˜è®¤éƒ½æ˜¯å¼€çš„</p>
<p>æ‰“å¼€äºŒçº§æ³¨è§£ï¼Œå…¨å±€é…ç½®é»˜è®¤ä¹Ÿæ˜¯æ‰“å¼€</p>
<p>å¯¹äºå•ä¸ªç±»ï¼Œä½¿ç”¨@CacheNamespaceï¼ˆé»˜è®¤æ˜¯falseï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@CacheNamespace</span>(blocking = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å³å¯å¼€å¯äºŒçº§ç¼“å­˜</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°08 å»¶è¿ŸåŠ è½½ä¸ç¼“å­˜</title>
    <url>/2020/04/02/note-mybatis-08/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/BV1Db411s7F5" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Db411s7F5</a></p>
<p>P60~67</p>
</blockquote>
<h1 id="å»¶è¿ŸåŠ è½½"><a href="#å»¶è¿ŸåŠ è½½" class="headerlink" title="å»¶è¿ŸåŠ è½½"></a>å»¶è¿ŸåŠ è½½</h1><p>å»¶è¿ŸåŠ è½½ï¼šåœ¨çœŸæ­£ä½¿ç”¨æ•°æ®æ—¶æ‰å‘èµ·æŸ¥è¯¢ï¼Œä¸ç”¨çš„æ—¶å€™ä¸æŸ¥è¯¢ï¼ŒæŒ‰éœ€åŠ è½½ï¼ˆæ‡’åŠ è½½ï¼‰</p>
<p>ç«‹å³åŠ è½½ï¼šä¸ç®¡ç”¨ä¸ç”¨ï¼Œåªè¦ä¸€è°ƒç”¨æ–¹æ³•ï¼Œé©¬ä¸Šå‘èµ·æŸ¥è¯¢</p>
<p>ä¸€èˆ¬ä¸€å¯¹å¤šã€å¤šå¯¹å¤šé‡‡ç”¨å»¶è¿ŸåŠ è½½ï¼›å¤šå¯¹ä¸€ã€ä¸€å¯¹ä¸€é‡‡ç”¨ç«‹å³åŠ è½½</p>
<p>æŸ¥å®˜ç½‘æ–‡æ¡£</p>
<p>æ‰¾åˆ°å»¶è¿ŸåŠ è½½çš„å…¨å±€å¼€å…³</p>
<p>åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®å‚æ•°--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å¼€å¯Mybatisæ”¯æŒå»¶è¿ŸåŠ è½½--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>&gt;</span><span class="tag">&lt;/<span class="name">setting</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸€å¯¹ä¸€å®ç°å»¶è¿ŸåŠ è½½"><a href="#ä¸€å¯¹ä¸€å®ç°å»¶è¿ŸåŠ è½½" class="headerlink" title="ä¸€å¯¹ä¸€å®ç°å»¶è¿ŸåŠ è½½"></a>ä¸€å¯¹ä¸€å®ç°å»¶è¿ŸåŠ è½½</h2><p>ä»ç„¶æ˜¯IAccountDaoçš„findAllæ–¹æ³•</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰å°è£…accountå’Œuserçš„resultMap --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"accountUserMap"</span> <span class="attr">type</span>=<span class="string">"account"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"uid"</span> <span class="attr">column</span>=<span class="string">"uid"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"money"</span> <span class="attr">column</span>=<span class="string">"money"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä¸€å¯¹ä¸€çš„å…³ç³»æ˜ å°„ï¼šé…ç½®å°è£…userçš„å†…å®¹</span></span><br><span class="line"><span class="comment">        selectå±æ€§æŒ‡å®šçš„å†…å®¹ï¼šæŸ¥è¯¢ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼š</span></span><br><span class="line"><span class="comment">        columnå±æ€§æŒ‡å®šçš„å†…å®¹ï¼šç”¨æˆ·æ ¹æ®idæŸ¥è¯¢æ—¶ï¼Œæ‰€éœ€è¦çš„å‚æ•°çš„å€¼</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"user"</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">javaType</span>=<span class="string">"user"</span> <span class="attr">select</span>=<span class="string">"com.itheima.dao.IUserDao.findById"</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"accountUserMap"</span>&gt;</span></span><br><span class="line">  select * from account</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>IUserDao.xmlä¸­éœ€è¦é…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ ¹æ®idæŸ¥è¯¢ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findById"</span> <span class="attr">parameterType</span>=<span class="string">"INT"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  select * from user where id = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•æ—¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">  List&lt;Account&gt; accounts = accountDao.findAll();</span><br><span class="line">  <span class="comment">//        for(Account account : accounts)&#123;</span></span><br><span class="line">  <span class="comment">//            System.out.println("--------æ¯ä¸ªaccountçš„ä¿¡æ¯------------");</span></span><br><span class="line">  <span class="comment">//            System.out.println(account);</span></span><br><span class="line">  <span class="comment">//            System.out.println(account.getUser());</span></span><br><span class="line">  <span class="comment">//        &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æŠŠæ‰“å°ç”¨æˆ·ä¿¡æ¯æ³¨é‡Šæ‰ï¼Œè°ƒç”¨åªfindAll()æ—¶ä¸ä¼šåŠ è½½æ¯ä¸ªç”¨æˆ·ä¿¡æ¯</p>
<p>åªæœ‰å®é™…ç”¨åˆ°Userçš„æ—¶å€™æ‰ä¼šæ‰§è¡ŒæŸ¥è¯¢ç”¨æˆ·çš„æ“ä½œ</p>
<h2 id="ä¸€å¯¹å¤šå®ç°å»¶è¿ŸåŠ è½½"><a href="#ä¸€å¯¹å¤šå®ç°å»¶è¿ŸåŠ è½½" class="headerlink" title="ä¸€å¯¹å¤šå®ç°å»¶è¿ŸåŠ è½½"></a>ä¸€å¯¹å¤šå®ç°å»¶è¿ŸåŠ è½½</h2><p>IUserDao.xmlä¸­</p>
<p>ä¸å†ä½¿ç”¨left outer join</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰Userçš„resultMap--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"userAccountMap"</span> <span class="attr">type</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"address"</span> <span class="attr">column</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"sex"</span> <span class="attr">column</span>=<span class="string">"sex"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"birthday"</span> <span class="attr">column</span>=<span class="string">"birthday"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®userå¯¹è±¡ä¸­accountsé›†åˆçš„æ˜ å°„ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"accounts"</span> <span class="attr">ofType</span>=<span class="string">"account"</span> <span class="attr">select</span>=<span class="string">"com.itheima.dao.IAccountDao.findAccountByUid"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"userAccountMap"</span>&gt;</span></span><br><span class="line">  select * from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>IAccountDao.xmlä¸­éœ€è¦</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢è´¦æˆ·åˆ—è¡¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAccountByUid"</span> <span class="attr">resultType</span>=<span class="string">"account"</span>&gt;</span></span><br><span class="line">  select * from account where uid = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šéƒ½æ˜¯åœ¨è¦ç”¨çš„æ—¶å€™æ‰å»è°ƒå¦ä¸€ä¸ªç±»ä¸­å…·ä½“çš„æŸ¥è¯¢æ–¹æ³•</p>
<h1 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h1><p>é€‚ç”¨äºç¼“å­˜çš„æ•°æ®ï¼šç»å¸¸æŸ¥è¯¢ä¸”ä¸å¸¸ä¿®æ”¹ã€æ•°æ®çš„æ­£ç¡®ä¸å¦å¯¹æœ€ç»ˆç»“æœå½±å“ä¸å¤§</p>
<h2 id="MyBatisä¸­çš„ä¸€çº§ç¼“å­˜"><a href="#MyBatisä¸­çš„ä¸€çº§ç¼“å­˜" class="headerlink" title="MyBatisä¸­çš„ä¸€çº§ç¼“å­˜"></a>MyBatisä¸­çš„ä¸€çº§ç¼“å­˜</h2><p>æŒ‡çš„æ˜¯MyBatisä¸­çš„SqlSessionå¯¹è±¡çš„ç¼“å­˜</p>
<p>æ‰§è¡ŒæŸ¥è¯¢åï¼ŒæŸ¥è¯¢ç»“æœä¼šåŒæ—¶å­˜å…¥SqlSessionæä¾›çš„ä¸€å—åŒºåŸŸä¸­ï¼Œæ”¹åŒºåŸŸçš„ç»“æ„æ˜¯ä¸€ä¸ªMap</p>
<p>å†æ¬¡æŸ¥è¯¢åŒæ ·çš„æ•°æ®æ—¶ï¼ŒMyBatisä¼šå…ˆå»SqlSessionä¸­æŸ¥è¯¢æ˜¯å¦æœ‰ç»“æœï¼Œæœ‰çš„è¯ç›´æ¥æ‹¿å‡ºæ¥ç”¨</p>
<p>å½“SqlSessionå¯¹è±¡æ¶ˆå¤±æ—¶ï¼Œä¸€çº§ç¼“å­˜ä¹Ÿæ¶ˆå¤±</p>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFirstLevelCache</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="comment">// æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">  User user1 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">  System.out.println(user1);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å†æ¬¡æŸ¥è¯¢åŒä¸€ç”¨æˆ·</span></span><br><span class="line">  User user2 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">  System.out.println(user2);</span><br><span class="line"></span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å°å‘ç°user1å’Œuser2æ˜¯åŒä¸€ä¸ªï¼Œä¸”æ—¥å¿—ä¿¡æ¯ä¸­åªè®°å½•äº†ä¸€æ¬¡æŸ¥è¯¢</p>
<p>è¯´æ˜user2æ˜¯ç›´æ¥ä»ç¼“å­˜ä¸­å–çš„</p>
<p>å¦‚æœåœ¨ä¸¤æ¬¡æŸ¥è¯¢ä¸­å…³é—­SqlSession</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFirstLevelCache</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="comment">// æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">  User user1 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">  System.out.println(user1);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å…³é—­å¹¶é‡æ–°è·å–Session</span></span><br><span class="line">  sqlSession.close();</span><br><span class="line">  sqlSession = factory.openSession();</span><br><span class="line">  userDao = sqlSession.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å†æ¬¡æŸ¥è¯¢åŒä¸€ç”¨æˆ·</span></span><br><span class="line">  User user2 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">  System.out.println(user2);</span><br><span class="line"></span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ¬¡ä¸¤ä¸ªå¯¹è±¡ä¸åŒäº†</p>
<p>sqlSession.clearCache() å¯ä»¥æ¸…ç¼“å­˜ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹Ÿä¸åŒ</p>
<h2 id="è§¦å‘æ¸…ç©ºä¸€çº§ç¼“å­˜çš„æƒ…å†µ"><a href="#è§¦å‘æ¸…ç©ºä¸€çº§ç¼“å­˜çš„æƒ…å†µ" class="headerlink" title="è§¦å‘æ¸…ç©ºä¸€çº§ç¼“å­˜çš„æƒ…å†µ"></a>è§¦å‘æ¸…ç©ºä¸€çº§ç¼“å­˜çš„æƒ…å†µ</h2><p>è°ƒç”¨SqlSessionçš„ä¿®æ”¹ã€æ·»åŠ ã€åˆ é™¤ã€æäº¤ã€å…³é—­ç­‰æ–¹æ³•æ—¶ï¼Œä¼šæ¸…ç©ºä¸€çº§ç¼“å­˜</p>
<p>å¦‚åœ¨ä¸¤æ¬¡æŸ¥è¯¢ä¸­æ›´æ–°ç”¨æˆ·</p>
<p>é…ç½®æ–‡ä»¶ä¸­åŠ æ›´æ–°æ–¹æ³•</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ›´æ–°ç”¨æˆ·ä¿¡æ¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  update user set username=#&#123;username&#125;,address=#&#123;address&#125; where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•æ—¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testClearlCache</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="comment">// 1.æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">  User user1 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">  System.out.println(user1);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">  user1.setUsername(<span class="string">"update user clear cache"</span>);</span><br><span class="line">  user1.setAddress(<span class="string">"åŒ—äº¬å¸‚æµ·æ·€åŒº"</span>);</span><br><span class="line">  userDao.updateUser(user1);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.å†æ¬¡æŸ¥è¯¢idä¸º41çš„ç”¨æˆ·</span></span><br><span class="line">  User user2 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">  System.out.println(user2);</span><br><span class="line"></span><br><span class="line">  System.out.println(user1 == user2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´æ–°ä¹‹åå†æŸ¥è¯¢ï¼Œä¼šå‘èµ·ä¸€æ¬¡æ–°çš„æŸ¥è¯¢</p>
<h2 id="MyBatisä¸­çš„äºŒçº§ç¼“å­˜"><a href="#MyBatisä¸­çš„äºŒçº§ç¼“å­˜" class="headerlink" title="MyBatisä¸­çš„äºŒçº§ç¼“å­˜"></a>MyBatisä¸­çš„äºŒçº§ç¼“å­˜</h2><p>æŒ‡çš„æ˜¯MyBatisä¸­SqlSessionFactoryå¯¹è±¡çš„ç¼“å­˜ï¼Œç”±åŒä¸€ä¸ªSqlSessionFactoryå¯¹è±¡åˆ›å»ºçš„SqlSessionå…±äº«å…¶ç¼“å­˜</p>
<img src="/images/2020/screencapture2020-04-02PM5.34.35.jpg">

<p>ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ol>
<li><p>è®©MyBatisæ¡†æ¶æ”¯æŒäºŒçº§ç¼“å­˜ï¼ˆåœ¨SqlMapConfig.xmlä¸­é…ç½®ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆä¸é…ä¹Ÿè¡Œï¼Œé»˜è®¤æ˜¯trueï¼‰</p>
</li>
<li><p>è®©å½“å‰çš„æ˜ å°„æ–‡ä»¶æ”¯æŒäºŒçº§ç¼“å­˜ï¼ˆåœ¨IUserDao.xmlä¸­é…ç½®ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¼€å¯useræ”¯æŒäºŒçº§ç¼“å­˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è®©å½“å‰çš„æ“ä½œæ”¯æŒäºŒçº§ç¼“å­˜ï¼ˆåœ¨selectæ ‡ç­¾ä¸­é…ç½®ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- æ ¹æ®idæŸ¥è¯¢ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findById"</span> <span class="attr">parameterType</span>=<span class="string">"INT"</span> <span class="attr">resultType</span>=<span class="string">"user"</span> <span class="attr">useCache</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">  select * from user where id = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">SqlSession sqlSession1 = factory.openSession();</span><br><span class="line">IUserDao dao1 = sqlSession1.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">User user1 = dao1.findById(<span class="number">41</span>);</span><br><span class="line">System.out.println(user1);</span><br><span class="line">sqlSession1.close();</span><br><span class="line"></span><br><span class="line">SqlSession sqlSession2 = factory.openSession();</span><br><span class="line">IUserDao dao2 = sqlSession2.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">User user2 = dao2.findById(<span class="number">41</span>);</span><br><span class="line">System.out.println(user2);</span><br><span class="line">sqlSession2.close();</span><br><span class="line"></span><br><span class="line">System.out.println(user1 == user2);</span><br></pre></td></tr></table></figure>

<p>å‘ç°ç¬¬äºŒæ¬¡å¹¶æ²¡æœ‰æŸ¥è¯¢ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–</p>
<p>ä½†æ˜¯æ‰“å°ç»“æœä¸ºfalse</p>
<p>å› ä¸ºäºŒçº§ç¼“å­˜ä¸­å­˜æ”¾çš„æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹è±¡</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°07 å¤šè¡¨æŸ¥è¯¢</title>
    <url>/2020/03/31/note-mybatis-07/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p48~56</p>
</blockquote>
<p>è¡¨ä¹‹é—´çš„å‡ ç§å…³ç³»ï¼šä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤š</p>
<p>MyBatisæŠŠå¤šå¯¹ä¸€çœ‹æˆä¸€å¯¹ä¸€</p>
<h1 id="ç¤ºä¾‹ï¼šç”¨æˆ·å’Œè´¦æˆ·"><a href="#ç¤ºä¾‹ï¼šç”¨æˆ·å’Œè´¦æˆ·" class="headerlink" title="ç¤ºä¾‹ï¼šç”¨æˆ·å’Œè´¦æˆ·"></a>ç¤ºä¾‹ï¼šç”¨æˆ·å’Œè´¦æˆ·</h1><p>ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè´¦æˆ·</p>
<p>ä¸€ä¸ªè´¦æˆ·åªèƒ½å±äºä¸€ä¸ªç”¨æˆ·</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li><p>ä¸¤å¼ è¡¨ï¼ˆè´¦æˆ·è¡¨ å¤–é”®ï¼‰</p>
</li>
<li><p>ä¸¤ä¸ªå®ä½“ç±»ï¼ˆä½“ç°ä¸€å¯¹å¤šçš„å…³ç³»ï¼‰</p>
</li>
<li><p>ä¸¤ä¸ªé…ç½®æ–‡ä»¶</p>
</li>
<li><p>å®ç°é…ç½®</p>
<p>æŸ¥ç”¨æˆ·çš„æ‰€æœ‰è´¦æˆ·</p>
<p>æŸ¥è´¦æˆ·çš„ç”¨æˆ·ä¿¡æ¯</p>
</li>
</ol>
<h1 id="ä¸¤å¼ è¡¨"><a href="#ä¸¤å¼ è¡¨" class="headerlink" title="ä¸¤å¼ è¡¨"></a>ä¸¤å¼ è¡¨</h1><p>userè¡¨</p>
<table>
<thead>
<tr>
<th>id</th>
<th>username</th>
<th>address</th>
<th>sex</th>
<th>birthday</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>accountè¡¨</p>
<table>
<thead>
<tr>
<th>id</th>
<th>uid</th>
<th>money</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>46</td>
<td>1000</td>
</tr>
<tr>
<td>2</td>
<td>45</td>
<td>1000</td>
</tr>
<tr>
<td>3</td>
<td>46</td>
<td>2000</td>
</tr>
</tbody></table>
<p>å¤–é”®uidï¼Œå¼•ç”¨userè¡¨çš„id</p>
<h1 id="ä¸¤ä¸ªå®ä½“ç±»"><a href="#ä¸¤ä¸ªå®ä½“ç±»" class="headerlink" title="ä¸¤ä¸ªå®ä½“ç±»"></a>ä¸¤ä¸ªå®ä½“ç±»</h1><h2 id="User"><a href="#User" class="headerlink" title="User"></a>User</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸€å¯¹å¤šå…³ç³»æ˜ å°„ï¼šä¸»è¡¨å®ä½“åº”è¯¥åŒ…å«ä»è¡¨å®ä½“çš„é›†åˆå¼•ç”¨</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Account&gt; accounts;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼ŒåŒæ—¶è·å–åˆ°ç”¨æˆ·ä¸‹æ‰€æœ‰è´¦æˆ·çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Account"><a href="#Account" class="headerlink" title="Account"></a>Account</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»è¡¨å®ä½“åº”è¯¥åŒ…å«ä¸€ä¸ªä¸»è¡¨å®ä½“çš„å¯¹è±¡å¼•ç”¨</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">		</span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// æŸ¥è¯¢æ‰€æœ‰è´¦æˆ·ï¼ŒåŒæ—¶è¿˜è¦è·å–åˆ°å½“å‰è´¦æˆ·çš„æ‰€å±ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// æŸ¥è¯¢æ‰€æœ‰è´¦æˆ·ï¼Œå¹¶ä¸”å¸¦æœ‰ç”¨æˆ·åç§°å’Œåœ°å€ä¿¡æ¯</span></span><br><span class="line">    <span class="function">List&lt;AccountUser&gt; <span class="title">findAllAccount</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ä¸€å¯¹ä¸€æŸ¥è¯¢"><a href="#ä¸€å¯¹ä¸€æŸ¥è¯¢" class="headerlink" title="ä¸€å¯¹ä¸€æŸ¥è¯¢"></a>ä¸€å¯¹ä¸€æŸ¥è¯¢</h1><p>æŸ¥è¯¢æ‰€æœ‰è´¦æˆ·ï¼Œå’Œè´¦æˆ·å¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯</p>
<h2 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><p>æ–°å»ºä¸€ä¸ªAccountUserç±»ï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountUser</span> <span class="keyword">extends</span> <span class="title">Account</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>IAccountDao.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllAccount"</span> <span class="attr">resultType</span>=<span class="string">"accountuser"</span>&gt;</span></span><br><span class="line">  select a.*,u.username,u.address from account a , user u where u.id = a.uid;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ç§å†™ä¸€ä¸ªå­ç±»çš„æ–¹å¼å®é™…ç”¨å¾—ä¸å¤š</p>
<h2 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><p>æ›´å¸¸ç”¨ -&gt; Accountä¸­Userå¯¹è±¡å¼•ç”¨</p>
<p>é…ç½®IAccountDao.xmlæ—¶ä½¿ç”¨associationæ ‡ç­¾</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰å°è£…accountå’Œuserçš„resultMap --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"accountUserMap"</span> <span class="attr">type</span>=<span class="string">"account"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"aid"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"uid"</span> <span class="attr">column</span>=<span class="string">"uid"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"money"</span> <span class="attr">column</span>=<span class="string">"money"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä¸€å¯¹ä¸€çš„å…³ç³»æ˜ å°„ï¼šé…ç½®å°è£…userçš„å†…å®¹--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"user"</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">javaType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"address"</span> <span class="attr">property</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"birthday"</span> <span class="attr">property</span>=<span class="string">"birthday"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"accountUserMap"</span>&gt;</span></span><br><span class="line">  select u.*,a.id as aid,a.uid,a.money from account a , user u where u.id = a.uid;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="ä¸€å¯¹å¤šæŸ¥è¯¢"><a href="#ä¸€å¯¹å¤šæŸ¥è¯¢" class="headerlink" title="ä¸€å¯¹å¤šæŸ¥è¯¢"></a>ä¸€å¯¹å¤šæŸ¥è¯¢</h1><p>æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼Œå’Œç”¨æˆ·ä¸‹æ‰€æœ‰è´¦æˆ·çš„ä¿¡æ¯</p>
<p>IUserDao.xmlä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰Userçš„resultMap--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"userAccountMap"</span> <span class="attr">type</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"address"</span> <span class="attr">column</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"sex"</span> <span class="attr">column</span>=<span class="string">"sex"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"birthday"</span> <span class="attr">column</span>=<span class="string">"birthday"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®userå¯¹è±¡ä¸­accountsé›†åˆçš„æ˜ å°„ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"accounts"</span> <span class="attr">ofType</span>=<span class="string">"account"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"aid"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">property</span>=<span class="string">"uid"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"money"</span> <span class="attr">property</span>=<span class="string">"money"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"userAccountMap"</span>&gt;</span></span><br><span class="line">  select * from user u left outer join account a on u.id = a.uid</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸èƒ½å†ç”¨inner joinï¼ˆ,ï¼‰ï¼Œæ”¹æˆleft outer join</p>
<h1 id="å¤šå¯¹å¤šæŸ¥è¯¢ï¼ˆç”¨æˆ·-è§’è‰²ï¼‰"><a href="#å¤šå¯¹å¤šæŸ¥è¯¢ï¼ˆç”¨æˆ·-è§’è‰²ï¼‰" class="headerlink" title="å¤šå¯¹å¤šæŸ¥è¯¢ï¼ˆç”¨æˆ·-è§’è‰²ï¼‰"></a>å¤šå¯¹å¤šæŸ¥è¯¢ï¼ˆç”¨æˆ·-è§’è‰²ï¼‰</h1><p>æ­¥éª¤ï¼š</p>
<ol>
<li><p>ä¸‰å¼ è¡¨ï¼ˆç”¨æˆ·è¡¨ è§’è‰²è¡¨ è¿˜éœ€ä½¿ç”¨ä¸­é—´è¡¨ï¼‰</p>
</li>
<li><p>ä¸¤ä¸ªå®ä½“ç±»ï¼ˆä½“ç°å¤šå¯¹å¤šçš„å…³ç³»ï¼‰</p>
</li>
<li><p>ä¸¤ä¸ªé…ç½®æ–‡ä»¶</p>
</li>
<li><p>å®ç°é…ç½®</p>
<p>æŸ¥è¯¢ç”¨æˆ·&amp;ç”¨æˆ·çš„è§’è‰²ä¿¡æ¯</p>
<p>æŸ¥è¯¢è§’è‰²&amp;è§’è‰²çš„ç”¨æˆ·ä¿¡æ¯</p>
</li>
</ol>
<h1 id="ä¸‰å¼ è¡¨"><a href="#ä¸‰å¼ è¡¨" class="headerlink" title="ä¸‰å¼ è¡¨"></a>ä¸‰å¼ è¡¨</h1><p>ç”¨æˆ·è¡¨</p>
<table>
<thead>
<tr>
<th>id</th>
<th>username</th>
<th>address</th>
<th>sex</th>
<th>birthday</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>è§’è‰²è¡¨</p>
<table>
<thead>
<tr>
<th>id</th>
<th>role_name</th>
<th>role_desc</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>é™¢é•¿</td>
<td>ç®¡ç†æ•´ä¸ªå­¦é™¢</td>
</tr>
<tr>
<td>2</td>
<td>æ€»è£</td>
<td>ç®¡ç†æ•´ä¸ªå…¬å¸</td>
</tr>
<tr>
<td>3</td>
<td>æ ¡é•¿</td>
<td>ç®¡ç†æ•´ä¸ªå­¦æ ¡</td>
</tr>
</tbody></table>
<p>ä¸­é—´è¡¨</p>
<table>
<thead>
<tr>
<th>uid</th>
<th>rid</th>
</tr>
</thead>
<tbody><tr>
<td>41</td>
<td>1</td>
</tr>
<tr>
<td>45</td>
<td>1</td>
</tr>
<tr>
<td>41</td>
<td>2</td>
</tr>
</tbody></table>
<h1 id="ä¸¤ä¸ªå®ä½“ç±»-1"><a href="#ä¸¤ä¸ªå®ä½“ç±»-1" class="headerlink" title="ä¸¤ä¸ªå®ä½“ç±»"></a>ä¸¤ä¸ªå®ä½“ç±»</h1><h2 id="User-1"><a href="#User-1" class="headerlink" title="User"></a>User</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¤šå¯¹å¤šçš„å…³ç³»æ˜ å°„ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥å…·å¤‡å¤šä¸ªè§’è‰²</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Role&gt; roles;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼ŒåŒæ—¶è·å–åˆ°ç”¨æˆ·ä¸‹æ‰€æœ‰è´¦æˆ·çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">		<span class="comment">// æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Role"><a href="#Role" class="headerlink" title="Role"></a>Role</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Role</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer roleId;</span><br><span class="line">    <span class="keyword">private</span> String roleName;</span><br><span class="line">    <span class="keyword">private</span> String roleDesc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¤šå¯¹å¤šçš„å…³ç³»æ˜ å°„ï¼šä¸€ä¸ªè§’è‰²å¯ä»¥èµ‹äºˆå¤šä¸ªç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// get set ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IRoleDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢æ‰€æœ‰è§’è‰²</span></span><br><span class="line">    <span class="function">List&lt;Role&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸¤ä¸ªé…ç½®æ–‡ä»¶"><a href="#ä¸¤ä¸ªé…ç½®æ–‡ä»¶" class="headerlink" title="ä¸¤ä¸ªé…ç½®æ–‡ä»¶"></a>ä¸¤ä¸ªé…ç½®æ–‡ä»¶</h2><h2 id="User-2"><a href="#User-2" class="headerlink" title="User"></a>User</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰Userçš„resultMap--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"userMap"</span> <span class="attr">type</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"address"</span> <span class="attr">column</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"sex"</span> <span class="attr">column</span>=<span class="string">"sex"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"birthday"</span> <span class="attr">column</span>=<span class="string">"birthday"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®è§’è‰²é›†åˆçš„æ˜ å°„ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"roles"</span> <span class="attr">ofType</span>=<span class="string">"role"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"roleId"</span> <span class="attr">column</span>=<span class="string">"rid"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"roleName"</span> <span class="attr">column</span>=<span class="string">"role_name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"roleDesc"</span> <span class="attr">column</span>=<span class="string">"role_desc"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">  select u.*,r.id as rid,r.role_name,r.role_desc from user u</span><br><span class="line">  left outer join user_role ur  on u.id = ur.uid</span><br><span class="line">  left outer join role r on r.id = ur.rid</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æ ¹æ®idæŸ¥è¯¢ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findById"</span> <span class="attr">parameterType</span>=<span class="string">"INT"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  select * from user where id = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Role-1"><a href="#Role-1" class="headerlink" title="Role"></a>Role</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å®šä¹‰roleè¡¨çš„ResultMap--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"roleMap"</span> <span class="attr">type</span>=<span class="string">"role"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"roleId"</span> <span class="attr">column</span>=<span class="string">"rid"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"roleName"</span> <span class="attr">column</span>=<span class="string">"role_name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"roleDesc"</span> <span class="attr">column</span>=<span class="string">"role_desc"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"users"</span> <span class="attr">ofType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"username"</span> <span class="attr">property</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"address"</span> <span class="attr">property</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"birthday"</span> <span class="attr">property</span>=<span class="string">"birthday"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æŸ¥è¯¢æ‰€æœ‰--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"roleMap"</span>&gt;</span></span><br><span class="line">  select u.*,r.id as rid,r.role_name,r.role_desc from role r</span><br><span class="line">  left outer join user_role ur  on r.id = ur.rid</span><br><span class="line">  left outer join user u on u.id = ur.uid</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é•¿è¯­å¥æ¢è¡Œçš„æ—¶å€™æ³¨æ„åŠ ç©ºæ ¼ï¼Œé˜²æ­¢r leftå˜æˆrleft</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°06 åŠ¨æ€sqlè¯­å¥</title>
    <url>/2020/03/30/note-mybatis-06/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p45~47</p>
</blockquote>
<h1 id="ifæ ‡ç­¾"><a href="#ifæ ‡ç­¾" class="headerlink" title="ifæ ‡ç­¾"></a>ifæ ‡ç­¾</h1><p>æ ¹æ®ä¼ å…¥å‚æ•°æ¡ä»¶æŸ¥è¯¢</p>
<p>æ¡ä»¶å¯èƒ½æ˜¯ç”¨æˆ·åã€æ€§åˆ«ã€åœ°å€ï¼Œæˆ–è€…éƒ½æœ‰ã€éƒ½æ²¡æœ‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// IUserDao.java</span></span><br><span class="line"></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">findUserByCondition</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure>

<p>ä¸è¦ç”¨andï¼Œä¸èƒ½ç”¨&amp;&amp;</p>
<p>sqlè¯­å¥ä¸Šçš„å†…å®¹æ— å…³å¤§å°å†™</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserByCondition"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span> <span class="attr">parameterType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  select * from user where 1=1</span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"userName != null"</span>&gt;</span></span><br><span class="line">    and username = #&#123;userName&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"userSex != null"</span>&gt;</span></span><br><span class="line">    and sex = #&#123;userSex&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByCondition</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User u = <span class="keyword">new</span> User();</span><br><span class="line">  u.setUserName(<span class="string">"è€ç‹"</span>);</span><br><span class="line">  u.setUserSex(<span class="string">"å¥³"</span>);</span><br><span class="line"></span><br><span class="line">  List&lt;User&gt; users = userDao.findUserByCondition(u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸å†™ where 1=1 ï¼Ÿ</p>
<p>æ”¹è¿› -&gt; whereæ ‡ç­¾</p>
<h1 id="whereæ ‡ç­¾"><a href="#whereæ ‡ç­¾" class="headerlink" title="whereæ ‡ç­¾"></a>whereæ ‡ç­¾</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserByCondition"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span> <span class="attr">parameterType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  select * from user</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"userName != null"</span>&gt;</span></span><br><span class="line">      and username = #&#123;userName&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"userSex != null"</span>&gt;</span></span><br><span class="line">      and sex = #&#123;userSex&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="foreachæ ‡ç­¾"><a href="#foreachæ ‡ç­¾" class="headerlink" title="foreachæ ‡ç­¾"></a>foreachæ ‡ç­¾</h1><p>æ ¹æ®queryvoä¸­çš„Idé›†åˆå®ç°æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</p>
<p><strong>QueryVo.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; ids;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get set ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>IUserDao.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">List&lt;User&gt; <span class="title">findUserInIds</span><span class="params">(QueryVo vo)</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>IUserDao.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserInIds"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span> <span class="attr">parameterType</span>=<span class="string">"queryvo"</span>&gt;</span></span><br><span class="line">  select * from user</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"ids != null and ids.size()&gt;0"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"ids"</span> <span class="attr">open</span>=<span class="string">"and id in ("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">item</span>=<span class="string">"uid"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">        #&#123;uid&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>#{uid}æ˜¯ç”±ä¸Šé¢item=â€uidâ€å†³å®šçš„</p>
<p><strong>æµ‹è¯•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindInIds</span><span class="params">()</span></span>&#123;</span><br><span class="line">  QueryVo vo = <span class="keyword">new</span> QueryVo();</span><br><span class="line">  List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">  list.add(<span class="number">41</span>);</span><br><span class="line">  list.add(<span class="number">42</span>);</span><br><span class="line">  list.add(<span class="number">46</span>);</span><br><span class="line">  vo.setIds(list);</span><br><span class="line"></span><br><span class="line">  List&lt;User&gt; users = userDao.findUserInIds(vo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="sqlæ ‡ç­¾"><a href="#sqlæ ‡ç­¾" class="headerlink" title="sqlæ ‡ç­¾"></a>sqlæ ‡ç­¾</h1><p>æŠ½å–é‡å¤çš„sqlè¯­å¥</p>
<p>ï¼ˆæœ¬æ¥å†™ä¸å†™;éƒ½å¯ä»¥ï¼Œä½†æ˜¯æŠ½å–sqlè¯­å¥æ—¶ï¼Œä¸ºäº†é˜²æ­¢åç»­çš„æ‹¼æ¥å‡ºé—®é¢˜ï¼Œæœ€å¥½ä¸è¦å†™;ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"defaultUser"</span>&gt;</span></span><br><span class="line">  select * from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥æŠŠ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">  select * from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ”¹æˆ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"defaultUser"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°05 è¿æ¥æ± </title>
    <url>/2020/03/30/note-mybatis-05/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p39~43</p>
</blockquote>
<h1 id="è¿æ¥æ± "><a href="#è¿æ¥æ± " class="headerlink" title="è¿æ¥æ± "></a>è¿æ¥æ± </h1><p>æ˜¯ä¸€ä¸ªå­˜å‚¨è¿æ¥çš„å®¹å™¨</p>
<p>ç”¨äºé™ä½è·å–è¿æ¥çš„å¼€é”€</p>
<p>å¿…é¡»çº¿ç¨‹å®‰å…¨</p>
<p>å…ˆè¿›å…ˆå‡º</p>
<h1 id="MyBatisä¸­çš„è¿æ¥æ± "><a href="#MyBatisä¸­çš„è¿æ¥æ± " class="headerlink" title="MyBatisä¸­çš„è¿æ¥æ± "></a>MyBatisä¸­çš„è¿æ¥æ± </h1><p>MyBatisè¿æ¥æ± æä¾›3ç§æ–¹å¼çš„é…ç½®</p>
<p>é…ç½®çš„ä½ç½®ï¼šä¸»é…ç½®æ–‡ä»¶SqlMapConfig.xmlä¸­dataSourceæ ‡ç­¾ï¼Œtypeå±æ€§è¡¨ç¤ºé‡‡ç”¨ä½•ç§è¿æ¥æ± </p>
<p>typeå±æ€§çš„å–å€¼ï¼š</p>
<ul>
<li><p>POOLED - é‡‡ç”¨ä¼ ç»Ÿçš„javax.sql.DataSourceè§„èŒƒä¸­çš„è¿æ¥æ± </p>
</li>
<li><p>UNPOOLED - é‡‡ç”¨ä¼ ç»Ÿçš„è·å–è¿æ¥çš„æ–¹å¼ï¼Œè™½ç„¶ä¹Ÿå®ç°äº†javax.sql.DataSourceæ¥å£ï¼Œä½†æ²¡æœ‰ä½¿ç”¨æ± çš„æ€æƒ³ï¼ˆæ²¡æœ‰å®¹å™¨ï¼Œæ¯æ¬¡ç”¨éƒ½é‡æ–°è·å–ä¸€ä¸ªè¿æ¥ï¼‰</p>
</li>
<li><p>JNDI - é‡‡ç”¨æœåŠ¡å™¨æä¾›çš„JNDIæŠ€æœ¯å®ç°ï¼Œæ¥è·å–DataSourceå¯¹è±¡ï¼Œä¸åŒçš„æœåŠ¡å™¨èƒ½æ‹¿åˆ°çš„DataSourceä¸åŒï¼ˆå¦‚æœä¸æ˜¯webæˆ–mavençš„warå·¥ç¨‹ï¼Œä¸èƒ½ä½¿ç”¨ï¼‰</p>
<p>tomcatæœåŠ¡å™¨é‡‡ç”¨dbcpè¿æ¥æ± </p>
</li>
</ul>
<h2 id="POOLEDå’ŒUNPOOLEDå¯¹æ¯”"><a href="#POOLEDå’ŒUNPOOLEDå¯¹æ¯”" class="headerlink" title="POOLEDå’ŒUNPOOLEDå¯¹æ¯”"></a>POOLEDå’ŒUNPOOLEDå¯¹æ¯”</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®è¿æ¥æ± --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-30AM10.00.05.jpg">

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®è¿æ¥æ± --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"UNPOOLED"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-30AM10.00.10.jpg">

<h2 id="UNPOOLEDæºç åˆ†æ"><a href="#UNPOOLEDæºç åˆ†æ" class="headerlink" title="UNPOOLEDæºç åˆ†æ"></a>UNPOOLEDæºç åˆ†æ</h2><p>Command + O æœç´¢ PooledDataSource å’Œ UnpooledDataSourceï¼Œå¯ä»¥å‘ç°éƒ½å®ç°äº†DataSourceæ¥å£</p>
<img src="/images/2020/screencapture2020-03-30AM10.11.24.jpg">

<p>è€Œè¿™ä¸ªDataSourceå®ç°javax.sqlï¼Œå³ä¸ºjdbcè§„èŒƒä¸­çš„è¿æ¥æ± å®šä¹‰</p>
<p>å…¶ä¸­ä¸€å®šä¼šæœ‰getConnection()</p>
<img src="/images/2020/screencapture2020-03-30AM10.14.24.jpg">

<p>æ‰¾ä¸€ä¸‹UnpooledDataSourceä¸­çš„getConnection()</p>
<img src="/images/2020/screencapture2020-03-30AM10.17.28.jpg">

<p>è°ƒäº†doGetConnection()</p>
<img src="/images/2020/screencapture2020-03-30AM10.18.42.jpg">

<p>æœ€åè·å–è¿æ¥çš„è¯­å¥å°±æ˜¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Connection connection = DriverManager.getConnection(url, properties);</span><br></pre></td></tr></table></figure>

<p>è€ŒinitializeDriver()ä¸­å°±æ˜¯åå°„æ³¨å†Œé©±åŠ¨</p>
<img src="/images/2020/screencapture2020-03-30AM10.20.30.jpg">

<p>æ‰€ä»¥ï¼ŒUNPOOLEDä½¿ç”¨æ—¶ï¼Œä¼šæ³¨å†Œé©±åŠ¨ã€è·å–è¿æ¥ã€è¿”å›è¿æ¥</p>
<h2 id="POOLEDæºç åˆ†æ"><a href="#POOLEDæºç åˆ†æ" class="headerlink" title="POOLEDæºç åˆ†æ"></a>POOLEDæºç åˆ†æ</h2><p>ä¹Ÿæ‰¾åˆ°getConnection()</p>
<img src="/images/2020/screencapture2020-03-30AM10.22.59.jpg">

<p>è°ƒäº†popConnection()</p>
<img src="/images/2020/screencapture2020-03-30AM10.26.37.jpg">

<p>å¦‚æœæ²¡æœ‰è¿æ¥ï¼Œåœ¨synchronizedå—ä¸­è¿›è¡Œåç»­æ“ä½œ</p>
<p>é”çš„æ˜¯è¿™ä¸ªstate</p>
<img src="/images/2020/screencapture2020-03-30AM10.27.15.jpg">

<p>ç»§ç»­ï¼Œå¦‚æœidleConnectionséç©º</p>
<img src="/images/2020/screencapture2020-03-30AM10.30.59.jpg">

<p>è€ŒidleConnectionså°±æ˜¯ä¸€ä¸ªArrayList</p>
<img src="/images/2020/screencapture2020-03-30AM10.32.21.jpg">

<p>å³ï¼Œå½“å®ƒéç©ºï¼Œå–å‡ºç¬¬ä¸€ä¸ª</p>
<p>å¦‚æœä¸ºç©ºï¼Œè¿æ¥æ•°é‡å°äºæœ€å¤§å€¼ï¼Œåˆ›å»ºè¿æ¥</p>
<img src="/images/2020/screencapture2020-03-30AM10.34.52.jpg">

<p>å¦‚æœå·²ç»åˆ°æœ€å¤§å€¼äº†ï¼Œå–å‡ºä¸€ä¸ªæœ€è€çš„è¿æ¥ï¼Œå°è¯•å¤„ç†ä¹‹åç»§ç»­ç”¨</p>
<p>æ€»çš„æµç¨‹ï¼š</p>
<img src="/images/2020/screencapture2020-03-30AM10.40.26.jpg">

<p>POOLEDæ˜¯MyBatisè‡ªå·±å®ç°çš„ä¸€å¥—è¿æ¥æ± ï¼Œæ ¹æ®javax.sql.DataSourceè§„èŒƒ</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°04 é…ç½®æ–‡ä»¶</title>
    <url>/2020/03/27/note-mybatis-04/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p37~38</p>
</blockquote>
<h1 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h1><p>å¯ä»¥åœ¨æ ‡ç­¾å†…éƒ¨é…ç½®è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å±æ€§å¼•ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶ä¿¡æ¯</p>
<h2 id="å†…éƒ¨é…ç½®"><a href="#å†…éƒ¨é…ç½®" class="headerlink" title="å†…éƒ¨é…ç½®"></a>å†…éƒ¨é…ç½®</h2><p>ç›´æ¥å†™åœ¨ä¸»é…ç½®æ–‡ä»¶ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/eesy_mybatis"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"1234"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å¤–éƒ¨æ–‡ä»¶"><a href="#å¤–éƒ¨æ–‡ä»¶" class="headerlink" title="å¤–éƒ¨æ–‡ä»¶"></a>å¤–éƒ¨æ–‡ä»¶</h2><p>å¼•ç”¨å¤–éƒ¨æ–‡ä»¶</p>
<p>classpath ä¸‹å®šä¹‰ db.properties æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jdbc.driver&#x3D;com.mysql.jdbc.Driver</span><br><span class="line">jdbc.url&#x3D;jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;eesy</span><br><span class="line">jdbc.username&#x3D;root</span><br><span class="line">jdbc.password&#x3D;1234</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚æŒ‰urlçš„å†™æ³•å†™åœ°å€</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">url</span>=<span class="string">"file:///D:/IdeaProjects/day02_eesy_01mybatisCRUD/src/main/resources/jdbcConfig.properties"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="ä½¿ç”¨typeAliasesé…ç½®ç±»å‹åˆ«å"><a href="#ä½¿ç”¨typeAliasesé…ç½®ç±»å‹åˆ«å" class="headerlink" title="ä½¿ç”¨typeAliasesé…ç½®ç±»å‹åˆ«å"></a>ä½¿ç”¨typeAliasesé…ç½®ç±»å‹åˆ«å</h1><p>åªèƒ½é…ç½®domainä¸­ç±»çš„åˆ«å</p>
<p>typeï¼šæŒ‡å®šçš„æ˜¯å®ä½“ç±»å…¨é™å®šç±»å</p>
<p>aliasï¼šå±æ€§æŒ‡å®šåˆ«å</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- å•ä¸ªåˆ«åå®šä¹‰ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.itheima.domain.User"</span> <span class="attr">alias</span>=<span class="string">"user"</span>&gt;</span><span class="tag">&lt;/<span class="name">typeAlias</span>&gt;</span>--&gt;</span><br><span class="line">  <span class="comment">&lt;!-- ç”¨äºæŒ‡å®šè¦é…ç½®åˆ«åçš„åŒ…ï¼Œå½“æŒ‡å®šä¹‹åï¼Œè¯¥åŒ…ä¸‹çš„å®ä½“ç±»éƒ½ä¼šæ³¨å†Œåˆ«åï¼Œå¹¶ä¸”ç±»åå°±æ˜¯åˆ«åï¼Œä¸å†åŒºåˆ†å¤§å°å†™--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.itheima.domain"</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æŒ‡å®šäº†åˆ«åå°±ä¸å†åŒºåˆ†å¤§å°å†™ï¼Œuserã€USERã€uSeRéƒ½å¯ä»¥</p>
<h1 id="mappers"><a href="#mappers" class="headerlink" title="mappers"></a>mappers</h1><p>resourceç”¨äºæŒ‡å®šç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºä½ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/itheima/dao/IUserDao.xml"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>classæŒ‡å®šæ¥å£ç±»è·¯å¾„</p>
<p>è¦æ±‚ mapper æ¥å£åç§°å’Œ mapper æ˜ å°„æ–‡ä»¶åç§°ç›¸åŒï¼Œä¸”æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.itheima.dao.UserDao"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ›´ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨package</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--&lt;mapper resource="com/itheima/dao/IUserDao.xml"&gt;&lt;/mapper&gt;--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- packageæ ‡ç­¾æ˜¯ç”¨äºæŒ‡å®šdaoæ¥å£æ‰€åœ¨çš„åŒ…,å½“æŒ‡å®šäº†ä¹‹åå°±ä¸éœ€è¦å†å†™mapperä»¥åŠresourceæˆ–è€…classäº† --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.itheima.dao"</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°03 å‚æ•°ä¸ç»“æœå°è£…</title>
    <url>/2020/03/27/note-mybatis-03/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p28ï½29</p>
</blockquote>
<h1 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h1><p>è¾“å…¥ç±»å‹å¯ä»¥æ˜¯ï¼š</p>
<ul>
<li><p>ç®€å•ç±»å‹</p>
</li>
<li><p>pojoå¯¹è±¡</p>
<p>ä½¿ç”¨OGNLè¡¨è¾¾å¼è§£æå¯¹è±¡å­—æ®µçš„å€¼ï¼Œ#{}æˆ–${}æ‹¬å·ä¸­çš„å€¼ä¸ºpojoå±æ€§åç§°</p>
</li>
<li><p>pojoåŒ…è£…å¯¹è±¡</p>
<p>æŠŠå®ä½“ç±»åŒ…è£…èµ·æ¥ï¼Œè¿›è¡Œæ¡ä»¶æŸ¥è¯¢</p>
</li>
</ul>
<h2 id="OGNLè¡¨è¾¾å¼"><a href="#OGNLè¡¨è¾¾å¼" class="headerlink" title="OGNLè¡¨è¾¾å¼"></a>OGNLè¡¨è¾¾å¼</h2><p>Object Graphic Navigation Language</p>
<p>é€šè¿‡å¯¹è±¡çš„å–å€¼æ–¹æ³•æ¥è·å–æ•°æ®ï¼Œçœç•¥get</p>
<p>å¦‚è·å–ç”¨æˆ·åï¼Œç±»ä¸­çš„å†™æ³•ï¼šuser.getUsername()</p>
<p>OGNLè¡¨è¾¾å¼å†™æ³•ï¼šuser.username</p>
<p>MyBatisä¸­ï¼Œç”±äºparameterTypeä¸­å·²ç»æä¾›äº†å±æ€§æ‰€å±çš„ç±»ï¼Œå¯ä»¥ç›´æ¥å†™usernameï¼Œä¸éœ€è¦å†™å¯¹è±¡å</p>
<h2 id="æ¡ä»¶æŸ¥è¯¢ä¾‹"><a href="#æ¡ä»¶æŸ¥è¯¢ä¾‹" class="headerlink" title="æ¡ä»¶æŸ¥è¯¢ä¾‹"></a>æ¡ä»¶æŸ¥è¯¢ä¾‹</h2><p>é€šè¿‡QueryVoè®¾ç½®æŸ¥è¯¢æ¡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ç”¨usernameå°±éœ€è¦åŠ å¯¹è±¡å</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ ¹æ®queryVoçš„æ¡ä»¶æŸ¥è¯¢ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserByVo"</span> <span class="attr">parameterType</span>=<span class="string">"com.itheima.domain.QueryVo"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">  select * from user where username like #&#123;user.username&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByVo</span><span class="params">()</span></span>&#123;</span><br><span class="line">  QueryVo vo = <span class="keyword">new</span> QueryVo();</span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setUserName(<span class="string">"%ç‹%"</span>);</span><br><span class="line">  vo.setUser(user);</span><br><span class="line">  List&lt;User&gt; users = userDao.findUserByVo(vo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ç»“æœå°è£…"><a href="#ç»“æœå°è£…" class="headerlink" title="ç»“æœå°è£…"></a>ç»“æœå°è£…</h1><p>resultTypeå¯ä»¥æ˜¯ï¼š</p>
<ul>
<li>ç®€å•ç±»å‹</li>
<li>pojoå¯¹è±¡</li>
<li>pojoåˆ—è¡¨</li>
</ul>
<h1 id="åç§°å¯¹åº”"><a href="#åç§°å¯¹åº”" class="headerlink" title="åç§°å¯¹åº”"></a>åç§°å¯¹åº”</h1><p>å¦‚æœæœ¬æ¥å±æ€§åå…¨æ˜¯å°å†™ï¼Œæ•°æ®åº“ä¸­ä¹Ÿå…¨æ˜¯å°å†™ï¼Œå¯ä»¥æ­£å¸¸æ‰§è¡Œ</p>
<p>æŠŠå±æ€§åä»å…¨å°å†™æ”¹æˆå±±å³°ï¼Œå¦‚useridæ”¹æˆuserIdï¼Œusernameæ”¹æˆuserNameï¼Œè¿è¡ŒæŸ¥æ‰€æœ‰</p>
<p>å¯èƒ½åªæœ‰userNameçš„å€¼æŸ¥å‡ºæ¥äº†</p>
<p>å› ä¸ºwindowsç³»ç»Ÿä¸‹mysqlä¸åŒºåˆ†å¤§å°å†™</p>
<p>ä½†æ˜¯linuxç³»ç»Ÿä¸‹åŒºåˆ†</p>
<p><strong>è§£å†³æ–¹æ³•</strong></p>
<ol>
<li>å–åˆ«å</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">select id as userId,username as userName,address as userAddress,sex as userSex,birthday as userBirthday from user</span><br></pre></td></tr></table></figure>

<p>åœ¨sqlè¯­å¥å±‚é¢è§£å†³é—®é¢˜ï¼Œæ‰§è¡Œæ•ˆç‡é«˜</p>
<ol start="2">
<li>MyBatisé…ç½®</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½® æŸ¥è¯¢ç»“æœçš„åˆ—åå’Œå®ä½“ç±»çš„å±æ€§åçš„å¯¹åº”å…³ç³» --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"userMap"</span> <span class="attr">type</span>=<span class="string">"uSeR"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ä¸»é”®å­—æ®µçš„å¯¹åº” --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"userId"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--éä¸»é”®å­—æ®µçš„å¯¹åº”--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"userName"</span> <span class="attr">column</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"userAddress"</span> <span class="attr">column</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"userSex"</span> <span class="attr">column</span>=<span class="string">"sex"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"userBirthday"</span> <span class="attr">column</span>=<span class="string">"birthday"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶resultTypeè¦æ”¹æˆresultMapï¼Œè¯´æ˜ä½¿ç”¨userMapè§£æç»“æœå°è£…</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--select id as userId,username as userName,address as userAddress,sex as userSex,birthday as userBirthday from user;--&gt;</span></span><br><span class="line">  select * from user;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¼€å‘æ•ˆç‡é«˜äº›</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°02 å®ç°CRUD</title>
    <url>/2020/03/27/note-mybatis-02/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p21ï½27, 44</p>
</blockquote>
<h1 id="ç”¨æˆ·çš„æŒä¹…å±‚æ¥å£"><a href="#ç”¨æˆ·çš„æŒä¹…å±‚æ¥å£" class="headerlink" title="ç”¨æˆ·çš„æŒä¹…å±‚æ¥å£"></a>ç”¨æˆ·çš„æŒä¹…å±‚æ¥å£</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¢</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ </span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ”¹</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findByName</span><span class="params">(String username)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findTotal</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="é…ç½®ä¸æµ‹è¯•ï¼ˆä»¥æŸ¥æ‰€æœ‰ä¸ºä¾‹ï¼‰"><a href="#é…ç½®ä¸æµ‹è¯•ï¼ˆä»¥æŸ¥æ‰€æœ‰ä¸ºä¾‹ï¼‰" class="headerlink" title="é…ç½®ä¸æµ‹è¯•ï¼ˆä»¥æŸ¥æ‰€æœ‰ä¸ºä¾‹ï¼‰"></a>é…ç½®ä¸æµ‹è¯•ï¼ˆä»¥æŸ¥æ‰€æœ‰ä¸ºä¾‹ï¼‰</h1><h2 id="æŸ¥è¯¢æ“ä½œçš„æ˜ å°„"><a href="#æŸ¥è¯¢æ“ä½œçš„æ˜ å°„" class="headerlink" title="æŸ¥è¯¢æ“ä½œçš„æ˜ å°„"></a>æŸ¥è¯¢æ“ä½œçš„æ˜ å°„</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"com.itheima.domain.User"</span>&gt;</span></span><br><span class="line">  select * from user;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession sqlSession;</span><br><span class="line">    <span class="keyword">private</span> IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">// ç”¨äºåœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">// 1.è¯»å–é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆå­—èŠ‚è¾“å…¥æµ</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">"SqlMapConfig.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.è·å–SqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">// 3.è·å–SqlSessionå¯¹è±¡</span></span><br><span class="line">        sqlSession = factory.openSession();</span><br><span class="line">        <span class="comment">// 4.è·å–daoçš„ä»£ç†å¯¹è±¡</span></span><br><span class="line">        userDao = sqlSession.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span> <span class="comment">// ç”¨äºåœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">// 5.æäº¤äº‹åŠ¡</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        <span class="comment">// 6.é‡Šæ”¾èµ„æº</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•æŸ¥è¯¢æ‰€æœ‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        <span class="keyword">for</span>(User user : users)&#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h1><h3 id="å¢"><a href="#å¢" class="headerlink" title="å¢"></a>å¢</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¿å­˜ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"saveUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.itheima.domain.User"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®æ’å…¥æ“ä½œåï¼Œè·å–æ’å…¥æ•°æ®çš„id --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"userId"</span> <span class="attr">keyColumn</span>=<span class="string">"id"</span> <span class="attr">resultType</span>=<span class="string">"int"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span>&gt;</span></span><br><span class="line">    select last_insert_id();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">  insert into user(username,address,sex,birthday)values(#&#123;userName&#125;,#&#123;userAddress&#125;,#&#123;userSex&#125;,#&#123;userBirthday&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setUserName(<span class="string">"AAA"</span>);</span><br><span class="line">user.setUserAddress(<span class="string">"åŒ—äº¬å¸‚é¡ºä¹‰åŒº"</span>);</span><br><span class="line">user.setUserSex(<span class="string">"ç”·"</span>);</span><br><span class="line">user.setUserBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">userDao.saveUser(user);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åœ¨æ–°å¢ç”¨æˆ·åè·å–id</p>
<p>åœ¨saveUserå‰åæ‰“å°userï¼Œå¯ä»¥å‘ç°idä»nullå˜ä¸ºå€¼</p>
<h3 id="åˆ "><a href="#åˆ " class="headerlink" title="åˆ "></a>åˆ </h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åˆ é™¤ç”¨æˆ·--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">  delete from user where id = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œuidï¼Œä¼ åŸºæœ¬ç±»å‹æˆ–åŸºæœ¬ç±»å‹åŒ…è£…ç±»æ—¶ï¼Œå ä½ç¬¦å¯ä»¥éšä¾¿å†™</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">userDao.deleteUser(<span class="number">48</span>);</span><br></pre></td></tr></table></figure>

<h3 id="æ”¹"><a href="#æ”¹" class="headerlink" title="æ”¹"></a>æ”¹</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ›´æ–°ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.itheima.domain.User"</span>&gt;</span></span><br><span class="line">  update user set username=#&#123;userName&#125;,address=#&#123;userAddress&#125;,sex=#&#123;userAex&#125;,birthday=#&#123;userBirthday&#125; where id=#&#123;userId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setUserId(<span class="number">50</span>);</span><br><span class="line">user.setUserName(<span class="string">"BBB"</span>);</span><br><span class="line">user.setUserAddress(<span class="string">"åŒ—äº¬å¸‚é¡ºä¹‰åŒº"</span>);</span><br><span class="line">user.setUserSex(<span class="string">"å¥³"</span>);</span><br><span class="line">user.setUserBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">userDao.updateUser(user);</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥"><a href="#æŸ¥" class="headerlink" title="æŸ¥"></a>æŸ¥</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ ¹æ®idæŸ¥è¯¢ç”¨æˆ· --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.itheima.domain.User"</span>&gt;</span></span><br><span class="line">  select * from user where id = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- æ ¹æ®åç§°æ¨¡ç³ŠæŸ¥è¯¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findByName"</span> <span class="attr">parameterType</span>=<span class="string">"string"</span> <span class="attr">resultType</span>=<span class="string">"com.itheima.domain.User"</span>&gt;</span></span><br><span class="line">  select * from user where username like #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- è·å–ç”¨æˆ·çš„æ€»è®°å½•æ¡æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findTotal"</span> <span class="attr">resultType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">  select count(id) from user;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">  User  user = userDao.findById(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByName</span><span class="params">()</span></span>&#123;</span><br><span class="line">  List&lt;User&gt; users = userDao.findByName(<span class="string">"%ç‹%"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindTotal</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> count = userDao.findTotal();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®åç§°æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥æœ‰ä¸¤ç§æ–¹å¼</p>
<ol>
<li><p>select * from user where username like #{name}</p>
</li>
<li><p>select * from user where username like â€˜%${value}%â€™</p>
</li>
</ol>
<p>å‰è€…ç”¨çš„æ˜¯PrepareStatementçš„å‚æ•°å ä½ç¬¦ï¼ˆæ›´å¥½ï¼‰ï¼Œè€Œåè€…ç”¨çš„æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥</p>
<h1 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h1><p>MyBatisé€šè¿‡sqlsessionå¯¹è±¡çš„commitå’Œrollbackæ–¹æ³•å®ç°äº‹åŠ¡çš„æäº¤å’Œå›æ»š</p>
<p>æœ€ç»ˆç”¨åˆ°çš„éƒ½æ˜¯connection.commit()å’Œconnection.rollback()</p>
<p><strong>è‡ªåŠ¨æäº¤</strong></p>
<p>åˆ›å»ºSqlSessionæ—¶å¯ä»¥è®¾ç½®è‡ªåŠ¨æäº¤</p>
<img src="/images/2020/screencapture2020-03-30AM10.53.57.jpg">

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">sqlSession = factory.openSession(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·åé¢å°±ä¸ç”¨æ‰‹åŠ¨æäº¤äº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// sqlSession.commit();</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å®é™…ä¸Šèƒ½è¿™æ ·ç”¨ä¸å¤š</p>
<p>å¦‚è½¬è´¦æ“ä½œï¼Œè¿˜æ˜¯éœ€è¦æ‰‹åŠ¨æ§åˆ¶æäº¤æ—¶é—´</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatisç¬”è®°01 å…¥é—¨</title>
    <url>/2020/03/26/note-mybatis-01/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952553" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952553</a><br>p1~10</p>
</blockquote>
<h1 id="æ¡†æ¶æ¦‚è¿°"><a href="#æ¡†æ¶æ¦‚è¿°" class="headerlink" title="æ¡†æ¶æ¦‚è¿°"></a>æ¡†æ¶æ¦‚è¿°</h1><p>ä»€ä¹ˆæ˜¯æ¡†æ¶ï¼šæ•´ä¸ªæˆ–éƒ¨åˆ†ç³»ç»Ÿçš„å¯é‡ç”¨è®¾è®¡ï¼Œè¡¨ç°ä¸ºä¸€ç»„æŠ½è±¡æ„ä»¶åŠæ„ä»¶å®ä¾‹é—´äº¤äº’çš„æ–¹æ³•</p>
<p>ç›®çš„ï¼šå°è£…ç»†èŠ‚ï¼Œæé«˜å¼€å‘æ•ˆç‡ -&gt; å…³æ³¨åŠŸèƒ½å®ç°</p>
<p>ä¸åŒçš„æ¡†æ¶å„å¸å…¶èŒï¼Œè§£å†³æŸä¸€å±‚æˆ–æŸä¸€ç±»é—®é¢˜</p>
<img src="/images/2020/screencapture2020-03-26PM10.20.30.jpg">

<p>æŒä¹…å±‚æŠ€æœ¯æœ‰jdbcã€Springçš„JdbcTemplateã€Apacheçš„DBUtils</p>
<p>ä½†æ˜¯å®ƒä»¬éƒ½ä¸æ˜¯æ¡†æ¶ï¼Œjdbcæ˜¯è§„èŒƒï¼ŒJdbcTemplateå’ŒDButilsæ˜¯å·¥å…·ç±»ï¼ˆåªæœ‰ç®€å•çš„å°è£…è€Œæ²¡æœ‰å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼‰</p>
<h2 id="MyBatisæ¡†æ¶æ¦‚è¿°"><a href="#MyBatisæ¡†æ¶æ¦‚è¿°" class="headerlink" title="MyBatisæ¡†æ¶æ¦‚è¿°"></a>MyBatisæ¡†æ¶æ¦‚è¿°</h2><p>åŸºäº java çš„æŒä¹…å±‚æ¡†æ¶</p>
<p>å†…éƒ¨å°è£…äº† jdbcæ“ä½œçš„ç»†èŠ‚ï¼Œä½¿å¼€å‘è€…åªéœ€è¦å…³æ³¨ sql è¯­å¥æœ¬èº«ï¼Œè€Œæ— éœ€å…³æ³¨æ³¨å†Œé©±åŠ¨ã€åˆ›å»ºè¿æ¥ç­‰ç¹æ‚è¿‡ç¨‹</p>
<p>ä½¿ç”¨ORMï¼ˆObject Relational Mappingï¼‰æ€æƒ³å®ç°ç»“æœé›†çš„å°è£…</p>
<p>é€šè¿‡xmlæˆ–æ³¨è§£çš„æ–¹å¼é…ç½®statement</p>
<h1 id="ç¯å¢ƒæ­å»º-amp-å…¥é—¨æ¡ˆä¾‹"><a href="#ç¯å¢ƒæ­å»º-amp-å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="ç¯å¢ƒæ­å»º&amp;å…¥é—¨æ¡ˆä¾‹"></a>ç¯å¢ƒæ­å»º&amp;å…¥é—¨æ¡ˆä¾‹</h1><h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/screencapture2020-03-26PM10.44.35.jpg" width=400>

<p>Ideaä¸­åˆ›å»ºç›®å½•å’ŒåŒ…æ˜¯ä¸ä¸€æ ·çš„</p>
<p>åˆ›å»ºåŒ…æ—¶com.itheima.daoæ˜¯ä¸‰çº§ç»“æ„</p>
<p>åˆ›å»ºç›®å½•æ—¶com.itheima.daoæ˜¯ä¸€çº§ç›®å½•</p>
<p>resourceä¸­åˆ›å»ºdirectoryè¦ä¸€çº§ä¸€çº§çš„åˆ›å»ºï¼Œå› ä¸ºMyBatisçš„æ˜ å°„é…ç½®æ–‡ä»¶ä½ç½®å¿…é¡»å’Œdaoæ¥å£çš„åŒ…ç»“æ„ç›¸åŒ</p>
<p>å†è¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œå°±æ— é¡»å†å†™daoçš„å®ç°ç±»äº†ï¼Œå‰©ä¸‹çš„ç”±MyBatiså®ç°</p>
<p>ï¼ˆMyBatisæ”¯æŒè‡ªå·±å†™å®ç°ç±»ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆæ„ä¹‰ï¼‰</p>
<h2 id="1-å‡†å¤‡æ•°æ®åº“"><a href="#1-å‡†å¤‡æ•°æ®åº“" class="headerlink" title="1.å‡†å¤‡æ•°æ®åº“"></a>1.å‡†å¤‡æ•°æ®åº“</h2><p>Userè¡¨</p>
<h2 id="2-Ideaåˆ›å»ºMavenå·¥ç¨‹ï¼Œå¯¼åæ ‡"><a href="#2-Ideaåˆ›å»ºMavenå·¥ç¨‹ï¼Œå¯¼åæ ‡" class="headerlink" title="2.Ideaåˆ›å»ºMavenå·¥ç¨‹ï¼Œå¯¼åæ ‡"></a>2.Ideaåˆ›å»ºMavenå·¥ç¨‹ï¼Œå¯¼åæ ‡</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-å®ä½“ç±»å’ŒDaoæ¥å£"><a href="#3-å®ä½“ç±»å’ŒDaoæ¥å£" class="headerlink" title="3. å®ä½“ç±»å’ŒDaoæ¥å£"></a>3. å®ä½“ç±»å’ŒDaoæ¥å£</h2><p>å®ä½“ç±»Userï¼Œå±æ€§å’Œæ•°æ®åº“è¡¨ä¸­å­—æ®µä¸€ä¸€å¯¹åº”ï¼Œå®ç°Serializableï¼Œç”Ÿæˆgetã€setæ–¹æ³•</p>
<p>ç”¨æˆ·çš„æŒä¹…å±‚æ¥å£IUserDaoï¼Œä¸€ä¸ªæ–¹æ³•ï¼šList<User> findAll();</p>
<h2 id="4-é…ç½®æ–‡ä»¶"><a href="#4-é…ç½®æ–‡ä»¶" class="headerlink" title="4. é…ç½®æ–‡ä»¶"></a>4. é…ç½®æ–‡ä»¶</h2><h3 id="ä¸»é…ç½®æ–‡ä»¶-SqlMapConfig-xml"><a href="#ä¸»é…ç½®æ–‡ä»¶-SqlMapConfig-xml" class="headerlink" title="ä¸»é…ç½®æ–‡ä»¶ SqlMapConfig.xml"></a>ä¸»é…ç½®æ–‡ä»¶ SqlMapConfig.xml</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mybatisçš„ä¸»é…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®ç¯å¢ƒ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®mysqlçš„ç¯å¢ƒ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡çš„ç±»å‹--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®æ•°æ®æºï¼ˆè¿æ¥æ± ï¼‰ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- é…ç½®è¿æ¥æ•°æ®åº“çš„4ä¸ªåŸºæœ¬ä¿¡æ¯ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/eesy_mybatis"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"1234"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šæ˜ å°„é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œæ˜ å°„é…ç½®æ–‡ä»¶æŒ‡çš„æ˜¯æ¯ä¸ªdaoç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/itheima/dao/IUserDao.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span></span></span><br></pre></td></tr></table></figure>

<h3 id="æ˜ å°„é…ç½®æ–‡ä»¶-IUserDao-xml"><a href="#æ˜ å°„é…ç½®æ–‡ä»¶-IUserDao-xml" class="headerlink" title="æ˜ å°„é…ç½®æ–‡ä»¶ IUserDao.xml"></a>æ˜ å°„é…ç½®æ–‡ä»¶ IUserDao.xml</h3><p>MyBatisä¸­æŒä¹…å±‚çš„æ“ä½œæ¥å£åå’Œæ˜ å°„æ–‡ä»¶ä¹Ÿå«Mapper</p>
<p>å‘½åIUserDaoæˆ–è€…IUserMapperéƒ½å¯ä»¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.itheima.dao.IUserDao"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®æŸ¥è¯¢æ‰€æœ‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"com.itheima.domain.User"</span>&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>namespaceå¿…é¡»æ˜¯daoæ¥å£çš„æƒé™å®šç±»å</p>
<p>idè¦å†™daoæ¥å£çš„æ–¹æ³•å</p>
<p>resultTypeå†™è¿”å›ç±»å‹ï¼ˆå°è£…æˆä»€ä¹ˆå¯¹è±¡ï¼‰</p>
<p>sqlè¯­å¥å†™ä¸å†™åˆ†å·å‡å¯</p>
<h2 id="5-æµ‹è¯•"><a href="#5-æµ‹è¯•" class="headerlink" title="5.æµ‹è¯•"></a>5.æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.è¯»å–é…ç½®æ–‡ä»¶</span></span><br><span class="line">InputStream in = Resources.getResourceAsStream(<span class="string">"SqlMapConfig.xml"</span>);</span><br><span class="line"><span class="comment">// 2.åˆ›å»ºSqlSessionFactoryå·¥å‚</span></span><br><span class="line">SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">SqlSessionFactory factory = builder.build(in);</span><br><span class="line"><span class="comment">// 3.ä½¿ç”¨å·¥å‚ç”Ÿäº§SqlSessionå¯¹è±¡</span></span><br><span class="line">SqlSession session = factory.openSession();</span><br><span class="line"><span class="comment">// 4.ä½¿ç”¨SqlSessionåˆ›å»ºDaoæ¥å£çš„ä»£ç†å¯¹è±¡</span></span><br><span class="line">IUserDao userDao = session.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">// 5.ä½¿ç”¨ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">List&lt;User&gt; users = userDao.findAll();</span><br><span class="line"><span class="keyword">for</span>(User user : users)&#123;</span><br><span class="line">  System.out.println(user);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 6.é‡Šæ”¾èµ„æº</span></span><br><span class="line">session.close();</span><br><span class="line">in.close();</span><br></pre></td></tr></table></figure>

<p>æ¶‰åŠæ„å»ºè€…æ¨¡å¼&amp;å·¥å‚æ¨¡å¼&amp;åŠ¨æ€ä»£ç†</p>
<img src="/images/2020/screencapture2020-03-26PM11.27.06.jpg">

<h1 id="æ³¨è§£æ–¹å¼"><a href="#æ³¨è§£æ–¹å¼" class="headerlink" title="æ³¨è§£æ–¹å¼"></a>æ³¨è§£æ–¹å¼</h1><p>ä¸»é…ç½®æ–‡ä»¶è¿˜è¦æœ‰ï¼Œä¿®æ”¹ä¸€ä¸‹mapperå³å¯ï¼Œæ˜ å°„é…ç½®æ–‡ä»¶å¯ä»¥ä¸è¦äº†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æŒ‡å®šæ˜ å°„é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œæ˜ å°„é…ç½®æ–‡ä»¶æŒ‡çš„æ˜¯æ¯ä¸ªdaoç‹¬ç«‹çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">        å¦‚æœæ˜¯ç”¨æ³¨è§£æ¥é…ç½®çš„è¯ï¼Œæ­¤å¤„åº”è¯¥ä½¿ç”¨classå±æ€§æŒ‡å®šè¢«æ³¨è§£çš„daoå…¨é™å®šç±»å</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.itheima.dao.IUserDao"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>IUserDaoåŠ @Select</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°15 æ€»ç»“</title>
    <url>/2020/03/20/note-spring-15/</url>
    <content><![CDATA[<img src="/images/2020/spring.png">]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°14 Spring5çš„æ–°ç‰¹æ€§</title>
    <url>/2020/03/20/note-spring-14/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931?p=82" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931?p=82</a></p>
</blockquote>
<p>åŸºäºjdk1.8ï¼Œtomcatç‰ˆæœ¬è¦æ±‚8.5ä»¥ä¸Š</p>
<h1 id="åˆ©ç”¨jdk8ç‰ˆæœ¬æ›´æ–°çš„å†…å®¹"><a href="#åˆ©ç”¨jdk8ç‰ˆæœ¬æ›´æ–°çš„å†…å®¹" class="headerlink" title="åˆ©ç”¨jdk8ç‰ˆæœ¬æ›´æ–°çš„å†…å®¹"></a>åˆ©ç”¨jdk8ç‰ˆæœ¬æ›´æ–°çš„å†…å®¹</h1><h2 id="åŸºäºjdk8çš„åå°„å¢å¼º"><a href="#åŸºäºjdk8çš„åå°„å¢å¼º" class="headerlink" title="åŸºäºjdk8çš„åå°„å¢å¼º"></a>åŸºäºjdk8çš„åå°„å¢å¼º</h2><p> <strong>ä¸€ä¸ªæµ‹è¯•</strong></p>
<p>ä¸‰ç§æ“ä½œï¼š</p>
<p>1.åˆ›å»ºæ–°å¯¹è±¡å¹¶èµ‹å€¼</p>
<p>2.åˆ›å»ºä¸€ä¸ªå¯¹è±¡èµ‹å€¼å¤šæ¬¡</p>
<p>3.é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡å¹¶èµ‹å€¼</p>
<p>åˆ†åˆ«æ‰§è¡Œ10äº¿æ¬¡ï¼Œæ¯”è¾ƒç”¨æ—¶(ms)</p>
<p>jdk8ï¼š8ã€31ã€2417</p>
<p>jdk7ï¼š6212ã€3025ã€290400</p>
<h2 id="NonNull-å’Œ-Nullable-çš„ä½¿ç”¨"><a href="#NonNull-å’Œ-Nullable-çš„ä½¿ç”¨" class="headerlink" title="@NonNull å’Œ@Nullable çš„ä½¿ç”¨"></a>@NonNull å’Œ@Nullable çš„ä½¿ç”¨</h2><p>ç”¨ @Nullable å’Œ @NotNull æ³¨è§£æ¥è¡¨æ˜å¯ä¸ºç©ºçš„å‚æ•°å’Œä»¥åŠè¿”å›å€¼</p>
<p>è¿™æ ·å°±å¤Ÿåœ¨ç¼–è¯‘çš„æ—¶å€™å¤„ç†ç©ºå€¼è€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶æŠ›å‡º NullPointerExceptions</p>
<h2 id="æ—¥å¿—è®°å½•æ–¹é¢"><a href="#æ—¥å¿—è®°å½•æ–¹é¢" class="headerlink" title="æ—¥å¿—è®°å½•æ–¹é¢"></a>æ—¥å¿—è®°å½•æ–¹é¢</h2><p>å°è£… Commons Logging æ¡¥æ¥æ¨¡å—ï¼ˆå«åš spring-jclï¼‰</p>
<h1 id="æ ¸å¿ƒå®¹å™¨çš„æ›´æ–°"><a href="#æ ¸å¿ƒå®¹å™¨çš„æ›´æ–°" class="headerlink" title="æ ¸å¿ƒå®¹å™¨çš„æ›´æ–°"></a>æ ¸å¿ƒå®¹å™¨çš„æ›´æ–°</h1><p>æ”¯æŒå€™é€‰ç»„ä»¶ç´¢å¼•ä½œä¸ºç±»è·¯å¾„æ‰«æçš„æ›¿ä»£æ–¹æ¡ˆ</p>
<p>ä»ç´¢å¼•è¯»å–å®ä½“è€Œä¸æ˜¯æ‰«æç±»è·¯å¾„å¯¹äºå°äº 200 ä¸ªç±»çš„å°å‹é¡¹ç›®æ²¡æœ‰æ˜æ˜¾å·®å¼‚</p>
<p>å¯¹äºå¤§å‹é¡¹ç›®ï¼Œåº”ç”¨ç¨‹åºçš„å¯åŠ¨æ—¶é—´å°†è¢«å¤§å¤§ç¼©å‡</p>
<h1 id="JetBrains-Kotlin-è¯­è¨€æ”¯æŒ"><a href="#JetBrains-Kotlin-è¯­è¨€æ”¯æŒ" class="headerlink" title="JetBrains Kotlin è¯­è¨€æ”¯æŒ"></a>JetBrains Kotlin è¯­è¨€æ”¯æŒ</h1><h1 id="å“åº”å¼ç¼–ç¨‹é£æ ¼"><a href="#å“åº”å¼ç¼–ç¨‹é£æ ¼" class="headerlink" title="å“åº”å¼ç¼–ç¨‹é£æ ¼"></a>å“åº”å¼ç¼–ç¨‹é£æ ¼</h1><p>å“åº”å¼å †æ ˆ WEB æ¡†æ¶</p>
<p>è¿™ä¸ªå †æ ˆå®Œå…¨çš„å“åº”å¼ä¸”éé˜»å¡ï¼Œé€‚åˆäºäº‹ä»¶å¾ªç¯é£æ ¼çš„å¤„ç†ï¼Œå¯ä»¥è¿›è¡Œå°‘é‡çº¿ç¨‹çš„æ‰©å±•</p>
<p>ï¼ˆæœ‰ä¸€ä¸ªå“åº”å¼ç¼–ç¨‹å®æˆ˜ç¤ºä¾‹ï¼Œå»ºè®®å­¦å®ŒSpring Bootä¹‹åæ­å»º  -MARK- ï¼‰</p>
<h1 id="Junit5-æ”¯æŒ"><a href="#Junit5-æ”¯æŒ" class="headerlink" title="Junit5 æ”¯æŒ"></a>Junit5 æ”¯æŒ</h1>]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°13 Springä¸­çš„äº‹åŠ¡æ§åˆ¶</title>
    <url>/2020/03/19/note-spring-13/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p75-78</p>
</blockquote>
<p>å‡ ä¸ªç‚¹ï¼š</p>
<ul>
<li>JavaEEä½“ç³»è¿›è¡Œåˆ†å±‚å¼€å‘ï¼Œäº‹åŠ¡å¤„ç†ä½äºä¸šåŠ¡å±‚</li>
<li>Springæä¾›äº‹åŠ¡æ§åˆ¶çš„æ¥å£ï¼Œåœ¨spring-tx-5.0.2.RELEASE.jarä¸­</li>
<li>Springçš„äº‹åŠ¡æ§åˆ¶åŸºäºAOPã€‚å®ƒæ—¢å¯ä»¥ç”¨é…ç½®æ–¹å¼å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨ç¼–ç¨‹æ–¹å¼å®ç°ï¼ˆé‡ç‚¹æ˜¯é…ç½®å®ç°ï¼‰</li>
</ul>
<h1 id="Springä¸­äº‹åŠ¡æ§åˆ¶çš„API"><a href="#Springä¸­äº‹åŠ¡æ§åˆ¶çš„API" class="headerlink" title="Springä¸­äº‹åŠ¡æ§åˆ¶çš„API"></a>Springä¸­äº‹åŠ¡æ§åˆ¶çš„API</h1><h2 id="PlatformTransactionManager"><a href="#PlatformTransactionManager" class="headerlink" title="PlatformTransactionManager"></a>PlatformTransactionManager</h2><p>è¯¥æ¥å£æä¾›äº‹åŠ¡æ“ä½œçš„æ–¹æ³•ï¼š</p>
<ul>
<li>è·å–çŠ¶æ€ getTransaction()</li>
<li>æäº¤ commit()</li>
<li>å›æ»š rollback()</li>
</ul>
<p>å¸¸ç”¨å®ç°ç±»ï¼š</p>
<ul>
<li>org.springframework.jdbc.datasource.DataSourceTransactionManager </li>
<li>org.springframework.orm.hibernate5.HibernateTransactionManager </li>
</ul>
<h2 id="TransactionDefinition"><a href="#TransactionDefinition" class="headerlink" title="TransactionDefinition"></a>TransactionDefinition</h2><p>è¯¥æ¥å£æ˜¯äº‹åŠ¡çš„å®šä¹‰ä¿¡æ¯å¯¹è±¡ï¼Œå¯ä»¥è·å–äº‹åŠ¡å¯¹è±¡åç§°ã€éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºã€è¶…æ—¶æ—¶é—´ã€æ˜¯å¦åªè¯»</p>
<p>Springé»˜è®¤ä½¿ç”¨æ•°æ®åº“çš„éš”ç¦»çº§åˆ«</p>
<p>ä¼ æ’­è¡Œä¸ºæŒ‡ä»€ä¹ˆæƒ…å†µä¸‹å¿…é¡»æœ‰äº‹åŠ¡ã€ä»€ä¹ˆæƒ…å†µå¯æœ‰å¯æ— </p>
<h2 id="TransactionStatus"><a href="#TransactionStatus" class="headerlink" title="TransactionStatus"></a>TransactionStatus</h2><p>è¯¥æ¥å£æä¾›äº‹åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥åˆ·æ–°äº‹åŠ¡ã€è·å–æ˜¯å¦å­˜åœ¨å­˜å‚¨ç‚¹ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‰æ­¥æäº¤ï¼Œå›æ»šå¯ä»¥å›æ»šåˆ°å½“å‰ç‚¹ï¼Œä¸ç”¨å…¨éƒ¨å›æ»šï¼‰ã€æ˜¯å¦å®Œæˆã€æ˜¯å¦ä¸ºæ–°çš„äº‹åŠ¡ã€æ˜¯å¦å›æ»šã€è®¾ç½®å›æ»š</p>
<h1 id="Springçš„äº‹åŠ¡æ§åˆ¶"><a href="#Springçš„äº‹åŠ¡æ§åˆ¶" class="headerlink" title="Springçš„äº‹åŠ¡æ§åˆ¶"></a>Springçš„äº‹åŠ¡æ§åˆ¶</h1><h2 id="ä»£ç å‡†å¤‡"><a href="#ä»£ç å‡†å¤‡" class="headerlink" title="ä»£ç å‡†å¤‡"></a>ä»£ç å‡†å¤‡</h2><p>pom.xmlä¸­éœ€è¦å¯¼å…¥aspectjçš„ä¾èµ–ï¼Œå› ä¸ºäº‹åŠ¡æ§åˆ¶åŸºäºAOP</p>
<p>å‡†å¤‡æ•°æ®åº“è¡¨å’Œå®ä½“ç±»ï¼ˆè¿˜æ˜¯è´¦æˆ·ï¼‰</p>
<p>å®ç°ä¸‰ä¸ªæ–¹æ³•ï¼šæ ¹æ®IdæŸ¥è¯¢è´¦æˆ·ã€æ ¹æ®åç§°æŸ¥è¯¢è´¦æˆ·ã€è½¬è´¦</p>
<p>ç¼–å†™Daoå±‚å’Œä¸šåŠ¡å±‚æ¥å£å’Œå®ç°ç±»</p>
<h2 id="åŸºäºXMLçš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶"><a href="#åŸºäºXMLçš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶" class="headerlink" title="åŸºäºXMLçš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶"></a>åŸºäºXMLçš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶</h2><p>é…ç½®æ­¥éª¤</p>
<p>1ã€é…ç½®äº‹åŠ¡ç®¡ç†å™¨</p>
<p>2ã€é…ç½®äº‹åŠ¡çš„é€šçŸ¥</p>
<p>æ­¤æ—¶éœ€è¦å¯¼å…¥äº‹åŠ¡çš„çº¦æŸï¼ˆæ–‡æ¡£é¦–é¡µç‚¹Data Accessï¼Œæœxmlns:txï¼ŒåŒæ—¶ä¹Ÿä¼šå¯¼å…¥AOPçš„çº¦æŸï¼‰</p>
<p>ä½¿ç”¨tx:adviceæ ‡ç­¾é…ç½®äº‹åŠ¡é€šçŸ¥<br>å±æ€§ï¼šidï¼šäº‹åŠ¡é€šçŸ¥çš„å”¯ä¸€æ ‡è¯†   transaction-managerï¼šç»™äº‹åŠ¡é€šçŸ¥æä¾›ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨å¼•ç”¨</p>
<p>3ã€é…ç½®AOPä¸­çš„é€šç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</p>
<p>4ã€å»ºç«‹äº‹åŠ¡é€šçŸ¥å’Œåˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„å¯¹åº”å…³ç³»</p>
<p>5ã€é…ç½®äº‹åŠ¡çš„å±æ€§ï¼ˆåœ¨äº‹åŠ¡çš„é€šçŸ¥tx:adviceæ ‡ç­¾çš„å†…éƒ¨ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®äº‹åŠ¡çš„é€šçŸ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡çš„å±æ€§</span></span><br><span class="line"><span class="comment">                isolationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚é»˜è®¤å€¼æ˜¯DEFAULTï¼Œè¡¨ç¤ºä½¿ç”¨æ•°æ®åº“çš„é»˜è®¤éš”ç¦»çº§åˆ«ã€‚</span></span><br><span class="line"><span class="comment">                propagationï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºã€‚é»˜è®¤å€¼æ˜¯REQUIREDï¼Œè¡¨ç¤ºä¸€å®šä¼šæœ‰äº‹åŠ¡ï¼Œå¢åˆ æ”¹çš„é€‰æ‹©ã€‚æŸ¥è¯¢æ–¹æ³•å¯ä»¥é€‰æ‹©SUPPORTSã€‚</span></span><br><span class="line"><span class="comment">                read-onlyï¼šç”¨äºæŒ‡å®šäº‹åŠ¡æ˜¯å¦åªè¯»ã€‚åªæœ‰æŸ¥è¯¢æ–¹æ³•æ‰èƒ½è®¾ç½®ä¸ºtrueã€‚é»˜è®¤å€¼æ˜¯falseï¼Œè¡¨ç¤ºè¯»å†™ã€‚</span></span><br><span class="line"><span class="comment">                timeoutï¼šç”¨äºæŒ‡å®šäº‹åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯-1ï¼Œè¡¨ç¤ºæ°¸ä¸è¶…æ—¶ã€‚å¦‚æœæŒ‡å®šäº†æ•°å€¼ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚</span></span><br><span class="line"><span class="comment">                rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¸å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚</span></span><br><span class="line"><span class="comment">                no-rollback-forï¼šç”¨äºæŒ‡å®šä¸€ä¸ªå¼‚å¸¸ï¼Œå½“äº§ç”Ÿè¯¥å¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¸å›æ»šï¼Œäº§ç”Ÿå…¶ä»–å¼‚å¸¸æ—¶äº‹åŠ¡å›æ»šã€‚æ²¡æœ‰é»˜è®¤å€¼ã€‚è¡¨ç¤ºä»»ä½•å¼‚å¸¸éƒ½å›æ»šã€‚</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">read-only</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åé¢å†™æŸ¥è¯¢æ–¹æ³•éƒ½ä»¥findå¼€å¤´ è¿™æ ·ä¸¤è¡Œé…ç½®å°±å¤Ÿäº†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">tx:method</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®aop--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pt1"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:pointcut</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å»ºç«‹åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å’Œäº‹åŠ¡é€šçŸ¥çš„å¯¹åº”å…³ç³» --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:advisor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·service.implä¸‹çš„å®ç°ç±»å°±éƒ½é…ç½®å¥½äº‹åŠ¡æ§åˆ¶äº†</p>
<h2 id="åŸºäºæ³¨è§£çš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶"><a href="#åŸºäºæ³¨è§£çš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶" class="headerlink" title="åŸºäºæ³¨è§£çš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶"></a>åŸºäºæ³¨è§£çš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶</h2><p>å¯¼åç§°ç©ºé—´æ—¶è¦å¤šä¸€ä¸ªcontextï¼Œä»¥åŠå¯¹åº”çš„çº¦æŸ</p>
<p>ä¸šåŠ¡å±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="meta">@Transactional</span>(propagation= Propagation.SUPPORTS,readOnly=<span class="keyword">true</span>) <span class="comment">// åªè¯»å‹äº‹åŠ¡çš„é…ç½®</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">findAccountById</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findAccountById(accountId);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éœ€è¦çš„æ˜¯è¯»å†™å‹äº‹åŠ¡é…ç½®</span></span><br><span class="line">    <span class="meta">@Transactional</span>(propagation= Propagation.REQUIRED,readOnly=<span class="keyword">false</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String sourceName, String targetName, Float money)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// 2.1æ ¹æ®åç§°æŸ¥è¯¢è½¬å‡ºè´¦æˆ·</span></span><br><span class="line">            Account source = accountDao.findAccountByName(sourceName);</span><br><span class="line">            <span class="comment">// 2.2æ ¹æ®åç§°æŸ¥è¯¢è½¬å…¥è´¦æˆ·</span></span><br><span class="line">            Account target = accountDao.findAccountByName(targetName);</span><br><span class="line">            <span class="comment">// 2.3è½¬å‡ºè´¦æˆ·å‡é’±</span></span><br><span class="line">            source.setMoney(source.getMoney()-money);</span><br><span class="line">            <span class="comment">// 2.4è½¬å…¥è´¦æˆ·åŠ é’±</span></span><br><span class="line">            target.setMoney(target.getMoney()+money);</span><br><span class="line">            <span class="comment">// 2.5æ›´æ–°è½¬å‡ºè´¦æˆ·</span></span><br><span class="line">            accountDao.updateAccount(source);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> i=<span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2.6æ›´æ–°è½¬å…¥è´¦æˆ·</span></span><br><span class="line">            accountDao.updateAccount(target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Daoå±‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span>(<span class="string">"accountDao"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ä¸èƒ½å†ç»§æ‰¿JdbcDaoSupportäº†ï¼ˆå› ä¸ºæ²¡æ³•ç»™jdbcTemplateåŠ æ³¨è§£ï¼‰ï¼Œå¿…é¡»è‡ªå·±å®šä¹‰ä¸€ä¸ªjdbcTemplateï¼Œå¹¶åœ¨xmlä¸­é…ç½®ï¼ˆå¹¶æ³¨å…¥dataSourceï¼Œè¿˜è¦é…ç½®Springåœ¨åˆ›å»ºå®¹å™¨æ—¶éœ€è¦æ‰«æçš„åŒ…ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®springåˆ›å»ºå®¹å™¨æ—¶è¦æ‰«æçš„åŒ…--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.itheima"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®JdbcTemplate--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jdbcTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.core.JdbcTemplate"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®æ•°æ®æº--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/eesy"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"1234"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- springä¸­åŸºäºæ³¨è§£ çš„å£°æ˜å¼äº‹åŠ¡æ§åˆ¶é…ç½®æ­¥éª¤</span></span><br><span class="line"><span class="comment">            1ã€é…ç½®äº‹åŠ¡ç®¡ç†å™¨</span></span><br><span class="line"><span class="comment">            2ã€å¼€å¯springå¯¹æ³¨è§£äº‹åŠ¡çš„æ”¯æŒ</span></span><br><span class="line"><span class="comment">            3ã€åœ¨éœ€è¦äº‹åŠ¡æ”¯æŒçš„åœ°æ–¹ä½¿ç”¨@Transactionalæ³¨è§£</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¼€å¯springå¯¹æ³¨è§£äº‹åŠ¡çš„æ”¯æŒ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span><span class="tag">&lt;/<span class="name">tx:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å±æ€§åœ¨@Transactionalä¸­é…ç½®</p>
<p>ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœæœ‰åä¸ªäº‹åŠ¡ï¼Œä¸€åŠåªè¯»ä¸€åŠè¯»å†™ï¼Œå°±éƒ½å¾—å•ç‹¬é…ç½®å±æ€§</p>
<p>è€Œç”¨xmlé…ç½®æ—¶ä¸€æ¬¡å°±è§£å†³äº†</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°12 åŸºäºXMLå’Œæ³¨è§£çš„äº‹åŠ¡æ§åˆ¶</title>
    <url>/2020/03/19/note-spring-12/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p72-74</p>
</blockquote>
<h1 id="åŸºäºXMLçš„äº‹åŠ¡æ§åˆ¶"><a href="#åŸºäºXMLçš„äº‹åŠ¡æ§åˆ¶" class="headerlink" title="åŸºäºXMLçš„äº‹åŠ¡æ§åˆ¶"></a>åŸºäºXMLçš„äº‹åŠ¡æ§åˆ¶</h1><p>2ä¸ªå·¥å…·ç±»ï¼šConnectionUtils å’Œ TransactionManager</p>
<p>è§ <a href="/2020/03/09/note-spring-09/">Springç¬”è®°09 äº‹åŠ¡æ§åˆ¶çš„é—®é¢˜&amp;åŠ¨æ€ä»£ç†</a></p>
<p>ä¸»è¦é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®Connectionçš„å·¥å…·ç±» ConnectionUtils --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"connectionUtils"</span> <span class="attr">class</span>=<span class="string">"com.itheima.utils.ConnectionUtils"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- æ³¨å…¥æ•°æ®æº--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"com.itheima.utils.TransactionManager"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- æ³¨å…¥ConnectionUtils --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionUtils"</span> <span class="attr">ref</span>=<span class="string">"connectionUtils"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®aop--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--é…ç½®é€šç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pt1"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:pointcut</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">ref</span>=<span class="string">"txManager"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®å‰ç½®é€šçŸ¥ï¼šå¼€å¯äº‹åŠ¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"beginTransaction"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:before</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®åç½®é€šçŸ¥ï¼šæäº¤äº‹åŠ¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">"commit"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after-returning</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®å¼‚å¸¸é€šçŸ¥ï¼šå›æ»šäº‹åŠ¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"rollback"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after-throwing</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®æœ€ç»ˆé€šçŸ¥ï¼šé‡Šæ”¾è¿æ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"release"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="åŸºäºæ³¨è§£çš„AOPé…ç½®"><a href="#åŸºäºæ³¨è§£çš„AOPé…ç½®" class="headerlink" title="åŸºäºæ³¨è§£çš„AOPé…ç½®"></a>åŸºäºæ³¨è§£çš„AOPé…ç½®</h1><p>xmlä¸­è¦å¼€å¯å¯¹æ³¨è§£çš„æ”¯æŒ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span>(<span class="string">"accountDao"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> QueryRunner runner;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ConnectionUtils connectionUtils;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"connectionUtils"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"txManager"</span>)</span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ConnectionUtils connectionUtils;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pt1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@Around</span>(<span class="string">"pt1()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">aroundAdvice</span><span class="params">(ProceedingJoinPoint pjp)</span></span>&#123;</span><br><span class="line">        Object rtValue = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.è·å–å‚æ•°</span></span><br><span class="line">            Object[] args = pjp.getArgs();</span><br><span class="line">            <span class="comment">// 2.å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            <span class="keyword">this</span>.beginTransaction();</span><br><span class="line">            <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">            rtValue = pjp.proceed(args);</span><br><span class="line">            <span class="comment">// 4.æäº¤äº‹åŠ¡</span></span><br><span class="line">            <span class="keyword">this</span>.commit();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è¿”å›ç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span>  rtValue;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Throwable e)&#123;</span><br><span class="line">            <span class="comment">// 5.å›æ»šäº‹åŠ¡</span></span><br><span class="line">            <span class="keyword">this</span>.rollback();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 6.é‡Šæ”¾èµ„æº</span></span><br><span class="line">            <span class="keyword">this</span>.release();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåˆ†åˆ«åœ¨å¼€å¯äº‹åŠ¡ã€æäº¤äº‹åŠ¡ã€å›æ»šäº‹åŠ¡ã€é‡Šæ”¾è¿æ¥çš„å‡½æ•°ä¸Šåˆ†åˆ«åŠ @Before(â€œpt1()â€)ã€@AfterReturning(â€œpt1()â€)ã€@AfterThrowing(â€œpt1()â€)ã€@After(â€œpt1()â€)</p>
<p>ç†è®ºä¸Šæ²¡æ¯›ç—…ã€‚ä½†æ˜¯ï¼Springå®é™…çš„æ‰§è¡Œé¡ºåºæ˜¯æœ‰é—®é¢˜çš„ï¼ˆåŒ è§ç¬”è®°9ï¼‰</p>
<p>æœ€ç»ˆé€šçŸ¥åœ¨åç½®é€šçŸ¥ä¹‹å‰æ‰§è¡Œäº†ï¼Œäºæ˜¯æ ¹æœ¬æ²¡æœ‰æäº¤å°±é‡Šæ”¾äº†ï¼Œè¿æ¥å·²ç»å˜æˆäº†æ–°çš„è¿æ¥</p>
<p>æ‰€ä»¥ä¸è¦åˆ†åˆ«ç”¨ã€‚ç”¨ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œé‡Œé¢try-catchï¼Œè‡ªå·±æ§åˆ¶é¡ºåº</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>å­¦ä¹ Springçš„ä¸€ç‚¹æ„Ÿæƒ³</title>
    <url>/2020/03/19/note-spring/</url>
    <content><![CDATA[<p>Springå­¦åˆ°è¿™é‡Œï¼Œè®°å½•ä¸€ç‚¹ç‚¹æ„Ÿæƒ³</p>
<hr>
<p>è¿™ä¸ªæ•™ç¨‹ä¸€ä¸ªç»å¸¸çš„æ“ä½œå°±æ˜¯</p>
<p>å™¼é‡Œå•ªå•¦å™¼é‡Œå•ªå•¦å†™äº†ä¸€å¤§å †ï¼Œç„¶åçµé­‚è´¨é—®ï¼š<strong>ä½ éƒ½èƒ½å†™å‡ºæ¥çš„ä¸œè¥¿Springä¼šæ²¡æœ‰å—ï¼Ÿ</strong></p>
<p>ğŸ¥¶ğŸ¥¶ğŸ¥¶</p>
<p>fine</p>
<p>ä¸è¿‡è¿™ç§è¿‡ç¨‹è§£é‡Šäº†è¿™äº›è®¾è®¡çš„ç”¨æ„ï¼Œä¹Ÿéš¾æ€ªè¯„è®ºå¾ˆå¤šéƒ½è¯´è¿™ä¸ªæ•™ç¨‹æ˜¯çœ‹è¿‡æœ€å¥½çš„</p>
<p>ç„¶é¹…ï¼Œç”¨Spring Bootçš„æ—¶å€™ç°åœ¨çš„è¿™ä¸€å †ä¹Ÿä¸ç”¨å†™å•Šï¼</p>
<p>æœ€åˆæ¥è§¦java webè¿™ä¸€å¤§è¶´çš„æ—¶å€™ç‰¹åˆ«è¿·æƒ‘ï¼ŒTomcatã€Springã€Spring MVCã€Spring Bootâ€¦ä¸€ğŸ˜³è„¸ğŸ˜³æ‡µğŸ˜³é€¼</p>
<p>çœ‹åˆ°å¤§å¤šçš„å»ºè®®æ˜¯ä»Springå¼€å§‹ï¼Œä¸ç„¶Spring Bootèƒ½ç”¨ä½†æ˜¯ä¸æ‡‚ä¸ºä»€ä¹ˆ</p>
<p>äºæ˜¯å­¦äº†ä¸€äº›Springï¼ˆä¼°è®¡æ˜¯ä¸€ä¸ªå››å°æ—¶ç‰ˆæœ¬ï¼‰ï¼Œç”¨çš„æ—¶å€™ä¸ºäº†æ–¹ä¾¿è¿˜æ˜¯ç›´æ¥ä¸Šäº†Spring Boot</p>
<p>ç°åœ¨é‡æ–°å­¦ä¸€éï¼Œæ²¡ä¹‹å‰é‚£ä¹ˆğŸ˜³ğŸ˜³ğŸ˜³äº†ï¼Œæ•™ç¨‹é‡Œè¯´åˆ°Springå¯ä»¥ç®€åŒ–æ‰‹æ’•ä»£ç çš„æ—¶å€™ï¼Œä¹ŸçŸ¥é“Spring Bootè¿˜èƒ½å†ç®€åŒ–ä¸€äº›</p>
<p>å¯¹å®ƒä»¬çš„ç†è§£ä¹Ÿæ…¢æ…¢æ¸…æ™°äº†ä¸€ç‚¹ç‚¹ï¼Œæ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªä¸æ–­å°è£…ã€çº¦å®š&gt;é…ç½®çš„ç®€åŒ–è¿‡ç¨‹ï¼Œå’Œè®¡ç®—æœºä¸­è®¸è®¸å¤šå¤šçš„è¿›åŒ–è¿‡ç¨‹ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸€å±‚ä¸€å±‚çš„æŠ½(tou)è±¡(lan)</p>
<hr>
<img src="/images/2020/1949370-200.png" width=100>


<p>è¯´èµ·æ¥ï¼Œæ˜¥å¤©åˆ°äº†å‘¢</p>
<p>ä»Šå¤©æ¹–åŒ—å·²ç»0æ–°å¢äº†ï¼Œå¸Œæœ›èƒ½èµ¶å¿«å¼€é—¨â€¦</p>
<p>ğŸ¦¢</p>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°11 Springä¸­çš„JdbcTemplate</title>
    <url>/2020/03/19/note-spring-11/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a></p>
<p>p67~71</p>
</blockquote>
<p>æŒä¹…å±‚æ€»å›¾</p>
<img src="/images/2020/20200319.jpg">

<p>Springä¸­çš„JdbcTemplate</p>
<p>ä½œç”¨ï¼šå’Œæ•°æ®åº“äº¤äº’ï¼Œå®ç°å¯¹è¡¨çš„CRUDæ“ä½œ</p>
<h1 id="JdbcTemplateä¸DbUtils"><a href="#JdbcTemplateä¸DbUtils" class="headerlink" title="JdbcTemplateä¸DbUtils"></a>JdbcTemplateä¸DbUtils</h1><p>DbUtilsæ˜¯Apacheæä¾›çš„ä¸€ä¸ªå¯¹JDBCè¿›è¡Œç®€å•å°è£…çš„å¼€æºå·¥å…·ç±»åº“ï¼Œä¸»è¦æœ‰</p>
<ul>
<li>org.apache.commons.dbutils.QueryRunner â€” æ ¸å¿ƒç±»ï¼Œæ‰§è¡ŒSQLæŸ¥è¯¢ä»¥å¤„ç†ç»“æœé›†ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</li>
<li>org.apache.commons.dbutils.ResultSetHandler â€” ç»“æœé›†å°è£…å™¨</li>
<li>org.apache.commons.dbutils.DbUtils â€” æä¾›å¦‚åŠ è½½é©±åŠ¨ã€å…³é—­è¿æ¥ã€äº‹åŠ¡æäº¤ã€å›æ»šç­‰å¸¸è§„å·¥ä½œçš„å·¥å…·ç±»</li>
</ul>
<p>JdbcTemplateæ˜¯Springæä¾›çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯å¯¹åŸå§‹Jdbc APIå¯¹è±¡çš„ç®€å•å°è£…ï¼ŒåŸºæœ¬æ–¹æ³•ï¼š</p>
<ul>
<li>executeæ–¹æ³•</li>
<li>updateä¸batchUpdateæ–¹æ³•</li>
<li>queryä¸queryXXXæ–¹æ³•</li>
<li>callæ–¹æ³•</li>
</ul>
<p>DbUtilså¯¼çš„ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        dbutils--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        mysqlé©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        jdbcè¿æ¥æ± --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>JdbcTemplateå¯¼çš„ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        JdbcTemplate--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        å’Œäº‹åŠ¡ç›¸å…³--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        mysqlé©±åŠ¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="è¡¨çš„å®ä½“ç±»"><a href="#è¡¨çš„å®ä½“ç±»" class="headerlink" title="è¡¨çš„å®ä½“ç±»"></a>è¡¨çš„å®ä½“ç±»</h1><p>å®ç°Serializableæ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„å®ä½“ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Float money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get set toString</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="JdbcTemplateçš„æœ€åŸºæœ¬ç”¨æ³•"><a href="#JdbcTemplateçš„æœ€åŸºæœ¬ç”¨æ³•" class="headerlink" title="JdbcTemplateçš„æœ€åŸºæœ¬ç”¨æ³•"></a>JdbcTemplateçš„æœ€åŸºæœ¬ç”¨æ³•</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcTemplateDemo1</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å‡†å¤‡æ•°æ®æºï¼šspringçš„å†…ç½®æ•°æ®æº</span></span><br><span class="line">        DriverManagerDataSource ds = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        ds.setDriverClassName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        ds.setUrl(<span class="string">"jdbc:mysql://localhost:3306/groot?characterEncoding=utf8"</span>);</span><br><span class="line">        ds.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        ds.setPassword(<span class="string">"iamgroot"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.åˆ›å»ºJdbcTemplateå¯¹è±¡</span></span><br><span class="line">        JdbcTemplate jt = <span class="keyword">new</span> JdbcTemplate();</span><br><span class="line">        <span class="comment">// ç»™jtè®¾ç½®æ•°æ®æº</span></span><br><span class="line">        jt.setDataSource(ds);</span><br><span class="line">        <span class="comment">// 2.æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">        jt.execute(<span class="string">"insert into account(name,money) values('ccc',1000)"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œï¼Œæ²¡æœ‰é—®é¢˜</p>
<img src="/images/2020/screencapture2020-03-19PM3.57.43.jpg" width=200>

<p>ä½†æ˜¯è¿™æ ·å†™æ•°æ®åº“çš„é…ç½®éƒ½å†™æ­»äº†ï¼Œè€Œä¸”ç”¨äº†å¾ˆå¤šsetã€new</p>
<p>éƒ½å¯ä»¥é€šè¿‡IoCé…ç½®</p>
<h2 id="IoCé…ç½®"><a href="#IoCé…ç½®" class="headerlink" title="IoCé…ç½®"></a>IoCé…ç½®</h2><p>è¿™é‡ŒdataSourceæš‚æ—¶å…ˆç”¨Springå†…ç½®çš„ï¼ˆid=â€dataSourceâ€ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcTemplateDemo2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.è·å–å¯¹è±¡</span></span><br><span class="line">        JdbcTemplate jt = ac.getBean(<span class="string">"jdbcTemplate"</span>,JdbcTemplate<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">        jt.execute(<span class="string">"insert into account(name,money)values('ddd',2222)"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæ²¡é—®é¢˜</p>
<img src="/images/2020/screencapture2020-03-19PM4.04.17.jpg" width=200>

<h1 id="ä½¿ç”¨JdbcTemplateå®ç°åŸºæœ¬çš„CRUD"><a href="#ä½¿ç”¨JdbcTemplateå®ç°åŸºæœ¬çš„CRUD" class="headerlink" title="ä½¿ç”¨JdbcTemplateå®ç°åŸºæœ¬çš„CRUD"></a>ä½¿ç”¨JdbcTemplateå®ç°åŸºæœ¬çš„CRUD</h1><p>å¢åˆ æ”¹éƒ½æ˜¯updateæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¿å­˜</span></span><br><span class="line">jt.update(<span class="string">"insert into account(name,money)values(?,?)"</span>,<span class="string">"eee"</span>,<span class="number">3333f</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´æ–°</span></span><br><span class="line">jt.update(<span class="string">"update account set name=?,money=? where id=?"</span>,<span class="string">"test"</span>,<span class="number">4567</span>,<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤</span></span><br><span class="line">jt.update(<span class="string">"delete from account where id=?"</span>,<span class="number">8</span>);</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢æ˜¯query</p>
<p>queryæœ‰å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šé‡è½½çš„æ–¹æ³•ï¼Œæ‰¾çš„æ—¶å€™å…³æ³¨ä¸¤ä¸ªç‚¹ï¼šæˆ‘ä»¬æœ‰ä»€ä¹ˆï¼ˆå‚æ•°ï¼‰ã€æˆ‘ä»¬è¦ä»€ä¹ˆï¼ˆè¿”å›å€¼ï¼‰</p>
<p>æ¯”å¦‚æœ‰sqlè¯­å¥ã€å‚æ•°ï¼Œè¦è¿”å›ä¸€ä¸ªListï¼Œç­›é€‰å‡ºæ¥åŸºæœ¬å°±å‰©2ä¸ªäº†ï¼Œå®ƒä»¬ä¸€ä¸ªè¦ä¼ Object[] argsï¼Œä¸€ä¸ªæ˜¯Objectâ€¦ argsï¼Œæ˜¯é’ˆå¯¹ä¸åŒç‰ˆæœ¬çš„ï¼ˆå‰è€…æ‰€æœ‰ç‰ˆæœ¬å¯ç”¨ï¼Œåè€…jdk5ä¹‹åæ”¯æŒå¯å˜å‚æ•°å¯ç”¨ï¼‰</p>
<p>ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢æ‰€æœ‰</span></span><br><span class="line">List&lt;Account&gt; accounts = jt.query(<span class="string">"select * from account where money &gt; ?"</span>,<span class="keyword">new</span> AccountRowMapper(),<span class="number">1000f</span>);</span><br></pre></td></tr></table></figure>

<p>éœ€è¦å†™ä¸€ä¸ªAccountRowMapperç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰Accountçš„å°è£…ç­–ç•¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AccountRowMapper</span> <span class="keyword">implements</span> <span class="title">RowMapper</span>&lt;<span class="title">Account</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠç»“æœé›†ä¸­çš„æ•°æ®å°è£…åˆ°Accountä¸­ï¼Œç„¶åç”±springæŠŠæ¯ä¸ªAccountåŠ åˆ°é›†åˆä¸­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> rs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> rowNum</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> rowNum)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setId(rs.getInt(<span class="string">"id"</span>));</span><br><span class="line">        account.setName(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">        account.setMoney(rs.getFloat(<span class="string">"money"</span>));</span><br><span class="line">        <span class="keyword">return</span> account;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶é—®é¢˜æ¥äº†ï¼Œå¯¹æ¯”dbutilsä¸­çš„QueryRunner</p>
<img src="/images/2020/2020031902.png">

<p>ä¸åŒçš„åªæœ‰ResultSetHandlerå’ŒAccountRowMapperï¼Œä»å°è£…çš„è§’åº¦ä½œç”¨æ˜¯ä¸€æ ·çš„</p>
<p>ä»¥å‰æ˜¯ç”¨çš„dbutilsæä¾›çš„beanListHandlerå®ç°çš„</p>
<p>éš¾é“æœºæ™ºçš„Springæ²¡æœ‰è¿™ä¸ªå®ç°å—è¿˜è¦è‡ªå·±å†™ï¼Ÿ</p>
<p>æ˜¾ç„¶å¿…é¡»æœ‰ -&gt; BeanPropertyRowMapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢æ‰€æœ‰</span></span><br><span class="line"><span class="comment">// List&lt;Account&gt; accounts = jt.query("select * from account where money &gt; ?",new AccountRowMapper(),1000f);</span></span><br><span class="line">List&lt;Account&gt; accounts = jt.query(<span class="string">"select * from account where money &gt; ?"</span>,<span class="keyword">new</span> BeanPropertyRowMapper&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>),1000<span class="title">f</span>)</span>;</span><br><span class="line"><span class="keyword">for</span>(Account account : accounts)&#123;</span><br><span class="line">  System.out.println(account);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>èƒ½æŸ¥æ‰€æœ‰äº†ï¼ŒæŸ¥ä¸€ä¸ªä¹Ÿå·®ä¸å¤šï¼ˆå®é™…ä½¿ç”¨BeanPropertyRowMapperæ¯”è¾ƒå¤šï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢ä¸€ä¸ª</span></span><br><span class="line">List&lt;Account&gt; accounts = jt.query(<span class="string">"select * from account where id = ?"</span>,<span class="keyword">new</span> BeanPropertyRowMapper&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>),3)</span>;</span><br><span class="line">System.out.println(accounts.isEmpty()? <span class="string">"æ²¡æœ‰å†…å®¹"</span> :accounts.get(<span class="number">0</span>));</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰èšåˆ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢è¿”å›ä¸€è¡Œä¸€åˆ—ï¼ˆä½¿ç”¨èšåˆå‡½æ•°ï¼Œä½†ä¸åŠ group byå­å¥ï¼‰</span></span><br><span class="line">Long count = jt.queryForObject(<span class="string">"select count(*) from account where money &gt; ?"</span>,Long<span class="class">.<span class="keyword">class</span>,1000<span class="title">f</span>)</span>;</span><br><span class="line">System.out.println(count);</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šè¿”å›ç±»å‹ï¼ˆå‰ææ˜¯èƒ½è½¬ï¼Œä¸ºé˜²æº¢å‡ºä¸€èˆ¬ç”¨Longæ¥æ”¶ï¼‰</p>
<h1 id="JdbcTemplateåœ¨Daoä¸­çš„ä½¿ç”¨"><a href="#JdbcTemplateåœ¨Daoä¸­çš„ä½¿ç”¨" class="headerlink" title="JdbcTemplateåœ¨Daoä¸­çš„ä½¿ç”¨"></a>JdbcTemplateåœ¨Daoä¸­çš„ä½¿ç”¨</h1><p>å†™ä¸€ä¸ªIAccountDaoæ¥å£ï¼Œå®ç°ç±»ä¸­ç”¨ä¸Šé¢çš„æ–¹æ³•å®ŒæˆåŠŸèƒ½å³å¯</p>
<h2 id="JdbcDaoSupportçš„ä½¿ç”¨"><a href="#JdbcDaoSupportçš„ä½¿ç”¨" class="headerlink" title="JdbcDaoSupportçš„ä½¿ç”¨"></a>JdbcDaoSupportçš„ä½¿ç”¨</h2><p>æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœå®é™…å¼€å‘ä¸­æœ‰å¤šä¸ªDaoï¼Œæ¯ä¸ªå®ç°ç±»ä¸­éƒ½è¦è·å–JdbcTemplate</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJdbcTemplate</span><span class="params">(JdbcTemplate jdbcTemplate)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç ä¼šé‡å¤å¾ˆå¤šæ¬¡</p>
<p>å¯ä»¥å†™ä¸€ä¸ªJdbcDaoSupportç±»ç”¨äºæŠ½å–è¿™æ®µé‡å¤ä»£ç </p>
<p>å…¶å®ƒDaoImpç»§æ‰¿è¿™ä¸ªç±»ï¼Œgetå…¶ä¸­çš„jdbcTemplateï¼ŒdataSourceä¹Ÿåœ¨å…¶ä¸­è®¾ç½®å¥½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ­¤ç±»ç”¨äºæŠ½å–daoä¸­çš„é‡å¤ä»£ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcDaoSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJdbcTemplate</span><span class="params">(JdbcTemplate jdbcTemplate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JdbcTemplate <span class="title">getJdbcTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSource</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(jdbcTemplate == <span class="keyword">null</span>)&#123;</span><br><span class="line">            jdbcTemplate = createJdbcTemplate(dataSource);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> JdbcTemplate <span class="title">createJdbcTemplate</span><span class="params">(DataSource dataSource)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶ï¼ŒsetDataSourceçš„æ—¶å€™JdbcTemplateä¹Ÿæœ‰äº†</p>
<p>äºæ˜¯é…ç½®çš„æ—¶å€™å°±ä¸ç”¨é…JdbcTemplateäº†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®è´¦æˆ·çš„æŒä¹…å±‚--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.itheima.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--        &lt;property name="jdbcTemplate" ref="jdbcTemplate"&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®JdbcTemplate--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate"&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/bean&gt;--&gt;</span></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆé—®é¢˜åˆæ¥äº†</p>
<p>è‡ªå·±éƒ½èƒ½å†™å‡ºæ¥çš„ä¸œè¥¿Springæ˜¾ç„¶å¿…é¡»æœ‰</p>
<p>æŠŠè¿™ä¸ªè‡ªå·±å†™çš„JdbcDaoSupportæ³¨é‡Šæ‰ï¼Œè¿˜èƒ½è·‘ï¼Œä¸ºå•¥å‘¢</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.support.JdbcDaoSupport;</span><br></pre></td></tr></table></figure>

<p>è‡ªåŠ¨å¯¼å…¥äº†Springçš„JdbcDaoSupport</p>
<p>æ‰“å¼€è¿™ä¸ªç±»çœ‹ä¸€ä¸‹ï¼Œå°±æœ‰JdbcTemplateï¼Œæœ‰setDataSourceæ–¹æ³•ï¼Œæœ‰ä¸Šé¢ä¸€å †</p>
<p>æ‰€ä»¥ä¸éœ€è¦è‡ªå·±å†™ï¼Œç»§æ‰¿å°±å®Œäº‹</p>
<p>ç»§æ‰¿å®ƒçš„ç›®çš„å°±æ˜¯åœ¨æœ‰å¤šä¸ªDaoæ—¶å»é™¤é‡å¤ä»£ç </p>
<p>ä½†æ˜¯ç”±äºæºç ä¸èƒ½åŠ¨ï¼Œå°±ä¸å¥½é€šè¿‡æ³¨è§£é…ç½®äº†ï¼Œè‡ªå·±å†™å’Œç›´æ¥ç»§æ‰¿çš„åŒºåˆ«å°±åœ¨äºè¿™é‡Œï¼Œéœ€è¦æƒè¡¡</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°å½•å‡ ä¸ªè®©æˆ‘å¿ƒåŠ¨çš„è®¾è®¡</title>
    <url>/2020/03/18/aha/</url>
    <content><![CDATA[<h1 id="Trelloçš„åˆ—è¡¨å®Œæˆæœ€åä¸€ä¸ªæ—¶ä¼šæ‰­åŠ¨ï½è¿˜æœ‰ä¸åŒçš„æ‘‡æ‘†æ–¹å¼ï¼"><a href="#Trelloçš„åˆ—è¡¨å®Œæˆæœ€åä¸€ä¸ªæ—¶ä¼šæ‰­åŠ¨ï½è¿˜æœ‰ä¸åŒçš„æ‘‡æ‘†æ–¹å¼ï¼" class="headerlink" title="Trelloçš„åˆ—è¡¨å®Œæˆæœ€åä¸€ä¸ªæ—¶ä¼šæ‰­åŠ¨ï½è¿˜æœ‰ä¸åŒçš„æ‘‡æ‘†æ–¹å¼ï¼"></a>Trelloçš„åˆ—è¡¨å®Œæˆæœ€åä¸€ä¸ªæ—¶ä¼šæ‰­åŠ¨ï½è¿˜æœ‰ä¸åŒçš„æ‘‡æ‘†æ–¹å¼ï¼</h1><img src="/images/2020/Mar-18-2020 22-56-56.gif" width=400>
<img src="/images/2020/Mar-18-2020 22-56-19.gif" width=400>
<img src="/images/2020/Mar-18-2020 22-57-26.gif" width=400>
å•ŠTrelloæˆ‘çš„â¤ï¸ï¼

<h1 id="ä¼é¹…å²›é‡Œçš„ä¼é¹…ä¼šæŠŠèŠ±ç”°é‡Œçš„èŠ±å¼å‡ºæ¥ç§ï½"><a href="#ä¼é¹…å²›é‡Œçš„ä¼é¹…ä¼šæŠŠèŠ±ç”°é‡Œçš„èŠ±å¼å‡ºæ¥ç§ï½" class="headerlink" title="ä¼é¹…å²›é‡Œçš„ä¼é¹…ä¼šæŠŠèŠ±ç”°é‡Œçš„èŠ±å¼å‡ºæ¥ç§ï½"></a>ä¼é¹…å²›é‡Œçš„ä¼é¹…ä¼šæŠŠèŠ±ç”°é‡Œçš„èŠ±å¼å‡ºæ¥ç§ï½</h1><img src="/images/2020/20200318_233535.gif" width=300>
å¤©å‘æˆ‘éœ€è¦ä¸€ä¸ªé«˜æ¸…çš„å½•å±app -MARK-]]></content>
      <categories>
        <category>Memo</category>
      </categories>
  </entry>
  <entry>
    <title>Vueç¬”è®°07 æ€»ç»“</title>
    <url>/2020/03/17/note-vue-07/</url>
    <content><![CDATA[<p>è¿™ä¸ªæ•™ç¨‹6på­¦å®Œäº†ï½æ€»ç»“ä¸€ä¸‹è¿™ä¸ªå›¾ä¹¦å¢åˆ æ”¹æŸ¥çš„demo</p>
<blockquote>
<p><a href="https://www.bilibili.com/video/av85793766" target="_blank" rel="noopener">https://www.bilibili.com/video/av85793766</a></p>
</blockquote>
<hr>
<p><a href="/2020/03/06/note-vue-02/">å·¥ç¨‹åˆ›å»º</a>ç•¥<br>æ•°æ®åº“éƒ¨åˆ†ç•¥</p>
<h1 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h1><h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/screencapture2020-03-17PM5.44.27.jpg" width=400>

<ul>
<li>Book å®ä½“ç±»</li>
<li>BookRepository ç»§æ‰¿JpaRepositoryï¼Œæä¾›æ•°æ®åº“å¢åˆ æ”¹æŸ¥æ¥å£</li>
<li>BookHandler ç›¸åº”è¯·æ±‚</li>
<li>BookRepositoryTest æµ‹è¯•BookRepositoryçš„æ–¹æ³•</li>
</ul>
<h2 id="Book"><a href="#Book" class="headerlink" title="Book"></a>Book</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.bookstore_server.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span> <span class="comment">// æ ¹æ®ç±»åå’Œè¡¨åå¯¹åº”ç»‘å®š</span></span><br><span class="line"><span class="meta">@Data</span>   <span class="comment">// è‡ªåŠ¨ç”Ÿæˆget/set</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="comment">// ä¸»é”®</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY) <span class="comment">// idè‡ªå¢</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BookRepository"><a href="#BookRepository" class="headerlink" title="BookRepository"></a>BookRepository</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.bookstore_server.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coconutnut.bookstore_server.entity.Book;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &lt;&gt;ä¸­ç¬¬ä¸€ä¸ªæ˜¯å®ä½“ç±»ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸»é”®ç±»å‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Book</span>,<span class="title">Integer</span>&gt; </span>&#123; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JpaRepositoryä¸­æœ‰å¸¸ç”¨çš„å¢åˆ æ”¹æŸ¥æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨</p>
<p>&amp; é€šå¸¸æµç¨‹ï¼šå…ˆåœ¨Testä¸­æµ‹è¯•æ–¹æ³•ï¼Œæ²¡é—®é¢˜åœ¨Controllerä¸­å†™å¯¹å¤–æ¥å£ï¼Œæµè§ˆå™¨çœ‹ä¸€ä¸‹è¿”å›å€¼å¯¹ä¸å¯¹ï¼Œæœ€åå†™å‰ç«¯</p>
<p>Springå·¥ç¨‹è‡ªå¸¦ä¸€ä¸ªæµ‹è¯•ç±»BookstoreServerApplicationTests<br>è‡ªå·±åˆ›å»ºå¯åœ¨æ¥å£åä¸Šå³é”®-&gt;Go To-&gt;Test-&gt;Create New Test<br>ç”Ÿæˆçš„æµ‹è¯•ç±»åŠ @SpringBootTestï¼Œè¦æµ‹è¯•çš„ç±»@Autowiredè‡ªåŠ¨æ³¨å…¥ï¼Œå†™çš„æ–¹æ³•åŠ @Testå³å¯</p>
<h2 id="BookHandler"><a href="#BookHandler" class="headerlink" title="BookHandler"></a>BookHandler</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coconutnut.bookstore_server.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coconutnut.bookstore_server.entity.Book;</span><br><span class="line"><span class="keyword">import</span> com.coconutnut.bookstore_server.repository.BookRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/book"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥æ‰€æœ‰ä¹¦</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookRepository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥ä¸€é¡µ</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll/&#123;page&#125;/&#123;size&#125;"</span>)</span><br><span class="line">    <span class="comment">// @PathVariableè·å–å‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Page&lt;Book&gt; <span class="title">findAll</span><span class="params">(@PathVariable(<span class="string">"page"</span>)</span> Integer page,@<span class="title">PathVariable</span><span class="params">(<span class="string">"size"</span>)</span> Integer size)</span>&#123;</span><br><span class="line">        PageRequest pageRequest = PageRequest.of(page,size);</span><br><span class="line">        <span class="keyword">return</span> bookRepository.findAll(pageRequest);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–°å¢</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line">    <span class="comment">// @RequestBodyæŠŠjsonæ ¼å¼è½¬æˆjavaå¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">(@RequestBody Book book)</span></span>&#123;</span><br><span class="line">        Book result = bookRepository.save(book);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥ä¸€ä¸ª</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findById/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Book <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookRepository.findById(id).get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹</span></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(@RequestBody Book book)</span></span>&#123;</span><br><span class="line">        Book result = bookRepository.save(book);</span><br><span class="line">        <span class="keyword">if</span>(result != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤</span></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/deleteById/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">        bookRepository.deleteById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h1><h2 id="é¡¹ç›®ç»“æ„-1"><a href="#é¡¹ç›®ç»“æ„-1" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/screencapture2020-03-17PM5.46.22.jpg"  width=400>

<ul>
<li>Index.js é…è·¯ç”±</li>
<li>App.vue å¸¸é©»çš„é¡µé¢</li>
<li>å…¶å®ƒvue åµŒå…¥çš„é¡µé¢</li>
</ul>
<h2 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h2><p>é…ç½®é¡µé¢çš„ä»å±å…³ç³»ä¸è·¯å¾„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="keyword">import</span> Index <span class="keyword">from</span> <span class="string">"../views/Index"</span>;</span><br><span class="line"><span class="keyword">import</span> BookManage <span class="keyword">from</span> <span class="string">'../views/BookManage'</span></span><br><span class="line"><span class="keyword">import</span> AddBook <span class="keyword">from</span> <span class="string">'../views/AddBook'</span></span><br><span class="line"><span class="keyword">import</span> BookUpdate <span class="keyword">from</span> <span class="string">'../views/BookUpdate'</span></span><br><span class="line"></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'å›¾ä¹¦ç®¡ç†'</span>,</span><br><span class="line">    show: <span class="literal">true</span>,</span><br><span class="line">    component:Index,</span><br><span class="line">    redirect:<span class="string">'book-manage'</span>,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/book-manage'</span>,</span><br><span class="line">        name: <span class="string">'æŸ¥è¯¢å›¾ä¹¦'</span>,</span><br><span class="line">        component: BookManage</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/add-book'</span>,</span><br><span class="line">        name: <span class="string">'æ·»åŠ å›¾ä¹¦'</span>,</span><br><span class="line">        component: AddBook</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/book-update'</span>,</span><br><span class="line">    name: <span class="string">'ä¿®æ”¹'</span>,</span><br><span class="line">    show: <span class="literal">false</span>,</span><br><span class="line">    component: BookUpdate</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  mode: <span class="string">'history'</span>,</span><br><span class="line">  base: process.env.BASE_URL,</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<h2 id="é¡µé¢åµŒå¥—ä¸è·³è½¬"><a href="#é¡µé¢åµŒå¥—ä¸è·³è½¬" class="headerlink" title="é¡µé¢åµŒå¥—ä¸è·³è½¬"></a>é¡µé¢åµŒå¥—ä¸è·³è½¬</h2><p>App.vueä¸­templateç»“æ„</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-aside</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-menu</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+------------------------------------+ </span><br><span class="line">| App                                |  </span><br><span class="line">| +------+-------------------------+ | </span><br><span class="line">| | menu | main                    | |  </span><br><span class="line">| |      | +---------------------+ | |  </span><br><span class="line">| |      | | router-view         | | | </span><br><span class="line">| |      | +---------------------+ | |  </span><br><span class="line">| +------+-------------------------+ | </span><br><span class="line">+------------------------------------+</span><br></pre></td></tr></table></figure>

<p>å·¦ä¾§asideåŒºåŸŸä¸­æ”¾menuï¼Œå³ä¾§mainä¸­ç”±routeråŠ¨æ€åŠ è½½</p>
<p>Index.vueä¸­templateç»“æ„</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Index.vueä¸­å…¶å®ƒéƒ½æ˜¯é»˜è®¤çš„</p>
<p>æ ¹æ®index.jsä¸­çš„é…ç½®ï¼Œâ€™/â€˜å°±åŠ è½½Index.vueåˆ°App.vueçš„router-viewåŒºåŸŸï¼Œå†â€™/book-manageâ€™åŠ è½½Index.vueçš„router-viewåŒºåŸŸã€‚è€ŒIndexé‡å®šå‘åˆ°book-manageï¼Œäºæ˜¯â€™http:localhost:4000/â€˜é»˜è®¤å°±æ˜¾ç¤ºäº†book-manage</p>
<p>è€Œâ€™/book-updateâ€™åŠ è½½Update.vueåˆ°App.vueçš„router-viewåŒºåŸŸ</p>
<p>æ•…æ˜¾ç¤ºæ‰€æœ‰å­é¡µé¢çš„æ—¶å€™éƒ½å¯ä»¥çœ‹åˆ°èœå•</p>
<h2 id="æ ¹æ®routesé…ç½®åŠ¨æ€åŠ è½½èœå•æ -gt-App-vue"><a href="#æ ¹æ®routesé…ç½®åŠ¨æ€åŠ è½½èœå•æ -gt-App-vue" class="headerlink" title="æ ¹æ®routesé…ç½®åŠ¨æ€åŠ è½½èœå•æ  -&gt; App.vue"></a>æ ¹æ®routesé…ç½®åŠ¨æ€åŠ è½½èœå•æ  -&gt; App.vue</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">style</span>=<span class="string">"height: 500px; border: 1px solid #eee"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">"200px"</span> <span class="attr">style</span>=<span class="string">"background-color: rgb(238, 241, 246)"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--            è¿™é‡Œæ·»åŠ routeræ ‡ç­¾ï¼Œel-menu-itemçš„indexå°±ä¼šè¢«ä½œä¸ºrouterè·¯å¾„--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-menu</span> <span class="attr">router</span> <span class="attr">:default-openeds</span>=<span class="string">"['0','1']"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--          showå±æ€§ä¸ºtrueåˆ™éå†--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in $router.options.routes"</span> <span class="attr">:index</span>=<span class="string">"index+''"</span> <span class="attr">v-if</span>=<span class="string">"item.show"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-setting"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--                    æ¡ä»¶åˆ¤æ–­å½“å‰è·¯å¾„æ˜¯å¦ç­‰äºindexï¼Œæ›´æ”¹é€‰ä¸­çŠ¶æ€ï¼Œä¸»è¦æ˜¯åœ¨åˆå§‹åŒ–æ—¶å¢åŠ é»˜è®¤çš„é€‰ä¸­çŠ¶æ€--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">v-for</span>=<span class="string">"item2 in item.children"</span> <span class="attr">:index</span>=<span class="string">"item2.path"</span> <span class="attr">:class</span>=<span class="string">"$route.path==item2.path ? 'is-active' : ''"</span>&gt;</span>&#123;&#123;item2.name&#125;&#125;<span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--            ä¸Šé¢åˆindexç¡®å®šçš„routerè¢«æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯mainåŒºåŸŸä¸­--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'app'</span>,</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-id">#app</span> &#123;</span></span><br><span class="line">  font-family: 'Avenir', Helvetica, Arial, sans-serif;</span><br><span class="line">  -webkit-font-smoothing: antialiased;</span><br><span class="line">  -moz-osx-font-smoothing: grayscale;</span><br><span class="line">  text-align: center;</span><br><span class="line"><span class="css">  <span class="selector-tag">color</span>: <span class="selector-id">#2c3e50</span>;</span></span><br><span class="line">  margin-top: 60px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="è¡¨å•æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±ã€ç¿»é¡µã€åˆ é™¤-gt-BookManage-vue"><a href="#è¡¨å•æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±ã€ç¿»é¡µã€åˆ é™¤-gt-BookManage-vue" class="headerlink" title="è¡¨å•æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±ã€ç¿»é¡µã€åˆ é™¤ -&gt; BookManage.vue"></a>è¡¨å•æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±ã€ç¿»é¡µã€åˆ é™¤ -&gt; BookManage.vue</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:data</span>=<span class="string">"tableData"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">border</span></span></span><br><span class="line"><span class="tag">            <span class="attr">style</span>=<span class="string">"width: 100%"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">                <span class="attr">fixed</span></span></span><br><span class="line"><span class="tag">                <span class="attr">prop</span>=<span class="string">"id"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">label</span>=<span class="string">"ç¼–å·"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">width</span>=<span class="string">"150"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">                <span class="attr">prop</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">label</span>=<span class="string">"ä¹¦å"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">width</span>=<span class="string">"150"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">                <span class="attr">prop</span>=<span class="string">"author"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">label</span>=<span class="string">"ä½œè€…"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">width</span>=<span class="string">"150"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                fixed="right"--&gt;</span></span><br><span class="line">                label="æ“ä½œ"</span><br><span class="line">                width="100"&gt;</span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"edit(scope.row)"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>ä¿®æ”¹<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"deleteBook(scope.row)"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">            <span class="attr">background</span></span></span><br><span class="line"><span class="tag">            <span class="attr">layout</span>=<span class="string">"prev, pager, next"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:page-size</span>=<span class="string">"pageSize"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:total</span>=<span class="string">"total"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">current-change</span>=<span class="string">"clickPage"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">// åˆ é™¤</span></span></span><br><span class="line">            deleteBook(row) &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">const</span> _this = <span class="keyword">this</span></span></span><br><span class="line"><span class="actionscript">                axios.delete(<span class="string">'http://localhost:8181/book/deleteById/'</span>+row.id).then(<span class="function"><span class="keyword">function</span><span class="params">(resp)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="comment">// è¿™é‡Œæ²¡æœ‰ç®¡è¿”å›ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–­çŠ¶æ€ï¼Œ200å°±æ˜¯æˆåŠŸ</span></span></span><br><span class="line"><span class="actionscript">                    _this.$alert(<span class="string">'ã€Š'</span>+row.name+<span class="string">'ã€‹åˆ é™¤æˆåŠŸï¼'</span>, <span class="string">'æ¶ˆæ¯'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">                        confirmButtonText: <span class="string">'ç¡®å®š'</span>,</span></span><br><span class="line"><span class="javascript">                        callback: <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">                            <span class="comment">// åˆ·æ–°</span></span></span><br><span class="line"><span class="javascript">                            <span class="built_in">window</span>.location.reload()</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            <span class="comment">// è·³è½¬åˆ°ç¼–è¾‘</span></span></span><br><span class="line">            edit(row) &#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">// this.$router.push('/book-update')</span></span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$router.push(&#123;</span></span><br><span class="line"><span class="actionscript">                    path: <span class="string">'/book-update'</span>,</span></span><br><span class="line">                    query: &#123;</span><br><span class="line">                        id: row.id</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            <span class="comment">// ç¿»é¡µ</span></span></span><br><span class="line">            clickPage(index)&#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">const</span> _this = <span class="keyword">this</span></span></span><br><span class="line"><span class="actionscript">                axios.get(<span class="string">'http://localhost:8181/book/findAll/'</span>+(index<span class="number">-1</span>)+<span class="string">'/6'</span>).then(<span class="function"><span class="keyword">function</span><span class="params">(resp)</span></span>&#123;</span></span><br><span class="line">                    _this.tableData = resp.data.content</span><br><span class="line">                    _this.pageSize = resp.data.size</span><br><span class="line">                    _this.total = resp.data.totalElements</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        data() &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">                pageSize:<span class="string">'6'</span>,</span></span><br><span class="line"><span class="actionscript">                total:<span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">                tableData:<span class="string">''</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// åŠ è½½ä¹¦ç±ä¿¡æ¯åˆ°è¡¨å•</span></span></span><br><span class="line">        created()&#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> _this = <span class="keyword">this</span></span></span><br><span class="line"><span class="actionscript">            axios.get(<span class="string">'http://localhost:8181/book/findAll/0/6'</span>).then(<span class="function"><span class="keyword">function</span><span class="params">(resp)</span></span>&#123;</span></span><br><span class="line">                _this.tableData = resp.data.content</span><br><span class="line">                _this.pageSize = resp.data.size</span><br><span class="line">                _this.total = resp.data.totalElements</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¢-gt-AddBook-vue"><a href="#æ–°å¢-gt-AddBook-vue" class="headerlink" title="æ–°å¢ -&gt; AddBook.vue"></a>æ–°å¢ -&gt; AddBook.vue</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    modelè®¾ç½®æ•°æ®ç»‘å®šï¼Œrulesè®¾ç½®æ ¡éªŒè§„åˆ™ï¼Œrefæ˜¯åå­—ï¼Œåœ¨æäº¤æ—¶ä½¿ç”¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-form</span> <span class="attr">style</span>=<span class="string">"width: 60%"</span> <span class="attr">:model</span>=<span class="string">"ruleForm"</span> <span class="attr">:rules</span>=<span class="string">"rules"</span> <span class="attr">ref</span>=<span class="string">"ruleForm"</span> <span class="attr">label-width</span>=<span class="string">"100px"</span> <span class="attr">class</span>=<span class="string">"demo-ruleForm"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ä¹¦å"</span> <span class="attr">prop</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ä½œè€…"</span> <span class="attr">prop</span>=<span class="string">"author"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.author"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"submitForm('ruleForm')"</span>&gt;</span>ç«‹å³åˆ›å»º<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"resetForm('ruleForm')"</span>&gt;</span>é‡ç½®<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        data() &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line">                ruleForm: &#123;</span><br><span class="line"><span class="actionscript">                    name: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">                    author: <span class="string">''</span>,</span></span><br><span class="line">                &#125;,</span><br><span class="line">                rules: &#123;</span><br><span class="line">                    name: [</span><br><span class="line"><span class="actionscript">                        &#123; required: <span class="literal">true</span>, message: <span class="string">'è¯·è¾“å…¥ä¹¦å'</span>, trigger: <span class="string">'blur'</span> &#125;,</span></span><br><span class="line">                    ],</span><br><span class="line">                    author: [</span><br><span class="line"><span class="actionscript">                        &#123; required: <span class="literal">true</span>, message: <span class="string">'è¯·è¾“å…¥ä½œè€…'</span>, trigger: <span class="string">'blur'</span> &#125;,</span></span><br><span class="line">                    ],</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">// æäº¤è¡¨å•</span></span></span><br><span class="line">            submitForm(formName) &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">const</span> _this = <span class="keyword">this</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.$refs[formName].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line">                    if (valid) &#123;</span><br><span class="line"><span class="actionscript">                        axios.post(<span class="string">'http://localhost:8181/book/save'</span>,<span class="keyword">this</span>.ruleForm).then(<span class="function"><span class="keyword">function</span><span class="params">(resp)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                            <span class="keyword">if</span>(resp.data == <span class="string">'success'</span>)&#123;</span></span><br><span class="line">                                _this.$message(&#123;</span><br><span class="line"><span class="actionscript">                                    message: <span class="string">'ã€Š'</span>+_this.ruleForm.name+<span class="string">'ã€‹'</span>+<span class="string">'æ·»åŠ æˆåŠŸ'</span>,</span></span><br><span class="line"><span class="actionscript">                                    type: <span class="string">'success'</span></span></span><br><span class="line">                                &#125;)</span><br><span class="line"><span class="actionscript">                                _this.$router.push(<span class="string">'/book-manage'</span>)</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            <span class="comment">// é‡ç½®è¡¨å•</span></span></span><br><span class="line">            resetForm(formName) &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$refs[formName].resetFields();</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹-gt-BookUpdate-vue"><a href="#ä¿®æ”¹-gt-BookUpdate-vue" class="headerlink" title="ä¿®æ”¹ -&gt;  BookUpdate.vue"></a>ä¿®æ”¹ -&gt;  BookUpdate.vue</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    modelè®¾ç½®æ•°æ®ç»‘å®šï¼Œrulesè®¾ç½®æ ¡éªŒè§„åˆ™ï¼Œrefæ˜¯åå­—ï¼Œåœ¨æäº¤æ—¶ä½¿ç”¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">style</span>=<span class="string">"width: 60%"</span> <span class="attr">:model</span>=<span class="string">"ruleForm"</span> <span class="attr">:rules</span>=<span class="string">"rules"</span> <span class="attr">ref</span>=<span class="string">"ruleForm"</span> <span class="attr">label-width</span>=<span class="string">"100px"</span> <span class="attr">class</span>=<span class="string">"demo-ruleForm"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ç¼–å·"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.id"</span> <span class="attr">readonly</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ä¹¦å"</span> <span class="attr">prop</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ä½œè€…"</span> <span class="attr">prop</span>=<span class="string">"author"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.author"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"submitForm('ruleForm')"</span>&gt;</span>ä¿®æ”¹<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"submitForm('ruleForm')"</span>&gt;</span>é‡ç½®<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        data() &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line">                ruleForm: &#123;</span><br><span class="line"><span class="actionscript">                    id: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">                    name: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">                    author: <span class="string">''</span>,</span></span><br><span class="line">                &#125;,</span><br><span class="line">                rules: &#123;</span><br><span class="line">                    name: [</span><br><span class="line"><span class="actionscript">                        &#123; required: <span class="literal">true</span>, message: <span class="string">'è¯·è¾“å…¥ä¹¦å'</span>, trigger: <span class="string">'blur'</span> &#125;,</span></span><br><span class="line">                    ],</span><br><span class="line">                    author: [</span><br><span class="line"><span class="actionscript">                        &#123; required: <span class="literal">true</span>, message: <span class="string">'è¯·è¾“å…¥ä½œè€…'</span>, trigger: <span class="string">'blur'</span> &#125;,</span></span><br><span class="line">                    ],</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">// æäº¤è¡¨å•</span></span></span><br><span class="line">            submitForm(formName) &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">const</span> _this = <span class="keyword">this</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.$refs[formName].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line">                    if (valid) &#123;</span><br><span class="line"><span class="actionscript">                        axios.put(<span class="string">'http://localhost:8181/book/update'</span>,<span class="keyword">this</span>.ruleForm).then(<span class="function"><span class="keyword">function</span><span class="params">(resp)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                            <span class="keyword">if</span>(resp.data == <span class="string">'success'</span>)&#123;</span></span><br><span class="line">                                _this.$message(&#123;</span><br><span class="line"><span class="actionscript">                                    message: <span class="string">'ã€Š'</span>+_this.ruleForm.name+<span class="string">'ã€‹'</span>+<span class="string">'ä¿®æ”¹æˆåŠŸ'</span>,</span></span><br><span class="line"><span class="actionscript">                                    type: <span class="string">'success'</span></span></span><br><span class="line">                                &#125;)</span><br><span class="line"><span class="actionscript">                                _this.$router.push(<span class="string">'/book-manage'</span>)</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            resetForm(formName) &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.$refs[formName].resetFields();</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        <span class="comment">// å¡«å…¥åˆå§‹ä¿¡æ¯</span></span></span><br><span class="line">        created()&#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">// æ˜¯routeä¸æ˜¯router!</span></span></span><br><span class="line"><span class="actionscript">            <span class="comment">// alert(this.$route.query.id)</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> _this = <span class="keyword">this</span></span></span><br><span class="line"><span class="actionscript">            axios.get(<span class="string">'http://localhost:8181/book/findById/'</span>+<span class="keyword">this</span>.$route.query.id).then(<span class="function"><span class="keyword">function</span><span class="params">(resp)</span></span>&#123;</span></span><br><span class="line">                _this.ruleForm = resp.data</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="ä¸€ç‚¹æƒ³æ³•"><a href="#ä¸€ç‚¹æƒ³æ³•" class="headerlink" title="ä¸€ç‚¹æƒ³æ³•"></a>ä¸€ç‚¹æƒ³æ³•</h1><p>Spring Boot + Vue çœŸæ˜¯å¥½æ–¹ä¾¿</p>
<p>åç«¯åŸºæœ¬ä¸ç”¨å†™ä»€ä¹ˆï¼Œè¦ç”¨çš„æ–¹æ³•éƒ½æœ‰</p>
<p>å‰ç«¯è¦ä»€ä¹ˆæ¨¡ç‰ˆç›´æ¥åœ¨element uié‡Œæ‰¾æ¥ç”¨</p>
<p>è·Ÿç€æ•²è¿™ä¸ªdemoçš„æ—¶å€™ç¢°åˆ°çš„å‘åŸºæœ¬éƒ½æ˜¯å’Œè·¯ç”±æœ‰å…³çš„ï¼Œrouterè½¬æ¥è½¬å»æœ‰ç‚¹æ™•</p>
<p>ä½†æ˜¯ æ€»ä¹‹</p>
<p>æˆ‘çœŸçš„ä»æ¥æ²¡æœ‰åœ¨å“ªä¸ªæ•™ç¨‹å¬è§è¿™ä¹ˆå¤šâ€œå°±è¡Œäº†â€ã€â€œè‡ªåŠ¨â€ã€â€œä¸ç”¨ç®¡äº†â€â€¦æåº¦èˆ’é€‚ï¼æœ‰æ¶å­ä¸ç”¨å¾’æ‰‹çˆ¬å¢™çœŸå¥½</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueç¬”è®°06 ä¿®æ”¹å’Œåˆ é™¤</title>
    <url>/2020/03/17/note-vue-06/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av85793766?p=6" target="_blank" rel="noopener">https://www.bilibili.com/video/av85793766?p=6</a></p>
</blockquote>
<h1 id="è·³è½¬åˆ°ä¿®æ”¹é¡µé¢"><a href="#è·³è½¬åˆ°ä¿®æ”¹é¡µé¢" class="headerlink" title="è·³è½¬åˆ°ä¿®æ”¹é¡µé¢"></a>è·³è½¬åˆ°ä¿®æ”¹é¡µé¢</h1><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;template slot-scope=<span class="string">"scope"</span>&gt;</span><br><span class="line">  &lt;el-button @click="edit(scope.row)" type="text" size="small"&gt;ä¿®æ”¹&lt;/el-button&gt;</span><br><span class="line">  &lt;el-button type="text" size="small"&gt;åˆ é™¤&lt;/el-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>@clickä¸­ç»‘å®šç‚¹å‡»äº‹ä»¶</p>
<p>è¿™é‡Œè·³è½¬ç”¨thisè€Œä¸éœ€è¦_thisï¼Œå› ä¸ºä¸åœ¨å›è°ƒå‡½æ•°ä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">edit(row) &#123;</span><br><span class="line">	this.$router.push(&#39;&#x2F;book-update&#39;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>DEBUG</strong></p>
<p>è¿™é‡Œè·³è½¬è¿‡å»ä¹‹åï¼Œæ•´é¡µéƒ½æ˜¯ä¿®æ”¹é¡µé¢ï¼Œå·¦ä¾§èœå•æ²¡æœ‰äº†</p>
<p>å’Œæºç å¯¹æ¯”ï¼Œå‘ç°å·¦ä¾§èœå•çš„ä»£ç æ”¾åœ¨App.vueè€Œä¸æ˜¯Index.vue æˆ‘å¤±å¿†äº†ï¼Ÿ</p>
<p>ä¸è¿‡ä¹Ÿå°±å¯ä»¥è§£é‡Šäº†ï¼ŒåŠ è½½ç®¡ç†ã€æ–°å¢å’Œä¿®æ”¹æ›¿æ¢çš„æ˜¯mainé‡Œçš„Indexéƒ¨åˆ†ï¼Œä¸ç®¡æ€ä¹ˆæ›¿æ¢èœå•éƒ½è¿˜åœ¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+------------------------------------+ </span><br><span class="line">| App                                |  </span><br><span class="line">| +------+-------------------------+ | </span><br><span class="line">| | menu | main                    | |  </span><br><span class="line">| |      | +---------------------+ | |  </span><br><span class="line">| |      | | Index               | | | </span><br><span class="line">| |      | +---------------------+ | |  </span><br><span class="line">| +------+-------------------------+ | </span><br><span class="line">+------------------------------------+</span><br></pre></td></tr></table></figure>

<p>è€Œæˆ‘çš„æŠŠmenuå†™åœ¨Indexé‡Œé¢ï¼Œç®¡ç†å’Œæ–°å¢æ›¿æ¢çš„æ˜¯Indexé‡Œçš„mainåŒºåŸŸï¼Œmenuè¿˜åœ¨ï¼Œè€Œä¿®æ”¹ç›´æ¥æŠŠIndexæ¢æ‰äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+------------------------------------+ </span><br><span class="line">| App                                |  </span><br><span class="line">| +--------------------------------+ | </span><br><span class="line">| | Index                          | |  </span><br><span class="line">| | +------+---------------------+ | |  </span><br><span class="line">| | | menu | main                | | | </span><br><span class="line">| | +------+---------------------+ | |  </span><br><span class="line">| +--------------------------------+ | </span><br><span class="line">+------------------------------------+</span><br></pre></td></tr></table></figure>

<p>æ”¹è¿‡æ¥ä¹‹åé¡µé¢å°±æ­£å¸¸äº†</p>
<hr>
<h1 id="ä¿®æ”¹é¡µé¢"><a href="#ä¿®æ”¹é¡µé¢" class="headerlink" title="ä¿®æ”¹é¡µé¢"></a>ä¿®æ”¹é¡µé¢</h1><p>å…ˆæŠŠæ–°å¢ç•Œé¢è¡¨å•å¤åˆ¶è¿‡å»</p>
<p>åœ¨createdæ–¹æ³•ä¸­è°ƒåå°æ•°æ®ï¼Œæ˜¾ç¤ºåˆ°é¡µé¢</p>
<p>é¦–å…ˆéœ€è¦è·å–å½“å‰çš„idï¼ŒBookManageé¡µé¢åœ¨routerä¸­å¸¦å‚æ•°ç©¿è¿‡å»</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">edit(row) &#123;</span><br><span class="line">  <span class="comment">// this.$router.push('/book-update')</span></span><br><span class="line">  <span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">    path: <span class="string">'/book-update'</span>,</span><br><span class="line">    query: &#123;</span><br><span class="line">    	id: row.id</span><br><span class="line">  	&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>BookUpdateé¡µé¢ä¸­æ¥æ”¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  submitForm(formName) &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;,</span><br><span class="line">    resetForm(formName) &#123;</span><br><span class="line">      <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">created()&#123;</span><br><span class="line">    <span class="comment">// æ˜¯routeä¸æ˜¯router!</span></span><br><span class="line">    alert(<span class="keyword">this</span>.$route.query.id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œcreated()åœ¨methodså¤–é¢</p>
<h1 id="è·å–å¾…ä¿®æ”¹ä¿®æ”¹å›¾ä¹¦ä¿¡æ¯"><a href="#è·å–å¾…ä¿®æ”¹ä¿®æ”¹å›¾ä¹¦ä¿¡æ¯" class="headerlink" title="è·å–å¾…ä¿®æ”¹ä¿®æ”¹å›¾ä¹¦ä¿¡æ¯"></a>è·å–å¾…ä¿®æ”¹ä¿®æ”¹å›¾ä¹¦ä¿¡æ¯</h1><h2 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h2><p>Repositoryçš„findById()è¿”å›çš„æ˜¯Optionç±»ï¼Œç›¸å½“äºæŠŠBookåˆåŒ…äº†ä¸€å±‚ï¼Œå†ç”¨get()å¾—åˆ°Bookå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findById</span><span class="params">()</span></span>&#123;</span><br><span class="line">  Book book = repository.findById(<span class="number">1</span>).get();</span><br><span class="line">  System.out.println(book);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆæµ‹è¯•ä¸€ä¸‹ï¼Œæ¥å£æ²¡æœ‰é—®é¢˜ï¼Œå†å†™å¯¹å¤–æä¾›çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/findById/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Book <span class="title">findById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> bookRepository.findById(id).get();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¯¹æ¥"><a href="#å¯¹æ¥" class="headerlink" title="å¯¹æ¥"></a>å¯¹æ¥</h2><p>è·å–æ•°æ®å¹¶ç»‘å®šåˆ°è¡¨å•ä¸Š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">created()&#123;</span><br><span class="line">  <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">  axios.get(<span class="string">'http://localhost:8181/book/findById/'</span>+<span class="keyword">this</span>.$route.query.id).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">    _this.ruleForm = resp.data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¡¨å•åŠ ä¸€ä¸ªidå±æ€§</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ç¼–å·"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.id"</span> <span class="attr">readonly</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸å¯ä¿®æ”¹ï¼ŒåŠ readonlyï¼Œä¸éœ€è¦æ ¡éªŒï¼Œåˆ prop=â€idâ€</p>
<p>ä¸‹é¢ruleFormä¹Ÿè¦åŠ å¯¹åº”çš„id</p>
<h1 id="ä¿®æ”¹å›¾ä¹¦"><a href="#ä¿®æ”¹å›¾ä¹¦" class="headerlink" title="ä¿®æ”¹å›¾ä¹¦"></a>ä¿®æ”¹å›¾ä¹¦</h1><p>åç«¯å†™ä¸€ä¸ªä¿®æ”¹æ–¹æ³•</p>
<p>repositoryæ²¡æœ‰updateæ–¹æ³•ï¼Œsaveå¯ä»¥ç”¨äºä¿®æ”¹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(@RequestBody Book book)</span></span>&#123;</span><br><span class="line">  Book result = bookRepository.save(book);</span><br><span class="line">  <span class="keyword">if</span>(result != <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†…å®¹å’Œsaveæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä¸ºäº†ç¬¦åˆRESTfulé£æ ¼ï¼Œæ–°å†™ä¸€ä¸ªPutMappingçš„</p>
<p>å‰ç«¯submitFormé‡Œé¢ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œpostæ”¹æˆputï¼Œurlæ”¹ä¸€ä¸‹ï¼Œmessageæ”¹æˆä¿®æ”¹æˆåŠŸ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">axios.put(<span class="string">'http://localhost:8181/book/update'</span>,<span class="keyword">this</span>.ruleForm).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(resp.data == <span class="string">'success'</span>)&#123;</span><br><span class="line">    _this.$message(&#123;</span><br><span class="line">      message: <span class="string">'ã€Š'</span>+_this.ruleForm.name+<span class="string">'ã€‹'</span>+<span class="string">'ä¿®æ”¹æˆåŠŸ'</span>,</span><br><span class="line">      type: <span class="string">'success'</span></span><br><span class="line">    &#125;)</span><br><span class="line">    _this.$router.push(<span class="string">'/book-manage'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="åˆ é™¤å›¾ä¹¦"><a href="#åˆ é™¤å›¾ä¹¦" class="headerlink" title="åˆ é™¤å›¾ä¹¦"></a>åˆ é™¤å›¾ä¹¦</h1><p>åç«¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping</span>(<span class="string">"/deleteById/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>&#123;</span><br><span class="line">  bookRepository.deleteById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>buttonç»‘ä¸€ä¸ªäº‹ä»¶</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"deleteBook(scope.row)"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span>åˆ é™¤<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸èƒ½å«deleteï¼Œå’Œå…³é”®å­—å†²çª</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">deleteBook(row) &#123;</span><br><span class="line">  <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">  axios.delete(<span class="string">'http://localhost:8181/book/deleteById/'</span>+row.id).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ²¡æœ‰ç®¡è¿”å›ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–­çŠ¶æ€ï¼Œ200å°±æ˜¯æˆåŠŸ</span></span><br><span class="line">    _this.$alert(<span class="string">'ã€Š'</span>+row.name+<span class="string">'ã€‹åˆ é™¤æˆåŠŸï¼'</span>, <span class="string">'æ¶ˆæ¯'</span>, &#123;</span><br><span class="line">      confirmButtonText: <span class="string">'ç¡®å®š'</span>,</span><br><span class="line">      callback: <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ·æ–°</span></span><br><span class="line">        <span class="built_in">window</span>.location.reload()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´çš„å¢åˆ æ”¹æŸ¥å°±å®ç°äº†ï½</p>
<h1 id="ä¿®æ”¹èœå•"><a href="#ä¿®æ”¹èœå•" class="headerlink" title="ä¿®æ”¹èœå•"></a>ä¿®æ”¹èœå•</h1><p>ç”±äºåŠ äº†ä¸€ä¸ªè·¯ç”±ï¼Œè€Œèœå•æ˜¯æ ¹æ®è·¯ç”±åŠ¨æ€åŠ è½½çš„ï¼Œä¼šæŠŠé…ç½®çš„è·¯ç”±å…¨éƒ¨éå†å‡ºæ¥ï¼Œäºæ˜¯èœå•å·¦ä¾§å°±å¤šäº†ä¸€ä¸ª</p>
<p>å¯ä»¥æ·»åŠ ä¸€ä¸ªå±æ€§æ¥åˆ¤æ–­ï¼Œshowæ˜¯trueå°±éå†ï¼Œfalseå°±ä¸éå†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'å›¾ä¹¦ç®¡ç†'</span>,</span><br><span class="line">    show: <span class="literal">true</span>,</span><br><span class="line">    component:Index,</span><br><span class="line">    redirect:<span class="string">'book-manage'</span>,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/book-manage'</span>,</span><br><span class="line">        name: <span class="string">'æŸ¥è¯¢å›¾ä¹¦'</span>,</span><br><span class="line">        component: BookManage</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/add-book'</span>,</span><br><span class="line">        name: <span class="string">'æ·»åŠ å›¾ä¹¦'</span>,</span><br><span class="line">        component: AddBook</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/book-update'</span>,</span><br><span class="line">    name: <span class="string">'ä¿®æ”¹'</span>,</span><br><span class="line">    show: <span class="literal">false</span>,</span><br><span class="line">    component: BookUpdate</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>App.vueä¸­é€šè¿‡v-if=â€item.showâ€åˆ¤æ–­</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">style</span>=<span class="string">"height: 500px; border: 1px solid #eee"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">"200px"</span> <span class="attr">style</span>=<span class="string">"background-color: rgb(238, 241, 246)"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--            è¿™é‡Œæ·»åŠ routeræ ‡ç­¾ï¼Œel-menu-itemçš„indexå°±ä¼šè¢«ä½œä¸ºrouterè·¯å¾„--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-menu</span> <span class="attr">router</span> <span class="attr">:default-openeds</span>=<span class="string">"['0','1']"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--          showå±æ€§ä¸ºtrueåˆ™éå†--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in $router.options.routes"</span> <span class="attr">:index</span>=<span class="string">"index+''"</span> <span class="attr">v-if</span>=<span class="string">"item.show"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-setting"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--                    æ¡ä»¶åˆ¤æ–­å½“å‰è·¯å¾„æ˜¯å¦ç­‰äºindexï¼Œæ›´æ”¹é€‰ä¸­çŠ¶æ€ï¼Œä¸»è¦æ˜¯åœ¨åˆå§‹åŒ–æ—¶å¢åŠ é»˜è®¤çš„é€‰ä¸­çŠ¶æ€--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">v-for</span>=<span class="string">"item2 in item.children"</span> <span class="attr">:index</span>=<span class="string">"item2.path"</span> <span class="attr">:class</span>=<span class="string">"$route.path==item2.path ? 'is-active' : ''"</span>&gt;</span>&#123;&#123;item2.name&#125;&#125;<span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--            ä¸Šé¢åˆindexç¡®å®šçš„routerè¢«æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯mainåŒºåŸŸä¸­--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®Œå·¥ï¼</p>
<img src="/images/2020/screencapture2020-03-17PM5.05.48.jpg">]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueç¬”è®°05 è¡¨å•</title>
    <url>/2020/03/16/note-vue-05/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av85793766?p=5" target="_blank" rel="noopener">https://www.bilibili.com/video/av85793766?p=5</a></p>
</blockquote>
<h1 id="æ–°å¢ä¹¦ç±é¡µé¢"><a href="#æ–°å¢ä¹¦ç±é¡µé¢" class="headerlink" title="æ–°å¢ä¹¦ç±é¡µé¢"></a>æ–°å¢ä¹¦ç±é¡µé¢</h1><p>ç»§ç»­å®ç°å¯¹å›¾ä¹¦å®Œæ•´çš„å¢åˆ æ”¹æŸ¥</p>
<p>å®˜ç½‘æ‰¾ä¸€ä¸ªformè¡¨å•</p>
<p>æ•°æ®æ˜¯åŒå‘ç»‘å®šçš„ï¼Œ:modelå’Œv-modelç”¨æ¥ç»‘å®šå¯¹è±¡</p>
<p>å¯ä»¥æ·»åŠ æ ¡éªŒè§„åˆ™ï¼Œé€šè¿‡rulesç»‘å®šã€‚æ ¡éªŒè§„åˆ™ä¸­ï¼Œè§¦å‘äº‹ä»¶bluræŒ‡å¤±å»ç„¦ç‚¹æ—¶è§¦å‘æ ¡éªŒ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">"ruleForm"</span> <span class="attr">:rules</span>=<span class="string">"rules"</span> <span class="attr">ref</span>=<span class="string">"ruleForm"</span> <span class="attr">label-width</span>=<span class="string">"100px"</span> <span class="attr">class</span>=<span class="string">"demo-ruleForm"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ä¹¦å"</span> <span class="attr">prop</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"ä½œè€…"</span> <span class="attr">prop</span>=<span class="string">"author"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"ruleForm.author"</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> @<span class="attr">click</span>=<span class="string">"submitForm('ruleForm')"</span>&gt;</span>ç«‹å³åˆ›å»º<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"resetForm('ruleForm')"</span>&gt;</span>é‡ç½®<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                ruleForm: &#123;</span><br><span class="line">                    name: <span class="string">''</span>,</span><br><span class="line">                    author: <span class="string">''</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                rules: &#123;</span><br><span class="line">                    name: [</span><br><span class="line">                        &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'è¯·è¾“å…¥ä¹¦å'</span>, <span class="attr">trigger</span>: <span class="string">'blur'</span> &#125;,</span><br><span class="line">                    ],</span><br><span class="line">                    author: [</span><br><span class="line">                        &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'è¯·è¾“å…¥ä½œè€…'</span>, <span class="attr">trigger</span>: <span class="string">'blur'</span> &#125;,</span><br><span class="line">                    ],</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            submitForm(formName) &#123;</span><br><span class="line">                <span class="keyword">this</span>.$refs[formName].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">                        alert(<span class="string">'submit!'</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">'error submit!!'</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            resetForm(formName) &#123;</span><br><span class="line">                <span class="keyword">this</span>.$refs[formName].resetFields();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h1><p>Bookçš„idè¦åŠ è‡ªå¢æ³¨è§£ï¼Œå¦åˆ™ä¼šå‡ºé—®é¢˜</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)  <span class="comment">// idè‡ªå¢</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>controllerä¸­åŠ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line"><span class="comment">// @RequestBodyæŠŠjsonæ ¼å¼è½¬æˆjavaå¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">(@RequestBody Book book)</span></span>&#123;</span><br><span class="line">  Book result = bookRepository.save(book);</span><br><span class="line">  <span class="keyword">if</span>(result != <span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"sucess"</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="å¯¹æ¥"><a href="#å¯¹æ¥" class="headerlink" title="å¯¹æ¥"></a>å¯¹æ¥</h1><p>ä¼ Bookå¯¹è±¡ï¼Œç›´æ¥è¿½åŠ å°±è¡Œäº†ï¼Œä¸éœ€è¦æ‹¼æ¥</p>
<p>æç¤ºä¿¡æ¯å¯ä»¥å†å»å®˜ç½‘æ‰¾ä¸€ä¸ªåˆé€‚çš„æ‹¿æ¥ç”¨</p>
<p>æ·»åŠ æˆåŠŸåè·³è½¬åˆ°æŸ¥è¯¢é¡µé¢ï¼Œç”¨router.push</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">submitForm(formName) &#123;</span><br><span class="line">  <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">this</span>.$refs[formName].validate(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">      axios.post(<span class="string">'http://localhost:8181/book/save'</span>,<span class="keyword">this</span>.ruleForm).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(resp.data == <span class="string">'success'</span>)&#123;</span><br><span class="line">          _this.$message(&#123;</span><br><span class="line">            message: <span class="string">'ã€Š'</span>+_this.ruleForm.name+<span class="string">'ã€‹'</span>+<span class="string">'æ·»åŠ æˆåŠŸ'</span>,</span><br><span class="line">            type: <span class="string">'success'</span></span><br><span class="line">          &#125;)</span><br><span class="line">          _this.$router.push(<span class="string">'/book-manage'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>å‘ç°ä¸€ä¸ªå°é—®é¢˜</p>
<p>è¿™æ ·å¼¹å‡ºé¡¶éƒ¨æç¤ºä¹‹åç›´æ¥åˆ‡æ¢é¡µé¢ï¼Œå·¦ä¾§çš„é€‰ä¸­çŠ¶æ€æœ‰é—®é¢˜ï¼ŒåŸé¡µé¢å’Œæ–°é¡µé¢éƒ½é€‰ä¸­äº†</p>
<p>ä½†æ˜¯ç”¨éœ€è¦ç‚¹å‡»ç¡®å®šçš„æç¤ºæ¡†ä¹‹ååˆ‡å›å»ï¼Œé€‰ä¸­çŠ¶æ€å°±æ²¡æœ‰é—®é¢˜</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">_this.$alert(<span class="string">'æ·»åŠ æˆåŠŸ'</span>,<span class="string">'MSG'</span>,&#123;</span><br><span class="line">  confirmButtonTest: <span class="string">'OK'</span>,</span><br><span class="line">  callback: <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.$message(&#123;</span><br><span class="line">      type: <span class="string">'info'</span>,</span><br><span class="line">      message: <span class="string">`action: <span class="subst">$&#123;action&#125;</span>`</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">_this.$router.push(<span class="string">'/book-manage'</span>)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueç¬”è®°04 åˆ†é¡µ</title>
    <url>/2020/03/16/note-vue-04/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av85793766?p=4" target="_blank" rel="noopener">https://www.bilibili.com/video/av85793766?p=4</a></p>
</blockquote>
<h1 id="è¡¨æ ¼ä¸åˆ†é¡µ"><a href="#è¡¨æ ¼ä¸åˆ†é¡µ" class="headerlink" title="è¡¨æ ¼ä¸åˆ†é¡µ"></a>è¡¨æ ¼ä¸åˆ†é¡µ</h1><p>åœ¨ä¸Šä¸€æ¬¡çš„åŸºç¡€ä¸Šæ·»åŠ è¡¨æ ¼å’Œåˆ†é¡µï¼Œåœ¨å®˜ç½‘æ‹·è¿‡æ¥ï¼Œæ”¾åœ¨Page1</p>
<p>æ³¨æ„ä¸èƒ½ç›´æ¥å¹¶åˆ—æ”¾åœ¨templateä¸‹ï¼Œç”±äºåªèƒ½æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå¤–é¢è¦å¥—ä¸€ä¸ªdiv</p>
<h2 id="è¡¨æ ¼æ•°æ®åŠ è½½"><a href="#è¡¨æ ¼æ•°æ®åŠ è½½" class="headerlink" title="è¡¨æ ¼æ•°æ®åŠ è½½"></a>è¡¨æ ¼æ•°æ®åŠ è½½</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">    <span class="attr">fixed</span></span></span><br><span class="line"><span class="tag">    <span class="attr">prop</span>=<span class="string">"id"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">label</span>=<span class="string">"ç¼–å·"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">"150"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">tableData: [&#123;</span><br><span class="line">     id: <span class="string">'01'</span>,</span><br><span class="line">     name: <span class="string">'ä¹¦ç±1'</span>,</span><br><span class="line">     author: <span class="string">'ä½œè€…1'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®propçš„å€¼å’Œæ•°æ®å¯¹åº”</p>
<h2 id="åˆ†é¡µ"><a href="#åˆ†é¡µ" class="headerlink" title="åˆ†é¡µ"></a>åˆ†é¡µ</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">     <span class="attr">background</span></span></span><br><span class="line"><span class="tag">     <span class="attr">layout</span>=<span class="string">"prev, pager, next"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">:total</span>=<span class="string">"1000"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>totalæ˜¯æ€»è®°å½•æ•°ï¼Œé»˜è®¤æ¯é¡µ10æ¡ï¼Œæ­¤æ—¶å°±æœ‰1000/10=100é¡µ</p>
<h2 id="ç»‘å®šç‚¹å‡»äº‹ä»¶"><a href="#ç»‘å®šç‚¹å‡»äº‹ä»¶" class="headerlink" title="ç»‘å®šç‚¹å‡»äº‹ä»¶"></a>ç»‘å®šç‚¹å‡»äº‹ä»¶</h2><p>ç”¨@current-change=â€pageâ€</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">               <span class="attr">background</span></span></span><br><span class="line"><span class="tag">               <span class="attr">layout</span>=<span class="string">"prev, pager, next"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:total</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag">               @<span class="attr">current-change</span>=<span class="string">"clickPage"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Scriptä¸­åŠ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        methods: &#123;</span><br><span class="line">            clickPage()&#123;</span><br><span class="line">                alert(<span class="number">1</span>)</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å³å¯çœ‹åˆ°æ•ˆæœ</p>
<h2 id="ç‚¹å‡»ç¿»é¡µ"><a href="#ç‚¹å‡»ç¿»é¡µ" class="headerlink" title="ç‚¹å‡»ç¿»é¡µ"></a>ç‚¹å‡»ç¿»é¡µ</h2><p>æŠŠä¼ è¿‡æ¥çš„å¯¹è±¡æ‰“å°çœ‹çœ‹ï¼Œå‘ç°å°±æ˜¯é¡µé¢çš„index</p>
<p>ç»‘æµ‹è¯•çš„æ•°æ®è¯•è¯•ï¼Œåé¢åœ¨è¿åå°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">clickPage(index)&#123;</span><br><span class="line">  <span class="keyword">switch</span>(index)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">this</span>.tableData = [&#123;</span><br><span class="line">        id: <span class="string">'01'</span>,</span><br><span class="line">        name: <span class="string">'ä¹¦ç±1'</span>,</span><br><span class="line">        author: <span class="string">'ä½œè€…1'</span>,</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        id: <span class="string">'02'</span>,</span><br><span class="line">        name: <span class="string">'ä¹¦ç±2'</span>,</span><br><span class="line">        author: <span class="string">'ä½œè€…2'</span>,</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        id: <span class="string">'03'</span>,</span><br><span class="line">        name: <span class="string">'ä¹¦ç±3'</span>,</span><br><span class="line">        author: <span class="string">'ä½œè€…3'</span>,</span><br><span class="line">      &#125;]</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="keyword">this</span>.tableData = [&#123;</span><br><span class="line">        id: <span class="string">'04'</span>,</span><br><span class="line">        name: <span class="string">'ä¹¦ç±4'</span>,</span><br><span class="line">        author: <span class="string">'ä½œè€…4'</span>,</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        id: <span class="string">'05'</span>,</span><br><span class="line">        name: <span class="string">'ä¹¦ç±5'</span>,</span><br><span class="line">        author: <span class="string">'ä½œè€…5'</span>,</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        id: <span class="string">'06'</span>,</span><br><span class="line">        name: <span class="string">'ä¹¦ç±6'</span>,</span><br><span class="line">        author: <span class="string">'ä½œè€…6'</span>,</span><br><span class="line">      &#125;]</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ­£å¸¸åˆ‡æ¢</p>
<h1 id="åç«¯æ·»åŠ åˆ†é¡µæ“ä½œ"><a href="#åç«¯æ·»åŠ åˆ†é¡µæ“ä½œ" class="headerlink" title="åç«¯æ·»åŠ åˆ†é¡µæ“ä½œ"></a>åç«¯æ·»åŠ åˆ†é¡µæ“ä½œ</h1><p>Spring Bootçš„RepositoryæŠŠåˆ†é¡µä¹Ÿè§£å†³äº†</p>
<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookstoreServerApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    BookRepository repository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageRequest pageRequest = PageRequest.of(<span class="number">3</span>,<span class="number">3</span>);</span><br><span class="line">        Page&lt;Book&gt; page = repository.findAll(pageRequest);</span><br><span class="line">        System.out.println(page);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-16AM11.08.48.jpg">

<p>éœ€è¦çš„ä¸œè¥¿éƒ½å–å‡ºæ¥äº†</p>
<p>ç›´æ¥è°ƒæ–¹æ³•å®ç°æ¥å£å°±å¯ä»¥äº†</p>
<p>åœ¨controllerä¸­ï¼Œæ¥æ”¶å‚æ•°ï¼Œè°ƒfindAllï¼Œè¿”å›Page</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/findAll/&#123;page&#125;/&#123;size&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Page&lt;Book&gt; <span class="title">findAll</span><span class="params">(@PathVariable(<span class="string">"page"</span>)</span> Integer page,@<span class="title">PathVariable</span><span class="params">(<span class="string">"size"</span>)</span> Integer size)</span>&#123;</span><br><span class="line">        PageRequest pageRequest = PageRequest.of(page,size);</span><br><span class="line">        <span class="keyword">return</span> bookRepository.findAll(pageRequest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-16AM11.15.19.jpg">

<h1 id="å¯¹æ¥"><a href="#å¯¹æ¥" class="headerlink" title="å¯¹æ¥"></a>å¯¹æ¥</h1><p>è£…æ’ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vue add axios</span><br></pre></td></tr></table></figure>

<p>axio.get().then()</p>
<p>geté‡Œæ˜¯è¯·æ±‚ï¼Œthené‡Œæ˜¯å›è°ƒå‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">created()&#123;</span><br><span class="line">	axios.get(<span class="string">'http://localhost:8181/book/findAll/0/6'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(resp)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-16AM11.22.45.jpg">

<p>çœ‹åˆ°æ•°æ®å¾—åˆ°äº†</p>
<p>Pageä¸­data.contentéƒ¨åˆ†å°±æ˜¯ä¹¦ç±æ•°æ®ï¼Œèµ‹å€¼å³å¯</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    pageSize:<span class="string">'6'</span>,</span><br><span class="line">    total:<span class="string">''</span>,</span><br><span class="line">    tableData:<span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">created()&#123;</span><br><span class="line">  <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">  axios.get(<span class="string">'http://localhost:8181/book/findAll/0/6'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">    _this.tableData = resp.data.content</span><br><span class="line">    _this.pageSize = resp.data.size</span><br><span class="line">    _this.total = resp.data.totalElements</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">               <span class="attr">background</span></span></span><br><span class="line"><span class="tag">               <span class="attr">layout</span>=<span class="string">"prev, pager, next"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:page-size</span>=<span class="string">"pageSize"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">:total</span>=<span class="string">"total"</span></span></span><br><span class="line"><span class="tag">               @<span class="attr">current-change</span>=<span class="string">"clickPage"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¹¶ä¸”ä¿®æ”¹ç‚¹å‡»äº‹ä»¶ç»‘å®šçš„å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">clickPage(index)&#123;</span><br><span class="line">  <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">  axios.get(<span class="string">'http://localhost:8181/book/findAll/'</span>+(index<span class="number">-1</span>)+<span class="string">'/6'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">    _this.tableData = resp.data.content</span><br><span class="line">    _this.pageSize = resp.data.size</span><br><span class="line">    _this.total = resp.data.totalElements</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥ç‚¹å‡»ç¿»é¡µäº†</p>
<img src="/images/2020/screencapture2020-03-16AM11.35.54.jpg">

<img src="/images/2020/screencapture2020-03-16AM11.35.57.jpg">

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>å„ç§å„æ ·çš„åŠ¨æ€è§„åˆ’å°ç»“</title>
    <url>/2020/03/14/dynamic-programming/</url>
    <content><![CDATA[<h1 id="å¡«å……dpæ•°ç»„çš„æ–¹å¼"><a href="#å¡«å……dpæ•°ç»„çš„æ–¹å¼" class="headerlink" title="å¡«å……dpæ•°ç»„çš„æ–¹å¼"></a>å¡«å……dpæ•°ç»„çš„æ–¹å¼</h1><p>ç›®å‰ç¢°åˆ°çš„é¢˜ç›®ä¸­ï¼Œä¸€èˆ¬å¡«å……dpè¦ä¹ˆæ˜¯æŒ‰ç…§é¡ºåºä¸€ä¸ªä¸€ä¸ªå¡«ï¼Œè¦ä¹ˆæ˜¯å…ˆå…¨åˆå§‹åŒ–ä¸º-1ï¼Œç¼ºå“ªä¸ªè¡¥å“ªä¸ª</p>
<p>ä»¥<a href="#point">æœ€é•¿ä¸Šå‡å­åºåˆ—</a>ä¸ºä¾‹</p>
<h2 id="æŒ‰é¡ºåºæ‰«æ"><a href="#æŒ‰é¡ºåºæ‰«æ" class="headerlink" title="æŒ‰é¡ºåºæ‰«æ"></a>æŒ‰é¡ºåºæ‰«æ</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums.length==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            dp[i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;i;k++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(nums[i]&gt;nums[k])&#123;</span><br><span class="line">                        dp[i] = Math.max(dp[i],dp[k]+<span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            max = Math.max(max,dp[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æŒ‰éœ€è¦è®¡ç®—"><a href="#æŒ‰éœ€è¦è®¡ç®—" class="headerlink" title="æŒ‰éœ€è¦è®¡ç®—"></a>æŒ‰éœ€è¦è®¡ç®—</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer[] dp;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] nums;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums.length==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.nums = nums;</span><br><span class="line">        dp = <span class="keyword">new</span> Integer[nums.length];</span><br><span class="line">        Arrays.fill(dp,-<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            max = Math.max(max,getDp(i));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDp</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(dp[i]==-<span class="number">1</span>)&#123;</span><br><span class="line">            dp[i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;i;k++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(nums[i]&gt;nums[k])&#123;</span><br><span class="line">                        dp[i] = Math.max(dp[i],getDp(k)+<span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸€äº›æƒ³æ³•"><a href="#ä¸€äº›æƒ³æ³•" class="headerlink" title="ä¸€äº›æƒ³æ³•"></a>ä¸€äº›æƒ³æ³•</h3><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”±äºdpçš„æ¯ä¸ªå…ƒç´ éƒ½éœ€è¦å¡«å……ï¼ˆç„¶åæ‰¾æœ€å¤§å€¼ï¼‰ï¼Œè€Œä¸”å¯ä»¥æ–¹ä¾¿çš„æŒ‰ç…§é¡ºåºéå†ï¼Œæ‰€ä»¥æ–¹æ³•ä¸€æ˜¾å¾—ç®€å•ä¸€äº›</p>
<p>ä½†æ˜¯æœ‰çš„é¢˜ç›®ä¸­é¡ºåºä¸æ˜¯å¾ˆå¥½æ‰¾ï¼Œæ¯”å¦‚æœ‰çš„äºŒç»´dpæ•°ç»„ä¸­ï¼Œè¦å¡«å……çš„æ˜¯ä¸‰è§’å½¢åŒºåŸŸï¼Œæœ‰çš„æ˜¯ä»å·¦å¾€å³æ‰«ï¼Œæœ‰çš„æ˜¯ä»ä¸Šå¾€ä¸‹æ‰«ï¼Œå…¶å®ƒä¸€äº›å¥‡æ€ªçš„dpå‡ ä¹æ‰¾ä¸åˆ°é¡ºåº</p>
<p>è€Œä¸”å¾ˆå¤šé¢˜ç›®ä¸­å¹¶ä¸éœ€è¦æŠŠæ•´ä¸ªdpéƒ½å¡«æ»¡ï¼Œåªéœ€è¦å¾—åˆ°ç‰¹å®šä¸€ä¸ªå…ƒç´ å³ä¸ºç­”æ¡ˆï¼Œå…¶å®æ²¡å¿…è¦æŒ‰é¡ºåºæŠŠæ‰€æœ‰çš„å…ƒç´ éƒ½ç®—å‡ºæ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// getDpçœŸæ˜¯éå¸¸å¥—è·¯</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDp</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dp[i]==-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="comment">// æ²¡ç®—è¿‡å°±ç®—</span></span><br><span class="line">    <span class="comment">// ç®—çš„è¿‡ç¨‹ä¸­ç»§ç»­getDp(k)</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ç®—è¿‡äº†ç›´æ¥è¿”å›</span></span><br><span class="line">  <span class="keyword">return</span> dp[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ„Ÿè§‰ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°é¡ºåºã€æˆ–è€…å¿…é¡»å¡«æ»¡çš„å¯ä»¥ç”¨æ–¹æ³•ä¸€ï¼Œå…¶å®ƒçš„ç›´æ¥getDp()çœè„‘ç»†èƒ</p>
<h1 id="ä¸€ç»´"><a href="#ä¸€ç»´" class="headerlink" title="ä¸€ç»´ "></a>ä¸€ç»´ <h1 id="point"></h1></h1><h2 id="ä¾‹1-æœ€é•¿ä¸Šå‡å­åºåˆ—-LeetCode-300"><a href="#ä¾‹1-æœ€é•¿ä¸Šå‡å­åºåˆ—-LeetCode-300" class="headerlink" title="ä¾‹1 æœ€é•¿ä¸Šå‡å­åºåˆ— (LeetCode 300)"></a>ä¾‹1 æœ€é•¿ä¸Šå‡å­åºåˆ— (LeetCode 300)</h2><a href="https://leetcode-cn.com/problems/longest-increasing-subsequence/" title="" target="">link</a>

<h3 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>ç»™å®šä¸€ä¸ªæ— åºçš„æ•´æ•°æ•°ç»„ï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦</p>
<h3 id="çŠ¶æ€è¡¨ç¤º"><a href="#çŠ¶æ€è¡¨ç¤º" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[i] è¡¨ç¤ºç¬¬iä¸ªå…ƒç´ ï¼ˆåŒ…å«iï¼‰ä¹‹å‰æœ€å¤§ä¸Šå‡å­åºåˆ—çš„é•¿åº¦</span><br></pre></td></tr></table></figure>

<h3 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[i] &#x3D; max&#123; dp[k] + 1&#125;</span><br><span class="line">å…¶ä¸­ 0&lt;&#x3D;k&lt;i ä¸” nums[i]&gt;nums[k]</span><br></pre></td></tr></table></figure>

<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>è§ï¼š<a href="#å¡«å……dpæ•°ç»„çš„æ–¹å¼">å¡«å……dpæ•°ç»„çš„æ–¹å¼</a></p>
<h1 id="äºŒç»´"><a href="#äºŒç»´" class="headerlink" title="äºŒç»´"></a>äºŒç»´</h1><h2 id="ä¾‹1-æœ€é•¿å…¬å…±å­åºåˆ—é—®é¢˜ï¼ˆç®—æ³•è®¾è®¡æŠ€å·§ä¸åˆ†æ-æ²™ç‰¹ç‰ˆ-p130ï¼‰"><a href="#ä¾‹1-æœ€é•¿å…¬å…±å­åºåˆ—é—®é¢˜ï¼ˆç®—æ³•è®¾è®¡æŠ€å·§ä¸åˆ†æ-æ²™ç‰¹ç‰ˆ-p130ï¼‰" class="headerlink" title="ä¾‹1 æœ€é•¿å…¬å…±å­åºåˆ—é—®é¢˜ï¼ˆç®—æ³•è®¾è®¡æŠ€å·§ä¸åˆ†æ æ²™ç‰¹ç‰ˆ p130ï¼‰"></a>ä¾‹1 æœ€é•¿å…¬å…±å­åºåˆ—é—®é¢˜ï¼ˆç®—æ³•è®¾è®¡æŠ€å·§ä¸åˆ†æ æ²™ç‰¹ç‰ˆ p130ï¼‰</h2><h3 id="æè¿°-1"><a href="#æè¿°-1" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>æ‰¾ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦</p>
<p>å¦‚A=zxyxyz B=xyyzx åˆ™æœ€é•¿å…¬å…±å­åºåˆ—ä¸ºxyyz</p>
<h3 id="çŠ¶æ€è¡¨ç¤º-1"><a href="#çŠ¶æ€è¡¨ç¤º-1" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä»¤ A &#x3D; a1a2â€¦anï¼ŒB &#x3D; b1b2â€¦bn</span><br><span class="line">L[i , j] è¡¨ç¤º a1a2â€¦ai å’Œ b1b2â€¦bj çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦</span><br></pre></td></tr></table></figure>

<h3 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-1"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-1" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å½“ A[i] &#x3D;&#x3D; B[i]ï¼ŒL[i , j] &#x3D; L[i-1 , j-1] + 1</span><br><span class="line">å½“ A[i] !&#x3D; B[i]ï¼ŒL[i , j] &#x3D; max&#123; L[i-1 , j] , L[i , j-1] &#125;</span><br></pre></td></tr></table></figure>

<p>eg:<br>A = horseï¼ŒB = ros<br>iä¸º2ï¼Œjä¸º2æ—¶ï¼Œo == oï¼ŒL[ ho , ro ] = L[ h , r ] + 1<br>iä¸º3ï¼Œjä¸º3æ—¶ï¼Œr != sï¼ŒL[ hor , ros ] = max{ L[ ho , ros ] , L[ hor , ro ] }</p>
<h3 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">LCS</span><span class="params">(String word1, String word2)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">  <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[word1.length()+<span class="number">1</span>][word2.length()+<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;word1.length()+<span class="number">1</span>;i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;word2.length()+<span class="number">1</span>;j++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(word1.charAt(i-<span class="number">1</span>)==word2.charAt(j-<span class="number">1</span>)) &#123;</span><br><span class="line">				dp[i][j] = dp[i-<span class="number">1</span>][j-<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				dp[i][j] = Math.max(dp[i-<span class="number">1</span>][j], dp[i][j-<span class="number">1</span>]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">  </span><br><span class="line">	<span class="keyword">return</span> dp[word1.length()][word2.length()];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¾‹2-ç¼–è¾‘è·ç¦»-LeetCode-72"><a href="#ä¾‹2-ç¼–è¾‘è·ç¦»-LeetCode-72" class="headerlink" title="ä¾‹2 ç¼–è¾‘è·ç¦» (LeetCode 72)"></a>ä¾‹2 ç¼–è¾‘è·ç¦» (LeetCode 72)</h2><a href="https://leetcode-cn.com/problems/edit-distance/" title="" target="">link</a>

<h3 id="æè¿°-2"><a href="#æè¿°-2" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>ç»™å®šä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œè®¡ç®—å°† word1 è½¬æ¢æˆ word2 æ‰€ä½¿ç”¨çš„æœ€å°‘æ“ä½œæ•°</p>
<p>æ“ä½œåŒ…æ‹¬ï¼š</p>
<ul>
<li>æ’å…¥ä¸€ä¸ªå­—ç¬¦</li>
<li>åˆ é™¤ä¸€ä¸ªå­—ç¬¦</li>
<li>æ›¿æ¢ä¸€ä¸ªå­—ç¬¦</li>
</ul>
<h3 id="çŠ¶æ€è¡¨ç¤º-2"><a href="#çŠ¶æ€è¡¨ç¤º-2" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä»¤ A &#x3D; a1a2â€¦anï¼ŒB &#x3D; b1b2â€¦bn</span><br><span class="line">L[i , j] è¡¨ç¤º a1a2â€¦ai å’Œ b1b2â€¦bj çš„æœ€çŸ­ç¼–è¾‘è·ç¦»</span><br></pre></td></tr></table></figure>

<p>å’Œå…¬å…±å­åºåˆ—ä¸€æ ·</p>
<h3 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-2"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-2" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å½“ A[i] &#x3D;&#x3D; B[i]ï¼ŒL[i , j] &#x3D; L[i-1 , j-1]</span><br><span class="line">å½“ A[i] !&#x3D; B[i]ï¼ŒL[i , j] &#x3D; min&#123; L[i-1 , j-1] , L[i-1 , j] , L[i , j-1] &#125; + 1</span><br><span class="line">å…¶ä¸­ï¼ŒL[i-1 , j-1]ä»£è¡¨æ›¿æ¢æ“ä½œï¼ŒL[i-1 , j]ä»£è¡¨åˆ é™¤æ“ä½œï¼ŒL[i , j-1]ä»£è¡¨æ’å…¥æ“ä½œ</span><br></pre></td></tr></table></figure>

<p>eg:<br>A = horseï¼ŒB = ros<br>iä¸º2ï¼Œjä¸º2æ—¶ï¼Œo == oï¼ŒL[ ho , ro ] = L[ h , r ]ï¼Œæ— éœ€ç»§ç»­ç¼–è¾‘<br>iä¸º3ï¼Œjä¸º3æ—¶ï¼Œr != sï¼ŒL[ hor , ros ] = min{ L[ ho , ro ] , L[ ho , ros ] , L[ hor , ro ] } + 1<br>L[ ho , ro ] + 1 ä»£è¡¨ï¼Œåœ¨hoå·²ç»ç¼–è¾‘æˆroä¹‹åï¼Œå°†ræ›¿æ¢æˆs<br>L[ ho , ros ] + 1 ä»£è¡¨ï¼Œåœ¨hoå·²ç»ç¼–è¾‘æˆrosä¹‹åï¼Œå°†råˆ é™¤<br>L[ hor , ro ] + 1 ä»£è¡¨ï¼Œåœ¨horå·²ç»ç¼–è¾‘æˆroä¹‹åï¼Œæ’å…¥s</p>
<h3 id="å®ç°-2"><a href="#å®ç°-2" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(String word1, String word2)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[word1.length()+<span class="number">1</span>][word2.length()+<span class="number">1</span>];</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;word1.length()+<span class="number">1</span>;i++) &#123;</span><br><span class="line">    	    dp[i][<span class="number">0</span>] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;word2.length()+<span class="number">1</span>;i++) &#123;</span><br><span class="line">    	    dp[<span class="number">0</span>][i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;word1.length()+<span class="number">1</span>;i++) &#123;</span><br><span class="line">	    	<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;word2.length()+<span class="number">1</span>;j++) &#123;</span><br><span class="line">		    	<span class="keyword">if</span>(word1.charAt(i-<span class="number">1</span>)==word2.charAt(j-<span class="number">1</span>)) &#123;</span><br><span class="line">			    	dp[i][j] = dp[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">    			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">	    			<span class="keyword">int</span> min = Math.min(dp[i-<span class="number">1</span>][j], dp[i][j-<span class="number">1</span>]);</span><br><span class="line">		    		min = Math.min(min, dp[i-<span class="number">1</span>][j-<span class="number">1</span>]);</span><br><span class="line">			    	dp[i][j] = min+<span class="number">1</span>;</span><br><span class="line">			    &#125;</span><br><span class="line">    		&#125;</span><br><span class="line">	    &#125;	</span><br><span class="line">	</span><br><span class="line">	    <span class="keyword">return</span> dp[word1.length()][word2.length()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>è¿™é¢˜dpç¬¬0è¡Œå’Œç¬¬0åˆ—åˆå§‹åŒ–ä¸º0,1,2,3â€¦</p>
<h2 id="ä¾‹3-å›æ–‡å­ä¸²-LeetCode-647"><a href="#ä¾‹3-å›æ–‡å­ä¸²-LeetCode-647" class="headerlink" title="ä¾‹3 å›æ–‡å­ä¸² (LeetCode 647)"></a>ä¾‹3 å›æ–‡å­ä¸² (LeetCode 647)</h2><a href="https://leetcode-cn.com/problems/palindromic-substrings/" title="" target="">link</a>

<h3 id="æè¿°-3"><a href="#æè¿°-3" class="headerlink" title="æè¿°"></a>æè¿°</h3><p>ç»Ÿè®¡ç»™å®šå­—ç¬¦ä¸²ä¸­å›æ–‡å­ä¸²çš„ä¸ªæ•°</p>
<p>å¦‚â€aaaâ€ä¸­æœ‰â€aâ€, â€œaâ€, â€œaâ€, â€œaaâ€, â€œaaâ€, â€œaaaâ€å…±6ä¸ª</p>
<h3 id="çŠ¶æ€è¡¨ç¤º-3"><a href="#çŠ¶æ€è¡¨ç¤º-3" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[i][j] è¡¨ç¤ºå­—ç¬¦ä¸²çš„ç¬¬iåˆ°jä½(å«)æ˜¯å¦ä¸ºå›æ–‡ä¸²</span><br></pre></td></tr></table></figure>

<h3 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-3"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-3" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h3><p>è§æ³¨é‡Š</p>
<h3 id="å®ç°-3"><a href="#å®ç°-3" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    Integer[][] dp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countSubstrings</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.length()==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        dp = <span class="keyword">new</span> Integer[s.length()][s.length()];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length();i++)&#123;</span><br><span class="line">            Arrays.fill(dp[i],-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length();i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;s.length();j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(getDp(i,j,s)==<span class="number">1</span>)&#123;</span><br><span class="line">                    cnt++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDp</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,String s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(dp[i][j]==-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i==j)&#123;</span><br><span class="line">                <span class="comment">// "a"æ˜¯</span></span><br><span class="line">                dp[i][j] = <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.charAt(i)!=s.charAt(j))&#123;</span><br><span class="line">                <span class="comment">// "ab"ã€"a***b"ä¸æ˜¯</span></span><br><span class="line">                dp[i][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(j-i==<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="comment">// "aa"æ˜¯</span></span><br><span class="line">                    dp[i][j] = <span class="number">1</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="comment">// "a****a"</span></span><br><span class="line">                    <span class="keyword">if</span>(getDp(i+<span class="number">1</span>,j-<span class="number">1</span>,s)==<span class="number">1</span>)&#123;</span><br><span class="line">                        <span class="comment">// ä¸­é—´æ˜¯åˆ™æ˜¯</span></span><br><span class="line">                        dp[i][j] = <span class="number">1</span>;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        dp[i][j] = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ä¸‰ç»´"><a href="#ä¸‰ç»´" class="headerlink" title="ä¸‰ç»´"></a>ä¸‰ç»´</h1><h2 id="ä¾‹1-äºŒæŒ‡è¾“å…¥çš„çš„æœ€å°è·ç¦»-LeetCode-1320"><a href="#ä¾‹1-äºŒæŒ‡è¾“å…¥çš„çš„æœ€å°è·ç¦»-LeetCode-1320" class="headerlink" title="ä¾‹1 äºŒæŒ‡è¾“å…¥çš„çš„æœ€å°è·ç¦» (LeetCode 1320)"></a>ä¾‹1 äºŒæŒ‡è¾“å…¥çš„çš„æœ€å°è·ç¦» (LeetCode 1320)</h2><a href="https://leetcode-cn.com/problems/minimum-distance-to-type-a-word-using-two-fingers/" title="" target="">link</a>

<h3 id="æè¿°-4"><a href="#æè¿°-4" class="headerlink" title="æè¿°"></a>æè¿°</h3><img src="/images/2020/screencapture2020-03-14PM4.50.56.jpg" width=400>

<p>äºŒæŒ‡è¾“å…¥æ³•é”®ç›˜ä¸Šï¼Œæ¯ä¸ªå­—æ¯å¯ç”¨åæ ‡è¡¨ç¤ºï¼Œå¦‚P(2,3)</p>
<p>ç»™å®šä¸€ä¸ªå¾…è¾“å…¥å­—ç¬¦ä¸²ï¼Œè®¡ç®—ä»…ç”¨ä¸¤æ ¹æ‰‹æŒ‡ï¼Œè¾“å…¥è¯¥å­—ç¬¦ä¸²çš„æœ€å°ç§»åŠ¨è·ç¦»ï¼ˆèµ·å§‹ä½ç½®ä»»æ„ï¼Œä»£ä»·ä½0ï¼‰</p>
<p>è·ç¦»æŒ‰ |x1-x2| + |y1-y2| è®¡ç®—</p>
<h3 id="çŠ¶æ€è¡¨ç¤º-4"><a href="#çŠ¶æ€è¡¨ç¤º-4" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[i][l][r] è¡¨ç¤ºè¾“å…¥å®Œç¬¬iä¸ªå­—æ¯åï¼Œå·¦æ‰‹ä½ç½®ä¸ºlï¼Œå³æ‰‹ä½ç½®ä¸ºr</span><br><span class="line">lã€rå¯¹åº”å­—æ¯ç¼–å·ï¼Œå¦‚A-0,B-1</span><br></pre></td></tr></table></figure>

<h3 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-4"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-4" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è®°ç¬¬iä¸ªå­—æ¯ä½curï¼Œç¬¬i-1ä¸ªå­—æ¯ä¸ºpre</span><br><span class="line"></span><br><span class="line">1.å·¦æ‰‹ç§»åŠ¨åˆ°curå¤„</span><br><span class="line">	- ç§»åŠ¨å‰å·¦æ‰‹åœ¨preå¤„ï¼Œåˆ™å·¦æ‰‹å¿…ç„¶ä»preç§»åˆ°curï¼Œå³æ‰‹å¯ä»¥åœ¨ä»»æ„ä½ç½®m</span><br><span class="line">	   dp[i][cur][m] &#x3D; dp[i-1][pre][m] + dis(pre,cur);</span><br><span class="line">	- ç§»åŠ¨å‰å³æ‰‹åœ¨preå¤„(å³m&#x3D;&#x3D;pre)ï¼Œåˆ™å·¦æ‰‹å¯ä»¥ä»ä»»æ„ä½ç½®nç§»åˆ°cur</span><br><span class="line">	   dp[i][cur][m] &#x3D; dp[i-1][n][m] + dis(n,cur);</span><br><span class="line"></span><br><span class="line">æ•… dp[i][cur][m] &#x3D; min&#123; dp[i-1][pre][m] , dp[i-1][n][pre] &#125;</span><br><span class="line">å…¶ä¸­må–å€¼0~26ï¼Œnå–å€¼0~26</span><br><span class="line"></span><br><span class="line">2.å³æ‰‹ç§»åŠ¨åˆ°curå¤„</span><br><span class="line">	- ç§»åŠ¨å‰å³æ‰‹åœ¨preå¤„ï¼Œåˆ™å³æ‰‹å¿…ç„¶ä»preç§»åˆ°curï¼Œå·¦æ‰‹å¯ä»¥åœ¨ä»»æ„ä½ç½®m</span><br><span class="line">	   dp[i][m][cur] &#x3D; dp[i-1][m][pre] + dis(pre,cur);</span><br><span class="line">	- ç§»åŠ¨å‰å·¦æ‰‹åœ¨preå¤„(å³m&#x3D;&#x3D;pre)ï¼Œåˆ™å³æ‰‹å¯ä»¥ä»ä»»æ„ä½ç½®nç§»åˆ°cur</span><br><span class="line">	   dp[i][m][cur] &#x3D; dp[i-1][m][n] + dis(n,cur);</span><br><span class="line"></span><br><span class="line">åŒä¸Šï¼Œdp[i][cur][m] &#x3D; min&#123; dp[i-1][pre][m] , dp[i-1][n][pre] &#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®ç°-4"><a href="#å®ç°-4" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumDistance</span><span class="params">(String word)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] words = <span class="keyword">new</span> <span class="keyword">int</span>[word.length()];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;word.length();i++)&#123;</span><br><span class="line">            words[i] = word.charAt(i) - <span class="string">'A'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[][][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[words.length][<span class="number">26</span>][<span class="number">26</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)&#123;</span><br><span class="line">            <span class="comment">// å·¦æ‰‹å¼€å§‹</span></span><br><span class="line">            dp[<span class="number">0</span>][words[<span class="number">0</span>]][i] = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// å³æ‰‹å¼€å§‹</span></span><br><span class="line">            dp[<span class="number">0</span>][i][words[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;words.length;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> cur = words[i];</span><br><span class="line">            <span class="keyword">int</span> pre = words[i-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> dis = calDis(cur,pre);</span><br><span class="line">            <span class="comment">// è‡³å°‘æœ‰ä¸€åªæ‰‹åœ¨curï¼Œå¦ä¸€åªæ‰‹å¯ä»¥åœ¨ä»»æ„ä½ç½®</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;<span class="number">26</span>;m++)&#123;</span><br><span class="line">                <span class="comment">// å³æ‰‹ä¸åŠ¨ï¼Œå·¦æ‰‹ä»preç§»åˆ°curï¼ˆä¸Šä¸€ä¸ªå­—ç¬¦æ˜¯å·¦æ‰‹æŒ‰çš„ï¼‰</span></span><br><span class="line">                dp[i][cur][m] = dp[i-<span class="number">1</span>][pre][m] + dis;</span><br><span class="line">                <span class="comment">// å·¦æ‰‹ä¸åŠ¨ï¼Œå³æ‰‹ä»preç§»åˆ°curï¼ˆä¸Šä¸€ä¸ªå­—ç¬¦æ˜¯å³æ‰‹æŒ‰çš„ï¼‰</span></span><br><span class="line">                dp[i][m][cur] = dp[i-<span class="number">1</span>][m][pre] + dis;</span><br><span class="line">                <span class="keyword">if</span>(m==pre)&#123;</span><br><span class="line">                    <span class="comment">// ç§»åŠ¨å‰å¦ä¸€åªæ‰‹åˆšå¥½åœ¨preå¤„</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> n=<span class="number">0</span>;n&lt;<span class="number">26</span>;n++)&#123;</span><br><span class="line">                        <span class="keyword">int</span> dis2 = calDis(n,cur);</span><br><span class="line">                        <span class="comment">// å³æ‰‹ä¸åŠ¨ï¼Œå·¦æ‰‹ä»ä»»æ„ä½ç½®ç§»åˆ°curï¼ˆä¸Šä¸€ä¸ªå­—ç¬¦æ˜¯å³æ‰‹æŒ‰çš„ï¼‰</span></span><br><span class="line">                        dp[i][cur][m] = Math.min(dp[i][cur][m],dp[i-<span class="number">1</span>][n][m]+dis2);</span><br><span class="line">                        <span class="comment">// å·¦æ‰‹ä¸åŠ¨ï¼Œå³æ‰‹ä»ä»»æ„ä½ç½®ç§»åˆ°curï¼ˆä¸Šä¸€ä¸ªå­—ç¬¦æ˜¯å·¦æ‰‹æŒ‰çš„ï¼‰</span></span><br><span class="line">                        dp[i][m][cur] = Math.min(dp[i][m][cur],dp[i-<span class="number">1</span>][m][n]+dis2);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">int</span> last = words[words.length-<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;<span class="number">26</span>;m++)&#123;</span><br><span class="line">            min = Math.min(min,dp[words.length-<span class="number">1</span>][last][m]);</span><br><span class="line">            min = Math.min(min,dp[words.length-<span class="number">1</span>][m][last]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calDis</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x1 = a / <span class="number">6</span>, y1 = a % <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">int</span> x2 = b / <span class="number">6</span>, y2 = b % <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(Math.abs(x1 - x2)) + (<span class="keyword">int</span>)(Math.abs(y1 - y2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¼˜åŒ–ä¸ºäºŒç»´"><a href="#ä¼˜åŒ–ä¸ºäºŒç»´" class="headerlink" title="ä¼˜åŒ–ä¸ºäºŒç»´"></a>ä¼˜åŒ–ä¸ºäºŒç»´</h3><p>ç”±äºä¸¤åªæ‰‹æ˜¯å®Œå…¨å¯¹ç§°çš„ï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“å“ªåªæ‰‹åœ¨curå¤„ï¼Œåªè¦æœ‰ä¸€åªåœ¨å°±è¡Œäº†</p>
<h4 id="çŠ¶æ€è¡¨ç¤º-5"><a href="#çŠ¶æ€è¡¨ç¤º-5" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[i][rest] è¡¨ç¤ºä¸€åªæ‰‹åœ¨curï¼Œå¦ä¸€åªæ‰‹åœ¨restå¤„æ—¶çš„æœ€å°ç§»åŠ¨è·ç¦»</span><br></pre></td></tr></table></figure>

<h4 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-5"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-5" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¸€åªæ‰‹ä»preç§»åŠ¨åˆ°curï¼Œå¦ä¸€åªæ‰‹éšä¾¿åœ¨å“ª</span><br><span class="line">dp[i][anywhere] &#x3D; dp[i-1][anywhere] + dis(pre,cur)</span><br><span class="line"></span><br><span class="line">è‹¥å¦ä¸€åªæ‰‹æ°å¥½åœ¨preå¤„ï¼Œè¿™åªæ‰‹å¯ä»¥ä»ä»»ä½•åœ°æ–¹ç§»åŠ¨åˆ°cur</span><br><span class="line">dp[i][pre] &#x3D; dp[i-1][anywhere] + dis(anywhere,cur)</span><br></pre></td></tr></table></figure>

<h4 id="å®ç°-5"><a href="#å®ç°-5" class="headerlink" title="å®ç°"></a>å®ç°</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumDistance</span><span class="params">(String word)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] words = <span class="keyword">new</span> <span class="keyword">int</span>[word.length()];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;word.length();i++)&#123;</span><br><span class="line">            words[i] = word.charAt(i) - <span class="string">'A'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[words.length][<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;words.length;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> cur = words[i];</span><br><span class="line">            <span class="keyword">int</span> pre = words[i-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> dis = calDis(cur,pre);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;<span class="number">26</span>;m++)&#123;</span><br><span class="line">                <span class="comment">// ä¸€åªæ‰‹ä»preç§»åŠ¨åˆ°curï¼Œå¦ä¸€åªæ‰‹éšä¾¿åœ¨å“ª</span></span><br><span class="line">                dp[i][m] = dp[i-<span class="number">1</span>][m] + dis;</span><br><span class="line">                <span class="keyword">if</span>(m==pre)&#123;</span><br><span class="line">                    <span class="comment">// å¦ä¸€åªæ‰‹æ°å¥½åœ¨preå¤„ï¼Œè¿™åªæ‰‹å¯ä»¥ä»ä»»ä½•åœ°æ–¹ç§»åŠ¨åˆ°cur</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> n=<span class="number">0</span>;n&lt;<span class="number">26</span>;n++)&#123;</span><br><span class="line">                        dp[i][m] = Math.min(dp[i][m],dp[i-<span class="number">1</span>][n]+calDis(n,cur));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;<span class="number">26</span>;m++)&#123;</span><br><span class="line">            min = Math.min(min,dp[words.length-<span class="number">1</span>][m]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calDis</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x1 = a / <span class="number">6</span>, y1 = a % <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">int</span> x2 = b / <span class="number">6</span>, y2 = b % <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(Math.abs(x1 - x2)) + (<span class="keyword">int</span>)(Math.abs(y1 - y2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼˜åŒ–å‰ æ‰§è¡Œç”¨æ—¶ï¼š<strong>19 ms</strong> å†…å­˜æ¶ˆè€—ï¼š<strong>42.6 MB</strong></p>
<p>ä¼˜åŒ–å æ‰§è¡Œç”¨æ—¶ï¼š<strong>7 ms</strong> å†…å­˜æ¶ˆè€—ï¼š<strong>38.1 MB</strong></p>
<p>ä¹Ÿä¸å¤šçš„æ ·å­â€¦ä½†æ˜¯æ€è·¯ç®€å•å¤šäº†</p>
<h1 id="çŠ¶æ€å‹ç¼©"><a href="#çŠ¶æ€å‹ç¼©" class="headerlink" title="çŠ¶æ€å‹ç¼©"></a>çŠ¶æ€å‹ç¼©</h1><p>å°†çŠ¶æ€ç”¨äºŒè¿›åˆ¶ä¸²è¡¨ç¤ºï¼ŒäºŒè¿›åˆ¶ä¸²ä»¥intå½¢å¼ä½œä¸ºä¸‹æ ‡</p>
<h2 id="ä¾‹1-å‚åŠ è€ƒè¯•çš„æœ€å¤§å­¦ç”Ÿæ•°-LeetCode-1349"><a href="#ä¾‹1-å‚åŠ è€ƒè¯•çš„æœ€å¤§å­¦ç”Ÿæ•°-LeetCode-1349" class="headerlink" title="ä¾‹1 å‚åŠ è€ƒè¯•çš„æœ€å¤§å­¦ç”Ÿæ•° (LeetCode 1349)"></a>ä¾‹1 å‚åŠ è€ƒè¯•çš„æœ€å¤§å­¦ç”Ÿæ•° (LeetCode 1349)</h2><a href="https://leetcode-cn.com/problems/maximum-students-taking-exam/" title="" target="">link</a>

<h3 id="æè¿°-5"><a href="#æè¿°-5" class="headerlink" title="æè¿°"></a>æè¿°</h3><img src="/images/2020/screencapture2020-03-13PM5.17.37.jpg">

<ul>
<li>æ•™å®¤é‡Œæœ‰çš„åº§ä½æ˜¯åçš„</li>
<li>å­¦ç”Ÿå¯ä»¥çœ‹åˆ°å·¦ã€å³ã€å·¦ä¸Šã€å³ä¸Šæ–¹å‘çš„è¯•å·</li>
</ul>
<p>è®¡ç®—è¯¥è€ƒåœºå¯ä»¥å®¹çº³çš„ä¸€èµ·å‚åŠ è€ƒè¯•ä¸”æ— æ³•ä½œå¼Šçš„æœ€å¤§å­¦ç”Ÿäººæ•°</p>
<h3 id="çŠ¶æ€å‹ç¼©-1"><a href="#çŠ¶æ€å‹ç¼©-1" class="headerlink" title="çŠ¶æ€å‹ç¼©"></a>çŠ¶æ€å‹ç¼©</h3><p>ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶ä¸²è¡¨ç¤ºä¸€è¡Œä¸­æ¯ä¸ªä½ç½®æœ‰æ²¡æœ‰äººå</p>
<p>å¦‚ 0011 è¡¨ç¤º æ— æ— æœ‰æœ‰ï¼Œè®°ä¸º3</p>
<h3 id="çŠ¶æ€è¡¨ç¤º-6"><a href="#çŠ¶æ€è¡¨ç¤º-6" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[row][pre] è¡¨ç¤ºå½“row-1è¡Œçš„åæ³•ä¸ºpreæ—¶ï¼Œç¬¬rowè¡ŒåŠåé¢æ‰€æœ‰è¡Œæœ€å¤šåå¤šå°‘äºº</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œpreåˆå§‹åŒ–çš„å¤§å°ä¸º 1 &lt;&lt; åˆ—æ•°</p>
<p>å¦‚ æœ‰6åˆ—ï¼Œæœ€å¤š 2 ^ 6 ç§åæ³•ï¼Œå³ 1 &lt;&lt; 6</p>
<h3 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-6"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-6" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[row][pre] &#x3D; max&#123; dp[row+1][cur] + Integer.bitCount(cur) &#125;</span><br><span class="line">å…¶ä¸­curæ˜¯rowè¡Œæ‰€æœ‰å¯è¡ŒçŠ¶æ€</span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡éœ€å…ˆåˆ¤æ–­åæ³•ä¸º cur æ˜¯å¦å¯è¡Œ</p>
<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dp[0][0] å³ä¸º ç¬¬-1è¡Œæ²¡äººåæ—¶ï¼Œç¬¬1è¡ŒåŠåé¢æ‰€æœ‰è¡Œæœ€å¤šåçš„äººæ•°</span><br></pre></td></tr></table></figure>

<h3 id="å®ç°-6"><a href="#å®ç°-6" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">char</span>[][] seats;</span><br><span class="line">    <span class="keyword">private</span> Integer[][] dp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxStudents</span><span class="params">(<span class="keyword">char</span>[][] seats)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.seats = seats;</span><br><span class="line">        dp = <span class="keyword">new</span> Integer[seats.length][<span class="number">1</span> &lt;&lt; seats[<span class="number">0</span>].length];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ret = getDp(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDp</span><span class="params">(<span class="keyword">int</span> row,<span class="keyword">int</span> pre)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(row == seats.length)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(dp[row][pre] == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// éå†rowè¡Œæ‰€æœ‰åæ³•</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;dp[<span class="number">0</span>].length;i++)&#123;</span><br><span class="line">                <span class="comment">// æ£€æŸ¥æ˜¯å¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">                <span class="keyword">if</span>(isValid(row,pre,i))&#123;</span><br><span class="line">                    <span class="keyword">int</span> backNum = getDp(row+<span class="number">1</span>,i);     <span class="comment">// åæ’èƒ½åå¤šå°‘</span></span><br><span class="line">                    <span class="keyword">int</span> curNum = Integer.bitCount(i); <span class="comment">// æœ¬æ’èƒ½åå¤šå°‘</span></span><br><span class="line">                    res = Math.max(res,backNum+curNum);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            dp[row][pre] = res;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[row][pre];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// åˆ¤æ–­å½“ç¬¬row-1è¡Œåæ³•ä¸ºpreæ—¶ï¼Œrowè¡Œåæ³•ä¸ºcuræ˜¯å¦å¯è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> pre, <span class="keyword">int</span> cur)</span> </span>&#123; <span class="comment">//... &#125;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Exercise</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode.337 æ‰“å®¶åŠ«èˆ</title>
    <url>/2020/03/12/exercise/</url>
    <content><![CDATA[<a href="https://leetcode-cn.com/problems/house-robber-iii/" title="" target="">é¢˜ç›®åœ°å€</a>

<h1 id="æš´åŠ›æŠ¢åŠ«"><a href="#æš´åŠ›æŠ¢åŠ«" class="headerlink" title="æš´åŠ›æŠ¢åŠ«"></a>æš´åŠ›æŠ¢åŠ«</h1><p>å†™å‡ºæ¥å€’æ˜¯æŒºå¿«ï¼Œç»“æœå‘ç°æ—¶é—´çˆ†ç‚¸</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Math.max(find(root,<span class="keyword">true</span>),find(root,<span class="keyword">false</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(TreeNode root, <span class="keyword">boolean</span> isGap)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(!isGap)&#123;</span><br><span class="line">            <span class="comment">// æœ¬å±‚æŠ¢ï¼Œä¸‹å±‚ä¸èƒ½æŠ¢</span></span><br><span class="line">            ret+=root.val;</span><br><span class="line">            ret+=find(root.left,<span class="keyword">false</span>);</span><br><span class="line">            ret+=find(root.right,<span class="keyword">false</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> next1 = Math.max(find(root.left,<span class="keyword">true</span>),find(root.left,<span class="keyword">false</span>));</span><br><span class="line">            <span class="keyword">int</span> next2 = Math.max(find(root.right,<span class="keyword">true</span>),find(root.right,<span class="keyword">false</span>));</span><br><span class="line">            ret = next1 + next2;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ‰§è¡Œç”¨æ—¶ï¼š2817 ms</span><br><span class="line">å†…å­˜æ¶ˆè€—ï¼š39.3 MB</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å†™æ¯æ¬¡éƒ½é€’å½’æ‰¾äº†è‡³å°‘2æ¬¡ã€ç”šè‡³4æ¬¡å­èŠ‚ç‚¹</p>
<p>ç›¸å½“äºæŠŠäºŒå‰æ ‘çœä¸‹æ¥çš„logåˆç»™ç¿»å€ä¹˜å›å»äº†</p>
<h1 id="æœºæ™ºçš„åŠ«åŒª"><a href="#æœºæ™ºçš„åŠ«åŒª" class="headerlink" title="æœºæ™ºçš„åŠ«åŒª"></a>æœºæ™ºçš„åŠ«åŒª</h1><p>çœ‹äº†é¢˜è§£ä¸­ä¸€æ¬¡è¿”å›2ç§æƒ…å†µï¼Œä¿®æ”¹ä¸€ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">rob</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] ans = find(root);</span><br><span class="line">        <span class="keyword">return</span> Math.max(ans[<span class="number">0</span>],ans[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] find(TreeNode root)&#123;</span><br><span class="line">        <span class="comment">// ret0-æœ¬å±‚ä¸æŠ¢ï¼›ret1-æœ¬å±‚æŠ¢</span></span><br><span class="line">        <span class="keyword">int</span>[] ret = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(root==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span>[] left = find(root.left);</span><br><span class="line">        <span class="keyword">int</span>[] right = find(root.right);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¸‹å±‚çˆ±æŠ¢ä¸æŠ¢</span></span><br><span class="line">        ret[<span class="number">0</span>] = Math.max(left[<span class="number">0</span>],left[<span class="number">1</span>]) + Math.max(right[<span class="number">0</span>],right[<span class="number">1</span>]);</span><br><span class="line">        <span class="comment">// ä¸‹å±‚ä¸èƒ½æŠ¢</span></span><br><span class="line">        ret[<span class="number">1</span>] = root.val + left[<span class="number">0</span>] + right[<span class="number">0</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ‰§è¡Œç”¨æ—¶ï¼š1 ms</span><br><span class="line">å†…å­˜æ¶ˆè€—ï¼š41.6 MB</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±åªéå†äº†1æ¬¡</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€’å½’ä¸­å¦‚æœè¦åˆ†æƒ…å†µè®¨è®ºï¼Œä¸€æ¬¡è¿”å›å¤šä¸ªç»“æœï¼Œä¸è¦å¤šæ¬¡è°ƒç”¨é€’å½’</p>
]]></content>
      <categories>
        <category>Exercise</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>Android 10 å†™æ–‡ä»¶æƒé™é—®é¢˜</title>
    <url>/2020/03/12/debug-android/</url>
    <content><![CDATA[<h1 id="bugæè¿°"><a href="#bugæè¿°" class="headerlink" title="bugæè¿°"></a>bugæè¿°</h1><p>æ¢æ‰‹æœºä¹‹åä¸€ä¸ªä»¥å‰æ²¡æ¯›ç—…çš„å†™æ–‡ä»¶æ“ä½œå†™ä¸äº†äº†<br>ä¼°æ‘¸ç€æ˜¯ç‰ˆæœ¬é—®é¢˜</p>
<h1 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h1><p>AndroidManifest.xmlä¸­ï¼Œapplicationæ ‡ç­¾ä¸­åŠ </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">android:requestLegacyExternalStorage&#x3D;&quot;true&quot;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ref:<br><a href="https://blog.csdn.net/weixin_40093242/article/details/104067573?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40093242/article/details/104067573?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Debug</category>
      </categories>
  </entry>
  <entry>
    <title>Springç¬”è®°10 AOP</title>
    <url>/2020/03/12/note-spring-10/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p56~65</p>
</blockquote>
<hr>
<h1 id="AOPæ¦‚è¿°"><a href="#AOPæ¦‚è¿°" class="headerlink" title="AOPæ¦‚è¿°"></a>AOPæ¦‚è¿°</h1><p>Aspect Oriented Programming é¢å‘åˆ‡é¢ç¼–ç¨‹</p>
<ul>
<li><p>æ‰©å±•åŠŸèƒ½ä¸é€šè¿‡ä¿®æ”¹æºä»£ç å®ç°</p>
</li>
<li><p>AOPé‡‡å–æ¨ªå‘æŠ½å–æœºåˆ¶ï¼Œå–ä»£äº†ä¼ ç»Ÿçš„çºµå‘ç»§æ‰¿ä½“ç³»é‡å¤æ€§ä»£ç </p>
</li>
<li><p>åº•å±‚ä½¿ç”¨åŠ¨æ€ä»£ç†æ–¹æ³•å®ç°</p>
<ul>
<li>æœ‰æ¥å£æ—¶ï¼Œä½¿ç”¨jdkåŠ¨æ€ä»£ç†ï¼Œåˆ›å»ºå’Œæ¥å£å®ç°å¹³çº§çš„ä»£ç†å¯¹è±¡</li>
<li>æ— æ¥å£æ—¶ï¼Œä½¿ç”¨cglibåŠ¨æ€ä»£ç†ï¼Œåˆ›å»ºç±»çš„å­ç±»çš„ä»£ç†å¯¹è±¡</li>
</ul>
</li>
</ul>
<h2 id="ä½œç”¨åŠä¼˜åŠ¿"><a href="#ä½œç”¨åŠä¼˜åŠ¿" class="headerlink" title="ä½œç”¨åŠä¼˜åŠ¿"></a>ä½œç”¨åŠä¼˜åŠ¿</h2><p>ä½œç”¨ï¼š</p>
<ul>
<li>åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ï¼Œä¸ä¿®æ”¹æºç å¯¹å·²æœ‰æ–¹æ³•è¿›è¡Œå¢å¼º</li>
</ul>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å‡å°‘é‡å¤ä»£ç </li>
<li>æé«˜å¼€å‘æ•ˆç‡</li>
<li>ç»´æŠ¤æ–¹ä¾¿</li>
</ul>
<h1 id="Springä¸­çš„AOP"><a href="#Springä¸­çš„AOP" class="headerlink" title="Springä¸­çš„AOP"></a>Springä¸­çš„AOP</h1><h2 id="ç›¸å…³æœ¯è¯­"><a href="#ç›¸å…³æœ¯è¯­" class="headerlink" title="ç›¸å…³æœ¯è¯­"></a>ç›¸å…³æœ¯è¯­</h2><h3 id="Joinpoint-è¿æ¥ç‚¹"><a href="#Joinpoint-è¿æ¥ç‚¹" class="headerlink" title="Joinpoint è¿æ¥ç‚¹"></a>Joinpoint è¿æ¥ç‚¹</h3><p>ç±»ä¸­å¯ä»¥è¢«å¢å¼ºçš„æ–¹æ³•</p>
<h3 id="Pointcut-åˆ‡å…¥ç‚¹"><a href="#Pointcut-åˆ‡å…¥ç‚¹" class="headerlink" title="Pointcut åˆ‡å…¥ç‚¹"></a>Pointcut åˆ‡å…¥ç‚¹</h3><p>ç±»ä¸­å®é™…å¢å¼ºçš„æ–¹æ³•</p>
<h3 id="Advice-é€šçŸ¥-å¢å¼º"><a href="#Advice-é€šçŸ¥-å¢å¼º" class="headerlink" title="Advice é€šçŸ¥/å¢å¼º"></a>Advice é€šçŸ¥/å¢å¼º</h3><p>åˆ‡å…¥ç‚¹ä¸Šæ‰©å±•çš„åŠŸèƒ½</p>
<ul>
<li>å‰ç½®å¢å¼ºï¼šåœ¨æ–¹æ³•ä¹‹å‰æ‰§è¡Œ</li>
<li>åç½®å¢å¼ºï¼šåœ¨æ–¹æ³•æ­£å¸¸æ‰§è¡Œä¹‹åæ‰§è¡Œ</li>
<li>æœ€ç»ˆå¢å¼ºï¼šåœ¨æœ€åæ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸</li>
<li>ç¯ç»•å¢å¼ºï¼šåœ¨ä¹‹å‰å’Œä¹‹åæ‰§è¡Œ</li>
<li>å¼‚å¸¸å¢å¼ºï¼šæ–¹æ³•å‡ºç°å¼‚å¸¸æ—¶æ‰§è¡Œ</li>
</ul>
<h3 id="Introduction-å¼•ä»‹"><a href="#Introduction-å¼•ä»‹" class="headerlink" title="Introduction å¼•ä»‹"></a>Introduction å¼•ä»‹</h3><p>ä¸€ç§ç‰¹æ®Šçš„å¢å¼ºï¼Œåœ¨ä¸ä¿®æ”¹ç±»ä»£ç çš„å‰æä¸‹ï¼Œå¯ä»¥åœ¨è¿è¡ŒæœŸé—´ä¸ºç±»åŠ¨æ€åœ°æ·»åŠ ä¸€äº›æ–¹æ³•æˆ–Field</p>
<h3 id="Target-ç›®æ ‡å¯¹è±¡"><a href="#Target-ç›®æ ‡å¯¹è±¡" class="headerlink" title="Target ç›®æ ‡å¯¹è±¡"></a>Target ç›®æ ‡å¯¹è±¡</h3><p>è¦å¢å¼ºçš„ç±»</p>
<h3 id="Weaving-ç»‡å…¥"><a href="#Weaving-ç»‡å…¥" class="headerlink" title="Weaving ç»‡å…¥"></a>Weaving ç»‡å…¥</h3><p>æŠŠå¢å¼ºåº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡çš„è¿‡ç¨‹</p>
<h3 id="Proxy-ä»£ç†"><a href="#Proxy-ä»£ç†" class="headerlink" title="Proxy ä»£ç†"></a>Proxy ä»£ç†</h3><p>ä¸€ä¸ªç±»è¢«AOPç»‡å…¥å¢å¼ºåï¼Œå°±äº§ç”Ÿä¸€ä¸ªç»“æœä»£ç†ç±»</p>
<h3 id="Aspect-åˆ‡é¢"><a href="#Aspect-åˆ‡é¢" class="headerlink" title="Aspect åˆ‡é¢"></a>Aspect åˆ‡é¢</h3><p>åˆ‡å…¥ç‚¹ + é€šçŸ¥/å¼•ä»‹</p>
<h1 id="SpringåŸºäºXMLçš„AOPé…ç½®"><a href="#SpringåŸºäºXMLçš„AOPé…ç½®" class="headerlink" title="SpringåŸºäºXMLçš„AOPé…ç½®"></a>SpringåŸºäºXMLçš„AOPé…ç½®</h1><h2 id="é…ç½®æ­¥éª¤"><a href="#é…ç½®æ­¥éª¤" class="headerlink" title="é…ç½®æ­¥éª¤"></a>é…ç½®æ­¥éª¤</h2><ol>
<li><p>é…ç½®å¢å¼ºBean</p>
</li>
<li><p>ä½¿ç”¨aop:configæ ‡ç­¾è¡¨æ˜å¼€å§‹AOPçš„é…ç½®</p>
</li>
<li><p>ä½¿ç”¨aop:aspectæ ‡ç­¾è¡¨æ˜é…ç½®åˆ‡é¢</p>
<p>idå±æ€§ï¼šæ˜¯ç»™åˆ‡é¢æä¾›ä¸€ä¸ªå”¯ä¸€æ ‡è¯†<br>refå±æ€§ï¼šæ˜¯æŒ‡å®šé€šçŸ¥ç±»beançš„Id</p>
</li>
<li><p>åœ¨aop:aspectæ ‡ç­¾çš„å†…éƒ¨ä½¿ç”¨å¯¹åº”æ ‡ç­¾æ¥é…ç½®é€šçŸ¥çš„ç±»å‹</p>
<p>aop:beforeï¼šè¡¨ç¤ºé…ç½®å‰ç½®é€šçŸ¥ï¼ˆå®ä¾‹ä¸­è®©printLogæ–¹æ³•åœ¨åˆ‡å…¥ç‚¹æ–¹æ³•å‰æ‰§è¡Œï¼‰<br>methodå±æ€§ï¼šç”¨äºæŒ‡å®šç±»ä¸­å“ªä¸ªæ–¹æ³•æ˜¯å‰ç½®é€šçŸ¥<br>pointcutå±æ€§ï¼šç”¨äºæŒ‡å®šåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼çš„å«ä¹‰æŒ‡çš„æ˜¯å¯¹ä¸šåŠ¡å±‚ä¸­å“ªäº›æ–¹æ³•å¢å¼º</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„å†™æ³•ï¼š</span><br><span class="line">	å…³é”®å­—ï¼šexecution(è¡¨è¾¾å¼)</span><br><span class="line">	è¡¨è¾¾å¼ï¼š</span><br><span class="line">		è®¿é—®ä¿®é¥°ç¬¦  è¿”å›å€¼  åŒ…å.åŒ…å.åŒ…å...ç±»å.æ–¹æ³•å(å‚æ•°åˆ—è¡¨)</span><br><span class="line">		</span><br><span class="line">	æ ‡å‡†çš„è¡¨è¾¾å¼å†™æ³•ï¼š</span><br><span class="line">		public void com.itheima.service.impl.AccountServiceImpl.saveAccount()</span><br><span class="line">	è®¿é—®ä¿®é¥°ç¬¦å¯ä»¥çœç•¥</span><br><span class="line">		void com.itheima.service.impl.AccountServiceImpl.saveAccount()</span><br><span class="line">	è¿”å›å€¼å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œè¡¨ç¤ºä»»æ„è¿”å›å€¼</span><br><span class="line">		* com.itheima.service.impl.AccountServiceImpl.saveAccount()</span><br><span class="line">	åŒ…åå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œè¡¨ç¤ºä»»æ„åŒ…ã€‚ä½†æ˜¯æœ‰å‡ çº§åŒ…ï¼Œå°±éœ€è¦å†™å‡ ä¸ª*.</span><br><span class="line">		* *.*.*.*.AccountServiceImpl.saveAccount())</span><br><span class="line">	åŒ…åå¯ä»¥ä½¿ç”¨..è¡¨ç¤ºå½“å‰åŒ…åŠå…¶å­åŒ…</span><br><span class="line">		* *..AccountServiceImpl.saveAccount()</span><br><span class="line">	ç±»åå’Œæ–¹æ³•åéƒ½å¯ä»¥ä½¿ç”¨*æ¥å®ç°é€šé…</span><br><span class="line">		* *..*.*()</span><br><span class="line"></span><br><span class="line">	å‚æ•°åˆ—è¡¨ï¼š</span><br><span class="line">		å¯ä»¥ç›´æ¥å†™æ•°æ®ç±»å‹ï¼š</span><br><span class="line">			åŸºæœ¬ç±»å‹ç›´æ¥å†™åç§°           int</span><br><span class="line">			å¼•ç”¨ç±»å‹å†™åŒ…å.ç±»åçš„æ–¹å¼   java.lang.String</span><br><span class="line">			å¯ä»¥ä½¿ç”¨é€šé…ç¬¦è¡¨ç¤ºä»»æ„ç±»å‹ï¼Œä½†æ˜¯å¿…é¡»æœ‰å‚æ•°</span><br><span class="line">			å¯ä»¥ä½¿ç”¨..è¡¨ç¤ºæœ‰æ— å‚æ•°å‡å¯ï¼Œæœ‰å‚æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹</span><br><span class="line"></span><br><span class="line">	å…¨é€šé…å†™æ³•ï¼š</span><br><span class="line">		* *..*.*(..)</span><br><span class="line"></span><br><span class="line">	å®é™…å¼€å‘ä¸­åˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„é€šå¸¸å†™æ³•ï¼š</span><br><span class="line">		åˆ‡åˆ°ä¸šåŠ¡å±‚å®ç°ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•</span><br><span class="line">			* com.itheima.service.impl.*.*(..)</span><br></pre></td></tr></table></figure>

<h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><h3 id="xmlé…ç½®"><a href="#xmlé…ç½®" class="headerlink" title="xmlé…ç½®"></a>xmlé…ç½®</h3><p>åœ¨Spring Framework Documentationçš„Coreä¸­æœç´¢xmlns:aopï¼Œå¯¼å…¥çº¦æŸ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®srpingçš„Ioc,æŠŠserviceå¯¹è±¡é…ç½®è¿›æ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">     <span class="comment">&lt;!-- é…ç½®Loggerç±» --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"logger"</span> <span class="attr">class</span>=<span class="string">"com.itheima.utils.Logger"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®AOP--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é…ç½®åˆ‡é¢ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">id</span>=<span class="string">"logAdvice"</span> <span class="attr">ref</span>=<span class="string">"logger"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®é€šçŸ¥çš„ç±»å‹ï¼Œå¹¶ä¸”å»ºç«‹é€šçŸ¥æ–¹æ³•å’Œåˆ‡å…¥ç‚¹æ–¹æ³•çš„å…³è”--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"printLog"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:before</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¸šåŠ¡å±‚"><a href="#ä¸šåŠ¡å±‚" class="headerlink" title="ä¸šåŠ¡å±‚"></a>ä¸šåŠ¡å±‚</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„ä¸šåŠ¡å±‚æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿä¿å­˜è´¦æˆ· æ— è¿”å›å€¼æ— å‚</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿæ›´æ–°è´¦æˆ· æ— è¿”å›å€¼æœ‰å‚</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è´¦æˆ· æœ‰è¿”å›å€¼æ— å‚</span></span><br><span class="line">   <span class="function"><span class="keyword">int</span>  <span class="title">deleteAccount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„ä¸šåŠ¡å±‚å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ‰§è¡Œäº†ä¿å­˜"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ‰§è¡Œäº†æ›´æ–°"</span>+i);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ‰§è¡Œäº†åˆ é™¤"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é€šçŸ¥"><a href="#é€šçŸ¥" class="headerlink" title="é€šçŸ¥"></a>é€šçŸ¥</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºè®°å½•æ—¥å¿—çš„å·¥å…·ç±»ï¼Œå®ƒé‡Œé¢æä¾›äº†å…¬å…±çš„ä»£ç </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨äºæ‰“å°æ—¥å¿—ï¼šè®¡åˆ’è®©å…¶åœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">printLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Loggerç±»ä¸­çš„pringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•AOPçš„é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AOPTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);</span><br><span class="line">        <span class="comment">//2.è·å–å¯¹è±¡</span></span><br><span class="line">        IAccountService as = (IAccountService)ac.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">        <span class="comment">//3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        as.saveAccount();</span><br><span class="line">        as.updateAccount(<span class="number">1</span>);</span><br><span class="line">        as.deleteAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-12AM9.48.57.jpg">

<h2 id="é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"><a href="#é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼" class="headerlink" title="é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"></a>é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</h2><p>idå±æ€§ç”¨äºæŒ‡å®šè¡¨è¾¾å¼çš„å”¯ä¸€æ ‡è¯†</p>
<p>expressionå±æ€§ç”¨äºæŒ‡å®šè¡¨è¾¾å¼å†…å®¹</p>
<p>è¯¥æ ‡ç­¾å†™åœ¨aop:aspectæ ‡ç­¾å†…éƒ¨åªèƒ½å½“å‰åˆ‡é¢ä½¿ç”¨</p>
<p>è¿˜å¯ä»¥å†™åœ¨aop:aspectå¤–é¢ï¼Œæ­¤æ—¶å°±å˜æˆäº†æ‰€æœ‰åˆ‡é¢å¯ç”¨</p>
<p>æ³¨æ„ï¼šå¿…é¡»æ”¾åœ¨åˆ‡é¢ä¹‹å‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆè¿˜ä¸æé†’æ€ä¹ˆé”™çš„ï¼‰</p>
<h2 id="4ç§å¸¸ç”¨é€šçŸ¥ç±»å‹"><a href="#4ç§å¸¸ç”¨é€šçŸ¥ç±»å‹" class="headerlink" title="4ç§å¸¸ç”¨é€šçŸ¥ç±»å‹"></a>4ç§å¸¸ç”¨é€šçŸ¥ç±»å‹</h2><p>ç»§ç»­åœ¨åˆšæ‰çš„å®ä¾‹ä¸ŠåŠ å…¶å®ƒé€šçŸ¥ç±»å‹</p>
<p>ä½¿ç”¨åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç®€åŒ–é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®AOP--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pt1"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:pointcut</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®åˆ‡é¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">id</span>=<span class="string">"logAdvice"</span> <span class="attr">ref</span>=<span class="string">"logger"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®å‰ç½®é€šçŸ¥ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"beforePrintLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span> &gt;</span><span class="tag">&lt;/<span class="name">aop:before</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®åç½®é€šçŸ¥ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ­£å¸¸æ‰§è¡Œä¹‹åå€¼ã€‚å®ƒå’Œå¼‚å¸¸é€šçŸ¥æ°¸è¿œåªèƒ½æ‰§è¡Œä¸€ä¸ª--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">"afterReturningPrintLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after-returning</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®å¼‚å¸¸é€šçŸ¥ï¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œäº§ç”Ÿå¼‚å¸¸ä¹‹åæ‰§è¡Œã€‚å®ƒå’Œåç½®é€šçŸ¥æ°¸è¿œåªèƒ½æ‰§è¡Œä¸€ä¸ª--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"afterThrowingPrintLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after-throwing</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®æœ€ç»ˆé€šçŸ¥ï¼šæ— è®ºåˆ‡å…¥ç‚¹æ–¹æ³•æ˜¯å¦æ­£å¸¸æ‰§è¡Œå®ƒéƒ½ä¼šåœ¨å…¶åé¢æ‰§è¡Œ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"afterPrintLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ‡å…¥ç‚¹æ–¹æ³•æ— å¼‚å¸¸æ—¶è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‰ç½®é€šçŸ¥Loggerç±»ä¸­çš„beforePrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">æ‰§è¡Œäº†ä¿å­˜</span><br><span class="line">åç½®é€šçŸ¥Loggerç±»ä¸­çš„afterReturningPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">æœ€ç»ˆé€šçŸ¥Loggerç±»ä¸­çš„afterPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br></pre></td></tr></table></figure>

<p>åˆ‡å…¥ç‚¹æ–¹æ³•æœ‰å¼‚å¸¸æ—¶è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‰ç½®é€šçŸ¥Loggerç±»ä¸­çš„beforePrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">æ‰§è¡Œäº†ä¿å­˜</span><br><span class="line">å¼‚å¸¸é€šçŸ¥Loggerç±»ä¸­çš„afterThrowingPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">æœ€ç»ˆé€šçŸ¥Loggerç±»ä¸­çš„afterPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.ArithmeticException: &#x2F; by zero</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>åç½®å’Œå¼‚å¸¸åªä¼šæ‰§è¡Œå…¶ä¸­ä¸€ä¸ª</p>
<h2 id="ç¯ç»•é€šçŸ¥"><a href="#ç¯ç»•é€šçŸ¥" class="headerlink" title="ç¯ç»•é€šçŸ¥"></a>ç¯ç»•é€šçŸ¥</h2><p>ä¸‹é¢è¿™æ ·é…ç½®ç¯ç»•é€šçŸ¥æ˜¯ä¸è¡Œçš„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">aroundPringLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">       System.out.println(<span class="string">"Loggerç±»ä¸­çš„afterThrowingPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†..."</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·é…ç½®åï¼Œåˆ‡å…¥ç‚¹æ–¹æ³•ä¸æ‰§è¡Œäº†ï¼Œåªæ‰§è¡Œé€šçŸ¥æ–¹æ³•</p>
<p>åˆ†æï¼šå¯¹æ¯”åŠ¨æ€ä»£ç†ä¸­ï¼Œå‘ç°å…¶ä¸­çš„ç¯ç»•é€šçŸ¥æœ‰æ˜ç¡®çš„åˆ‡å…¥ç‚¹è°ƒç”¨ï¼Œè€Œè¿™æ ·æ²¡æœ‰</p>
<p>è§£å†³ï¼šä½¿ç”¨Springçš„ProceedingJoinPointæ¥å£ã€‚è¯¥æ¥å£æœ‰ä¸€ä¸ªproceed()æ–¹æ³•ï¼Œåœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼ŒSpringä¼šæä¾›è¯¥æ¥å£çš„å®ç°ç±»ä¾›æˆ‘ä»¬ä½¿ç”¨</p>
<p>è¿™æ ·å¯ä»¥æ§åˆ¶å¢å¼ºæ–¹æ³•ä½•æ—¶æ‰§è¡Œï¼Œå‰ç½®ã€åç½®ã€å¼‚å¸¸ã€æœ€ç»ˆéƒ½å¯ä»¥å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line">	 <span class="function"><span class="keyword">public</span> Object <span class="title">aroundPringLog</span><span class="params">(ProceedingJoinPoint pjp)</span></span>&#123;</span><br><span class="line">        Object rtValue = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Object[] args = pjp.getArgs();<span class="comment">// å¾—åˆ°æ–¹æ³•æ‰§è¡Œæ‰€éœ€çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...å‰ç½®"</span>);</span><br><span class="line">            rtValue = pjp.proceed(args);<span class="comment">// æ˜ç¡®è°ƒç”¨ä¸šåŠ¡å±‚æ–¹æ³•ï¼ˆåˆ‡å…¥ç‚¹æ–¹æ³•ï¼‰</span></span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...åç½®"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> rtValue;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Throwable t)&#123;</span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...å¼‚å¸¸"</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(t);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...æœ€ç»ˆ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ç¯ç»•é€šçŸ¥--&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">"aroundPringLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pt1"</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:around</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="SpringåŸºäºæ³¨è§£çš„AOPé…ç½®"><a href="#SpringåŸºäºæ³¨è§£çš„AOPé…ç½®" class="headerlink" title="SpringåŸºäºæ³¨è§£çš„AOPé…ç½®"></a>SpringåŸºäºæ³¨è§£çš„AOPé…ç½®</h1><h2 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><h3 id="xmlé…ç½®-1"><a href="#xmlé…ç½®-1" class="headerlink" title="xmlé…ç½®"></a>xmlé…ç½®</h3><p>çº¦æŸæ¯”åŸºäºxmlçš„å¤šäº†context</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®springåˆ›å»ºå®¹å™¨æ—¶è¦æ‰«æçš„åŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.itheima"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®springå¼€å¯æ³¨è§£AOPçš„æ”¯æŒ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Loggeré…ç½®ï¼ˆ4ç§å¸¸ç”¨ç±»å‹ï¼‰ï¼-å»ºè®®åˆ«ç”¨ï¼Œæœ‰bug"><a href="#Loggeré…ç½®ï¼ˆ4ç§å¸¸ç”¨ç±»å‹ï¼‰ï¼-å»ºè®®åˆ«ç”¨ï¼Œæœ‰bug" class="headerlink" title="Loggeré…ç½®ï¼ˆ4ç§å¸¸ç”¨ç±»å‹ï¼‰ï¼[å»ºè®®åˆ«ç”¨ï¼Œæœ‰bug]"></a>Loggeré…ç½®ï¼ˆ4ç§å¸¸ç”¨ç±»å‹ï¼‰ï¼[å»ºè®®åˆ«ç”¨ï¼Œæœ‰bug]</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"logger"</span>)</span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">// è¡¨ç¤ºå½“å‰ç±»æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pt1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨æ„è¦åŠ ()</span></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"pt1()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">beforePrintLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å‰ç½®é€šçŸ¥Loggerç±»ä¸­çš„beforePrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning</span>(<span class="string">"pt1()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">afterReturningPrintLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åç½®é€šçŸ¥Loggerç±»ä¸­çš„afterReturningPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing</span>(<span class="string">"pt1()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">afterThrowingPrintLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å¼‚å¸¸é€šçŸ¥Loggerç±»ä¸­çš„afterThrowingPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"pt1()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">afterPrintLog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æœ€ç»ˆé€šçŸ¥Loggerç±»ä¸­çš„afterPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè¾“å‡ºï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">å‰ç½®é€šçŸ¥Loggerç±»ä¸­çš„beforePrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">æ‰§è¡Œäº†ä¿å­˜</span><br><span class="line">æœ€ç»ˆé€šçŸ¥Loggerç±»ä¸­çš„afterPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br><span class="line">åç½®é€šçŸ¥Loggerç±»ä¸­çš„afterReturningPrintLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...</span><br></pre></td></tr></table></figure>

<p>å‘ç°æœ€ç»ˆåœ¨åç½®ä¹‹å‰æ‰§è¡Œäº†ï¼ˆå¼‚å¸¸ä¹Ÿä¸€æ ·ï¼‰</p>
<p>æ²¡æœ‰åŠæ³•ï¼Œå› ä¸ºSpringåŸºäºæ³¨è§£çš„AOPä¸­ï¼Œè°ƒç”¨é¡ºåºç¡®å®æœ‰é—®é¢˜ï¼Œå®é™…å¼€å‘ä¸­åº”è¯¥æ…é‡</p>
<h3 id="Loggeré…ç½®ï¼ˆç¯ç»•é€šçŸ¥ï¼‰"><a href="#Loggeré…ç½®ï¼ˆç¯ç»•é€šçŸ¥ï¼‰" class="headerlink" title="Loggeré…ç½®ï¼ˆç¯ç»•é€šçŸ¥ï¼‰"></a>Loggeré…ç½®ï¼ˆç¯ç»•é€šçŸ¥ï¼‰</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"logger"</span>)</span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">// è¡¨ç¤ºå½“å‰ç±»æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(* com.itheima.service.impl.*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pt1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"pt1()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">aroundPringLog</span><span class="params">(ProceedingJoinPoint pjp)</span></span>&#123;</span><br><span class="line">        Object rtValue = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Object[] args = pjp.getArgs();<span class="comment">// å¾—åˆ°æ–¹æ³•æ‰§è¡Œæ‰€éœ€çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...å‰ç½®"</span>);</span><br><span class="line"></span><br><span class="line">            rtValue = pjp.proceed(args);<span class="comment">// æ˜ç¡®è°ƒç”¨ä¸šåŠ¡å±‚æ–¹æ³•ï¼ˆåˆ‡å…¥ç‚¹æ–¹æ³•ï¼‰</span></span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...åç½®"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> rtValue;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Throwable t)&#123;</span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...å¼‚å¸¸"</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(t);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...æœ€ç»ˆ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å°±æ²¡æœ‰é¡ºåºé—®é¢˜äº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...å‰ç½®</span><br><span class="line">æ‰§è¡Œäº†ä¿å­˜</span><br><span class="line">Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...åç½®</span><br><span class="line">Loggerç±»ä¸­çš„aroundPringLogæ–¹æ³•å¼€å§‹è®°å½•æ—¥å¿—äº†...æœ€ç»ˆ</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueç¬”è®°03 Element UIä½¿ç”¨&amp;åŠ¨æ€è·¯ç”±å¯¼èˆªæ </title>
    <url>/2020/03/11/note-vue-03/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av85793766" target="_blank" rel="noopener">https://www.bilibili.com/video/av85793766</a><br>p2~3</p>
</blockquote>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>å’Œä¸Šæ¬¡ä¸€æ ·åˆ›å»ºé¡¹ç›®ï¼Œåœ¨vue uiä¸­æ·»åŠ Element UIæ’ä»¶</p>
<p>Ideaä¸­å¯¼å…¥å·¥ç¨‹</p>
<p>å¦‚æœæ’ä»¶åœ¨åˆšæ‰UIä¸­æ²¡æœ‰è£…æˆåŠŸï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œè£…</p>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>Element UIçš„ä½¿ç”¨å¯ä»¥çœ‹å®˜ç½‘æ‰‹å†Œ</p>
<a href="https://element.eleme.cn/2.0/#/zh-CN" title="" target="">Elemnt UI ä¸­æ–‡å®˜ç½‘</a>

<p>æœ‰ä¸€äº›å¸¸è§çš„å¸ƒå±€æ–¹å¼</p>
<h2 id="å¯¼å…¥å®ä¾‹"><a href="#å¯¼å…¥å®ä¾‹" class="headerlink" title="å¯¼å…¥å®ä¾‹"></a>å¯¼å…¥å®ä¾‹</h2><p>ç›´æ¥æŠŠå®˜ç½‘å®ä¾‹å¤åˆ¶åˆ°App.vueä¸­ï¼ˆhtmlå¤åˆ¶åˆ°divæ ‡ç­¾ä¹‹é—´ï¼‰</p>
<p>åˆ·æ–°ç½‘é¡µå°±èƒ½çœ‹åˆ°æ•ˆæœ</p>
<h2 id="ä¸€äº›æ ‡ç­¾è¯´æ˜"><a href="#ä¸€äº›æ ‡ç­¾è¯´æ˜" class="headerlink" title="ä¸€äº›æ ‡ç­¾è¯´æ˜"></a>ä¸€äº›æ ‡ç­¾è¯´æ˜</h2><p>el-container: æ„å»ºæ•´ä¸ªâ»šé¢æ¡†æ¶</p>
<p>el-menu: å·¦ä¾§èœå•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">// :default-openedsé»˜è®¤å±•å¼€çš„èœå• :default-activeé»˜è®¤é€‰ä¸­çš„èœå•</span><br><span class="line"><span class="tag">&lt;<span class="name">el-menu</span> <span class="attr">:default-openeds</span>=<span class="string">"['1', '3']"</span> <span class="attr">:default-active</span>=<span class="string">"1-2"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è§†é¢‘é‡Œè¯´è¿™ä¸ªâ€1-2â€å¿…é¡»å†™æˆâ€[1-2]â€æˆ–åˆ™â€â€˜1-2â€™â€æ‰èƒ½è¯†åˆ«</p>
<p>ä½†æ˜¯è¯•äº†ä¸€ä¸‹ç›´æ¥å†™ä¹Ÿè¯†åˆ«äº†</p>
<p>el-submenu: å¯å±•å¼€çš„èœå•</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">// èœå•çš„ä¸‹æ ‡ï¼Œæ–‡æœ¬ç±»å‹ï¼Œä¸èƒ½æ˜¯æ•°å€¼ç±»å‹</span><br><span class="line"><span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">index</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">  // template:å¯¹åº” el-submenu çš„èœå•å i:è®¾ç½®èœå•å›¾æ ‡ï¼Œå…·ä½“åœ¨æ–‡æ¡£æ‰¾</span><br><span class="line">	<span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-message"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>å¯¼èˆªä¸€<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>éœ€è¦çš„è¯è¿˜å¯ä»¥åµŒå¥—å¤šçº§submenu</p>
<h2 id="é€šè¿‡vue-routeråŠ¨æ€æ„å»ºå·¦ä¾§èœå•"><a href="#é€šè¿‡vue-routeråŠ¨æ€æ„å»ºå·¦ä¾§èœå•" class="headerlink" title="é€šè¿‡vue routeråŠ¨æ€æ„å»ºå·¦ä¾§èœå•"></a>é€šè¿‡vue routeråŠ¨æ€æ„å»ºå·¦ä¾§èœå•</h2><h3 id="é…ç½®é¡µé¢"><a href="#é…ç½®é¡µé¢" class="headerlink" title="é…ç½®é¡µé¢"></a>é…ç½®é¡µé¢</h3><p>æ–°å»º4ä¸ªé¡µé¢ï¼Œåœ¨routerä¸­é…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Page1 <span class="keyword">from</span> <span class="string">'../views/Page1'</span></span><br><span class="line"><span class="keyword">import</span> Page2 <span class="keyword">from</span> <span class="string">'../views/Page2'</span></span><br><span class="line"><span class="keyword">import</span> Page3 <span class="keyword">from</span> <span class="string">'../views/Page3'</span></span><br><span class="line"><span class="keyword">import</span> Page4 <span class="keyword">from</span> <span class="string">'../views/Page4'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/page1'</span>,</span><br><span class="line">    name: <span class="string">'é¡µé¢1'</span>,</span><br><span class="line">    component: Page1</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/page2'</span>,</span><br><span class="line">    name: <span class="string">'é¡µé¢2'</span>,</span><br><span class="line">    component: Page2</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/page3'</span>,</span><br><span class="line">    name: <span class="string">'é¡µé¢3'</span>,</span><br><span class="line">    component: Page3</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/page4'</span>,</span><br><span class="line">    name: <span class="string">'é¡µé¢4'</span>,</span><br><span class="line">    component: Page4</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™æ ·è¿˜ä¸ä¼šæ˜¾ç¤ºï¼Œè¦åœ¨App.vueä¸­åŠ ä¸Šrouterå¯¹åº”çš„é¡µé¢</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">        ...</span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-11AM10.59.18.jpg">

<p>æ­¤æ—¶ç›¸å½“äºAppä¸­çš„å†…å®¹æ˜¯æœ¬æ¥å°±æ˜¾ç¤ºçš„ï¼Œä¸‹é¢çš„viewæ˜¯é™„åŠ ä¸Šå»çš„</p>
<p>è¿™æ ·æ”¾æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„</p>
<p>æŠŠå®ƒæ”¾åˆ°mainé‡Œé¢</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">				...</span><br><span class="line">				<span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/images/2020/screencapture2020-03-11AM11.03.53.jpg">

<p>è¿™æ ·å°±æ”¾è¿›å»äº†ï¼Œä¸‹ä¸€æ­¥æŠŠå®ƒä»¬è¿ä¸Š</p>
<h3 id="éå†router"><a href="#éå†router" class="headerlink" title="éå†router"></a>éå†router</h3><p>éœ€è¦ä¿®æ”¹routerçš„å±‚çº§ç»“æ„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'å¯¼èˆª1'</span>,</span><br><span class="line">    component:App,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page1'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢1'</span>,</span><br><span class="line">        component: Page1</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page2'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢2'</span>,</span><br><span class="line">        component: Page2</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path:<span class="string">'/navigation'</span>,</span><br><span class="line">    name: <span class="string">'å¯¼èˆª2'</span>,</span><br><span class="line">    component:App,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page3'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢3'</span>,</span><br><span class="line">        component: Page3</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page4'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢4'</span>,</span><br><span class="line">        component: Page4</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨App.vueä¸­è¯»å–</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">"200px"</span> <span class="attr">style</span>=<span class="string">"background-color: rgb(238, 241, 246)"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">el-menu</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">v-for</span>=<span class="string">"item in $router.options.routes"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-setting"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°±æ˜¾ç¤ºå‡ºæ¥äº†</p>
<img src="/images/2020/screencapture2020-03-11AM11.14.49.jpg">

<hr>
<p>ä¸€ä¸ªå°bug</p>
<p>é¡µé¢ä¸€å¼€å§‹æ˜¯ç©ºç™½çš„ï¼Œå‘ç°æ˜¯Appæ²¡æœ‰å¼•å…¥ï¼Œrouterä¸­è¦åŠ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br></pre></td></tr></table></figure>

<hr>
<p>æŠŠå†…å±‚çš„å…ƒç´ ä¹Ÿè¯»å‡ºæ¥</p>
<p>ç°åœ¨ç‚¹ä¸€ä¸ªå¯¼èˆªæ—¶ï¼Œä¸¤ä¸ªä¼šä¸€èµ·å±•å¼€ã€åˆä¸Šï¼Œå› ä¸ºæ²¡æœ‰åŠ index</p>
<p>å†åŠ ä¸Šindexå±æ€§ï¼ˆé€šè¿‡itemçš„ä¸‹æ ‡ï¼Œitemåœ¨å‰ï¼Œindexåœ¨åï¼‰ï¼Œéœ€è¦å­—ç¬¦ä¸²å±æ€§ï¼Œæ‹¼ä¸€ä¸ªâ€™â€™</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">"200px"</span> <span class="attr">style</span>=<span class="string">"background-color: rgb(238, 241, 246)"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-menu</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in $router.options.routes"</span> <span class="attr">:index</span>=<span class="string">"index+''"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-setting"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&#123;&#123;index&#125;&#125;-&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">v-for</span>=<span class="string">"(item2,index2) in item.children"</span> <span class="attr">:index</span>=<span class="string">"index+'-'+index2"</span>&gt;</span>&#123;&#123;item2.name&#125;&#125;<span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥å®šä½åˆ°æ¯ä¸€ä¸ªäº†</p>
<img src="/images/2020/screencapture2020-03-11AM11.29.49.jpg">

<h2 id="menuä¸routerç»‘å®š"><a href="#menuä¸routerç»‘å®š" class="headerlink" title="menuä¸routerç»‘å®š"></a>menuä¸routerç»‘å®š</h2><p>æŠŠAppä¸­çš„å†…å®¹æ”¾åˆ°Indexé¡µé¢ä¸­</p>
<p>1ã€ç»™ el-menu æ ‡ç­¾æ·»åŠ  router å±æ€§</p>
<p>2ã€åœ¨â»šé¢ä¸­æ·»åŠ  router-view æ ‡ç­¾ï¼ˆå®ƒæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥åŠ¨æ€æ¸²æŸ“é€‰æ‹©çš„routerï¼‰</p>
<p>3ã€el-menu-item æ ‡ç­¾çš„ index å€¼å°±æ˜¯è¦è·³è½¬çš„ router</p>
<p>é»˜è®¤é¡µé¢ï¼Œåœ¨routerä¸­å†™redirect</p>
<p>å¹¶åˆå§‹åŒ–é€‰ä¸­ï¼Œå¦‚æœé€‰æ‹©åˆ™åŠ is-activeçŠ¶æ€ã€‚ç”¨route.pathè·å–å½“å‰è·¯å¾„</p>
<img src="/images/2020/screencapture2020-03-11PM4.09.10.jpg">

<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a>æ–‡ä»¶ç»“æ„</h2><img src="/images/2020/screencapture2020-03-11PM4.10.22.jpg" width=300>

<h2 id="App-vue"><a href="#App-vue" class="headerlink" title="App.vue"></a>App.vue</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    è¿™ä¸ªrouterå¯¹åº”çš„å³ä¸º/ï¼Œä¹Ÿå°±æ˜¯Indexé¡µé¢--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Index-vue"><a href="#Index-vue" class="headerlink" title="Index.vue"></a>Index.vue</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">style</span>=<span class="string">"height: 500px; border: 1px solid #eee"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">"200px"</span> <span class="attr">style</span>=<span class="string">"background-color: rgb(238, 241, 246)"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            è¿™é‡Œæ·»åŠ routeræ ‡ç­¾ï¼Œel-menu-itemçš„indexå°±ä¼šè¢«ä½œä¸ºrouterè·¯å¾„--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-menu</span> <span class="attr">router</span> <span class="attr">:default-openeds</span>=<span class="string">"['0','1']"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-submenu</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in $router.options.routes"</span> <span class="attr">:index</span>=<span class="string">"index+''"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-setting"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>&#123;&#123;index&#125;&#125;-&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                    æ¡ä»¶åˆ¤æ–­å½“å‰è·¯å¾„æ˜¯å¦ç­‰äºindexï¼Œæ›´æ”¹é€‰ä¸­çŠ¶æ€ï¼Œä¸»è¦æ˜¯åœ¨åˆå§‹åŒ–æ—¶å¢åŠ é»˜è®¤çš„é€‰ä¸­çŠ¶æ€--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">v-for</span>=<span class="string">"item2 in item.children"</span> <span class="attr">:index</span>=<span class="string">"item2.path"</span> <span class="attr">:class</span>=<span class="string">"$route.path==item2.path ? 'is-active' : ''"</span>&gt;</span>&#123;&#123;item2.path&#125;&#125;-&#123;&#123;item2.name&#125;&#125;<span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-submenu</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            ä¸Šé¢åˆindexç¡®å®šçš„routerè¢«æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯mainåŒºåŸŸä¸­--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    name: <span class="string">'å¯¼èˆª1'</span>,</span><br><span class="line">    component:Index,</span><br><span class="line">    redirect:<span class="string">'page1'</span>,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page1'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢1'</span>,</span><br><span class="line">        component: Page1</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page2'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢2'</span>,</span><br><span class="line">        component: Page2</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path:<span class="string">'/navigation'</span>,</span><br><span class="line">    name: <span class="string">'å¯¼èˆª2'</span>,</span><br><span class="line">    component:Index,</span><br><span class="line">    children:[</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page3'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢3'</span>,</span><br><span class="line">        component: Page3</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'/page4'</span>,</span><br><span class="line">        name: <span class="string">'é¡µé¢4'</span>,</span><br><span class="line">        component: Page4</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åŒºåˆ«ï¼šrouter/route/routes</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>maxOSæˆªå›¾è®¾ç½®</title>
    <url>/2020/03/11/mac-screencapture/</url>
    <content><![CDATA[<p>é—®é¢˜ï¼šä»¥å‰æ’å…¥æˆªå›¾å¾—å…ˆæ”¹æ–‡ä»¶åï¼Œè¦æ—¶é—´æˆ³ä¸å«ä¸­æ–‡ï¼Œè€Œä¸”pngç‰¹åˆ«å¤§ï¼Œæœ€å¥½è½¬æˆjpgï¼Œå¾ˆéº»çƒ¦</p>
<p>ç›®æ ‡ï¼šæ–‡ä»¶åæ—¶é—´æˆ³ä¸å«ä¸­æ–‡ &amp; jpgæ ¼å¼</p>
<hr>
<h1 id="ä¸€é€šæ“ä½œ"><a href="#ä¸€é€šæ“ä½œ" class="headerlink" title="ä¸€é€šæ“ä½œ"></a>ä¸€é€šæ“ä½œ</h1><h2 id="æ”¹æ ¼å¼"><a href="#æ”¹æ ¼å¼" class="headerlink" title="æ”¹æ ¼å¼"></a>æ”¹æ ¼å¼</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.screencapture type jpg</span><br></pre></td></tr></table></figure>

<h2 id="æ”¹å"><a href="#æ”¹å" class="headerlink" title="æ”¹å"></a>æ”¹å</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.screencapture name screencapture</span><br></pre></td></tr></table></figure>

<h2 id="æ”¹æ—¶é—´æˆ³æ ¼å¼"><a href="#æ”¹æ—¶é—´æˆ³æ ¼å¼" class="headerlink" title="æ”¹æ—¶é—´æˆ³æ ¼å¼"></a>æ”¹æ—¶é—´æˆ³æ ¼å¼</h2><p>ç³»ç»Ÿåå¥½è®¾ç½®-&gt;è¯­è¨€ä¸åœ°åŒº-&gt;é«˜çº§-&gt;æ—¶é—´</p>
<p>æ­£åˆå‰å’Œä¸­åˆåæ¡†ä¸­ï¼šä¸Šåˆ/ä¸‹åˆæ”¹æˆAM/PM </p>
<h2 id="å®Œå·¥"><a href="#å®Œå·¥" class="headerlink" title="å®Œå·¥"></a>å®Œå·¥</h2><p>Before:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆªå±2020-03-11ä¸Šåˆ9.50.34</span><br></pre></td></tr></table></figure>

<p>After:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screencapture2020-03-11AM10.05.30</span><br></pre></td></tr></table></figure>



<hr>
<h1 id="å‘½ä»¤å¤‡å¿˜"><a href="#å‘½ä»¤å¤‡å¿˜" class="headerlink" title="å‘½ä»¤å¤‡å¿˜"></a>å‘½ä»¤å¤‡å¿˜</h1><h2 id="ä¿®æ”¹æ ¼å¼"><a href="#ä¿®æ”¹æ ¼å¼" class="headerlink" title="ä¿®æ”¹æ ¼å¼"></a>ä¿®æ”¹æ ¼å¼</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.screencapture type jpg</span><br></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹æ–‡ä»¶å"><a href="#ä¿®æ”¹æ–‡ä»¶å" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶å"></a>ä¿®æ”¹æ–‡ä»¶å</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.screencapture name XXX</span><br></pre></td></tr></table></figure>

<h2 id="æ—¶é—´æˆ³"><a href="#æ—¶é—´æˆ³" class="headerlink" title="æ—¶é—´æˆ³"></a>æ—¶é—´æˆ³</h2><h3 id="ç§»é™¤æ—¶é—´æˆ³"><a href="#ç§»é™¤æ—¶é—´æˆ³" class="headerlink" title="ç§»é™¤æ—¶é—´æˆ³"></a>ç§»é™¤æ—¶é—´æˆ³</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.screencapture &quot;include-date&quot; 0</span><br></pre></td></tr></table></figure>

<h3 id="åŠ æ—¶é—´æˆ³"><a href="#åŠ æ—¶é—´æˆ³" class="headerlink" title="åŠ æ—¶é—´æˆ³"></a>åŠ æ—¶é—´æˆ³</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defaults write com.apple.screencapture &quot;include-date&quot; 1</span><br></pre></td></tr></table></figure>

<h2 id="å…¶å®ƒå¸®åŠ©"><a href="#å…¶å®ƒå¸®åŠ©" class="headerlink" title="å…¶å®ƒå¸®åŠ©"></a>å…¶å®ƒå¸®åŠ©</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">screencapture -h</span><br></pre></td></tr></table></figure>



<blockquote>
<p>ref:</p>
<p><a href="https://zhuanlan.zhihu.com/p/73725126" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/73725126</a></p>
<p><a href="https://www.maketecheasier.com/remove-time-stamp-screenshot-mac/" target="_blank" rel="noopener">https://www.maketecheasier.com/remove-time-stamp-screenshot-mac/</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>tool</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¥åˆ°Hexoçš„ç¬¬ä¸€å¤©ï¼</title>
    <url>/2020/03/10/hello-hexo/</url>
    <content><![CDATA[<p>ä»ä¸‹åˆå¼€å§‹æ­å»ºï¼Œè°ƒä¸»é¢˜ï¼Œä¸€ç›´åˆ°æ™šä¸Šæ¬è¿å®Œäº†æ­£åœ¨å†™çš„ç¬”è®°ï¼Œå¿ƒæƒ…èˆ’ç•…</p>
<p>å…ˆå°è¯•çš„æ˜¯Jekyllï¼Œæˆ‘çš„è€å¤©é¹…å•Šï¼ŒæŠ˜è…¾äº†ä¸€æ•´å¤©ï¼Œä¸æ˜¯é…ç½®æœ‰é—®é¢˜å°±æ˜¯èµ„æºæœ‰é—®é¢˜ï¼Œæœ¬åœ°å¥½ä¸å®¹æ˜“æˆåŠŸäº†æäº¤åˆ°githubåˆå´©äº†ï¼ŒbuildæˆåŠŸäº†cssåˆä¸æ¸²æŸ“â€¦<br>æ‚¨æ˜¯Hydeå§</p>
<p>æ€»ä¹‹ï¼Œç°åœ¨æ‹¥æœ‰ä¸€ä¸ªå¸¦ä¾§è¾¹æ ç›®å½•çš„å°ä»“åº“äº†ï½<br><img src="/images/2020/8586786.png" width=200></p>
<p>å¼€å¯æ¢ç´¢è¿›åº¦æ¡<br>[|||||Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·]10%</p>
<p>(deprecated)<a href="https://blog.csdn.net/weixin_42319408" title="" target="">è€å®¶</a></p>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
  </entry>
  <entry>
    <title>ä¸€äº›æœ‰è¶£çš„ç½‘ç«™</title>
    <url>/2020/03/10/bookmark/</url>
    <content><![CDATA[<h1 id="é…è‰²"><a href="#é…è‰²" class="headerlink" title="é…è‰²"></a>é…è‰²</h1><h2 id=""><a href="#" class="headerlink" title=""></a><a href="http://zhongguose.com/" title="" target="">ä¸­å›½è‰²</a></h2><p>ä¸­å›½ä¼ ç»Ÿé¢œè‰²ï¼Œæ¯ä¸€ä¸ªéƒ½æœ‰CMYKã€RGBå€¼(åŒ…æ‹¬16è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼ï½å¥½ç”¨ï¼)<br><img src="/images/2020/2020-03-10.8.30.50.jpg"><br>#5dbe8a è¶…çˆ±çš„è”»æ¢¢ç»¿ï½</p>
<h2 id="-1"><a href="#-1" class="headerlink" title=""></a><a href="https://brandcolors.net/" title="" target="">brandcolors</a></h2><p>å“ç‰Œé…è‰²ï¼Œå¯ä»¥å‘ç°å„ç§çœ¼ç†Ÿçš„é¢œè‰²</p>
<p>è¿™æ˜¯ç™¾åº¦<br><img src="/images/2020/2020-03-10.8.44.30.jpg"><br>è¿™æ˜¯NASA<br><img src="/images/2020/2020-03-10.8.48.06.jpg"><br>è¿™æ˜¯è°·æ­Œ<br><img src="/images/2020/2020-03-10.8.46.18.jpg"><br>è¿™æ˜¯å¾®è½¯<br><img src="/images/2020/2020-03-10.8.47.35.jpg"><br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå®ƒä»¬æ˜¯è°ï¼Ÿ<br><img src="/images/2020/2020-03-10.8.24.22.jpg"></p>
<p><a href="/images/2020/2020-03-10.8.24.21.jpg">æˆ‘æ˜¯ç­”æ¡ˆ</a></p>
<h2 id="-2"><a href="#-2" class="headerlink" title=""></a><a href="https://webgradients.com/" title="" target="">webgradients</a></h2><p>ä¸€é¢—ä¸€é¢—è¶…ä»™çš„æ¸å˜è‰²ï¼Œä¹Ÿå¯ä»¥å…¨å±æŸ¥çœ‹ï¼Œèˆ’é€‚<br><img src="/images/2020/2020-03-10.8.26.24.jpg"></p>
<h2 id="-3"><a href="#-3" class="headerlink" title=""></a><a href="https://uigradients.com/" title="" target="">uigradients</a></h2><p>ä¹Ÿæ˜¯ç¾ä¸½çš„æ¸å˜è‰²<br><img src="/images/2020/2020-03-10.8.30.23.jpg"></p>
<h2 id="-4"><a href="#-4" class="headerlink" title=""></a><a href="https://www.webdesignrankings.com/resources/lolcolors/" title="" target="">LOLCOLORS</a></h2><p>æ°´æ»´å½¢çš„é…è‰²<br><img src="/images/2020/2020-03-10.9.13.18.jpg"></p>
<h2 id="-5"><a href="#-5" class="headerlink" title=""></a><a href="https://color.adobe.com/zh/create/color-wheel/" title="" target="">è‰²è½®</a></h2><p>adobeå‡ºå“ï¼Œä¸ä¼šç”¨ï¼Œä½†æ˜¯å¾ˆå¥½ç©<br><img src="/images/2020/2020-03-10.9.10.41.jpg"></p>
<h2 id="-6"><a href="#-6" class="headerlink" title=""></a><a href="https://color.hailpixel.com/" title="" target="">Colordot</a></h2><p>è¿™ä¸ªä¹Ÿå¾ˆæœ‰è¶£ï¼æŒªåŠ¨å…‰æ ‡è°ƒè‰²ï¼Œç‚¹å‡»å›ºå®š<br><img src="/images/2020/2020-03-10.9.15.21.jpg"><br><img src="/images/2020/2020-03-10.9.17.15.jpg"></p>
<h1 id="å›¾æ ‡"><a href="#å›¾æ ‡" class="headerlink" title="å›¾æ ‡"></a>å›¾æ ‡</h1><h2 id="-7"><a href="#-7" class="headerlink" title=""></a><a href="https://thenounproject.com/" title="" target="">thenounproject</a></h2><p>å¸¸ç”¨çš„å›¾æ ‡ç½‘ç«™</p>
<img src="/images/2020/2020-03-10.9.22.23.jpg">



<h1 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h1><h2 id="-8"><a href="#-8" class="headerlink" title=""></a><a href="https://dribbble.com/" title="" target="">dribbble</a></h2><img src="/images/2020/screencapture2020-03-18PM11.47.55.jpg">

<h2 id="-9"><a href="#-9" class="headerlink" title=""></a><a href="https://tympanus.net/codrops/" title="" target="">codrops</a></h2><p>å‘ç°é…·ç‚«çš„é¡µé¢</p>
<img src="/images/2020/screencapture2020-03-18PM11.49.26.jpg">

]]></content>
      <categories>
        <category>Memo</category>
      </categories>
  </entry>
  <entry>
    <title>Springç¬”è®°09 äº‹åŠ¡æ§åˆ¶çš„é—®é¢˜&amp;åŠ¨æ€ä»£ç†</title>
    <url>/2020/03/09/note-spring-09/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p46~55</p>
</blockquote>
<hr>
<h1 id="Accountæ¡ˆä¾‹ä¸­è½¬è´¦æ–¹æ³•çš„äº‹åŠ¡é—®é¢˜"><a href="#Accountæ¡ˆä¾‹ä¸­è½¬è´¦æ–¹æ³•çš„äº‹åŠ¡é—®é¢˜" class="headerlink" title="Accountæ¡ˆä¾‹ä¸­è½¬è´¦æ–¹æ³•çš„äº‹åŠ¡é—®é¢˜"></a>Accountæ¡ˆä¾‹ä¸­è½¬è´¦æ–¹æ³•çš„äº‹åŠ¡é—®é¢˜</h1><img src="/images/2020/20200309100124499.png">

<p>äº‹åŠ¡æ§åˆ¶åº”è¯¥éƒ½åœ¨ä¸šåŠ¡å±‚ï¼Œä¹‹å‰çš„æ¡ˆä¾‹ä¸­éƒ½åœ¨æŒä¹…å±‚ï¼Œéœ€è¦ä¿®æ”¹<br>å†™ä¸¤ä¸ªå·¥å…·ç±»</p>
<h1 id="2ä¸ªå·¥å…·ç±»"><a href="#2ä¸ªå·¥å…·ç±»" class="headerlink" title="2ä¸ªå·¥å…·ç±»"></a>2ä¸ªå·¥å…·ç±»</h1><h2 id="ConnectionUtils"><a href="#ConnectionUtils" class="headerlink" title="ConnectionUtils"></a>ConnectionUtils</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿æ¥çš„å·¥å…·ç±»ï¼Œå®ƒç”¨äºä»æ•°æ®æºä¸­è·å–ä¸€ä¸ªè¿æ¥ï¼Œå¹¶ä¸”å®ç°å’Œçº¿ç¨‹çš„ç»‘å®š</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ThreadLocal&lt;Connection&gt; tl = <span class="keyword">new</span> ThreadLocal&lt;Connection&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSource</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataSource = dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰çº¿ç¨‹ä¸Šçš„è¿æ¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">getThreadConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.å…ˆä»ThreadLocalä¸Šè·å–</span></span><br><span class="line">            Connection conn = tl.get();</span><br><span class="line">            <span class="comment">// 2.åˆ¤æ–­å½“å‰çº¿ç¨‹ä¸Šæ˜¯å¦æœ‰è¿æ¥</span></span><br><span class="line">            <span class="keyword">if</span> (conn == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 3.ä»æ•°æ®æºä¸­è·å–ä¸€ä¸ªè¿æ¥ï¼Œå¹¶ä¸”å­˜å…¥ThreadLocalä¸­</span></span><br><span class="line">                conn = dataSource.getConnection();</span><br><span class="line">                tl.set(conn);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 4.è¿”å›å½“å‰çº¿ç¨‹ä¸Šçš„è¿æ¥</span></span><br><span class="line">            <span class="keyword">return</span> conn;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠè¿æ¥å’Œçº¿ç¨‹è§£ç»‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">        tl.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="TransactionManager"><a href="#TransactionManager" class="headerlink" title="TransactionManager"></a>TransactionManager</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å’Œäº‹åŠ¡ç®¡ç†ç›¸å…³çš„å·¥å…·ç±»ï¼Œå®ƒåŒ…å«äº†ï¼Œå¼€å¯äº‹åŠ¡ï¼Œæäº¤äº‹åŠ¡ï¼Œå›æ»šäº‹åŠ¡å’Œé‡Šæ”¾è¿æ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ConnectionUtils connectionUtils;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConnectionUtils</span><span class="params">(ConnectionUtils connectionUtils)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.connectionUtils = connectionUtils;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">beginTransaction</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connectionUtils.getThreadConnection().setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">commit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connectionUtils.getThreadConnection().commit();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›æ»šäº‹åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">rollback</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connectionUtils.getThreadConnection().rollback();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡Šæ”¾è¿æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">release</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connectionUtils.getThreadConnection().close();<span class="comment">// è¿˜å›è¿æ¥æ± ä¸­</span></span><br><span class="line">            connectionUtils.removeConnection();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿æ¥è¿˜å›è¿æ¥æ± ä¸­åï¼Œè¿˜éœ€å†æŠŠè¿æ¥å’Œçº¿ç¨‹è§£ç»‘ï¼Œå¦åˆ™ä¸‹æ¬¡ConnectionUtilsä¸­åˆ¤æ–­æ˜¯å¦æœ‰è¿æ¥æ˜¯trueï¼Œä½†è¿™ä¸ªè¿æ¥æ˜¯å·²ç»å…³é—­çš„é”™è¯¯çš„è¿æ¥</p>
<h2 id="æ³¨å…¥"><a href="#æ³¨å…¥" class="headerlink" title="æ³¨å…¥"></a>æ³¨å…¥</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;!-- é…ç½®Connectionçš„å·¥å…·ç±» ConnectionUtils --&gt;</span><br><span class="line">   &lt;bean id=<span class="string">"connectionUtils"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.itheima.utils.ConnectionUtils"</span>&gt;</span><br><span class="line">       &lt;!-- æ³¨å…¥æ•°æ®æº--&gt;</span><br><span class="line">       &lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;</span><br><span class="line">   &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">   &lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨--&gt;</span><br><span class="line">   &lt;bean id=<span class="string">"txManager"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.itheima.utils.TransactionManager"</span>&gt;</span><br><span class="line">       &lt;!-- æ³¨å…¥ConnectionUtils --&gt;</span><br><span class="line">       &lt;property name="connectionUtils" ref="connectionUtils"&gt;&lt;/property&gt;</span><br><span class="line">   &lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<h1 id="ä»£ç æ”¹é€ "><a href="#ä»£ç æ”¹é€ " class="headerlink" title="ä»£ç æ”¹é€ "></a>ä»£ç æ”¹é€ </h1><p>ä¿®æ”¹ä¹‹åä¸éœ€è¦åœ¨beans.xmlä¸­æ³¨å…¥dataSourceäº†</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®Connectionçš„å·¥å…·ç±» ConnectionUtils --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"connectionUtils"</span> <span class="attr">class</span>=<span class="string">"com.itheima.utils.ConnectionUtils"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ³¨å…¥æ•°æ®æº--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- property name="dataSource" ref="dataSource"&gt;&lt;/property--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨AccountDaoImplä¸­åŠ ä¸€ä¸ªConnectionUtils</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> ConnectionUtils connectionUtils;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConnectionUtils</span><span class="params">(ConnectionUtils connectionUtils)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.connectionUtils = connectionUtils;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¹¶ä¸”runnerè·å–è¿æ¥æ”¹ä¸º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">runner.query(connectionUtils.getThreadConnection(),<span class="string">"select * from account"</span>,<span class="keyword">new</span> BeanListHandler&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>))</span>;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼ŒAccountServiceImplä¸­ä¸€ä¸ªå®Œæ•´çš„äº‹åŠ¡æµç¨‹æ˜¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">findAllAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            txManager.beginTransaction();</span><br><span class="line">            <span class="comment">// 2.æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">            List&lt;Account&gt; accounts = accountDao.findAllAccount();</span><br><span class="line">            <span class="comment">// 3.æäº¤äº‹åŠ¡</span></span><br><span class="line">            txManager.commit();</span><br><span class="line">            <span class="comment">// 4.è¿”å›ç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span> accounts;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="comment">// 5.å›æ»šæ“ä½œ</span></span><br><span class="line">            txManager.rollback();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 6.é‡Šæ”¾è¿æ¥</span></span><br><span class="line">            txManager.release();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯æ¯ä¸ªæ–¹æ³•éƒ½è¦è¿™æ ·å†™ï¼Œå¾ˆè‡ƒè‚¿<br>è€Œä¸”æ–¹æ³•çš„ä¾èµ–å¾ˆä¸¥é‡ï¼ˆå¦‚æœTransactionManagerä¸­beginTransactionæ–¹æ³•åæ”¹æˆbeginTransaction1ï¼ŒAccountServiceImplä¸­æ¯ä¸€å¤„ç”¨åˆ°çš„éƒ½è¦æ”¹ï¼‰<br>è¿›ä¸€æ­¥æ”¹é€ ï¼šä»£ç†</p>
<p>&amp; ç°åœ¨çš„ä¾èµ–æœ‰äº›ä¹±ä¸ƒå…«ç³Ÿï¼Œåœ¨åé¢Springçš„äº‹åŠ¡æ§åˆ¶ä¸­è§£å†³</p>
<h1 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h1><h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><img src="/images/2020/20200309104823423.png">

<p>ç‰¹ç‚¹ï¼šå­—èŠ‚ç éšç”¨éšåˆ›å»ºï¼Œéšç”¨éšåŠ è½½<br>ä½œç”¨ï¼šä¸ä¿®æ”¹æºç çš„åŸºç¡€ä¸Šå¯¹æ–¹æ³•å¢å¼º</p>
<p>åˆ†ç±»ï¼š</p>
<ul>
<li>åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†</li>
<li>åŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†</li>
</ul>
<p>ç”¨å¤„å¦‚ï¼š<br>è¿æ¥æ± closeæ–¹æ³•å…³é—­æ—¶ä¸èƒ½çœŸæ­£å…³é—­ï¼Œè¿˜è¦è¿˜å›æ± ä¸­ã€‚å¯ä»¥ä½¿ç”¨åŠ¨æ€ä»£ç†å¯¹å…¶è¿›è¡Œå¢å¼ºï¼ŒæŠŠå®ƒè¿˜å›æ± é‡Œ<br>è§£å†³ä¸­æ–‡ä¹±ç ï¼Œrequestå¯¹è±¡çš„æ–¹æ³•å¢å¼ºï¼Œç”¨è£…é¥°è€…æ¨¡å¼å¯ä»¥å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨åŠ¨æ€ä»£ç†å®ç°</p>
<h2 id="åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†"><a href="#åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†" class="headerlink" title="åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†"></a>åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†</h2><p>æ¶‰åŠçš„ç±»ï¼šProxy<br>æä¾›è€…ï¼šJDKå®˜æ–¹<br>å¦‚ä½•åˆ›å»ºä»£ç†å¯¹è±¡ï¼šä½¿ç”¨Proxyç±»ä¸­çš„newProxyInstanceæ–¹æ³•<br>åˆ›å»ºä»£ç†å¯¹è±¡çš„è¦æ±‚ï¼šè¢«ä»£ç†ç±»æœ€å°‘å®ç°ä¸€ä¸ªæ¥å£ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸èƒ½ä½¿ç”¨</p>
<p>newProxyInstanceæ–¹æ³•çš„å‚æ•°ï¼š</p>
<ul>
<li>ClassLoaderï¼šç±»åŠ è½½å™¨<br>å®ƒæ˜¯ç”¨äºåŠ è½½ä»£ç†å¯¹è±¡å­—èŠ‚ç çš„ã€‚å’Œè¢«ä»£ç†å¯¹è±¡ä½¿ç”¨ç›¸åŒçš„ç±»åŠ è½½å™¨ã€‚å›ºå®šå†™æ³•</li>
<li>Class[]ï¼šå­—èŠ‚ç æ•°ç»„<br>å®ƒæ˜¯ç”¨äºè®©ä»£ç†å¯¹è±¡å’Œè¢«ä»£ç†å¯¹è±¡æœ‰ç›¸åŒæ–¹æ³•ã€‚å›ºå®šå†™æ³•</li>
<li>InvocationHandlerï¼šç”¨äºæä¾›å¢å¼ºçš„ä»£ç <br>å†™å¦‚ä½•ä»£ç†ã€‚ä¸€èˆ¬éƒ½æ˜¯å†™ä¸€ä¸ªè¯¥æ¥å£çš„å®ç°ç±»ï¼Œé€šå¸¸æƒ…å†µä¸‹éƒ½æ˜¯åŒ¿åå†…éƒ¨ç±»ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ã€‚æ­¤æ¥å£çš„å®ç°ç±»éƒ½æ˜¯è°ç”¨è°å†™</li>
</ul>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><img src="/images/2020/20200309110447314.png" width=300>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹ç”Ÿäº§å‚å®¶è¦æ±‚çš„æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IProducer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”€å”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saleProduct</span><span class="params">(<span class="keyword">float</span> money)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å”®å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterService</span><span class="params">(<span class="keyword">float</span> money)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸€ä¸ªç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">implements</span> <span class="title">IProducer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saleProduct</span><span class="params">(<span class="keyword">float</span> money)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é”€å”®äº§å“ï¼Œå¹¶æ‹¿åˆ°é’±ï¼š"</span>+money);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterService</span><span class="params">(<span class="keyword">float</span> money)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æä¾›å”®åæœåŠ¡ï¼Œå¹¶æ‹¿åˆ°é’±ï¼š"</span>+money);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¨¡æ‹Ÿä¸€ä¸ªæ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> Producer producer = <span class="keyword">new</span> Producer();</span><br><span class="line"></span><br><span class="line">        IProducer proxyProducer = (IProducer) Proxy.newProxyInstance(producer.getClass().getClassLoader(),</span><br><span class="line">                producer.getClass().getInterfaces(),</span><br><span class="line">                <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">                    <span class="comment">/**</span></span><br><span class="line"><span class="comment">                     * ä½œç”¨ï¼šæ‰§è¡Œè¢«ä»£ç†å¯¹è±¡çš„ä»»ä½•æ¥å£æ–¹æ³•éƒ½ä¼šç»è¿‡è¯¥æ–¹æ³•ï¼ˆå³æœ‰æ‹¦æˆªåŠŸèƒ½ï¼‰</span></span><br><span class="line"><span class="comment">                     * æ–¹æ³•å‚æ•°çš„å«ä¹‰</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> proxy   ä»£ç†å¯¹è±¡çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> method  å½“å‰æ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> args    å½“å‰æ‰§è¡Œæ–¹æ³•æ‰€éœ€çš„å‚æ•°</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@return</span>        å’Œè¢«ä»£ç†å¯¹è±¡æ–¹æ³•æœ‰ç›¸åŒçš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                        <span class="comment">// æ¥æ”¶è¿”å›å€¼</span></span><br><span class="line">                        Object returnValue = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 1.è·å–æ–¹æ³•æ‰§è¡Œçš„å‚æ•°</span></span><br><span class="line">                        Float money = (Float)args[<span class="number">0</span>];</span><br><span class="line">                        <span class="comment">// 2.åˆ¤æ–­å½“å‰æ–¹æ³•æ˜¯ä¸æ˜¯é”€å”®</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="string">"saleProduct"</span>.equals(method.getName())) &#123;</span><br><span class="line">                            returnValue = method.invoke(producer, money*<span class="number">0.8f</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span> returnValue;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    </span><br><span class="line">    	proxyProducer.saleProduct(<span class="number">10000f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/images/2020/20200309111349124.png" width=600>

<p>ä½¿ç”¨ä»£ç†åï¼Œæ¶ˆè´¹è€…ä»˜10000ï¼Œä»£ç†ææˆ20%ï¼Œç”Ÿäº§è€…æ‹¿åˆ°8000</p>
<p>å¹¶æ²¡æœ‰å¯¹ç”Ÿäº§è€…çš„ä»£ç åšä»»ä½•ä¿®æ”¹ï¼Œä½†æ˜¯å®ç°äº†å¢å¼º<br>æ­¤å¤„å³ä¸ºåŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†</p>
<p>ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜<br>å¦‚æœç”Ÿäº§è€…æ²¡æœ‰å®ç°æ¥å£ï¼Œå°±ä¸èƒ½è¿™æ ·ç”¨äº†ï¼Œä¼šæŠ¥ä»£ç†å¼‚å¸¸</p>
<h2 id="åŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†"><a href="#åŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†" class="headerlink" title="åŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†"></a>åŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†</h2><p>è¦æ±‚æœ‰ç¬¬ä¸‰æ–¹jaråŒ…çš„æ”¯æŒ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1_3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¶‰åŠçš„ç±»ï¼šEnhancer<br>æä¾›è€…ï¼šç¬¬ä¸‰æ–¹cglibåº“</p>
<p>å¦‚ä½•åˆ›å»ºä»£ç†å¯¹è±¡ï¼šä½¿ç”¨Enhancerç±»ä¸­çš„createæ–¹æ³•<br>åˆ›å»ºä»£ç†å¯¹è±¡çš„è¦æ±‚ï¼šè¢«ä»£ç†ç±»ä¸èƒ½æ˜¯æœ€ç»ˆç±»</p>
<p>createæ–¹æ³•çš„å‚æ•°ï¼š</p>
<ul>
<li>Classï¼šå­—èŠ‚ç <br>ç”¨äºæŒ‡å®šè¢«ä»£ç†å¯¹è±¡çš„å­—èŠ‚ç </li>
<li>Callbackï¼šç”¨äºæä¾›å¢å¼ºçš„ä»£ç <br>å†™å¦‚ä½•ä»£ç†ã€‚ä¸€èˆ¬æ˜¯å†™ä¸€ä¸ªè¯¥æ¥å£çš„å®ç°ç±»ï¼Œé€šå¸¸æƒ…å†µä¸‹éƒ½æ˜¯åŒ¿åå†…éƒ¨ç±»ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„<br>æ­¤æ¥å£çš„å®ç°ç±»éƒ½æ˜¯è°ç”¨è°å†™<br>ä¸€èˆ¬å†™çš„éƒ½æ˜¯è¯¥æ¥å£çš„å­æ¥å£å®ç°ç±»ï¼šMethodInterceptor</li>
</ul>
<h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸€ä¸ªç”Ÿäº§è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”€å”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saleProduct</span><span class="params">(<span class="keyword">float</span> money)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é”€å”®äº§å“ï¼Œå¹¶æ‹¿åˆ°é’±ï¼š"</span>+money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å”®å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> money</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterService</span><span class="params">(<span class="keyword">float</span> money)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æä¾›å”®åæœåŠ¡ï¼Œå¹¶æ‹¿åˆ°é’±ï¼š"</span>+money);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.cglib;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¨¡æ‹Ÿä¸€ä¸ªæ¶ˆè´¹è€…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> Producer producer = <span class="keyword">new</span> Producer();</span><br><span class="line"></span><br><span class="line">        Producer cglibProducer = (Producer)Enhancer.create(producer.getClass(), <span class="keyword">new</span> MethodInterceptor() &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * æ‰§è¡Œè¢«ä»£ç†å¯¹è±¡çš„ä»»ä½•æ–¹æ³•éƒ½ä¼šç»è¿‡è¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> proxy</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> method</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">             *    ä»¥ä¸Šä¸‰ä¸ªå‚æ•°å’ŒåŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†ä¸­invokeæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> methodProxy ï¼šå½“å‰æ‰§è¡Œæ–¹æ³•çš„ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">             * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object proxy, Method method, Object[] args, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                Object returnValue = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 1.è·å–æ–¹æ³•æ‰§è¡Œçš„å‚æ•°</span></span><br><span class="line">                Float money = (Float)args[<span class="number">0</span>];</span><br><span class="line">                <span class="comment">// 2.åˆ¤æ–­å½“å‰æ–¹æ³•æ˜¯ä¸æ˜¯é”€å”®</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="string">"saleProduct"</span>.equals(method.getName())) &#123;</span><br><span class="line">                    returnValue = method.invoke(producer, money*<span class="number">0.8f</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> returnValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        cglibProducer.saleProduct(<span class="number">12000f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°äº‹åŠ¡æ§åˆ¶"><a href="#ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°äº‹åŠ¡æ§åˆ¶" class="headerlink" title="ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°äº‹åŠ¡æ§åˆ¶"></a>ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°äº‹åŠ¡æ§åˆ¶</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨äºåˆ›å»ºServiceçš„ä»£ç†å¯¹è±¡çš„å·¥å‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IAccountService accountService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TransactionManager txManager;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setAccountService</span><span class="params">(IAccountService accountService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.accountService = accountService;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTxManager</span><span class="params">(TransactionManager txManager)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.txManager = txManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–Serviceä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IAccountService <span class="title">getAccountService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (IAccountService)Proxy.newProxyInstance(accountService.getClass().getClassLoader(),</span><br><span class="line">                accountService.getClass().getInterfaces(),</span><br><span class="line">                <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">                    <span class="comment">/**</span></span><br><span class="line"><span class="comment">                     * æ·»åŠ äº‹åŠ¡çš„æ”¯æŒ</span></span><br><span class="line"><span class="comment">                     *</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> proxy</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> method</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">                     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="string">"test"</span>.equals(method.getName()))&#123;</span><br><span class="line">                            <span class="keyword">return</span> method.invoke(accountService,args);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        Object rtValue = <span class="keyword">null</span>;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="comment">// 1.å¼€å¯äº‹åŠ¡</span></span><br><span class="line">                            txManager.beginTransaction();</span><br><span class="line">                            <span class="comment">// 2.æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">                            rtValue = method.invoke(accountService, args);</span><br><span class="line">                            <span class="comment">// 3.æäº¤äº‹åŠ¡</span></span><br><span class="line">                            txManager.commit();</span><br><span class="line">                            <span class="comment">// 4.è¿”å›ç»“æœ</span></span><br><span class="line">                            <span class="keyword">return</span> rtValue;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            <span class="comment">// 5.å›æ»šæ“ä½œ</span></span><br><span class="line">                            txManager.rollback();</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">                        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                            <span class="comment">// 6.é‡Šæ”¾è¿æ¥</span></span><br><span class="line">                            txManager.release();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¹¶å¯¹beans.xmlåšç›¸åº”çš„ä¿®æ”¹<br>æµ‹è¯•ä¸­IAccountServiceåªç”¨Autowirdä¸å¤Ÿäº†ï¼Œè¿˜éœ€@Qualifier(â€œproxyAccountServiceâ€)</p>
<p>ä½¿ç”¨åŠ¨æ€ä»£ç†åï¼Œæ¶ˆé™¤äº†é‡å¤ä»£ç ï¼Œè§£é™¤äº†æ–¹æ³•çš„ä¾èµ–<br>ä½†æ˜¯é…ç½®å˜å¾—ç¹çäº†<br>æ›´å¥½çš„æ–¹å¼ï¼Ÿâ€”â€”&gt;AOP</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueç¬”è®°02 Spring Boot+Vueå‰åç«¯åˆ†ç¦»å¼€å‘åŸºæœ¬æµç¨‹</title>
    <url>/2020/03/06/note-vue-02/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av85793766?p=1" target="_blank" rel="noopener">https://www.bilibili.com/video/av85793766?p=1</a></p>
</blockquote>
<hr>
<h1 id="Vueå·¥ç¨‹"><a href="#Vueå·¥ç¨‹" class="headerlink" title="Vueå·¥ç¨‹"></a>Vueå·¥ç¨‹</h1><h2 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h2><p>vue uiåˆ›å»ºå·¥ç¨‹ï¼Œå¯¼å…¥Idea<br>(jsç‰ˆæœ¬å¤ªä½å¯èƒ½æœ‰è¯­æ³•æŠ¥é”™ï¼Œé…ç½®ä¸­æ”¹ä¸º6å³å¯)</p>
<p>å¯åŠ¨ï¼šnpm run serve<br>åœæ­¢ï¼šctrl+C</p>
<h2 id="å¼•å…¥é¡µé¢-amp-é…ç½®è·¯å¾„"><a href="#å¼•å…¥é¡µé¢-amp-é…ç½®è·¯å¾„" class="headerlink" title="å¼•å…¥é¡µé¢&amp;é…ç½®è·¯å¾„"></a>å¼•å…¥é¡µé¢&amp;é…ç½®è·¯å¾„</h2><p>router/index.jsä¸­å¼•å…¥.vue<br>App.vueä¸­é…ç½®router</p>
<h2 id="Book-vue"><a href="#Book-vue" class="headerlink" title="Book.vue"></a>Book.vue</h2><p>templateå°±æ˜¯htmlï¼Œscriptå°±æ˜¯jsï¼Œstyleå°±æ˜¯css<br>templateä¸­åªå…è®¸æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹<br>å‰ç«¯å¯ä»¥å…ˆç”¨å‡æ•°æ®ï¼Œå†™åœ¨scripté‡Œé¢</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div id=<span class="string">"showcase"</span>&gt;</span><br><span class="line">        &lt;table&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;ç¼–å·&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">                &lt;td&gt;åç§°&lt;/</span>td&gt;</span><br><span class="line">                &lt;td&gt;ä½œè€…&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>tr&gt;</span><br><span class="line">            &lt;tr v-<span class="keyword">for</span>=<span class="string">"item in books"</span>&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;item.id&#125;&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">                &lt;td&gt;&#123;&#123;item.name&#125;&#125;&lt;/</span>td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;item.author&#125;&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>tr&gt;</span><br><span class="line">        &lt;<span class="regexp">/table&gt;</span></span><br><span class="line"><span class="regexp">        &#123;&#123;msg&#125;&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">    export default &#123;</span></span><br><span class="line"><span class="regexp">        name: "Book",</span></span><br><span class="line"><span class="regexp">        data()&#123;</span></span><br><span class="line"><span class="regexp">            return&#123;</span></span><br><span class="line"><span class="regexp">                msg:'2019999999999999',</span></span><br><span class="line"><span class="regexp">                books:[</span></span><br><span class="line"><span class="regexp">                    &#123;</span></span><br><span class="line"><span class="regexp">                        id: 20200001,</span></span><br><span class="line"><span class="regexp">                        name: 'ç—…æ¯’æ˜Ÿçƒ',</span></span><br><span class="line"><span class="regexp">                        author: 'å¡å°”Â·é½é»˜'</span></span><br><span class="line"><span class="regexp">                    &#125;,</span></span><br><span class="line"><span class="regexp">                    &#123;</span></span><br><span class="line"><span class="regexp">                        id:20200002,</span></span><br><span class="line"><span class="regexp">                        name: 'æ´›åŸºå¯ç¤ºå½•',</span></span><br><span class="line"><span class="regexp">                        author: 'ä¹”å®‰å¦®Â·MÂ·å“ˆé‡Œæ–¯'</span></span><br><span class="line"><span class="regexp">                    &#125;,</span></span><br><span class="line"><span class="regexp">                    &#123;</span></span><br><span class="line"><span class="regexp">                        id:20200003,</span></span><br><span class="line"><span class="regexp">                        name: 'å¢å¼ºäººç±»',</span></span><br><span class="line"><span class="regexp">                        author: 'æµ·ä¼¦Â·å¸•å¸•æ‰¬å°¼æ–¯'</span></span><br><span class="line"><span class="regexp">                    &#125;</span></span><br><span class="line"><span class="regexp">                ]</span></span><br><span class="line"><span class="regexp">            &#125;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure>
<p>vueå¯ä»¥åŠ¨æ€åŠ è½½ï¼Œæ”¹å®Œä»£ç ä¸éœ€è¦é‡å¯ï¼Œç›´æ¥è®¿é—®å³å¯<br>è¯•äº†ä¸‹å¯ä»¥æ­£å¸¸è®¿é—®ï½</p>
<h1 id="Springå·¥ç¨‹"><a href="#Springå·¥ç¨‹" class="headerlink" title="Springå·¥ç¨‹"></a>Springå·¥ç¨‹</h1><h2 id="åˆ›å»º-1"><a href="#åˆ›å»º-1" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h2><p>Ideaä¸­Spring Initializré»˜è®¤æ¨¡ç‰ˆåˆ›å»º<br>ä¾èµ–å‹¾ä¸Šï¼šLombokã€Spring Webã€Spring Data JPAã€MySQL Driver</p>
<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><p>è¿™é‡Œæ²¡æœ‰ç”¨application.propertiesï¼Œåˆ æ‰<br>æ–°å»ºapplication.ymlï¼Œå­˜æ”¾è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯</p>
<h2 id="æ•°æ®åº“å»ºè¡¨"><a href="#æ•°æ®åº“å»ºè¡¨" class="headerlink" title="æ•°æ®åº“å»ºè¡¨"></a>æ•°æ®åº“å»ºè¡¨</h2><p>ç”¨æä¾›çš„book.sqlå»ºbookè¡¨</p>
<h2 id="Book"><a href="#Book" class="headerlink" title="Book"></a>Book</h2><p>å’Œbookè¡¨å¯¹åº”ï¼ŒåŠ @Entityåï¼Œæ ¹æ®ç±»åå’Œè¡¨åå¯¹åº”ç»‘å®š<br>å†åŠ ä¸€ä¸ª@Dataï¼Œæ˜¯lombokçš„æ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆget/set<br>å±æ€§åå’Œå˜é‡åå¯¹åº”ï¼Œè‡ªåŠ¨ç»‘å®š<br>idè¦åŠ ä¸€ä¸ª@Idï¼Œå®ƒæ˜¯ä¸»é”®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BookRepository"><a href="#BookRepository" class="headerlink" title="BookRepository"></a>BookRepository</h2><p>ç»§æ‰¿JpaRepositoryï¼Œ&lt;&gt;ä¸­ç¬¬ä¸€ä¸ªæ˜¯å®ä½“ç±»ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸»é”®ç±»å‹<br>æ¥å£ä¸­findAllç­‰æ–¹æ³•éƒ½æœ‰ï¼Œç›´æ¥ç”¨å°±è¡Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Book</span>,<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•BookRepository"><a href="#æµ‹è¯•BookRepository" class="headerlink" title="æµ‹è¯•BookRepository"></a>æµ‹è¯•BookRepository</h2><p>ç„¶åæµ‹è¯•ä¸€ä¸‹<br>å»ºç«‹çš„Springå·¥ç¨‹è‡ªå¸¦ä¸€ä¸ªæµ‹è¯•ç±»BookstoreServerApplicationTests<br>æˆ–è€…è‡ªå·±åˆ›å»ºï¼Œåœ¨æ¥å£åä¸Šå³é”®-&gt;Go To-&gt;Test-&gt;Create New Test<br>ç»™ç”Ÿæˆçš„æµ‹è¯•ç±»åŠ ä¸€ä¸ª@SpringBootTestï¼Œè¦æµ‹è¯•çš„ç±»@Autowiredè‡ªåŠ¨æ³¨å…¥ï¼Œå†™çš„æ–¹æ³•åŠ ä¸€ä¸ª@Testï¼Œå°±å¯ä»¥è¿è¡Œäº†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookRepositoryTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(bookRepository.findAll());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯•ä¸€ä¸‹<br><img src="/images/2020/20200306180717607.png"><br>æˆåŠŸ<br>ä¸”æ‰“å°äº†sqlè¯­å¥ï¼Œå› ä¸ºymlé‡Œé¢é…äº†jpa: show-sql: trueå’Œæ ¼å¼åŒ–</p>
<p>æ¯å†™ä¸€ä¸ªrepositoryå…ˆæµ‹ä¸€ä¸‹ï¼Œä¿è¯æ²¡é—®é¢˜å†ç»§ç»­å†™controller</p>
<h2 id="BookHandler"><a href="#BookHandler" class="headerlink" title="BookHandler"></a>BookHandler</h2><p>é…ä¸Šå¯¹åº”çš„æ³¨è§£å’Œmapping</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/book"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/findAll"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Book&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bookRepository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>è¿è¡ŒBookstoreServerApplicationå¯åŠ¨ç±»<br>æ³¨æ„æ­¤æ—¶ç«¯å£æ˜¯8181<br><img src="/images/2020/20200306181433240.png"><br>æ²¡æœ‰é—®é¢˜ï¼Œåç«¯å°±æå®šäº†<br>æ¥ä¸‹æ¥å‰åç«¯å¯¹æ¥å°±è¡Œ</p>
<h1 id="å¯¹æ¥"><a href="#å¯¹æ¥" class="headerlink" title="å¯¹æ¥"></a>å¯¹æ¥</h1><p>vueä¸­ajaxè¯·æ±‚ç”¨axiosç»„ä»¶<br>ï¼ˆå…ˆåœ¨å‘½ä»¤è¡ŒæŠŠæœåŠ¡åœæ‰ï¼Œå®‰è£…ï¼Œvue add axiosï¼‰<br>è£…å¥½ä¹‹åè‡ªåŠ¨æœ‰äº†src/plugins/axios.js</p>
<p>åˆ·æ–°é¡µé¢æ—¶è¯»å–æ•°æ®ï¼Œå¯ä»¥å†™åˆ°åˆå§‹åŒ–å‡½æ•°ä¸­ï¼Œæ¯”å¦‚è¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">		created() &#123;</span><br><span class="line">            alert(<span class="number">123</span>)</span><br><span class="line">            axios.get(<span class="string">'http://localhost:8181/book/findAll/'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">resp</span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(resp)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>åˆ·æ–°ï¼Œçœ‹æµè§ˆå™¨çš„æ§åˆ¶å°<br>æœ‰ä¸ªè·¨åŸŸé—®é¢˜ï¼ˆ8181è®¿é—®8080ï¼‰ï¼Œå‰ç«¯åç«¯éƒ½å¯ä»¥è§£å†³<br>è¿™é‡Œåœ¨SpringBootä¸­è§£å†³<br>åªéœ€æ·»åŠ ä¸€ä¸ªé…ç½®ç±»ï¼Œé‡å†™addCorsMappingsæ–¹æ³•å³å¯ï¼ˆä¸ç”¨è®°ï¼Œå›ºå®šçš„ï¼Œè¦ç”¨çš„æ—¶å€™å¤åˆ¶å°±è¡Œï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrosConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">"/**"</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">"*"</span>)</span><br><span class="line">                .allowedMethods(<span class="string">"GET"</span>, <span class="string">"HEAD"</span>, <span class="string">"POST"</span>, <span class="string">"PUT"</span>, <span class="string">"DELETE"</span>, <span class="string">"OPTIONS"</span>)</span><br><span class="line">                .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">                .maxAge(<span class="number">3600</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">"*"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡å¯ï¼Œå†è®¿é—®å°±å¥½äº†<br><img src="https://img-blog.csdnimg.cn/20200306185233941.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjMxOTQwOA==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åå†å›è°ƒå‡½æ•°ä¸­æŠŠdataæ‹¿åˆ°å°±è¡Œ<br>æ³¨æ„ï¼šä¸èƒ½ç›´æ¥ç”¨thisï¼Œå›è°ƒå‡½æ•°ä¸­thisæŒ‡çš„æ˜¯å›è°ƒï¼Œè€Œä¸æ˜¯å¤–é¢ï¼Œè¦å…ˆåœ¨å¤–é¢æ‹¿åˆ°this</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div id=<span class="string">"showcase"</span>&gt;</span><br><span class="line">        &lt;table&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;ç¼–å·&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;åç§°&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;ä½œè€…&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr v-<span class="keyword">for</span>=<span class="string">"item in books"</span>&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;item.id&#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;item.name&#125;&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&#123;&#123;item.author&#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export <span class="keyword">default</span> &#123;</span><br><span class="line">        name: <span class="string">"Book"</span>,</span><br><span class="line">        data()&#123;</span><br><span class="line">            <span class="keyword">return</span>&#123;</span><br><span class="line">                books:[]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        created() &#123;</span><br><span class="line">            <span class="keyword">const</span> _this = <span class="keyword">this</span></span><br><span class="line">            axios.get(<span class="string">'http://localhost:8181/book/findAll'</span>).then(function (resp)&#123;</span><br><span class="line">                _this.books = resp.data</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å‰åç«¯å°±è¿ä¸Šäº†<br><img src="/images/2020/20200306185851937.png"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ol>
<li>å†™å‰ç«¯ï¼Œç”¨åŠ æ•°æ®æµ‹è¯•</li>
<li>å†™åç«¯ï¼Œä¿è¯æ¥å£èƒ½è®¿é—®</li>
<li>è°ƒåç«¯ï¼ˆåç«¯è§£å†³è·¨åŸŸé—®é¢˜ï¼‰</li>
</ol>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueç¬”è®°01 @vue_cliç¯å¢ƒæ­å»º</title>
    <url>/2020/03/06/note-vue-01/</url>
    <content><![CDATA[<img src="/images/2020/20200306115323370.png">
åœ¨ç»å†äº†è¿™ä¹ˆå¤šå‘ä¹‹åç»ˆäºbuild succeededäº†
å¯å–œå¯è´º
æ•´ç†ä¸‹æˆåŠŸè·¯å¾„

<hr>
<p>ç‰ˆæœ¬ï¼š</p>
<ul>
<li>macOS Catalina 10.15.3</li>
<li>Homebrew 2.2.6</li>
<li>node v13.8.0</li>
<li>npm 6.13.7</li>
<li>@vue/cli 4.2.3</li>
</ul>
<hr>
<h2 id="1-å®‰è£…node"><a href="#1-å®‰è£…node" class="headerlink" title="1. å®‰è£…node"></a>1. å®‰è£…node</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure>
<p>å‘ï¼šbrewå·¨æ…¢æ— æ¯”<br>è§£å†³ï¼šæ¢æ¸…åé•œåƒ</p>
<blockquote>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/</a></p>
</blockquote>
<h2 id="2-å®‰è£…-vue-cli"><a href="#2-å®‰è£…-vue-cli" class="headerlink" title="2. å®‰è£…@vue/cli"></a>2. å®‰è£…@vue/cli</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo npm install -g @vue&#x2F;cli</span><br></pre></td></tr></table></figure>
<p>å‘ï¼šæ²¡æœ‰æƒé™<br>è§£å†³ï¼šsudo</p>
<blockquote>
<p><a href="https://www.jianshu.com/p/0207ee424422" target="_blank" rel="noopener">https://www.jianshu.com/p/0207ee424422</a></p>
</blockquote>
<p>å‘ï¼šæ–°æ—§ç‰ˆæœ¬åå­—ä¸ä¸€æ ·<br>è§£å†³ï¼š@vue/cliï¼ˆä¸æ˜¯vue-cliï¼‰</p>
<blockquote>
<p><a href="https://cli.vuejs.org/zh/guide/installation.html" target="_blank" rel="noopener">https://cli.vuejs.org/zh/guide/installation.html</a></p>
</blockquote>
<h2 id="3-åˆ›å»ºé¡¹ç›®"><a href="#3-åˆ›å»ºé¡¹ç›®" class="headerlink" title="3. åˆ›å»ºé¡¹ç›®"></a>3. åˆ›å»ºé¡¹ç›®</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vue ui</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°08 Springæ•´åˆJunit</title>
    <url>/2020/03/04/note-spring-08/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p44ï½45 </p>
</blockquote>
<hr>
<p>ç”¨äºè§£å†³ä¹‹å‰æµ‹è¯•æ—¶çš„é‡å¤ä»£ç </p>
<p>åŸæœ¬çš„AccountServiceTestä¸­ï¼Œæ¯ä¸ªæ–¹æ³•ä¸­éƒ½æœ‰æ­¥éª¤1å’Œ2</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setName(<span class="string">"eee"</span>);</span><br><span class="line">        account.setMoney(<span class="number">10000f</span>);</span><br><span class="line">        as.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        as.deleteAccount(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨init()å¯ä»¥å°†é‡å¤ä»£ç æŠ½å‡ºæ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext ac;</span><br><span class="line">    <span class="keyword">private</span> IAccountService as;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setName(<span class="string">"eee"</span>);</span><br><span class="line">        account.setMoney(<span class="number">10000f</span>);</span><br><span class="line">        as.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        as.deleteAccount(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¹¶æ²¡æœ‰æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜<br>å¼€å‘å’Œæµ‹è¯•çš„ä»£ç ä»åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œéœ€è¦è¿›ä¸€æ­¥è§£è€¦</p>
<p>å¦‚æœä¸è¦init()ï¼Œåªåœ¨å˜é‡ä¸ŠåŠ @Autowiredæ²¡æœ‰ç”¨<br>ä¸€æ³¢åˆ†æï¼š<br><img src="/images/2020/20200304194906403.png" width=600></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<ol>
<li><p>pom.xmlä¸­å¯¼å…¥springæ•´åˆjunitçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸”ï¼šä½¿ç”¨spring 5.xæ—¶ï¼Œjuintéœ€è¦4.12ä»¥ä¸Šçš„ç‰ˆæœ¬</p>
</li>
<li><p>ä½¿ç”¨junitçš„@RunWithæ³¨è§£å°†åŸæœ‰çš„main()æ›¿æ¢æˆspringæä¾›çš„</p>
</li>
<li><p>ç”¨@ContextConfigurationå‘ŠçŸ¥springçš„è¿è¡Œå™¨ï¼ŒåŸºäºxmlè¿˜æ˜¯æ³¨è§£ï¼Œå¹¶è¯´æ˜ä½ç½®<br>locationsï¼šæŒ‡å®šxmlæ–‡ä»¶çš„ä½ç½®ï¼ŒåŠ ä¸Šclasspathå…³é”®å­—ï¼Œè¡¨ç¤ºåœ¨ç±»è·¯å¾„ä¸‹<br>classesï¼šæŒ‡å®šæ³¨é‡Šç±»æ‰€åœ¨çš„ä½ç½®</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ContextConfiguration</span>(<span class="title">locations</span> </span>= <span class="string">"classpath:beans.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountService as;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setName(<span class="string">"eee"</span>);</span><br><span class="line">        account.setMoney(<span class="number">10000f</span>);</span><br><span class="line">        as.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å³å¯æ­£å¸¸æ‰§è¡Œ</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°07 åŸºäºæ³¨è§£çš„IoCæ¡ˆä¾‹ï¼ˆå®ç°CRUDï¼‰</title>
    <url>/2020/03/04/note-spring-07/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931?p=38" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931?p=38</a></p>
</blockquote>
<hr>
<h1 id="æ•°æ®åº“éƒ¨åˆ†"><a href="#æ•°æ®åº“éƒ¨åˆ†" class="headerlink" title="æ•°æ®åº“éƒ¨åˆ†"></a>æ•°æ®åº“éƒ¨åˆ†</h1><p>ç»§ç»­ç”¨ä¸Šæ¬¡çš„è¡¨<br><img src="/images/2020/20200304181444129.png" width=200></p>
<hr>
<h1 id="åœ¨åŸºäºxmlçš„æ¡ˆä¾‹ä¸Šä¿®æ”¹"><a href="#åœ¨åŸºäºxmlçš„æ¡ˆä¾‹ä¸Šä¿®æ”¹" class="headerlink" title="åœ¨åŸºäºxmlçš„æ¡ˆä¾‹ä¸Šä¿®æ”¹"></a>åœ¨åŸºäºxmlçš„æ¡ˆä¾‹ä¸Šä¿®æ”¹</h1><p>ï¼ˆåŠ ä¸Šæ•´åˆjunitçš„éƒ¨åˆ†ï¼Œå…·ä½“è®°å½•åœ¨ç¬”è®°8ï¼‰</p>
<p>pom.xmlåŠ ä¸Šæ•´åˆjunitéœ€è¦çš„ä¾èµ–spring-test<br>junitç‰ˆæœ¬4.12åŠä»¥ä¸Š</p>
<p>beans.xmlåç§°ç©ºé—´éœ€è¦ä¿®æ”¹<br>åœ¨Springæ–‡æ¡£ä¸­æœç´¢xmlns:contextï¼ˆåŸºäºxmlæ—¶æ˜¯xmlnsï¼‰æ‰¾åç§°ç©ºé—´<br>é…ç½®Serviceå’ŒDaoçš„éƒ¨åˆ†å¯ä»¥ä¸è¦äº†<br>åŠ ä¸Šcomponent-scanå‘ŠçŸ¥Springåœ¨åˆ›å»ºå®¹å™¨æ—¶è¦æ‰«æçš„åŒ…</p>
<p>å®ä½“ç±»ã€æ¥å£æ²¡æœ‰å˜åŒ–</p>
<p>ä¸šåŠ¡å±‚å®ç°ç±»AccountServiceImplåŠ æ³¨è§£<br>@Service(â€œaccountServiceâ€)<br>å˜é‡accountDaoä¸ŠåŠ æ³¨è§£ï¼Œç”±äºåªæœ‰ä¸€ä¸ªAccountDaoï¼Œå¯ä»¥ç”¨@Autowired<br>å¯¹åº”çš„setæ–¹æ³•å¯ä»¥åˆ æ‰</p>
<p>æŒä¹…å±‚å®ç°ç±»AccountDaoImplåŠ æ³¨è§£<br>@Repository(â€œaccountDaoâ€)<br>runneråŒæ ·ç”¨@Autowiredï¼Œsetæ–¹æ³•åˆ æ‰</p>
<p>æµ‹è¯•ç±»æ”¹ä¸ºæ•´åˆjunitçš„å†™æ³•</p>
<hr>
<h1 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h1><h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/20200304183227273.png" width=300>

<h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.coconutnut<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>day02_02_account_xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    æ‰“æˆjaråŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--    åŠ å…¥ä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--        spring--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    	<span class="comment">&lt;!--    	springæ•´åˆjunit--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--        dbutils--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--        mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--        jdbcè¿æ¥æ± --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--    junitæµ‹è¯•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--    å‘ŠçŸ¥Springåœ¨åˆ›å»ºå®¹å™¨æ—¶è¦æ‰«æçš„åŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.cc"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--    é…ç½®QueryRunnerï¼ˆå¤šä¾‹ï¼‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"runner"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbutils.QueryRunner"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--        æ³¨å…¥æ•°æ®æºï¼ˆæ²¡æœ‰setæ–¹æ³•ï¼Œåªèƒ½æ„é€ å‡½æ•°æ³¨å…¥ï¼‰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"ds"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--    é…ç½®æ•°æ®æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--        æ³¨å…¥è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/groot?characterEncoding=utf8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"iamgroot"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å®ä½“ç±»"><a href="#å®ä½“ç±»" class="headerlink" title="å®ä½“ç±»"></a>å®ä½“ç±»</h2><p>Account.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„å®ä½“ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Float money;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Float <span class="title">getMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(Float money)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Account&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", money="</span> + money +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸šåŠ¡å±‚"><a href="#ä¸šåŠ¡å±‚" class="headerlink" title="ä¸šåŠ¡å±‚"></a>ä¸šåŠ¡å±‚</h2><p>IAccountService.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„ä¸šåŠ¡å±‚æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥ä¸€ä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰€æœ‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>AccountServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"><span class="keyword">import</span> com.cc.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„ä¸šåŠ¡å±‚å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        accountDao.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        accountDao.deleteAccount(accountId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        accountDao.updateAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.retrieveAccountById(accountId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.retrieveAllAccounts();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æŒä¹…å±‚"><a href="#æŒä¹…å±‚" class="headerlink" title="æŒä¹…å±‚"></a>æŒä¹…å±‚</h2><p>IAccountDao.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„æŒä¹…å±‚æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>AccountDaoImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanListHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„æŒä¹…å±‚å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">"accountDao"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> QueryRunner runner;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runner.update(<span class="string">"insert into account(name,money) values(?,?)"</span>, account.getName(), account.getMoney());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runner.update(<span class="string">"delete from account where id = ?"</span>, accountId);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runner.update(<span class="string">"update account set name = ?, money = ? where id = ?"</span>, account.getName(), account.getMoney(),account.getId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> runner.query(<span class="string">"select * from account where id = ?"</span>, <span class="keyword">new</span> BeanHandler&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>), <span class="title">accountId</span>)</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> runner.query(<span class="string">"select * from account"</span>, <span class="keyword">new</span> BeanListHandler&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•æ–¹æ³•"><a href="#æµ‹è¯•æ–¹æ³•" class="headerlink" title="æµ‹è¯•æ–¹æ³•"></a>æµ‹è¯•æ–¹æ³•</h2><p>AccountServiceTest.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"><span class="keyword">import</span> com.cc.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨Junitæµ‹è¯•é…ç½®</span></span><br><span class="line"><span class="comment"> * Springæ•´åˆJunitçš„é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ContextConfiguration</span>(<span class="title">locations</span> </span>= <span class="string">"classpath:beans.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IAccountService as;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setName(<span class="string">"eee"</span>);</span><br><span class="line">        account.setMoney(<span class="number">10000f</span>);</span><br><span class="line">        as.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        as.deleteAccount(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Account account = as.retrieveAccountById(<span class="number">3</span>);</span><br><span class="line">        account.setMoney(<span class="number">3000f</span>);</span><br><span class="line">        as.updateAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRetrieveOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Account account = as.retrieveAccountById(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRetrieveAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;Account&gt; accounts = as.retrieveAllAccounts();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Account account : accounts)&#123;</span><br><span class="line">            System.out.println(account);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>testRetrieveAll()<br><img src="/images/2020/20200304182802930.png" width=800></p>
<p>testRetrieveOne()<br><img src="/images/2020/20200304182924177.png" width=800></p>
<p>testCreate()<br><img src="/images/2020/20200304183005488.png" width=200></p>
<p>testDelete()<br><img src="/images/2020/20200304183052388.png" width=200></p>
<p>testUpdate()<br><img src="/images/2020/20200304183142618.png" width=200></p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°06 åŸºäºxmlçš„IoCæ¡ˆä¾‹ï¼ˆå®ç°CRUDï¼‰</title>
    <url>/2020/03/04/note-spring-06/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p35~37</p>
</blockquote>
<hr>
<h1 id="æ•°æ®åº“éƒ¨åˆ†"><a href="#æ•°æ®åº“éƒ¨åˆ†" class="headerlink" title="æ•°æ®åº“éƒ¨åˆ†"></a>æ•°æ®åº“éƒ¨åˆ†</h1><p>mysqlä¸­å»ºä¸€å¼ accountè¡¨<br><img src="/images/2020/20200304160612648.png" width=200></p>
<hr>
<h1 id="mavenå·¥ç¨‹"><a href="#mavenå·¥ç¨‹" class="headerlink" title="mavenå·¥ç¨‹"></a>mavenå·¥ç¨‹</h1><h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><img src="/images/2020/20200304180408780.png" width=300>

<h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.coconutnut<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>day02_02_account_xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    æ‰“æˆjaråŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    åŠ å…¥ä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        spring--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        dbutils--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbutils<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        jdbcè¿æ¥æ± --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    junitæµ‹è¯•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å®ä½“ç±»"><a href="#å®ä½“ç±»" class="headerlink" title="å®ä½“ç±»"></a>å®ä½“ç±»</h2><p>Account.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„å®ä½“ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Float money;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Float <span class="title">getMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(Float money)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Account&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", money="</span> + money +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸šåŠ¡å±‚"><a href="#ä¸šåŠ¡å±‚" class="headerlink" title="ä¸šåŠ¡å±‚"></a>ä¸šåŠ¡å±‚</h2><p>IAccountService.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„ä¸šåŠ¡å±‚æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> account</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥ä¸€ä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accountId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥æ‰€æœ‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>AccountServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"><span class="keyword">import</span> com.cc.service.IAccountService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„ä¸šåŠ¡å±‚å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(IAccountDao accountDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        accountDao.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        accountDao.deleteAccount(accountId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        accountDao.updateAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.retrieveAccountById(accountId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.retrieveAllAccounts();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æŒä¹…å±‚"><a href="#æŒä¹…å±‚" class="headerlink" title="æŒä¹…å±‚"></a>æŒä¹…å±‚</h2><p>IAccountDao.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„æŒä¹…å±‚æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>AccountDaoImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanListHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è´¦æˆ·çš„æŒä¹…å±‚å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> QueryRunner runner;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRunner</span><span class="params">(QueryRunner runner)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.runner = runner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runner.update(<span class="string">"insert into account(name,money) values(?,?)"</span>, account.getName(), account.getMoney());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAccount</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runner.update(<span class="string">"delete from account where id = ?"</span>, accountId);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAccount</span><span class="params">(Account account)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runner.update(<span class="string">"update account set name = ?, money = ? where id = ?"</span>, account.getName(), account.getMoney(),account.getId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Account <span class="title">retrieveAccountById</span><span class="params">(Integer accountId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> runner.query(<span class="string">"select * from account where id = ?"</span>, <span class="keyword">new</span> BeanHandler&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>), <span class="title">accountId</span>)</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">retrieveAllAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> runner.query(<span class="string">"select * from account"</span>, <span class="keyword">new</span> BeanListHandler&lt;Account&gt;(Account<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="beans-xml"><a href="#beans-xml" class="headerlink" title="beans.xml"></a>beans.xml</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    é…ç½®Service--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.cc.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        æ³¨å…¥Dao--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--    é…ç½®Dao--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.cc.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        æ³¨å…¥QueryRunner--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"runner"</span> <span class="attr">ref</span>=<span class="string">"runner"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--    é…ç½®QueryRunnerï¼ˆå¤šä¾‹ï¼‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"runner"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbutils.QueryRunner"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        æ³¨å…¥æ•°æ®æºï¼ˆæ²¡æœ‰setæ–¹æ³•ï¼Œåªèƒ½æ„é€ å‡½æ•°æ³¨å…¥ï¼‰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"ds"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    é…ç½®æ•°æ®æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        æ³¨å…¥è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/groot?characterEncoding=utf8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"iamgroot"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•æ–¹æ³•"><a href="#æµ‹è¯•æ–¹æ³•" class="headerlink" title="æµ‹è¯•æ–¹æ³•"></a>æµ‹è¯•æ–¹æ³•</h2><p>AccountServiceTest.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.cc.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.cc.domain.Account;</span><br><span class="line"><span class="keyword">import</span> com.cc.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨Junitæµ‹è¯•é…ç½®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        Account account = <span class="keyword">new</span> Account();</span><br><span class="line">        account.setName(<span class="string">"ddd"</span>);</span><br><span class="line">        account.setMoney(<span class="number">10f</span>);</span><br><span class="line">        as.createAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        as.deleteAccount(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        Account account = as.retrieveAccountById(<span class="number">1</span>);</span><br><span class="line">        account.setMoney(<span class="number">2000f</span>);</span><br><span class="line">        as.updateAccount(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRetrieveOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        Account account = as.retrieveAccountById(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRetrieveAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–å®¹å™¨</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.å¾—åˆ°ä¸šåŠ¡å±‚å¯¹è±¡</span></span><br><span class="line">        IAccountService as = ac.getBean(<span class="string">"accountService"</span>,IAccountService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 3.æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        List&lt;Account&gt; accounts = as.retrieveAllAccounts();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Account account : accounts)&#123;</span><br><span class="line">            System.out.println(account);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>testRetrieveAll()<br><img src="/images/2020/20200304174231997.png" width=800></p>
<p>testRetrieveOne()<br><img src="/images/2020/20200304174150392.png" width=800></p>
<p>testCreate()<br><img src="/images/2020/20200304175250925.png" width=200></p>
<p>testDelete()<br><img src="/images/2020/2020030417540352.png" width=200></p>
<p>testUpdate()<br><img src="/images/2020/20200304175530135.png" width=200></p>
<hr>
<h1 id="é‡åˆ°çš„bug"><a href="#é‡åˆ°çš„bug" class="headerlink" title="é‡åˆ°çš„bug"></a>é‡åˆ°çš„bug</h1><p>æ‰§è¡ŒtestRetrieveAll()æ—¶</p>
<p>==BUG01==</p>
<pre><code>è­¦å‘Š: Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;accountService&apos; defined in class path resource [beans.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property &apos;accountDao &apos; of bean class [com.cc.service.impl.AccountServiceImpl]: Bean property &apos;accountDao &apos; is not writable or has an invalid setter method. Did you mean &apos;accountDao&apos;?

org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;accountService&apos; defined in class path resource [beans.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property &apos;accountDao &apos; of bean class [com.cc.service.impl.AccountServiceImpl]: Bean property &apos;accountDao &apos; is not writable or has an invalid setter method. Did you mean &apos;accountDao&apos;?

at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1650)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1357)
...</code></pre><p>å…¶ä¸­</p>
<pre><code>Bean property &apos;accountDao &apos; is not writable or has an invalid setter method. Did you mean &apos;accountDao&apos;?</code></pre><p>å‘ç°å¤šæ‰“äº†ä¸ªç©ºæ ¼</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">beans.xmlä¸­</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao "</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">æ”¹ä¸º</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ”¹è¿‡æ¥ä¹‹å</p>
<p>==BUG02==</p>
<pre><code>è­¦å‘Š: com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask@63fd9b65 -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: 
java.sql.SQLException: Unknown initial character set index &apos;255&apos; received from server. Initial client character set can be forced via the &apos;characterEncoding&apos; property.
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)
...</code></pre><p>ä¼¼ä¹æ˜¯ç¼–ç é—®é¢˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">beans.xmlä¸­</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/groot"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">æ”¹ä¸º</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/groot?characterEncoding=utf8"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ”¹äº†ä¹‹å</p>
<p>==BUG03==</p>
<pre><code>è­¦å‘Š: com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask@4879bf70 -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: 
java.sql.SQLException: Unknown system variable &apos;tx_isolation&apos;
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)</code></pre><p>æŸ¥ä¸€ä¸‹è§£å†³æ–¹å•Š</p>
<blockquote>
<p><a href="https://blog.csdn.net/always_younger/article/details/80421783" target="_blank" rel="noopener">https://blog.csdn.net/always_younger/article/details/80421783</a></p>
</blockquote>
<p>è¯´æ˜¯mysql-connector-javaç‰ˆæœ¬å¤ªä½çš„åŸå› </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">pom.xmlä¸­</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">æ”¹ä¸º</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç‚¹å°é—®é¢˜</p>
<pre><code>Loading class `com.mysql.jdbc.Driver&apos;. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver&apos;. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</code></pre><p>æŠŠè¿‡æ—¶çš„ç±»æ¢æ‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">beans.xmlä¸­</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">æ”¹ä¸º</span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å°±å¥½äº†ï¼</p>
<pre><code>Account{id=1, name=&apos;aaa&apos;, money=1000.0}
Account{id=2, name=&apos;bbb&apos;, money=1000.0}
Account{id=3, name=&apos;ccc&apos;, money=1000.0}

Process finished with exit code 0</code></pre>]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºé—®é¢˜</title>
    <url>/2020/02/29/exercise/</url>
    <content><![CDATA[<p>æ€è·¯ï¼šåŠ¨æ€è§„åˆ’</p>
<p>dp[ i ][ j ][ k ]<br>i - åˆ°ç¬¬ i å¤©<br>j - æœ€å¤šäº¤æ˜“ j æ¬¡<br>k - 0:å½“å‰æŒè‚¡ / 1:å½“å‰ä¸æŒè‚¡</p>
<p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; ç¬¬iå¤©ï¼Œæœ€å¤šäº¤æ˜“jæ¬¡ï¼Œå½“å‰ä¸æŒè‚¡</span><br><span class="line">dp[i][j][0] &#x3D; MAX&#123;</span><br><span class="line">	dp[i-1][j][0],                 &#x2F;&#x2F; æœ¬æ¬¡ä¸æŒ-ä¸Šæ¬¡å°±ä¸æŒ</span><br><span class="line">	dp[i-1][j-1][1] + å·®ä»·          &#x2F;&#x2F; æœ¬æ¬¡ä¸æŒ-æœ¬æ¬¡å–</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; ç¬¬iå¤©ï¼Œæœ€å¤šäº¤æ˜“jæ¬¡ï¼Œå½“å‰æŒè‚¡</span><br><span class="line">dp[i][j][1] &#x3D; MAX&#123;</span><br><span class="line">	dp[i-1][j][0],                &#x2F;&#x2F; æœ¬æ¬¡æŒ-æœ¬æ¬¡ä¹°</span><br><span class="line">	dp[i-1][j][1] + å·®ä»·           &#x2F;&#x2F; æœ¬æ¬¡æŒ-ä¸Šæ¬¡å°±æŒ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getdp</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,<span class="keyword">int</span> k,<span class="keyword">int</span>[][][] dp,<span class="keyword">int</span>[] prices)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(dp[i][j][k]==-<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i&lt;<span class="number">1</span>)&#123;</span><br><span class="line">			dp[i][j][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">			dp[i][j][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">// æœ¬æ¬¡ä¸æŒ-ä¸Šæ¬¡å°±ä¸æŒ</span></span><br><span class="line">			<span class="keyword">int</span> dp1 = getdp(i-<span class="number">1</span>,j,<span class="number">0</span>,dp,prices);</span><br><span class="line">			<span class="comment">// æœ¬æ¬¡ä¸æŒ-æœ¬æ¬¡å–</span></span><br><span class="line">			<span class="keyword">int</span> dp2 = j&gt;<span class="number">0</span> ? getdp(i-<span class="number">1</span>,j-<span class="number">1</span>,<span class="number">1</span>,dp,prices)+prices[i]-prices[i-<span class="number">1</span>] : <span class="number">0</span>;</span><br><span class="line">			dp[i][j][<span class="number">0</span>] = Math.max(dp1,dp2);</span><br><span class="line">           </span><br><span class="line">			<span class="comment">// æœ¬æ¬¡æŒ-æœ¬æ¬¡ä¹°</span></span><br><span class="line">			<span class="keyword">int</span> dp3 = getdp(i-<span class="number">1</span>,j,<span class="number">0</span>,dp,prices);</span><br><span class="line">			<span class="comment">// æœ¬æ¬¡æŒ-ä¸Šæ¬¡å°±æŒ</span></span><br><span class="line">			<span class="keyword">int</span> dp4 = getdp(i-<span class="number">1</span>,j,<span class="number">1</span>,dp,prices)+prices[i]-prices[i-<span class="number">1</span>];</span><br><span class="line">			dp[i][j][<span class="number">1</span>] = Math.max(dp3,dp4);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">	<span class="keyword">return</span> dp[i][j][k];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ï¼šå½“kå¾ˆå¤§æ—¶ï¼Œå†…å­˜ä¼šçˆ†ï¼Œæ­¤æ—¶ç›¸å½“äºä¸é™åˆ¶äº¤æ˜“æ¬¡æ•°ï¼Œç›´æ¥ç”¨è´ªå¿ƒè§£å†³</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span>[] prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(prices.length&lt;<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(k &gt; prices.length/<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="comment">// ç›¸å½“äºä¸é™åˆ¶æ¬¡æ•°ï¼Œè´ªå¿ƒ</span></span><br><span class="line">            <span class="keyword">int</span> value = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;prices.length;i++)&#123;</span><br><span class="line">                value += prices[i]&gt;prices[i-<span class="number">1</span>] ? prices[i]-prices[i-<span class="number">1</span>] : <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[][][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[prices.length][k+<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;prices.length;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;k+<span class="number">1</span>;j++)&#123;</span><br><span class="line">                Arrays.fill(dp[i][j],-<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> getdp(prices.length-<span class="number">1</span>,k,<span class="number">0</span>,dp,prices);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getdp</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,<span class="keyword">int</span> k,<span class="keyword">int</span>[][][] dp,<span class="keyword">int</span>[] prices)</span></span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>ç”¨è¿™ä¸€å¥—è§£æ³•å¹²æ‰4é¢˜</p>
<p>Leetcode 121 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº â€”â€” æœ€å¤šäº¤æ˜“1æ¬¡<br>ä»¤ k = 1</p>
<p>Leetcode 122 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II â€”â€” ä¸é™æ¬¡æ•°<br>ç›´æ¥è´ªå¿ƒ</p>
<p>Leetcode 123 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III â€”â€” æœ€å¤šäº¤æ˜“2æ¬¡<br>ä»¤ k = 2</p>
<p>Leetcode 188 ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV â€”â€” æœ€å¤šäº¤æ˜“kæ¬¡</p>
]]></content>
      <categories>
        <category>Exercise</category>
      </categories>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°05 IoC</title>
    <url>/2020/02/28/note-spring-05/</url>
    <content><![CDATA[<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p15ï½34</p>
<hr>
<h1 id="IoCçš„æ¦‚å¿µå’Œä½œç”¨"><a href="#IoCçš„æ¦‚å¿µå’Œä½œç”¨" class="headerlink" title="IoCçš„æ¦‚å¿µå’Œä½œç”¨"></a>IoCçš„æ¦‚å¿µå’Œä½œç”¨</h1><p>ä¸Šæ¬¡å·¥å‚æ¨¡å¼ä¸­åˆ›å»ºå¯¹è±¡æœ‰2ç§æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ–¹å¼1</span></span><br><span class="line">IAccountService as = <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line"><span class="comment">// æ–¹å¼2</span></span><br><span class="line">IAccountService as = (IAccountService) BeanFactory.getBean(<span class="string">"accountService"</span>);</span><br></pre></td></tr></table></figure>
<p>æ–¹å¼1æ˜¯ä¸»åŠ¨çš„ï¼›æ–¹å¼2æ˜¯è¢«åŠ¨çš„ï¼ˆæ ¹æ®é…ç½®åˆ›å»ºï¼‰ï¼Œæ§åˆ¶æƒè½¬ç§»ç»™äº†å·¥å‚</p>
<p><strong>IoC (Inversion of Control æ§åˆ¶åè½¬)æŠŠåˆ›å»ºå¯¹è±¡çš„æƒåˆ©äº¤ç»™æ¡†æ¶</strong><br><strong>å…¶ä½œç”¨æ˜¯é™ä½ç¨‹åºçš„è€¦åˆ</strong><br>ä½†åªèƒ½æ˜¯é™ä½ï¼Œè€Œä¸èƒ½å®Œå…¨æ¶ˆé™¤ã€‚å¦‚æœä¸¤ä¸ªç±»ä¹‹é—´ä»»ä½•å…³ç³»éƒ½æ²¡æœ‰ï¼Œé‚£æœ‰ä¸€ä¸ªç±»ä¸€å®šæ˜¯å¤šä½™çš„ã€‚<br>è‡ªå·±å†™æ—¶ç”¨å·¥å‚æ¨¡å¼å®ç°ï¼ŒSpringä¸­çš„Iocå¦‚ä½•å®ç°ï¼Ÿ</p>
<hr>
<h1 id="Springä¸­çš„IoC"><a href="#Springä¸­çš„IoC" class="headerlink" title="Springä¸­çš„IoC"></a>Springä¸­çš„IoC</h1><p><strong>æ§åˆ¶åè½¬ Inversion of Control, IoC</strong></p>
<p>è§£å†³çš„é—®é¢˜ï¼šé™ä½ç¨‹åºè€¦åˆï¼ˆå‡å°‘ä¾èµ–å…³ç³»ï¼‰<br>è§£å†³çš„æ–¹æ³•ï¼šä½¿ç”¨é…ç½®çš„æ–¹å¼</p>
<h2 id="1-å¯¼å…¥ä¾èµ–"><a href="#1-å¯¼å…¥ä¾èµ–" class="headerlink" title="1.å¯¼å…¥ä¾èµ–"></a>1.å¯¼å…¥ä¾èµ–</h2><p>å¯¼å…¥Springä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æŸ¥çœ‹å¼•å…¥çš„ä¾èµ–<br><img src="/images/2020/20200228105855284.png" width=400>  <img src="/images/2020/20200228110642475.png" width=500><br>åŒ…å«äº†å¸¸ç”¨çš„æ ¸å¿ƒç»„ä»¶<br><img src="/images/2020/20200228110023357.png" width=400></p>
<p>Core Containerç®€å•çš„è¯´å°±æ˜¯ä¸€ä¸ªMapï¼Œå°è£…äº†è¦ç”¨çš„å¯¹è±¡</p>
<h2 id="2-åˆ›å»ºé…ç½®æ–‡ä»¶-amp-å¯¼å…¥çº¦æŸ-amp-é…ç½®bean"><a href="#2-åˆ›å»ºé…ç½®æ–‡ä»¶-amp-å¯¼å…¥çº¦æŸ-amp-é…ç½®bean" class="headerlink" title="2.åˆ›å»ºé…ç½®æ–‡ä»¶&amp;å¯¼å…¥çº¦æŸ&amp;é…ç½®bean"></a>2.åˆ›å»ºé…ç½®æ–‡ä»¶&amp;å¯¼å…¥çº¦æŸ&amp;é…ç½®bean</h2><p>ç„¶ååˆ›å»ºbean.xmlï¼ˆæ²¡æœ‰å›ºå®šè¦æ±‚ï¼Œä¹ æƒ¯è¿™æ ·å‘½åï¼Œå› ä¸ºæ˜¯ç®¡beansçš„ï¼‰<br>åœ¨spring-framework-5.0.2.RELEASE-docs/spring-framework-referenceæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°index.html<br><img src="/images/2020/20200228111723489.png" width=800><br>ç‚¹coreï¼Œæœç´¢xmlnsï¼ˆå¯¼å…¥xml schemaçº¦æŸçš„å…³é”®å­—ï¼‰<br><img src="/images/2020/20200228111921799.png" width=800><br>æŠŠå®ƒå¤åˆ¶ç²˜è´´åˆ°é…ç½®æ–‡ä»¶ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®beanï¼ŒæŠŠå¯¹è±¡çš„åˆ›å»ºäº¤ç»™Springæ¥ç®¡ç†<br>åŒå·¥å‚æ¨¡å¼ï¼Œéœ€è¦å”¯ä¸€æ ‡å¿—å’Œå¯¹è±¡çš„å…¨é™å®šç±»åï¼ˆåŒ…å+ç±»åï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.itheima.dao.impl.AccountDaoImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å‰©ä¸‹çš„è§£æé…ç½®æ–‡ä»¶çš„äº‹å°±ç”±Springåšäº†</p>
<h2 id="3-å–å‡ºå®¹å™¨-amp-è·å–å¯¹è±¡"><a href="#3-å–å‡ºå®¹å™¨-amp-è·å–å¯¹è±¡" class="headerlink" title="3.å–å‡ºå®¹å™¨&amp;è·å–å¯¹è±¡"></a>3.å–å‡ºå®¹å™¨&amp;è·å–å¯¹è±¡</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Client.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–æ ¸å¿ƒå®¹å™¨å¯¹è±¡</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);</span><br><span class="line">        <span class="comment">// 2.æ ¹æ®idè·å–Beanå¯¹è±¡</span></span><br><span class="line">        <span class="comment">// æ–¹æ³•ä¸€ï¼šæ‹¿åˆ°ä¸€ä¸ªObjectç±»ï¼Œè‡ªå·±å¼ºè½¬</span></span><br><span class="line">        IAccountService as  = (IAccountService)ac.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">        <span class="comment">// æ–¹æ³•äºŒï¼šç»™ä¸€ä¸ªç±»å‹ï¼Œç›´æ¥å¾—åˆ°è¯¥ç±»å‹å¯¹è±¡</span></span><br><span class="line">        IAccountDao adao = ac.getBean(<span class="string">"accountDao"</span>,IAccountDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="tip-ApplicationContextçš„ç»§æ‰¿å…³ç³»"><a href="#tip-ApplicationContextçš„ç»§æ‰¿å…³ç³»" class="headerlink" title="tip: ApplicationContextçš„ç»§æ‰¿å…³ç³»"></a>tip: ApplicationContextçš„ç»§æ‰¿å…³ç³»</h2><p>Ideaä¸­ï¼Œåœ¨ç±»ä¸Šå³é”®-&gt;Diagrams-&gt;Show Diagram<br>åœ¨æ¥å£ä¸Šå³é”®-&gt;Show Implementations<br><img src="/images/2020/20200228114140888.png"><br>å¯ä»¥çœ‹åˆ°ï¼ŒApplicationContextç»§æ‰¿è‡ªBeanFactoryï¼ŒClassPathXmlApplicationContextæ˜¯å®ƒçš„å®ç°ç±»</p>
<p>ApplicationContextçš„ä¸‰ä¸ªå¸¸ç”¨å®ç°ç±»ï¼š<br>     *      ClassPathXmlApplicationContextï¼šå®ƒå¯ä»¥åŠ è½½ç±»è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶ï¼ˆé…ç½®æ–‡ä»¶å¿…é¡»åœ¨ç±»è·¯å¾„ä¸‹ï¼Œä¸åœ¨çš„åŠ è½½ä¸äº†ï¼‰ï¼ˆæ›´å¸¸ç”¨ï¼‰<br>     *      FileSystemXmlApplicationContextï¼šå®ƒå¯ä»¥åŠ è½½ç£ç›˜ä»»æ„è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶ï¼ˆå¿…é¡»æœ‰è®¿é—®æƒé™ï¼‰<br>     *      AnnotationConfigApplicationContextï¼šå®ƒæ˜¯ç”¨äºè¯»å–æ³¨è§£åˆ›å»ºå®¹å™¨çš„ï¼ˆåé¢è®²ï¼‰</p>
<h2 id="tip-ApplicationContextå’ŒBeanFactoryçš„åŒºåˆ«"><a href="#tip-ApplicationContextå’ŒBeanFactoryçš„åŒºåˆ«" class="headerlink" title="tip: ApplicationContextå’ŒBeanFactoryçš„åŒºåˆ«"></a>tip: ApplicationContextå’ŒBeanFactoryçš„åŒºåˆ«</h2><p><strong>ApplicationContext</strong></p>
<ul>
<li>æ„å»ºæ ¸å¿ƒå®¹å™¨æ—¶ï¼Œåˆ›å»ºå¯¹è±¡é‡‡å–çš„ç­–ç•¥æ˜¯é‡‡ç”¨ç«‹å³åŠ è½½çš„æ–¹å¼ã€‚å³ï¼Œä¸€è¯»å–å®Œé…ç½®æ–‡ä»¶é©¬ä¸Šå°±åˆ›å»ºé…ç½®æ–‡ä»¶ä¸­é…ç½®çš„å¯¹è±¡</li>
<li>å•ä¾‹å¯¹è±¡é€‚ç”¨ </li>
</ul>
<p><strong>BeanFactory</strong></p>
<ul>
<li>æ„å»ºæ ¸å¿ƒå®¹å™¨æ—¶ï¼Œåˆ›å»ºå¯¹è±¡é‡‡å–çš„ç­–ç•¥æ˜¯é‡‡ç”¨å»¶è¿ŸåŠ è½½çš„æ–¹å¼ã€‚å³ï¼Œä»€ä¹ˆæ—¶å€™æ ¹æ®idè·å–å¯¹è±¡äº†ï¼Œä»€ä¹ˆæ—¶å€™æ‰çœŸæ­£çš„åˆ›å»ºå¯¹è±¡</li>
<li>å¤šä¾‹å¯¹è±¡ä½¿ç”¨</li>
</ul>
<hr>
<h1 id="beançš„ç»†èŠ‚"><a href="#beançš„ç»†èŠ‚" class="headerlink" title="beançš„ç»†èŠ‚"></a>beançš„ç»†èŠ‚</h1><h2 id="åˆ›å»ºbeanå¯¹è±¡çš„ä¸‰ç§æ–¹å¼"><a href="#åˆ›å»ºbeanå¯¹è±¡çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="åˆ›å»ºbeanå¯¹è±¡çš„ä¸‰ç§æ–¹å¼"></a>åˆ›å»ºbeanå¯¹è±¡çš„ä¸‰ç§æ–¹å¼</h2><h3 id="æ–¹å¼ä¸€ï¼šä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°åˆ›å»º"><a href="#æ–¹å¼ä¸€ï¼šä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°åˆ›å»º" class="headerlink" title="æ–¹å¼ä¸€ï¼šä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°åˆ›å»º"></a>æ–¹å¼ä¸€ï¼šä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°åˆ›å»º</h3><p>åœ¨springçš„é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨beanæ ‡ç­¾ï¼Œé…ä»¥idå’Œclasså±æ€§ä¹‹åï¼Œä¸”æ²¡æœ‰å…¶ä»–å±æ€§å’Œæ ‡ç­¾æ—¶ã€‚é‡‡ç”¨çš„å°±æ˜¯é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºbeanå¯¹è±¡ï¼Œæ­¤æ—¶å¦‚æœç±»ä¸­æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œåˆ™å¯¹è±¡æ— æ³•åˆ›å»ºã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–¹å¼äºŒï¼šä½¿ç”¨æ™®é€šå·¥å‚ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡"><a href="#æ–¹å¼äºŒï¼šä½¿ç”¨æ™®é€šå·¥å‚ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡" class="headerlink" title="æ–¹å¼äºŒï¼šä½¿ç”¨æ™®é€šå·¥å‚ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡"></a>æ–¹å¼äºŒï¼šä½¿ç”¨æ™®é€šå·¥å‚ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡</h3><p>å®é™…å¼€å‘ä¸­ï¼Œå¯èƒ½è¦ç”¨åˆ°åˆ«äººå†™å¥½çš„jaråŒ…ä¸­çš„ç±»ã€‚ï¼ˆä¸çŸ¥é“æœ‰æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œä¹Ÿæ— æ³•é€šè¿‡ä¿®æ”¹æºç æ¥æä¾›é»˜è®¤æ„é€ å‡½æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿä¸€ä¸ªå·¥å‚ç±»ï¼ˆè¯¥ç±»å¯èƒ½æ˜¯å­˜åœ¨äºjaråŒ…ä¸­çš„ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡ä¿®æ”¹æºç çš„æ–¹å¼æ¥æä¾›é»˜è®¤æ„é€ å‡½æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InstanceFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IAccountService <span class="title">getAccountService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰è¿™ä¹ˆä¸€ä¸ªInstanceFactoryç±»ï¼Œéœ€è¦æ‹¿åˆ°AccountServiceImpl<br>å¦‚æœåƒæ–¹æ³•ä¸€é‚£æ ·åˆ›å»ºå¯¹è±¡ï¼Œå³</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"instanceFactory"</span> <span class="attr">class</span>=<span class="string">"com.itheima.factory.InstanceFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„å¹¶ä¸æ˜¯AccountServiceImplå¯¹è±¡ï¼Œè€Œæ˜¯InstanceFactoryå¯¹è±¡</p>
<p>æ­¤æ—¶åº”è¯¥ä¿®æ”¹åˆ›å»ºå¯¹è±¡çš„æ–¹å¼<br><strong>ä½¿ç”¨æ™®é€šå·¥å‚ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆä½¿ç”¨æŸä¸ªç±»ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œå¹¶å­˜å…¥springå®¹å™¨ï¼‰</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"instanceFactory"</span> <span class="attr">class</span>=<span class="string">"com.itheima.factory.InstanceFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">factory-bean</span>=<span class="string">"instanceFactory"</span> <span class="attr">factory-method</span>=<span class="string">"getAccountService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…ˆåˆ›å»ºå·¥å‚ï¼Œå†é€šè¿‡å·¥å‚çš„æ–¹æ³•åˆ›å»ºæ‰€éœ€å¯¹è±¡</p>
<h3 id="æ–¹å¼ä¸‰ï¼šä½¿ç”¨å·¥å‚ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡"><a href="#æ–¹å¼ä¸‰ï¼šä½¿ç”¨å·¥å‚ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡" class="headerlink" title="æ–¹å¼ä¸‰ï¼šä½¿ç”¨å·¥å‚ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡"></a>æ–¹å¼ä¸‰ï¼šä½¿ç”¨å·¥å‚ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡</h3><p>æ¨¡æ‹Ÿä¸€ä¸ªå·¥å‚ç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªè¿”å›å¯¹è±¡çš„é™æ€æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿä¸€ä¸ªå·¥å‚ç±»ï¼ˆè¯¥ç±»å¯èƒ½æ˜¯å­˜åœ¨äºjaråŒ…ä¸­çš„ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡ä¿®æ”¹æºç çš„æ–¹å¼æ¥æä¾›é»˜è®¤æ„é€ å‡½æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IAccountService <span class="title">getAccountService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨å·¥å‚ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆä½¿ç”¨æŸä¸ªç±»ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œå¹¶å­˜å…¥springå®¹å™¨)</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.factory.StaticFactory"</span> <span class="attr">factory-method</span>=<span class="string">"getAccountService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„factory-methodæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•</p>
<p>Qï¼šè¿™ä¸¤ä¸ªå·¥å‚ä¸­ä¸éƒ½newå¯¹è±¡äº†å—ï¼Ÿ<br>Aï¼šæŠŠè¿™ä¸¤ä¸ªå¯¹è±¡çœ‹ä½œjaråŒ…ä¸­çš„ç±»ï¼ˆæ­¤å¤„åªæ˜¯æ¨¡æ‹Ÿå®ƒï¼‰ï¼ŒjaråŒ…ä¸­ä¸æ˜¯.javaæ–‡ä»¶è€Œæ˜¯.classï¼Œéƒ½æ˜¯æ— æ³•ä¿®æ”¹çš„ã€‚å®é™…å¼€å‘ä¸­ï¼Œæœ‰äº›å¯¹è±¡å°±å¾—ç”¨æ–¹æ³•äºŒæˆ–æ–¹æ³•ä¸‰æ¥åˆ›å»º</p>
<h2 id="æŒ‡å®šbeanå¯¹è±¡çš„ä½œç”¨èŒƒå›´ï¼šbeanæ ‡ç­¾çš„scopeå±æ€§"><a href="#æŒ‡å®šbeanå¯¹è±¡çš„ä½œç”¨èŒƒå›´ï¼šbeanæ ‡ç­¾çš„scopeå±æ€§" class="headerlink" title="æŒ‡å®šbeanå¯¹è±¡çš„ä½œç”¨èŒƒå›´ï¼šbeanæ ‡ç­¾çš„scopeå±æ€§"></a>æŒ‡å®šbeanå¯¹è±¡çš„ä½œç”¨èŒƒå›´ï¼šbeanæ ‡ç­¾çš„scopeå±æ€§</h2><p>å–å€¼ï¼š<br><strong>singleton</strong>ï¼šå•ä¾‹çš„ï¼ˆé»˜è®¤å€¼ï¼‰ï¼ˆå¸¸ç”¨ï¼‰<br><strong>prototype</strong>ï¼šå¤šä¾‹çš„ï¼ˆå¸¸ç”¨ï¼‰<br><strong>request</strong>ï¼šä½œç”¨äºwebåº”ç”¨çš„è¯·æ±‚èŒƒå›´<br><strong>session</strong>ï¼šä½œç”¨äºwebåº”ç”¨çš„ä¼šè¯èŒƒå›´<br><strong>global-session</strong>ï¼šä½œç”¨äºé›†ç¾¤ç¯å¢ƒçš„ä¼šè¯èŒƒå›´ï¼ˆå…¨å±€ä¼šè¯èŒƒå›´ï¼‰ï¼Œå½“ä¸æ˜¯é›†ç¾¤ç¯å¢ƒæ—¶ï¼Œå®ƒå°±æ˜¯session</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>global-sessionçš„å«ä¹‰<br><img src="/images/2020/20200228131045586.png" width=800></p>
<h2 id="beanå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#beanå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="beanå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ"></a>beanå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ</h2><p><strong>å•ä¾‹å¯¹è±¡</strong></p>
<ul>
<li>å‡ºç”Ÿï¼šå½“å®¹å™¨åˆ›å»ºæ—¶å¯¹è±¡å‡ºç”Ÿ</li>
<li>æ´»ç€ï¼šåªè¦å®¹å™¨è¿˜åœ¨ï¼Œå¯¹è±¡ä¸€ç›´æ´»ç€</li>
<li>æ­»äº¡ï¼šå®¹å™¨é”€æ¯ï¼Œå¯¹è±¡æ¶ˆäº¡</li>
</ul>
<p>æ€»ç»“ï¼šå•ä¾‹å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå®¹å™¨ç›¸åŒ</p>
<p><strong>å¤šä¾‹å¯¹è±¡</strong></p>
<ul>
<li>å‡ºç”Ÿï¼šå½“æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡æ—¶springæ¡†æ¶ä¸ºæˆ‘ä»¬åˆ›å»º</li>
<li>æ´»ç€ï¼šå¯¹è±¡åªè¦æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å°±ä¸€ç›´æ´»ç€ã€‚</li>
<li>æ­»äº¡ï¼šå½“å¯¹è±¡é•¿æ—¶é—´ä¸ç”¨ï¼Œä¸”æ²¡æœ‰åˆ«çš„å¯¹è±¡å¼•ç”¨æ—¶ï¼Œç”±Javaçš„åƒåœ¾å›æ”¶å™¨å›æ”¶</li>
</ul>
<p>å¯ä»¥é€šè¿‡beanæ ‡ç­¾æŒ‡å®šåœ¨ç‰¹å®šç”Ÿå‘½å‘¨æœŸæ‰§è¡Œçš„æ–¹æ³•</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// beans.xml</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">scope</span>=<span class="string">"singleton"</span> <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"destroy"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Client.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1.è·å–æ ¸å¿ƒå®¹å™¨å¯¹è±¡</span></span><br><span class="line">        ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);  <span class="comment">// æ‰§è¡Œå®Œè¿™å¥ï¼Œå•ä¾‹å¯¹è±¡å°±åˆ›å»ºäº†</span></span><br><span class="line">        <span class="comment">// 2.æ ¹æ®idè·å–Beanå¯¹è±¡</span></span><br><span class="line">        IAccountService as  = (IAccountService)ac.getBean(<span class="string">"accountService"</span>);  <span class="comment">// æ‰§è¡Œå®Œè¿™å¥ï¼Œå¤šä¾‹å¯¹è±¡æ‰åˆ›å»º</span></span><br><span class="line">        as.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// AccountServiceImpl.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountServiceImpl</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å¯¹è±¡åˆ›å»ºäº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">saveAccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"serviceä¸­çš„saveAccountæ–¹æ³•æ‰§è¡Œäº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å¯¹è±¡åˆå§‹åŒ–äº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">destroy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å¯¹è±¡é”€æ¯äº†..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¾“å‡º</p>
<blockquote>
<p>å¯¹è±¡åˆ›å»ºäº†â€¦<br>å¯¹è±¡åˆå§‹åŒ–äº†â€¦<br>serviceä¸­çš„saveAccountæ–¹æ³•æ‰§è¡Œäº†â€¦</p>
</blockquote>
<p>Qï¼šä¸ºä»€ä¹ˆæ²¡æœ‰æ‰§è¡Œé”€æ¯æ–¹æ³•ï¼Ÿ<br>Aï¼šmain()ç»“æŸä¹‹åï¼Œå½“å‰è¿›ç¨‹å ç”¨çš„å†…å­˜å…¨éƒ¨é‡Šæ”¾ï¼ˆåŒ…æ‹¬å®¹å™¨ï¼‰ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰è°ƒç”¨é”€æ¯æ–¹æ³•å°±å·²ç»æŠŠå†…å­˜é‡Šæ”¾äº†ã€‚è¿™é‡Œè¦æƒ³è°ƒç”¨é”€æ¯æ–¹æ³•ï¼Œå¯ä»¥æ‰‹åŠ¨å…³é—­å®¹å™¨</p>
<p>åœ¨main()ä¸­æ‰‹åŠ¨å…³é—­å®¹å™¨<br><img src="/images/2020/20200228132514347.png" width=600><br>ä¸ºä»€ä¹ˆæ²¡æœ‰å‘¢ï¼Ÿ<br>è¿™é‡ŒApplicationContextæ˜¯ä¸ªæ¥å£ï¼Œè°ƒä¸åˆ°å­ç±»çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.è·å–æ ¸å¿ƒå®¹å™¨å¯¹è±¡</span></span><br><span class="line"><span class="comment">// ApplicationContext ac = new ClassPathXmlApplicationContext("bean.xml");</span></span><br><span class="line">ClassPathXmlApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>);</span><br><span class="line"><span class="comment">// 2.æ ¹æ®idè·å–Beanå¯¹è±¡</span></span><br><span class="line">IAccountService as  = (IAccountService)ac.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">as.saveAccount();</span><br><span class="line"><span class="comment">// 3.æ‰‹åŠ¨å…³é—­å®¹å™¨</span></span><br><span class="line">ac.close();</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥äº†</p>
<blockquote>
<p>å¯¹è±¡åˆ›å»ºäº†â€¦<br>å¯¹è±¡åˆå§‹åŒ–äº†â€¦<br>serviceä¸­çš„saveAccountæ–¹æ³•æ‰§è¡Œäº†â€¦<br>å¯¹è±¡é”€æ¯äº†â€¦</p>
</blockquote>
<p>ä½†æ˜¯ï¼Œæ­¤æ—¶å¦‚æœæŠŠå¯¹è±¡æ”¹ä¸ºå¤šä¾‹çš„ï¼Œå…¶å®ƒéƒ½ä¸å˜ï¼Œä¸ä¼šæ‰§è¡Œé”€æ¯æ–¹æ³•</p>
<hr>
<h1 id="Springä¸­çš„ä¾èµ–æ³¨å…¥-DI"><a href="#Springä¸­çš„ä¾èµ–æ³¨å…¥-DI" class="headerlink" title="Springä¸­çš„ä¾èµ–æ³¨å…¥(DI)"></a>Springä¸­çš„ä¾èµ–æ³¨å…¥(DI)</h1><p><strong>ä¾èµ–æ³¨å…¥ Dependency Injection, DI</strong></p>
<p><strong>èƒ½æ³¨å…¥çš„ä¸‰ç±»æ•°æ®</strong></p>
<ol>
<li>åŸºæœ¬ç±»å‹å’ŒString</li>
<li>å…¶ä»–beanç±»å‹ï¼ˆåœ¨é…ç½®æ–‡ä»¶ä¸­æˆ–è€…æ³¨è§£é…ç½®è¿‡çš„beanï¼‰</li>
<li>å¤æ‚ç±»å‹/é›†åˆç±»å‹</li>
</ol>
<p><strong>æ³¨å…¥çš„ä¸‰ç§æ–¹å¼</strong></p>
<ol>
<li>ä½¿ç”¨æ„é€ å‡½æ•°æä¾›</li>
<li>ä½¿ç”¨setæ–¹æ³•æä¾›</li>
<li>ä½¿ç”¨æ³¨è§£æä¾›</li>
</ol>
<h2 id="æ„é€ å‡½æ•°æ³¨å…¥"><a href="#æ„é€ å‡½æ•°æ³¨å…¥" class="headerlink" title="æ„é€ å‡½æ•°æ³¨å…¥"></a>æ„é€ å‡½æ•°æ³¨å…¥</h2><p><strong>ä½¿ç”¨çš„æ ‡ç­¾</strong>ï¼šconstructor-arg<br><strong>æ ‡ç­¾å‡ºç°çš„ä½ç½®</strong>ï¼šbeanæ ‡ç­¾çš„å†…éƒ¨<br><strong>æ ‡ç­¾ä¸­çš„å±æ€§ï¼ˆæŒ‡å®šå‚æ•°ï¼‰</strong>ï¼š</p>
<ul>
<li>typeï¼šæŒ‡å®šæ•°æ®ç±»å‹</li>
<li>indexï¼šæŒ‡å®šæ„é€ å‡½æ•°ä¸­çš„ç´¢å¼•ä½ç½®</li>
<li>nameï¼šæŒ‡å®šåç§°ï¼ˆå¸¸ç”¨ï¼‰</li>
</ul>
<p><strong>æ ‡ç­¾ä¸­çš„å±æ€§ï¼ˆæä¾›èµ‹å€¼ï¼‰</strong>ï¼š</p>
<ul>
<li>valueï¼šç”¨äºæä¾›åŸºæœ¬ç±»å‹å’ŒStringç±»å‹çš„æ•°æ®</li>
<li>refï¼šç”¨äºæŒ‡å®šå…¶ä»–çš„beanç±»å‹æ•°æ®ï¼ˆåœ¨springçš„Iocæ ¸å¿ƒå®¹å™¨ä¸­å‡ºç°è¿‡çš„beanå¯¹è±¡ï¼‰</li>
</ul>
<p><strong>ä¼˜åŠ¿</strong>ï¼š<br>åœ¨è·å–beanå¯¹è±¡æ—¶ï¼Œæ³¨å…¥æ•°æ®æ˜¯å¿…é¡»çš„æ“ä½œï¼Œå¦åˆ™å¯¹è±¡æ— æ³•åˆ›å»ºæˆåŠŸï¼ˆå¿…é¡»æŸäº›æ•°æ®æ—¶ï¼Œä¸ä¼šè¢«å¿½ç•¥ï¼‰<br><strong>å¼Šç«¯</strong>ï¼š<br>æ”¹å˜äº†beanå¯¹è±¡çš„å®ä¾‹åŒ–æ–¹å¼ï¼Œåˆ›å»ºå¯¹è±¡æ—¶ï¼Œå³ä½¿ä»¥åç”¨ä¸åˆ°è¿™äº›æ•°æ®ï¼Œä¹Ÿå¿…é¡»æä¾›</p>
<p>ä¾‹ï¼š</p>
<p>AccountServiceImplç±»æœ‰3ä¸ªå˜é‡ï¼Œæ²¡æœ‰æ— å‚æ„é€ å‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ç»å¸¸å˜åŒ–çš„æ•°æ®ï¼Œå¹¶ä¸é€‚ç”¨äºæ³¨å…¥çš„æ–¹å¼</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountServiceImpl</span><span class="params">(String name,Integer age,Date birthday)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>bean.xmlå¯¹åº”çš„beané…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">ref</span>=<span class="string">"now"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®ä¸€ä¸ªæ—¥æœŸå¯¹è±¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"now"</span> <span class="attr">class</span>=<span class="string">"java.util.Date"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®ä¸­çš„valueéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå¯¹äºStringã€Integerç±»å‹ï¼ŒSpringå¯ä»¥è‡ªåŠ¨è½¬æ¢<br>ä½†Dateæ— æ³•ç›´æ¥è½¬æ¢ï¼Œéœ€å¦å¤–é…ç½®</p>
<h2 id="setæ–¹æ³•æ³¨å…¥"><a href="#setæ–¹æ³•æ³¨å…¥" class="headerlink" title="setæ–¹æ³•æ³¨å…¥"></a>setæ–¹æ³•æ³¨å…¥</h2><p>æ¯”æ„é€ å‡½æ•°å¸¸ç”¨</p>
<p><strong>ä½¿ç”¨çš„æ ‡ç­¾</strong>ï¼šproperty<br><strong>å‡ºç°çš„ä½ç½®</strong>ï¼šbeanæ ‡ç­¾çš„å†…éƒ¨<br><strong>æ ‡ç­¾çš„å±æ€§</strong>ï¼š</p>
<ul>
<li>nameï¼šç”¨äºæŒ‡å®šæ³¨å…¥æ—¶æ‰€è°ƒç”¨çš„setæ–¹æ³•åç§°ï¼ˆä¸ç®¡å˜é‡åï¼‰</li>
<li>valueï¼šç”¨äºæä¾›åŸºæœ¬ç±»å‹å’ŒStringç±»å‹çš„æ•°æ®</li>
<li>refï¼šç”¨äºæŒ‡å®šå…¶ä»–çš„beanç±»å‹æ•°æ®</li>
</ul>
<p><strong>ä¼˜åŠ¿</strong>ï¼š<br>åˆ›å»ºå¯¹è±¡æ—¶æ²¡æœ‰æ˜ç¡®çš„é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°<br><strong>å¼Šç«¯</strong>ï¼š<br>å¦‚æœæœ‰æŸä¸ªæˆå‘˜å¿…é¡»æœ‰å€¼ï¼Œä½†æ²¡æœ‰æ³¨å…¥</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl2</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;<span class="keyword">this</span>.name = name;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;<span class="keyword">this</span>.age = age;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;<span class="keyword">this</span>.birthday = birthday;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService2"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl2"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"TEST"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"21"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">ref</span>=<span class="string">"now"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å¤æ‚ç±»å‹æ³¨å…¥"><a href="#å¤æ‚ç±»å‹æ³¨å…¥" class="headerlink" title="å¤æ‚ç±»å‹æ³¨å…¥"></a>å¤æ‚ç±»å‹æ³¨å…¥</h2><p>ç”¨äºç»™Listç»“æ„é›†åˆæ³¨å…¥çš„æ ‡ç­¾ï¼š<br>            list array set</p>
<p>ç”¨äºä¸ªMapç»“æ„é›†åˆæ³¨å…¥çš„æ ‡ç­¾:<br>            map  props</p>
<p>! ç»“æ„ç›¸åŒï¼Œæ ‡ç­¾å¯ä»¥äº’æ¢</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl3</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// listç»“æ„</span></span><br><span class="line">    <span class="keyword">private</span> String[] myStrs;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; myList;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; mySet;</span><br><span class="line">    <span class="comment">// mapç»“æ„</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; myMap;</span><br><span class="line">    <span class="keyword">private</span> Properties myProps;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyStrs</span><span class="params">(String[] myStrs)</span> </span>&#123; <span class="keyword">this</span>.myStrs = myStrs; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyList</span><span class="params">(List&lt;String&gt; myList)</span> </span>&#123; <span class="keyword">this</span>.myList = myList; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMySet</span><span class="params">(Set&lt;String&gt; mySet)</span> </span>&#123; <span class="keyword">this</span>.mySet = mySet; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyMap</span><span class="params">(Map&lt;String, String&gt; myMap)</span> </span>&#123; <span class="keyword">this</span>.myMap = myMap; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyProps</span><span class="params">(Properties myProps)</span> </span>&#123; <span class="keyword">this</span>.myProps = myProps; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService3"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl3"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--ç”¨arrayã€listã€setéƒ½è¡Œ--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myStrs"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!--ç”¨mapã€propéƒ½è¡Œ--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myMap"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"testA"</span> <span class="attr">value</span>=<span class="string">"aaa"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"testB"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	        <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h1 id="åŸºäºæ³¨è§£çš„IoCé…ç½®"><a href="#åŸºäºæ³¨è§£çš„IoCé…ç½®" class="headerlink" title="åŸºäºæ³¨è§£çš„IoCé…ç½®"></a>åŸºäºæ³¨è§£çš„IoCé…ç½®</h1><p>æ³¨è§£é…ç½®å’Œxmlé…ç½®è¦å®ç°çš„åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼šé™ä½ç¨‹åºè€¦åˆ</p>
<p>æ›¾ç»XMLçš„é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">scope</span>=<span class="string">""</span>  <span class="attr">init-method</span>=<span class="string">""</span> <span class="attr">destroy-method</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">""</span>  <span class="attr">value</span>=<span class="string">""</span> | <span class="attr">ref</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ³¨è§£æ—¶ï¼Œä¸ç”¨ä¸Šé¢çš„<bean></bean>ï¼Œä½†éœ€è¦å‘Šè¯‰Springå¼€å¯æ³¨è§£æ‰«æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å‘ŠçŸ¥springåœ¨åˆ›å»ºå®¹å™¨æ—¶è¦æ‰«æçš„åŒ…ï¼Œé…ç½®æ‰€éœ€è¦çš„æ ‡ç­¾ä¸æ˜¯åœ¨beansçš„çº¦æŸä¸­ï¼Œè€Œæ˜¯ä¸€ä¸ªåç§°ä¸º</span></span><br><span class="line"><span class="comment">    contextåç§°ç©ºé—´å’Œçº¦æŸä¸­--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.itheima"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­contextåç§°ç©ºé—´å’Œå‰é¢ä¸€æ ·ï¼Œåœ¨æ–‡æ¡£ä¸­æœç´¢æ‰¾</p>
<h2 id="ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ³¨è§£"><a href="#ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ³¨è§£" class="headerlink" title="ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ³¨è§£"></a>ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ³¨è§£</h2><p><strong>@Component</strong><br>ä½œç”¨ï¼š<br>ç”¨äºæŠŠå½“å‰ç±»å¯¹è±¡å­˜å…¥springå®¹å™¨ä¸­</p>
<p>å±æ€§ï¼š<br>valueï¼šç”¨äºæŒ‡å®šbeançš„idï¼ˆä¸å†™æ—¶ï¼Œé»˜è®¤å€¼æ˜¯å½“å‰ç±»åï¼Œä¸”é¦–å­—æ¯å°å†™ï¼‰</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(value = <span class="string">"accountService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»†èŠ‚ï¼š<br>å½“åªç»™ä¸€ä¸ªvalueå±æ€§èµ‹å€¼æ—¶ï¼Œvalueå¯ä»¥ä¸å†™</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>@Controller</strong>ï¼šä¸€èˆ¬ç”¨åœ¨è¡¨ç°å±‚<br><strong>@Service</strong>ï¼šä¸€èˆ¬ç”¨åœ¨ä¸šåŠ¡å±‚<br><strong>@Repository</strong>ï¼šä¸€èˆ¬ç”¨åœ¨æŒä¹…å±‚</p>
<p>ä»¥ä¸Šä¸‰ä¸ªæ³¨è§£çš„ä½œç”¨å’Œå±æ€§ä¸@Componentä¸€æ¨¡ä¸€æ ·<br>æ˜¯Springæ¡†æ¶æä¾›çš„æ˜ç¡®çš„ä¸‰å±‚ä½¿ç”¨çš„æ³¨è§£ï¼Œä½¿ä¸‰å±‚å¯¹è±¡æ›´åŠ æ¸…æ™°</p>
<h2 id="ç”¨äºæ³¨å…¥æ•°æ®çš„æ³¨è§£"><a href="#ç”¨äºæ³¨å…¥æ•°æ®çš„æ³¨è§£" class="headerlink" title="ç”¨äºæ³¨å…¥æ•°æ®çš„æ³¨è§£"></a>ç”¨äºæ³¨å…¥æ•°æ®çš„æ³¨è§£</h2><p><strong>@Autowired</strong><br>ä½œç”¨ï¼š<br>è‡ªåŠ¨æŒ‰ç…§ç±»å‹æ³¨å…¥ã€‚åªè¦å®¹å™¨ä¸­æœ‰å”¯ä¸€çš„ä¸€ä¸ªbeanå¯¹è±¡ç±»å‹å’Œè¦æ³¨å…¥çš„å˜é‡ç±»å‹åŒ¹é…ï¼Œå°±å¯ä»¥æ³¨å…¥æˆåŠŸã€‚å¦‚æœiocå®¹å™¨ä¸­æ²¡æœ‰ä»»ä½•beançš„ç±»å‹å’Œè¦æ³¨å…¥çš„å˜é‡ç±»å‹åŒ¹é…ï¼Œåˆ™æŠ¥é”™<br>ï¼ˆå½“æœ‰å¤šä¸ªbeanç±»å‹åŒ¹é…æ—¶ï¼Œç”¨å˜é‡åå’Œbeançš„idåŒ¹é…ï¼Œå¦‚æœæ°å¥½æœ‰ä¸€ä¸ªåŒ¹é…ï¼Œä¹Ÿå¯ä»¥æˆåŠŸï¼Œå¦åˆ™æŠ¥é”™ï¼‰</p>
<p>å‡ºç°ä½ç½®ï¼š<br>å¯ä»¥æ˜¯å˜é‡ä¸Šï¼Œä¹Ÿå¯ä»¥æ˜¯æ–¹æ³•ä¸Š</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<p>ç»†èŠ‚ï¼š<br>åœ¨ä½¿ç”¨æ³¨è§£æ³¨å…¥æ—¶ï¼Œsetæ–¹æ³•å°±ä¸æ˜¯å¿…é¡»çš„äº†</p>
<p><strong>@Qualifier</strong><br> ä½œç”¨ï¼š<br> åœ¨æŒ‰ç…§ç±»ä¸­æ³¨å…¥çš„åŸºç¡€ä¹‹ä¸Šå†æŒ‰ç…§åç§°æ³¨å…¥ã€‚åœ¨ç»™ç±»æˆå‘˜æ³¨å…¥æ—¶ä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»å’Œ@Autowiredä¸€èµ·ã€‚ä½†æ˜¯åœ¨ç»™æ–¹æ³•å‚æ•°æ³¨å…¥æ—¶å¯ä»¥å•ç‹¬ä½¿ç”¨</p>
<p>å±æ€§ï¼š<br>valueï¼šç”¨äºæŒ‡å®šæ³¨å…¥beançš„id</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier</span>(<span class="string">"accountDao1"</span>)</span><br><span class="line"><span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<p><strong>@Resource</strong><br> ä½œç”¨ï¼š<br> ç›´æ¥æŒ‰ç…§beançš„idæ³¨å…¥ï¼Œå¯ä»¥ç‹¬ç«‹ä½¿ç”¨</p>
<p>å±æ€§ï¼š<br>nameï¼šç”¨äºæŒ‡å®šbeançš„id<br>ï¼ˆæ³¨æ„ï¼šè¿™é‡Œæ˜¯nameï¼Œä¸æ˜¯valueï¼‰</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Resource</span>(name = <span class="string">"accountDao1"</span>)</span><br><span class="line"><span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä¸‰ä¸ªæ³¨è§£éƒ½åªèƒ½æ³¨å…¥å…¶ä»–beanç±»å‹çš„æ•°æ®ï¼Œè€ŒåŸºæœ¬ç±»å‹å’ŒStringç±»å‹æ— æ³•æ³¨å…¥<br>å¦å¤–ï¼Œé›†åˆç±»å‹çš„æ³¨å…¥åªèƒ½é€šè¿‡XMLæ¥å®ç°</p>
<p><strong>@Value</strong><br>ä½œç”¨ï¼š<br>ç”¨äºæ³¨å…¥åŸºæœ¬ç±»å‹å’ŒStringç±»å‹çš„æ•°æ®</p>
<p>å±æ€§ï¼š<br>valueï¼šç”¨äºæŒ‡å®šæ•°æ®çš„å€¼<br>å¯ä»¥ä½¿ç”¨Springä¸­SpELï¼ˆå³Springçš„elè¡¨è¾¾å¼ï¼‰å†™æ³•ï¼š${è¡¨è¾¾å¼}</p>
<h2 id="ç”¨äºæ”¹å˜ä½œç”¨èŒƒå›´çš„æ³¨è§£"><a href="#ç”¨äºæ”¹å˜ä½œç”¨èŒƒå›´çš„æ³¨è§£" class="headerlink" title="ç”¨äºæ”¹å˜ä½œç”¨èŒƒå›´çš„æ³¨è§£"></a>ç”¨äºæ”¹å˜ä½œç”¨èŒƒå›´çš„æ³¨è§£</h2><p><strong>@Scope</strong><br>ä½œç”¨ï¼š<br>ç”¨äºæŒ‡å®šbeançš„ä½œç”¨èŒƒå›´</p>
<p>å±æ€§ï¼š<br>valueï¼šæŒ‡å®šèŒƒå›´çš„å–å€¼ï¼ˆå¸¸ç”¨ï¼šsingleton prototypeï¼‰</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="meta">@Scope</span>(<span class="string">"prototype"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ³¨è§£"><a href="#ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ³¨è§£" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ³¨è§£"></a>ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ³¨è§£</h2><p><strong>@PreDestroy</strong><br>ä½œç”¨ï¼šç”¨äºæŒ‡å®šé”€æ¯æ–¹æ³•</p>
<p><strong>@PostConstruct</strong><br>ä½œç”¨ï¼šç”¨äºæŒ‡å®šåˆå§‹åŒ–æ–¹æ³•</p>
<p>å’Œbeanæ ‡ç­¾ä¸­ä½¿ç”¨init-methodå’Œdestroy-methodeä¸€æ ·</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span>(<span class="string">"accountService"</span>)</span><br><span class="line"><span class="meta">@Scope</span>(<span class="string">"singleton"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span>(name = <span class="string">"accountDao1"</span>)</span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åˆå§‹åŒ–æ–¹æ³•æ‰§è¡Œäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">destroy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é”€æ¯æ–¹æ³•æ‰§è¡Œäº†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">saveAccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·ï¼Œå¦‚æœç±»æ˜¯å¤šä¾‹çš„ï¼Œå¯èƒ½ä¸ä¼šçœ‹åˆ°é”€æ¯æ–¹æ³•æ‰§è¡Œçš„è¾“å‡ºï¼Œå› ä¸ºå®ƒçš„é”€æ¯æ˜¯JVMç®¡çš„</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°04 åº”ç”¨åˆ†å±‚</title>
    <url>/2020/02/24/note-spring-04/</url>
    <content><![CDATA[<h1 id="ä¸‰å±‚æ¶æ„-3-Tier-Architecture"><a href="#ä¸‰å±‚æ¶æ„-3-Tier-Architecture" class="headerlink" title="ä¸‰å±‚æ¶æ„ (3-Tier Architecture)"></a>ä¸‰å±‚æ¶æ„ (3-Tier Architecture)</h1><img src="/images/2020/20200224200654315.png" width=400>

<ul>
<li><strong>è¡¨ç¤ºå±‚ (PL, Presentation Layer æˆ– UI, User Interface Layer)</strong> â€”â€” ä¸»è¦æ˜¯ä¸ç”¨æˆ·äº¤äº’çš„ç•Œé¢ï¼Œç”¨äºæ¥æ”¶ç”¨æˆ·è¾“å…¥çš„æ•°æ®å’Œæ˜¾ç¤ºå¤„ç†åçš„æ•°æ®</li>
<li><strong>ä¸šåŠ¡é€»è¾‘å±‚ (BLL, Business Logic Layer)</strong> â€”â€” PLä¸DALä¹‹é—´çš„æ¡¥æ¢ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ï¼Œä¸»è¦åŒ…æ‹¬éªŒè¯ã€è®¡ç®—ã€è§„åˆ™ç­‰</li>
<li><strong>æ•°æ®è®¿é—®å±‚ (DAL, Data Access Layer)</strong> â€”â€” ä¸æ•°æ®åº“äº¤äº’ï¼Œå®ç°å¯¹æ•°æ®çš„CURDï¼Œå°†å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®æäº¤ç»™ä¸šåŠ¡å±‚ï¼ŒåŒæ—¶å°†ä¸šåŠ¡å±‚å¤„ç†çš„æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“</li>
</ul>
<h1 id="MVCæ¨¡å¼-Model-View-Controller"><a href="#MVCæ¨¡å¼-Model-View-Controller" class="headerlink" title="MVCæ¨¡å¼ (Model-View-Controller)"></a>MVCæ¨¡å¼ (Model-View-Controller)</h1><img src="/images/2020/20200224201239437.png" width=300>

<p>æè¿°1:</p>
<ul>
<li><strong>æ¨¡å‹ (Model)</strong> â€”â€” ç¨‹åºéœ€è¦æ“ä½œçš„æ•°æ®æˆ–ä¿¡æ¯</li>
<li><strong>è§†å›¾ (View)</strong> â€”â€” æä¾›ç»™ç”¨æˆ·çš„æ“ä½œç•Œé¢ï¼Œæ˜¯ç¨‹åºçš„å¤–å£³</li>
<li><strong>æ§åˆ¶å™¨ (Controller)</strong> â€”â€” è´Ÿè´£æ ¹æ®ç”¨æˆ·ä»â€è§†å›¾å±‚â€è¾“å…¥çš„æŒ‡ä»¤ï¼Œé€‰å–â€æ•°æ®å±‚â€ä¸­çš„æ•°æ®ï¼Œç„¶åå¯¹å…¶è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œäº§ç”Ÿæœ€ç»ˆç»“æœ</li>
</ul>
<p>æè¿°2:</p>
<ul>
<li><strong>æ¨¡å‹ (Model)</strong> â€”â€” è¡¨ç¤ºåº”ç”¨ç¨‹åºå’Œä»»ä½•åº”ç”±å…¶æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘æˆ–æ“ä½œçš„çŠ¶æ€</li>
<li><strong>è§†å›¾ (View)</strong> â€”â€” è´Ÿè´£é€šè¿‡ç”¨æˆ·ç•Œé¢å±•ç¤ºå†…å®¹</li>
<li><strong>æ§åˆ¶å™¨ (Controller)</strong> â€”â€” æ˜¯å¤„ç†ç”¨æˆ·äº¤äº’ã€ä½¿ç”¨æ¨¡å‹å¹¶æœ€ç»ˆé€‰æ‹©è¦å‘ˆç°çš„è§†å›¾çš„ç»„ä»¶</li>
</ul>
<h1 id="ä¸‰å±‚æ¶æ„ä¸MVCçš„åŒºåˆ«ä¸è”ç³»"><a href="#ä¸‰å±‚æ¶æ„ä¸MVCçš„åŒºåˆ«ä¸è”ç³»" class="headerlink" title="ä¸‰å±‚æ¶æ„ä¸MVCçš„åŒºåˆ«ä¸è”ç³»"></a>ä¸‰å±‚æ¶æ„ä¸MVCçš„åŒºåˆ«ä¸è”ç³»</h1><h4 id="1-å…³æ³¨ç‚¹"><a href="#1-å…³æ³¨ç‚¹" class="headerlink" title="1. å…³æ³¨ç‚¹"></a>1. å…³æ³¨ç‚¹</h4><ul>
<li>ä¸‰å±‚æ¶æ„æ˜¯ä¸ºäº†è§£å†³æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å„ä¸ªä¸šåŠ¡æ“ä½œè¿‡ç¨‹ä¸­çš„==ä¸åŒé˜¶æ®µçš„ä»£ç å°è£…==é—®é¢˜ï¼Œä½¿ç¨‹åºå‘˜æ›´åŠ ä¸“æ³¨çš„å¤„ç†æŸé˜¶æ®µçš„ä¸šåŠ¡é€»è¾‘</li>
<li>MVCæ¶æ„æ¨¡å¼å°†åº”ç”¨ç¨‹åºåˆ†ä¸ºä¸‰ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†ï¼Œæœ‰åŠ©äºå®ç°å…³æ³¨ç‚¹åˆ†ç¦»ã€‚åˆ†ç¦»å…³æ³¨ç‚¹æ˜¯å¼€å‘æ—¶çš„æŒ‡å¯¼åŸåˆ™ï¼Œæ­¤åŸåˆ™ä¸»å¼ åº”æ ¹æ®==è½¯ä»¶æ‰§è¡Œçš„å·¥ä½œç±»å‹==å°†è½¯ä»¶åˆ†ç¦»<h4 id="2-åˆ‡åˆ†æ–¹å‘"><a href="#2-åˆ‡åˆ†æ–¹å‘" class="headerlink" title="2. åˆ‡åˆ†æ–¹å‘"></a>2. åˆ‡åˆ†æ–¹å‘</h4></li>
<li>ä¸‰å±‚æ¶æ„æ˜¯ä¸€ç§è½¯ä»¶æŠ½è±¡çš„å±‚æ¬¡ç»“æ„ï¼Œæ˜¯å¯¹å¤æ‚ç³»ç»Ÿçš„ä¸€ç§<strong>çºµå‘åˆ‡åˆ†</strong></li>
<li>MVCæ›´åƒæ˜¯<strong>æ¨ªå‘åˆ‡åˆ†</strong>ï¼Œæ¯å—éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•<h4 id="3-ä¾èµ–å…³ç³»"><a href="#3-ä¾èµ–å…³ç³»" class="headerlink" title="3. ä¾èµ–å…³ç³»"></a>3. ä¾èµ–å…³ç³»</h4></li>
<li>ä¸‰å±‚æ¶æ„ä¸­ï¼Œå±‚æ¬¡ä¹‹é—´ä¸€èˆ¬æ˜¯<strong>å‘ä¸‹ä¾èµ–</strong>çš„ã€‚ä¸‹å±‚åœ¨æœªç¡®å®šæ¥å£ï¼ˆå¥‘çº¦ï¼‰è§„èŒƒå‰ï¼Œä¸Šå±‚ä»£ç æ— æ³•å¼€å‘ï¼Œä¸‹å±‚ä»£ç æ¥å£çš„å˜åŒ–å°†ä½¿ä¸Šå±‚ä¸€èµ·å˜åŒ–</li>
<li>MVCä¸­ï¼Œä¸‰è€…å¹¶<strong>ä¸å­˜åœ¨æ˜æ˜¾çš„å±‚æ¬¡ç»“æ„</strong>ï¼Œæ²¡æœ‰æ˜æ˜¾çš„å‘ä¸‹ä¾èµ–çš„å…³ç³»ã€‚ç›¸åçš„æ˜¯Viewå’ŒModelå¾€å¾€æ˜¯æ¯”è¾ƒç‹¬ç«‹çš„ï¼Œè€ŒControlleråˆ™æ˜¯ä¸¤è€…çš„æ¡¥æ¢</li>
</ul>
<p><strong>éƒ½æ˜¯ä¸ºäº†è§£è€¦</strong></p>
<hr>
<h1 id="MVCã€MVPã€MVVM"><a href="#MVCã€MVPã€MVVM" class="headerlink" title="MVCã€MVPã€MVVM"></a>MVCã€MVPã€MVVM</h1><blockquote>
<p><a href="http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html" target="_blank" rel="noopener">MVCï¼ŒMVP å’Œ MVVM çš„å›¾ç¤º</a></p>
</blockquote>
<hr>
<h1 id="é˜¿é‡Œè§„èŒƒ"><a href="#é˜¿é‡Œè§„èŒƒ" class="headerlink" title="é˜¿é‡Œè§„èŒƒ"></a>é˜¿é‡Œè§„èŒƒ</h1><blockquote>
<p>ã€ŠJavaå¼€å‘æ‰‹å†Œã€‹v1.5.0 åå±±ç‰ˆ</p>
</blockquote>
<p>å›¾ä¸­é»˜è®¤ä¸Šå±‚ä¾èµ–äºä¸‹å±‚ï¼Œç®­å¤´å…³ç³»è¡¨ç¤ºå¯ç›´æ¥ä¾èµ–ï¼Œå¦‚:å¼€æ”¾æ¥å£å±‚å¯ä»¥ä¾èµ–äº Web å±‚ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¾èµ–äº Service å±‚ï¼Œä¾æ­¤ç±»æ¨:<br><img src="/images/2020/20200224193901683.png" width=400></p>
<ul>
<li><strong>å¼€æ”¾æ¥å£å±‚</strong> : å¯ç›´æ¥å°è£… Service æ–¹æ³•æš´éœ²æˆ RPC æ¥å£;é€šè¿‡ Web å°è£…æˆ http æ¥å£;è¿›è¡Œç½‘å…³å®‰å…¨æ§åˆ¶ã€æµé‡æ§åˆ¶ç­‰ã€‚</li>
<li><strong>ç»ˆç«¯æ˜¾ç¤ºå±‚</strong> : å„ä¸ªç«¯çš„æ¨¡æ¿æ¸²æŸ“å¹¶æ‰§è¡Œæ˜¾ç¤ºçš„å±‚ã€‚å½“å‰ä¸»è¦æ˜¯ velocity æ¸²æŸ“ï¼ŒJS æ¸²æŸ“ï¼ŒJSP æ¸²æŸ“ï¼Œç§»åŠ¨ç«¯å±•ç¤ºç­‰ã€‚</li>
<li><strong>Webå±‚</strong> : ä¸»è¦æ˜¯å¯¹è®¿é—®æ§åˆ¶è¿›è¡Œè½¬å‘ï¼Œå„ç±»åŸºæœ¬å‚æ•°æ ¡éªŒï¼Œæˆ–è€…ä¸å¤ç”¨çš„ä¸šåŠ¡ç®€å•å¤„ç†ç­‰ã€‚</li>
<li><strong>Serviceå±‚</strong> : ç›¸å¯¹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚ã€‚</li>
<li><strong>Managerå±‚</strong> : é€šç”¨ä¸šåŠ¡å¤„ç†å±‚ï¼Œå®ƒæœ‰å¦‚ä¸‹ç‰¹å¾:</li>
</ul>
<ol>
<li>å¯¹ç¬¬ä¸‰æ–¹å¹³å°å°è£…çš„å±‚ï¼Œé¢„å¤„ç†è¿”å›ç»“æœåŠè½¬åŒ–å¼‚å¸¸ä¿¡æ¯ã€‚</li>
<li>å¯¹ Service å±‚é€šç”¨èƒ½åŠ›çš„ä¸‹æ²‰ï¼Œå¦‚ç¼“å­˜æ–¹æ¡ˆã€ä¸­é—´ä»¶é€šç”¨å¤„ç†ã€‚</li>
<li>ä¸ DAO å±‚äº¤äº’ï¼Œå¯¹å¤šä¸ª DAO çš„ç»„åˆå¤ç”¨ã€‚</li>
</ol>
<ul>
<li><strong>DAOå±‚</strong> : æ•°æ®è®¿é—®å±‚ï¼Œä¸åº•å±‚ MySQLã€Oracleã€Hbase ç­‰è¿›è¡Œæ•°æ®äº¤äº’ã€‚</li>
<li><strong>å¤–éƒ¨æ¥å£æˆ–ç¬¬ä¸‰æ–¹å¹³å°</strong> : åŒ…æ‹¬å…¶å®ƒéƒ¨é—¨ RPC å¼€æ”¾æ¥å£ï¼ŒåŸºç¡€å¹³å°ï¼Œå…¶å®ƒå…¬å¸çš„ HTTP æ¥å£ã€‚</li>
</ul>
<blockquote>
<p>ref:<br><a href="http://www.ruanyifeng.com/blog/2007/11/mvc.html" target="_blank" rel="noopener">è°ˆè°ˆMVCæ¨¡å¼</a><br><a href="https://www.jianshu.com/p/3b231e5094c5" target="_blank" rel="noopener">ASP.NET MVCä¸ä¸‰å±‚æ¶æ„</a><br><a href="https://docs.microsoft.com/zh-cn/aspnet/core/mvc/overview?view=aspnetcore-3.1" target="_blank" rel="noopener">ASP.NET Core MVC æ¦‚è¿°</a><br><a href="https://docs.microsoft.com/zh-cn/dotnet/architecture/modern-web-apps-azure/architectural-principles#separation-of-concerns" target="_blank" rel="noopener">ä½“ç³»ç»“æ„åŸåˆ™</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°03 å·¥å‚æ¨¡å¼</title>
    <url>/2020/02/24/note-spring-03/</url>
    <content><![CDATA[<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a><br>p9~14</p>
<hr>
<h1 id="ç¨‹åºçš„è€¦åˆä¸è§£è€¦-ä»¥jdbcæ³¨å†Œé©±åŠ¨ä¸ºä¾‹"><a href="#ç¨‹åºçš„è€¦åˆä¸è§£è€¦-ä»¥jdbcæ³¨å†Œé©±åŠ¨ä¸ºä¾‹" class="headerlink" title="ç¨‹åºçš„è€¦åˆä¸è§£è€¦ (ä»¥jdbcæ³¨å†Œé©±åŠ¨ä¸ºä¾‹)"></a>ç¨‹åºçš„è€¦åˆä¸è§£è€¦ (ä»¥jdbcæ³¨å†Œé©±åŠ¨ä¸ºä¾‹)</h1><p>jdbcæ“ä½œä¸­ï¼Œæ³¨å†Œæ•°æ®åº“é©±åŠ¨æ—¶ï¼Œæœ‰2ç§æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•1</span></span><br><span class="line">DriverManager.registerDriver(<span class="keyword">new</span> com.mysql.jdbc.Driver());</span><br><span class="line"><span class="comment">// æ–¹æ³•2</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br></pre></td></tr></table></figure>
<p>åœ¨pom.xmlä¸­æ·»åŠ äº†ä¾èµ–çš„æƒ…å†µä¸‹éƒ½å¯ä»¥æ­£å¸¸è¿è¡Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¦‚æœå»æ‰è¿™æ®µä¾èµ–</p>
<p>æ–¹æ³•1æŠ¥Errorï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Error:(26, 56) java: ç¨‹åºåŒ…com.mysql.jdbcä¸å­˜åœ¨</span><br></pre></td></tr></table></figure>
<p>è€Œæ–¹æ³•2æŠ¥Exceptionï¼Œå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼ˆæ— æ³•è¿è¡Œï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.ClassNotFoundException: com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæ–¹æ³•1ä¾èµ–ä¸€ä¸ªå…·ä½“çš„é©±åŠ¨ç±»ï¼Œè€Œæ–¹æ³•2ç”¨åå°„ï¼Œä¾èµ–çš„åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²<br>ä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²ä»æ˜¯å†™æ­»åœ¨ä»£ç é‡Œçš„ã€‚åº”è¯¥å†™åˆ°é…ç½®æ–‡ä»¶é‡Œå»ï¼Œè¿›ä¸€æ­¥å‡å°‘è€¦åˆ</p>
<p>å®é™…å¼€å‘ä¸­åº”è¯¥åšåˆ°ï¼š</p>
<p><strong>ç¼–è¯‘æœŸä¸ä¾èµ–ï¼Œè¿è¡Œæ—¶æ‰ä¾èµ–</strong></p>
<p>è§£è€¦çš„æ€è·¯ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨åå°„æ¥åˆ›å»ºå¯¹è±¡ï¼Œè€Œé¿å…ä½¿ç”¨newå…³é”®å­—</strong></p>
<p><strong>ç¬¬äºŒæ­¥ï¼šé€šè¿‡è¯»å–é…ç½®æ–‡ä»¶æ¥è·å–è¦åˆ›å»ºçš„å¯¹è±¡å…¨é™å®šç±»å</strong></p>
<hr>
<h1 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h1><h2 id="åŸå§‹çš„åˆ†å±‚å®ç°æ–¹æ³•"><a href="#åŸå§‹çš„åˆ†å±‚å®ç°æ–¹æ³•" class="headerlink" title="åŸå§‹çš„åˆ†å±‚å®ç°æ–¹æ³•"></a>åŸå§‹çš„åˆ†å±‚å®ç°æ–¹æ³•</h2><img src="/images/2020/202002271544168.png" width=400>

<ul>
<li>Client : æ¨¡æ‹Ÿä¸€ä¸ªè¡¨ç°å±‚ï¼Œç”¨äºè°ƒç”¨ä¸šåŠ¡å±‚</li>
<li>IAccountService : è´¦æˆ·ä¸šåŠ¡å±‚çš„æ¥å£</li>
<li>AccountServiceImpl : è´¦æˆ·çš„ä¸šåŠ¡å±‚å®ç°ç±»</li>
<li>IAccountDao : è´¦æˆ·çš„æŒä¹…å±‚æ¥å£</li>
<li>AccountDaoImpl : è´¦æˆ·çš„æŒä¹…å±‚å®ç°ç±»</li>
</ul>
<p>å…¶ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¾èµ–å…³ç³»</p>
<ol>
<li>è¡¨ç°å±‚è°ƒç”¨ä¸šåŠ¡å±‚æ—¶<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        IAccountService as = <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line">        as.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>ä¸šåŠ¡å±‚è°ƒç”¨æŒä¹…å±‚æ—¶<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">new</span> AccountDaoImpl();</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">saveAccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
éƒ½ç”¨åˆ°äº†newï¼Œè€¦åˆåº¦é«˜<br>å¦‚æœæ­¤æ—¶æŠŠAccountDaoImplçš„ä»£ç åˆ äº†ï¼ŒServiceå°±æŠ¥é”™äº†ã€‚å’Œå‰é¢jdbcä¸­ç¼–è¯‘æœŸçš„é”™è¯¯ä¸€æ ·</li>
</ol>
<p>å¦‚ä½•è§£é™¤è¿™ç§ä¾èµ–ï¼Ÿ</p>
<h2 id="Bean-amp-BeanFactory"><a href="#Bean-amp-BeanFactory" class="headerlink" title="Bean &amp; BeanFactory"></a>Bean &amp; BeanFactory</h2><p><strong>Bean</strong> â€”â€” å¯é‡ç”¨ç»„ä»¶<br>egï¼šä¸€ä¸ªDaoå¯èƒ½è¢«å¤šä¸ªServiceä½¿ç”¨ï¼Œä¸€ä¸ªServiceå¯èƒ½è¢«å¤šä¸ªServletä½¿ç”¨ï¼Œå®ƒä»¬æ˜¯å¯é‡ç”¨çš„</p>
<p><strong>JavaBean</strong> â€”â€” ç”¨javaè¯­è¨€ç¼–å†™çš„å¯é‡ç”¨ç»„ä»¶</p>
<p><strong>BeanFactory</strong> â€”â€” åˆ›å»ºBeanå¯¹è±¡çš„å·¥å‚<br>egï¼šåˆ›å»ºDaoå’ŒServiceå¯¹è±¡</p>
<p>è¦å®ç°è¿™ä¸ªå·¥å‚ï¼Œç±»ä¼¼å‰é¢jdbcï¼Œ</p>
<p>1.éœ€è¦ä¸€ä¸ª<strong>é…ç½®æ–‡ä»¶</strong>æ¥é…ç½®serviceå’Œdao<br>å†…å®¹ï¼šå”¯ä¸€æ ‡è¯†=å…¨é™å®šç±»åï¼ˆkey=value)<br>é…ç½®æ–‡ä»¶å¯ä»¥æ˜¯xmlä¹Ÿå¯ä»¥æ˜¯properties</p>
<p>2.è¯»å–é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„å†…å®¹ï¼Œé€šè¿‡==åå°„==åˆ›å»ºå¯¹è±¡</p>
<h2 id="å·¥å‚æ¨¡å¼è§£è€¦"><a href="#å·¥å‚æ¨¡å¼è§£è€¦" class="headerlink" title="å·¥å‚æ¨¡å¼è§£è€¦"></a>å·¥å‚æ¨¡å¼è§£è€¦</h2><p>åœ¨resourcesä¸­æ–°å»ºbeans.propertiesé…ç½®æ–‡ä»¶ï¼ˆæ­¤å¤„ç”¨propertieså› ä¸ºç®€å•ï¼ŒSpringä¸­ç”¨çš„æ˜¯xmlï¼‰</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">accountService</span> = <span class="string">com.itheima.service.impl.AccountServiceImpl</span></span><br><span class="line"><span class="attr">accountDao</span> = <span class="string">com.itheima.dao.impl.AccountDaoImpl</span></span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºBeanFactoryç±»è¯»å–propertiesæ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªPropertieså¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Properties props;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨é™æ€ä»£ç å—ä¸ºPropertieså¯¹è±¡èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">            props = <span class="keyword">new</span> Properties();</span><br><span class="line">            <span class="comment">// è·å–propertiesæ–‡ä»¶çš„æµå¯¹è±¡</span></span><br><span class="line">            InputStream in = BeanFactory.class.getClassLoader().getResourceAsStream("bean.properties");</span><br><span class="line">            props.load(in);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// æŠ›ä¸€ä¸ªErrorï¼Œæ²¡æœ‰è·å–é…ç½®ä¿¡æ¯åé¢æƒ³éƒ½ä¸è¦æƒ³</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(<span class="string">"åˆå§‹åŒ–propertieså¤±è´¥ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ ¹æ®Beançš„åç§°è·å–beanå¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span></span>&#123;</span><br><span class="line">        Object bean = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String beanPath = props.getProperty(beanName);</span><br><span class="line">            bean = Class.forName(beanPath).newInstance();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<ol>
<li>è¯»é…ç½®æ–‡ä»¶æ—¶ä¸è¦ç”¨FileInputStreamï¼ŒWebå·¥ç¨‹ä¸å¥½æ‰¾è·¯å¾„ã€‚ç”¨ç±»åŠ è½½å™¨ã€‚</li>
<li>getBean()è¿”å›çš„æ˜¯Objectç±»å‹</li>
</ol>
<p>æŠŠä¸¤å¤„ä½¿ç”¨newåˆ›å»ºå¯¹è±¡çš„æ”¹ä¸ºç”¨åå°„åˆ›å»º</p>
<p>Clientä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// IAccountService as = new AccountServiceImpl();</span></span><br><span class="line">IAccountService as = (IAccountService) BeanFactory.getBean(<span class="string">"accountService"</span>);</span><br></pre></td></tr></table></figure>
<p>AccountServiceImplä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// private IAccountDao accountDao = new AccountDaoImpl();</span></span><br><span class="line"><span class="keyword">private</span> IAccountDao accountDao = (IAccountDao) BeanFactory.getBean(<span class="string">"accountDao"</span>);</span><br></pre></td></tr></table></figure>
<p>Objectç±»å¼ºè½¬ä¸ºå¯¹åº”çš„ç±»</p>
<p>æ”¹è¿›åç¨‹åºçš„UMLç±»å›¾é•¿è¿™æ ·</p>
<img src="/images/2020/20200227162837205.png" width=600>

<p>æ­¤æ—¶å¦‚æœæŠŠAccountServiceImplåˆ äº†ï¼Œç¨‹åºå¯ä»¥è¿è¡Œï¼ŒæŠ›ClassNotFoundException</p>
<h2 id="å·¥å‚æ¨¡å¼çš„é—®é¢˜ä¸æ”¹è¿›"><a href="#å·¥å‚æ¨¡å¼çš„é—®é¢˜ä¸æ”¹è¿›" class="headerlink" title="å·¥å‚æ¨¡å¼çš„é—®é¢˜ä¸æ”¹è¿›"></a>å·¥å‚æ¨¡å¼çš„é—®é¢˜ä¸æ”¹è¿›</h2><p>å¦‚æœè¦åœ¨Clientä¸­å¤šæ¬¡è°ƒç”¨Serviceï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++) &#123;</span><br><span class="line">	IAccountService as = (IAccountService) BeanFactory.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">	System.out.println(as);</span><br><span class="line">	as.saveAccount();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¹¶åœ¨AccountServiceImplä¸­åŠ ä¸€ä¸ªæˆå‘˜å˜é‡i</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao = (IAccountDao) BeanFactory.getBean(<span class="string">"accountDao"</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">saveAccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">        System.out.println(i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œ</p>
<blockquote>
<p>com.itheima.service.impl.AccountServiceImpl@610455d6<br>ä¿å­˜äº†è´¦æˆ·<br>1<br>com.itheima.service.impl.AccountServiceImpl@511d50c0<br>ä¿å­˜äº†è´¦æˆ·<br>1<br>com.itheima.service.impl.AccountServiceImpl@60e53b93<br>ä¿å­˜äº†è´¦æˆ·<br>1<br>com.itheima.service.impl.AccountServiceImpl@5e2de80c<br>ä¿å­˜äº†è´¦æˆ·<br>1<br>com.itheima.service.impl.AccountServiceImpl@1d44bcfa<br>ä¿å­˜äº†è´¦æˆ·<br>1</p>
<p>Process finished with exit code 0</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒAccountServiceImplåˆ›å»ºäº†5æ¬¡ï¼Œæ¯æ¬¡éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡<br>æ­¤æ—¶çš„å¯¹è±¡æ˜¯å¤šä¾‹ï¼Œæ•ˆç‡æ²¡æœ‰å•ä¾‹é«˜</p>
<p>å¯ä»¥åœ¨BeanFactoryä¸­æŠŠåˆ›å»ºå‡ºçš„å¯¹è±¡éƒ½å­˜èµ·æ¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªMap,ç”¨äºå­˜æ”¾æˆ‘ä»¬è¦åˆ›å»ºçš„å¯¹è±¡ã€‚æˆ‘ä»¬æŠŠå®ƒç§°ä¹‹ä¸ºå®¹å™¨</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Object&gt; beans;</span><br></pre></td></tr></table></figure>
<p>åœ¨é™æ€ä»£ç å—ä¸­ï¼Œå¾—åˆ°é…ç½®æ–‡ä»¶çš„è¾“å…¥æµåï¼Œå®ä¾‹åŒ–è¿™ä¸ªå®¹å™¨ã€‚å–å‡ºé…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„key-valueï¼Œåˆ›å»ºå¹¶ä¿å­˜å®ƒä»¬</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹åŒ–å®¹å™¨</span></span><br><span class="line">beans = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</span><br><span class="line"><span class="comment">// å–å‡ºé…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„Key</span></span><br><span class="line">Enumeration keys = props.keys();</span><br><span class="line"><span class="comment">// éå†æšä¸¾</span></span><br><span class="line"><span class="keyword">while</span> (keys.hasMoreElements())&#123;</span><br><span class="line">    <span class="comment">// å–å‡ºæ¯ä¸ªKey</span></span><br><span class="line">    String key = keys.nextElement().toString();</span><br><span class="line">    <span class="comment">// æ ¹æ®keyè·å–value</span></span><br><span class="line">    String beanPath = props.getProperty(key);</span><br><span class="line">    <span class="comment">// åå°„åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">    Object value = Class.forName(beanPath).newInstance();</span><br><span class="line">    <span class="comment">// æŠŠkeyå’Œvalueå­˜å…¥å®¹å™¨ä¸­</span></span><br><span class="line">    beans.put(key,value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è·å–Beansï¼Œä¸ç”¨newInstance()ï¼Œç›´æ¥ä»å®¹å™¨ä¸­å–å³å¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> beans.get(beanName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¿®æ”¹åï¼Œè°ƒç”¨5æ¬¡Serviceæ‰“å°çš„ç»“æœæ˜¯</p>
<blockquote>
<p>com.itheima.service.impl.AccountServiceImpl@610455d6<br>ä¿å­˜äº†è´¦æˆ·<br>1<br>com.itheima.service.impl.AccountServiceImpl@610455d6<br>ä¿å­˜äº†è´¦æˆ·<br>2<br>com.itheima.service.impl.AccountServiceImpl@610455d6<br>ä¿å­˜äº†è´¦æˆ·<br>3<br>com.itheima.service.impl.AccountServiceImpl@610455d6<br>ä¿å­˜äº†è´¦æˆ·<br>4<br>com.itheima.service.impl.AccountServiceImpl@610455d6<br>ä¿å­˜äº†è´¦æˆ·<br>5</p>
<p>Process finished with exit code 0</p>
</blockquote>
<p>æ­¤æ—¶çš„AccountServiceImplå°±æ˜¯å•ä¾‹çš„äº†</p>
<p>ä½†æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè¿™ä¸ªiåœ¨å¤šçº¿ç¨‹æ—¶æ˜¯ä¸å®‰å…¨çš„<br>åº”è¯¥æŠŠå®ƒç§»åˆ°æ–¹æ³•é‡Œé¢ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ï¼ˆå®é™…ä½¿ç”¨ä¸€èˆ¬ä¹Ÿæ˜¯è¿™æ ·ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//    private int i = 1;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">saveAccount</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">        System.out.println(i);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="å·¥å‚æ¨¡å¼ä½¿ç”¨å¥—è·¯æ€»ç»“"><a href="#å·¥å‚æ¨¡å¼ä½¿ç”¨å¥—è·¯æ€»ç»“" class="headerlink" title="å·¥å‚æ¨¡å¼ä½¿ç”¨å¥—è·¯æ€»ç»“"></a>å·¥å‚æ¨¡å¼ä½¿ç”¨å¥—è·¯æ€»ç»“</h2><p>1.åˆ›å»ºBeanFactory</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// BeanFactory.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªPropertieså¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Properties props;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªMap,ç”¨äºå­˜æ”¾æˆ‘ä»¬è¦åˆ›å»ºçš„å¯¹è±¡ã€‚ç§°ä¹‹ä¸ºå®¹å™¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Object&gt; beans;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä½¿ç”¨é™æ€ä»£ç å—ä¸ºPropertieså¯¹è±¡èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">            props = <span class="keyword">new</span> Properties();</span><br><span class="line">            <span class="comment">// 2.è·å–propertiesæ–‡ä»¶çš„æµå¯¹è±¡</span></span><br><span class="line">            InputStream in = BeanFactory.class.getClassLoader().getResourceAsStream("bean.properties");</span><br><span class="line">            props.load(in);</span><br><span class="line">            <span class="comment">// 3.å®ä¾‹åŒ–å®¹å™¨</span></span><br><span class="line">            beans = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</span><br><span class="line">            <span class="comment">// 4.å–å‡ºé…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„Key</span></span><br><span class="line">            Enumeration keys = props.keys();</span><br><span class="line">            <span class="comment">// 5.éå†æšä¸¾</span></span><br><span class="line">            <span class="keyword">while</span> (keys.hasMoreElements())&#123;</span><br><span class="line">                <span class="comment">// å–å‡ºæ¯ä¸ªKey</span></span><br><span class="line">                String key = keys.nextElement().toString();</span><br><span class="line">                <span class="comment">// æ ¹æ®keyè·å–value</span></span><br><span class="line">                String beanPath = props.getProperty(key);</span><br><span class="line">                <span class="comment">// åå°„åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">                Object value = Class.forName(beanPath).newInstance();</span><br><span class="line">                <span class="comment">// æŠŠkeyå’Œvalueå­˜å…¥å®¹å™¨ä¸­</span></span><br><span class="line">                beans.put(key,value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(<span class="string">"åˆå§‹åŒ–propertieså¤±è´¥ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®beançš„åç§°è·å–å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beans.get(beanName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.é…ç½®æ–‡ä»¶</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">//</span> <span class="string">beans.properties</span></span><br><span class="line"></span><br><span class="line"><span class="attr">accountService</span>=<span class="string">com.itheima.service.impl.AccountServiceImpl</span></span><br><span class="line"><span class="attr">accountDao</span>=<span class="string">com.itheima.dao.impl.AccountDaoImpl</span></span><br></pre></td></tr></table></figure>

<p>3.è·å–Bean</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Client.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    	IAccountService as = (IAccountService) BeanFactory.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">    	as.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°02 Ideaè¿è¡Œç¤ºä¾‹é¡¹ç›®çš„å‘</title>
    <url>/2020/02/24/note-spring-02/</url>
    <content><![CDATA[<p>è¡¨å»ºå¥½ä¹‹åï¼ŒIdeaé‡Œé¢ç›´æ¥æ‰“å¼€ç¤ºä¾‹å·¥ç¨‹è·‘ä¸èµ·æ¥ï¼Œmysqlçš„ä¾èµ–æœ‰é—®é¢˜</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.ClassNotFoundException: com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>
<p>å¯¹æ¯”å‘ç°Mavenè·¯å¾„ä¸å¯¹</p>
<p>è¿™æ˜¯è‡ªå·±åˆ›å»ºçš„å¯ä»¥è¿è¡Œçš„Mavené¡¹ç›®é…ç½®<br><img src="/images/2020/20200224170149695.png" alt="img"></p>
<p>è¿™æ˜¯å¯¼å…¥å·¥ç¨‹çš„é…ç½®<br><img src="/images/2020/20200224170322871.png" alt="img"></p>
<p>ä¿®æ”¹è·¯å¾„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;Cellar&#x2F;maven&#x2F;3.6.2&#x2F;libexec</span><br><span class="line">&#x2F;Users&#x2F;coconutnut&#x2F;.m2&#x2F;settings.xml</span><br><span class="line">&#x2F;Users&#x2F;coconutnut&#x2F;.m2&#x2F;repository</span><br></pre></td></tr></table></figure>
<p>è§£å†³Driveré—®é¢˜</p>
<hr>
<p>ä¸‹ä¸€ä¸ªbug<br>Ideaä¸­ç‚¹è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MySQLNonTransientConnectionException: Client does not support authentication protocol requested by server</span><br></pre></td></tr></table></figure>
<blockquote>
<p><a href="https://www.cnblogs.com/inconceivable/p/9186822.html" target="_blank" rel="noopener">https://www.cnblogs.com/inconceivable/p/9186822.html</a></p>
</blockquote>
<p>åœ¨MySQL Workbenchä¸­è¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line">ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;iamgroot&#39;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>
<p>Ideaä¸­æç¤ºå˜æˆäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.sql.SQLException: Unknown initial character set index &#39;255&#39; received from server. Initial client character set can be forced via the &#39;characterEncoding&#39; property.</span><br><span class="line">	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><a href="https://blog.csdn.net/qq1515312832/article/details/85614733" target="_blank" rel="noopener">https://blog.csdn.net/qq1515312832/article/details/85614733</a></p>
</blockquote>
<p>åœ¨è¿æ¥æ•°æ®åº“çš„urlååŠ ä¸Šç¼–ç æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Connection conn = DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/groot?useUnicode=true&amp;characterEncoding=utf8"</span>,<span class="string">"root"</span>,<span class="string">"iamgroot"</span>);</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸ</p>
<hr>
<p>æ€»ç»“ï¼š</p>
<ol>
<li>ä¿®æ”¹Preference-&gt;Build, Execution, Deployment-&gt;Build Tools-&gt;Mavenä¸­è·¯å¾„</li>
<li>åœ¨è¿æ¥æ•°æ®åº“çš„urlååŠ ä¸Šç¼–ç æ–¹å¼</li>
</ol>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springç¬”è®°01 jdbcå¸¸ç”¨æ“ä½œ</title>
    <url>/2020/02/24/note-spring-01/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av47952931" target="_blank" rel="noopener">https://www.bilibili.com/video/av47952931</a></p>
</blockquote>
<p>ä¹‹å‰å­¦æ•°æ®åº“çš„æ—¶å€™mysqlè¸©äº†å¥½å¤šå‘ï¼Œä¸»è¦æ˜¯ç‰ˆæœ¬é—®é¢˜<br>ä¸åŒç‰ˆæœ¬è¯­æ³•æœ‰äº›ä¸å…¼å®¹<br>è®°å½•ä¸€ä¸‹Applyç”Ÿæˆçš„è¯­å¥å¤‡ç”¨</p>
<hr>
<p>ç‰ˆæœ¬:<br>mysql-8.0.19-macos10.15-x86_64<br>MySQL Workbench 8.0.16</p>
<hr>
<h1 id="MySQL-Workbenchæ“ä½œ"><a href="#MySQL-Workbenchæ“ä½œ" class="headerlink" title="MySQL Workbenchæ“ä½œ"></a>MySQL Workbenchæ“ä½œ</h1><h2 id="åˆ›å»ºschema"><a href="#åˆ›å»ºschema" class="headerlink" title="åˆ›å»ºschema"></a>åˆ›å»ºschema</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SCHEMA</span> <span class="string">`groot`</span> ;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="åˆ›å»ºtable"><a href="#åˆ›å»ºtable" class="headerlink" title="åˆ›å»ºtable"></a>åˆ›å»ºtable</h2><p>è¿™æ˜¯bç«™æ•™ç¨‹ç»™çš„sql</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">account</span>(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">40</span>),</span><br><span class="line">	money <span class="built_in">float</span></span><br><span class="line">)<span class="built_in">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯Workbenché‡Œç”Ÿæˆçš„sql</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`groot`</span>.<span class="string">`account`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">45</span>) <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`money`</span> <span class="built_in">FLOAT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>));</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="æ’å…¥è®°å½•"><a href="#æ’å…¥è®°å½•" class="headerlink" title="æ’å…¥è®°å½•"></a>æ’å…¥è®°å½•</h2><p>bç«™æ•™ç¨‹ç»™çš„sql</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">account</span>(<span class="keyword">name</span>,money) <span class="keyword">values</span>(<span class="string">'aaa'</span>,<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">account</span>(<span class="keyword">name</span>,money) <span class="keyword">values</span>(<span class="string">'bbb'</span>,<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">account</span>(<span class="keyword">name</span>,money) <span class="keyword">values</span>(<span class="string">'ccc'</span>,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p>Workbenché‡Œç”Ÿæˆçš„sql</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`groot`</span>.<span class="string">`account`</span> (<span class="string">`name`</span>, <span class="string">`money`</span>) <span class="keyword">VALUES</span> (<span class="string">'aaa'</span>, <span class="string">'1000'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`groot`</span>.<span class="string">`account`</span> (<span class="string">`name`</span>, <span class="string">`money`</span>) <span class="keyword">VALUES</span> (<span class="string">'bbb'</span>, <span class="string">'1000'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`groot`</span>.<span class="string">`account`</span> (<span class="string">`name`</span>, <span class="string">`money`</span>) <span class="keyword">VALUES</span> (<span class="string">'ccc'</span>, <span class="string">'1000'</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="æŸ¥çœ‹è®°å½•"><a href="#æŸ¥çœ‹è®°å½•" class="headerlink" title="æŸ¥çœ‹è®°å½•"></a>æŸ¥çœ‹è®°å½•</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> groot.account;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Ideaä¸­è¿æ¥æ•°æ®åº“"><a href="#Ideaä¸­è¿æ¥æ•°æ®åº“" class="headerlink" title="Ideaä¸­è¿æ¥æ•°æ®åº“"></a>Ideaä¸­è¿æ¥æ•°æ®åº“</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.æ³¨å†Œé©±åŠ¨</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.è·å–è¿æ¥</span></span><br><span class="line">Connection conn = DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/groot?useUnicode=true&amp;characterEncoding=utf8"</span>,<span class="string">"root"</span>,<span class="string">"iamgroot"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.è·å–æ“ä½œæ•°æ®åº“çš„é¢„å¤„ç†å¯¹è±¡</span></span><br><span class="line">PreparedStatement pstm = conn.prepareStatement(<span class="string">"select * from account"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.æ‰§è¡ŒSQLï¼Œå¾—åˆ°ç»“æœé›†</span></span><br><span class="line">ResultSet rs = pstm.executeQuery();</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.éå†ç»“æœé›†</span></span><br><span class="line"><span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">    System.out.println(rs.getString(<span class="string">"name"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//6.é‡Šæ”¾èµ„æº</span></span><br><span class="line">rs.close();</span><br><span class="line">pstm.close();</span><br><span class="line">conn.close();</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>IntelliJ IDEA ç¬”è®°</title>
    <url>/2020/02/24/note-idea/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://www.bilibili.com/video/av71609179?from=search&amp;seid=7606544420555480673" target="_blank" rel="noopener">https://www.bilibili.com/video/av71609179?from=search&amp;seid=7606544420555480673</a></p>
</blockquote>
<hr>
<p>ç‰ˆæœ¬<br>ideaIU-2019.3.3 (å­¦ç”ŸLicense)<br>macOS Catalina 10.15.3</p>
<hr>
<h1 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h1><p>é¼ æ ‡æ‚¬æµ®æç¤º<br>Preferences-&gt;Editor-&gt;General-&gt;Show quick documentation on mouse move</p>
<p>è‡ªåŠ¨å¯¼åŒ…<br>Preferences-&gt;Editor-&gt;General-&gt;AutoImport-&gt;Add unambiguous imports on the fly<br>Preferences-&gt;Editor-&gt;General-&gt;AutoImport-&gt;Optimize imports on the fly (for current project)</p>
<p>æ–¹æ³•é—´åˆ†éš”ç¬¦<br>Preferences-&gt;Editor-&gt;General-&gt;Appearance-&gt;Show method separators</p>
<p>å¿½ç•¥å¤§å°å†™æç¤º<br>Preferences-&gt;Editor-&gt;General-&gt;Code Completion-&gt;Match case (ä¸å‹¾é€‰)</p>
<p>æ–‡ä»¶å¤šè¡Œæ˜¾ç¤ºæ <br>Preferences-&gt;Editor-&gt;General-&gt;Editor Tabs-&gt;Show tabs in one row (ä¸å‹¾é€‰)</p>
<p>ä¿®æ”¹æ³¨é‡Šé¢œè‰²<br>Preferences-&gt;Editor-&gt;Color Scheme-&gt;Language Defaults-&gt;Commentsä¸­</p>
<p>é¡¹ç›®å·¥ç¨‹ç¼–ç <br>Preferences-&gt;Editor-&gt;File Encodingsä¸­</p>
<p>è‡ªåŠ¨ç¼–è¯‘<br>Preferences-&gt;Build,Execution,Deployment-&gt;Compiler-&gt;Build project automatically<br>Preferences-&gt;Build,Execution,Deployment-&gt;Compiler-&gt;Compile independent modules in parallel</p>
<hr>
<h1 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h1><h2 id="å¸¸ç”¨å¿«æ·é”®"><a href="#å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="å¸¸ç”¨å¿«æ·é”®"></a>å¸¸ç”¨å¿«æ·é”®</h2><p>è¡¥å…¨æç¤ºï¼š^+/<br>è‡ªåŠ¨ç”Ÿæˆï¼š^+Enter<br>å•è¡Œè¡¥å…¨ï¼šCommand+Shift+Enter<br>æ–¹æ³•å‚æ•°æç¤ºï¼šCommand+P<br>é‡æ–°æ’ç‰ˆï¼šOption+Command+L<br>Surround Withï¼šOption+Command+T<br>å¤åˆ¶è¡Œæˆ–é€‰ä¸­åŒºåŸŸï¼šCommand+D<br>åˆ é™¤è¡Œï¼šCommand+Delete</p>
<h2 id="Live-Templates-amp-Postfix-Completion"><a href="#Live-Templates-amp-Postfix-Completion" class="headerlink" title="Live Templates &amp; Postfix Completion"></a>Live Templates &amp; Postfix Completion</h2><p>æŸ¥è¯¢å®æ—¶ä»£ç æ¨¡ç‰ˆï¼šCommand+J<br>Preferences-&gt;Editor-&gt;LiveTemplateså’ŒPreferences-&gt;Editor-&gt;General-&gt;Postfix Completionä¸­ä¿®æ”¹</p>
<hr>
<h1 id="å¯¹æ™®é€šJavaé¡¹ç›®æ‰“åŒ…"><a href="#å¯¹æ™®é€šJavaé¡¹ç›®æ‰“åŒ…" class="headerlink" title="å¯¹æ™®é€šJavaé¡¹ç›®æ‰“åŒ…"></a>å¯¹æ™®é€šJavaé¡¹ç›®æ‰“åŒ…</h1><p>File-&gt;Project Structure (æˆ–å·¥å…·æ ç›´æ¥æ‰“å¼€)<br>Project Settings-&gt;Artifactsä¸­åŠ å…¥å½“å‰é¡¹ç›®</p>
<p>Build-&gt;Build Artifacts<br>åœ¨å·¥ç¨‹ç›®å½•ä¸­out-&gt;artifactsä¸­åˆ›å»ºjaråŒ…<br>æµ‹è¯•æ—¶ï¼Œè¾“å…¥java -cp åŒ…å+ç±»å</p>
<hr>
<h1 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h1><h2 id="Ideaé…ç½®Maven"><a href="#Ideaé…ç½®Maven" class="headerlink" title="Ideaé…ç½®Maven"></a>Ideaé…ç½®Maven</h2><p>Preferences-&gt;Build,Execution,Deployment-&gt;Build Tools-&gt;Maven<br>Maven home directoryä¸­å¯¼å…¥</p>
<p>Preferences-&gt;Build,Execution,Deployment-&gt;Build Tools-&gt;Maven-&gt;Importing-&gt;Import Maven projects automaticallyå‹¾ä¸Š</p>
<h2 id="åˆ›å»ºMavené¡¹ç›®"><a href="#åˆ›å»ºMavené¡¹ç›®" class="headerlink" title="åˆ›å»ºMavené¡¹ç›®"></a>åˆ›å»ºMavené¡¹ç›®</h2><p>New Project-&gt;Maven-&gt;Create from archetypeå‹¾ä¸Š<br>å¯ä»¥é€‰æ‹©maven-archetype-quickstart<br>è¿è¡Œé»˜è®¤çš„Hello Worldé¡¹ç›®</p>
<h2 id="æ‰“åŒ…Mavené¡¹ç›®"><a href="#æ‰“åŒ…Mavené¡¹ç›®" class="headerlink" title="æ‰“åŒ…Mavené¡¹ç›®"></a>æ‰“åŒ…Mavené¡¹ç›®</h2><p>Ideaçš„Terminalä¸­è¾“å…¥ (æˆ–ç³»ç»ŸTerminalåˆ‡åˆ°å·¥ç¨‹ç›®å½•ä¸‹è¾“å…¥)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure>
<p>æ‰“åŒ…å®Œåœ¨targetç›®å½•ä¸‹<br>è¿è¡Œè¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java -cp target&#x2F;xxx.jar åŒ…å+ç±»å</span><br></pre></td></tr></table></figure>
<h2 id="æ’æŸ¥ä¾èµ–åŒ…å†²çª"><a href="#æ’æŸ¥ä¾èµ–åŒ…å†²çª" class="headerlink" title="æ’æŸ¥ä¾èµ–åŒ…å†²çª"></a>æ’æŸ¥ä¾èµ–åŒ…å†²çª</h2><p>pomæ–‡ä»¶ä¸­ï¼Œå³é”®Diagram-&gt;show Dependencies<br>ç»“æ„å›¾æ˜¾ç¤ºä¾èµ–å…³ç³»<br>çº¢è‰²è™šçº¿æ ‡æ˜é‡å¤<br>æœ‰æ—¶å€™é‡å¤ä¸åˆ æ‰ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œé»˜è®¤ä½¿ç”¨è·¯å¾„çŸ­çš„<br>å¦‚æœæŠ¥é”™ï¼Œæ’é™¤æ‰å³å¯ï¼Œä»£ç ä¸­è‡ªåŠ¨<exclusion>â€¦</exclusion></p>
<hr>
<h1 id="é¡¹ç›®ç›®å½•-amp-æ–‡ä»¶å¤¹ç±»å‹"><a href="#é¡¹ç›®ç›®å½•-amp-æ–‡ä»¶å¤¹ç±»å‹" class="headerlink" title="é¡¹ç›®ç›®å½•&amp;æ–‡ä»¶å¤¹ç±»å‹"></a>é¡¹ç›®ç›®å½•&amp;æ–‡ä»¶å¤¹ç±»å‹</h1><h2 id="å¯¹é¡¹ç›®ç±»å‹æ‰‹åŠ¨æ ‡æ³¨"><a href="#å¯¹é¡¹ç›®ç±»å‹æ‰‹åŠ¨æ ‡æ³¨" class="headerlink" title="å¯¹é¡¹ç›®ç±»å‹æ‰‹åŠ¨æ ‡æ³¨"></a>å¯¹é¡¹ç›®ç±»å‹æ‰‹åŠ¨æ ‡æ³¨</h2><p>åœ¨ç›®å½•ä¸Šå³é”®Mark Directory as-&gt;é€‰æ‹©ç±»å‹</p>
<p>Testï¼šå¯ç¼–è¯‘çš„å•å…ƒæµ‹è¯•ç›®å½•<br>Resourcesï¼šèµ„æºæ–‡ä»¶ç›®å½•<br>Test Resourcesï¼šå•å…ƒæµ‹è¯•èµ„æºæ–‡ä»¶ç›®å½•<br>Excludedï¼šæ’é™¤ç›®å½•ï¼ˆç›¸å½“äºè¢«åºŸå¼ƒæ‰ï¼‰<br>Generated Sourcesï¼šç±»ä¼¼srcï¼ˆåªæœ‰è¿™ç§å¯ä»¥æ–°å»ºjavaç±»å’ŒåŒ…ï¼‰</p>
<hr>
<h1 id="å¤šæ¨¡å—Mavené¡¹ç›®"><a href="#å¤šæ¨¡å—Mavené¡¹ç›®" class="headerlink" title="å¤šæ¨¡å—Mavené¡¹ç›®"></a>å¤šæ¨¡å—Mavené¡¹ç›®</h1><h2 id="æ„å»ºå¤šæ¨¡å—Mavené¡¹ç›®"><a href="#æ„å»ºå¤šæ¨¡å—Mavené¡¹ç›®" class="headerlink" title="æ„å»ºå¤šæ¨¡å—Mavené¡¹ç›®"></a>æ„å»ºå¤šæ¨¡å—Mavené¡¹ç›®</h2><p>æ–°å»ºä¸€ä¸ªMavené¡¹ç›®<br>å†æ–°å»ºModuleï¼Œå®ƒä¹Ÿä¼šæœ‰srcã€mainçš„ç›®å½•ç»“æ„</p>
<h2 id="è®¾ç½®æ¨¡å—é—´ä¾èµ–å…³ç³»"><a href="#è®¾ç½®æ¨¡å—é—´ä¾èµ–å…³ç³»" class="headerlink" title="è®¾ç½®æ¨¡å—é—´ä¾èµ–å…³ç³»"></a>è®¾ç½®æ¨¡å—é—´ä¾èµ–å…³ç³»</h2><p>Project Structure-&gt;Modules-&gt;é€‰ä¸­ä¸€ä¸ªæ¨¡å—-&gt;Dependenciesä¸­æ·»åŠ ï¼Œç„¶åå‹¾é€‰ä¸Š<br>pom.xmlä¸­ä¹Ÿè®¸æ·»åŠ </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xxx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ä¾èµ–åå¯ä»¥ç›´æ¥å¼•ç”¨è¢«ä¾èµ–æ¨¡å—ä¸­çš„ä»£ç </p>
<hr>
<h1 id="Maven-Webé¡¹ç›®"><a href="#Maven-Webé¡¹ç›®" class="headerlink" title="Maven Webé¡¹ç›®"></a>Maven Webé¡¹ç›®</h1><h2 id="åˆ›å»ºMaven-Webé¡¹ç›®"><a href="#åˆ›å»ºMaven-Webé¡¹ç›®" class="headerlink" title="åˆ›å»ºMaven Webé¡¹ç›®"></a>åˆ›å»ºMaven Webé¡¹ç›®</h2><p>New Project-&gt;Maven-&gt;Create from archetype<br>å¯ä»¥é€‰æ‹©maven-archetype-webapp</p>
<h2 id="é…ç½®Tomcat"><a href="#é…ç½®Tomcat" class="headerlink" title="é…ç½®Tomcat"></a>é…ç½®Tomcat</h2><p>å·¥å…·æ ä¸­build(ç»¿è‰²é”¤å­)æ—è¾¹ï¼ŒAdd Configuration<br>æ–°åŠ Tomcat-&gt;Local ï¼ˆéœ€å…ˆä¸‹è½½æ”¾åœ¨æœ¬åœ°ï¼Œé…ç½®è·¯å¾„ï¼‰</p>
<p>Serverä¸­å¯ä»¥ä¿®æ”¹é»˜è®¤æµè§ˆå™¨ï¼Œå¯ä»¥ä¿®æ”¹ç«¯å£å·</p>
<p>Deploymentä¸­æ·»åŠ Artifact<br>xxx:war exploded</p>
<p>å³å¯å¯åŠ¨è¿è¡Œ<br>é»˜è®¤index.jspæ˜¾ç¤ºHello World!</p>
<h2 id="æ‰“åŒ…è¿è¡Œ"><a href="#æ‰“åŒ…è¿è¡Œ" class="headerlink" title="æ‰“åŒ…è¿è¡Œ"></a>æ‰“åŒ…è¿è¡Œ</h2><p>å³ä¾§Mavenå·¥å…·æ ä¸­<br>Lifecycle-&gt;package-&gt;Run Maven Build<br>install-&gt;Run â€˜xxx [install]â€™<br>æ‰“åŒ…æˆåŠŸåï¼Œåœ¨targetæ–‡ä»¶å¤¹ä¸‹</p>
<p>waråŒ…å¯ä»¥éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š</p>
<p>ä¹Ÿå¯ä»¥æ‹·è´åˆ°æœ¬åœ°Tomcatçš„webappç›®å½•ä¸‹<br>è¿è¡ŒTomcatçš„binç›®å½•ä¸‹çš„startupï¼Œå¯åŠ¨tomcat<br>å³å¯æµè§ˆå™¨è®¿é—®<br>ç»“æŸåshutdownå…³é—­Tomcat</p>
]]></content>
      <categories>
        <category>Note</category>
      </categories>
      <tags>
        <tag>tool</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯¾ç¨‹æ€»ç»“ æ°‘äº‹è¯‰è®¼æ³•</title>
    <url>/2020/02/22/mindmap/</url>
    <content><![CDATA[<blockquote>
<p>MOOC åŒ—äº¬äº¤é€šå¤§å­¦ æ¨å†› æ°‘äº‹è¯‰è®¼æ³•</p>
</blockquote>
<p>P1<br><img src="/images/2020/civil_procedure_law1.png"></p>
<p>P2<br><img src="/images/2020/civil_procedure_law2.png"></p>
<p>P3<br><img src="/images/2020/civil_procedure_law3.png"></p>
<p>P4<br><img src="/images/2020/civil_procedure_law4.png"></p>
]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯¾ç¨‹æ€»ç»“ å‹åŠ›ä¸æƒ…ç»ªç®¡ç†</title>
    <url>/2020/02/22/mindmap-stress/</url>
    <content><![CDATA[<blockquote>
<p>MOOC å››å·å¤§å­¦ æ¨é‘« å‹åŠ›ä¸æƒ…ç»ªç®¡ç†</p>
</blockquote>
<img src="/images/2020/stress.png">]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯¾ç¨‹æ€»ç»“ ä¿¡æ¯ç´ å…»ä¸å®è·µ</title>
    <url>/2020/02/22/mindmap-paper/</url>
    <content><![CDATA[<blockquote>
<p>å¤§ä¸‰ä¸Šçš„å…¬é€‰è¯¾</p>
</blockquote>
<img src="/images/2020/paper.png">

]]></content>
      <categories>
        <category>Memo</category>
      </categories>
      <tags>
        <tag>mindmap</tag>
      </tags>
  </entry>
</search>
